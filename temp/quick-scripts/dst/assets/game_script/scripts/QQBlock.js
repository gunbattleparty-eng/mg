
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/QQBlock.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'fbf0dlHowZG8Kd8MVs8n02g', 'QQBlock');
// game_script/scripts/QQBlock.js

"use strict";

var o;
exports.QQBlock = void 0;

var $aDConfig = require("./ADConfig");

var $baseAd = require("./BaseAd");

var a = window.qq;

var l = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.style = null;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (a && a.createBlockAd) {
        var t = this.style || {};
        var e = {
          adUnitId: this.adUnitId,
          style: {
            left: t.left || 20,
            top: t.top || 200
          },
          size: $aDConfig.ADConfig.qq.block_size,
          orientation: $aDConfig.ADConfig.qq.block_orientation
        };
        this.adIns = a.createBlockAd(e);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onResize) {
          this.adIns.onResize(this.onResize);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }
      } else {
        console.warn("当前平台不支持创建Block");
      }
    } else {
      console.error("QQ Block ID为空");
    }
  };

  e.prototype.showBlock = function (t, e, i) {
    var o = this;
    this.showCallback = e;
    this.errorCallback = i;

    if (this.isCanShow) {
      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        this.loadAd();
      }

      if (this.isConsume) {
        this.reCreateAd(!0);
      } else {
        {
          if (!this.isLoaded) {
            console.warn(this.adUnitId, ":未加载完成，稍等");
            return void (this.isAutoShow = !0);
          }

          if (this.adIns && t) {
            if (void 0 !== t.top) {
              this.adIns.style.top = t.top;
            }

            if (void 0 !== t.left) {
              this.adIns.style.left = t.left;
            }
          }

          this.style = t;
          this.isConsume = !1;

          if (this.adIns.show) {
            var n = this.adIns.show();
            n && n.then ? n.then(function () {
              o.isConsume = !0;

              if (o.showCallback) {
                o.showCallback();
              }

              o.showCallback = null;
            })["catch"](function (t) {
              console.warn(o.adUnitId, ":show错误，重新加载", t);
              o.reCreateAd(!0);
            }) : (console.warn(this.adUnitId, ":show显示失败，重新加载"), this.reCreateAd(!0));
          }
        }
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示");
    }
  };

  e.prototype.forbiddenBlock = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideBlock(!1);
    }
  };

  e.prototype.hideBlock = function (t) {
    t ? (this.destroyAd(), this.reCreateAd(!1)) : this.adIns && this.adIns.hide && this.adIns.hide();
  };

  e.prototype.onAdResize = function (t) {
    console.warn("onBlockResize", t);
    var e = a.getSystemInfoSync();
    var i = e.windowWidth;
    var o = e.windowHeight;
    var n = this.style || {};
    null != n.top ? this.adIns.style.top = n.top : this.adIns.style.top = Math.round(o - t.height - 50);
    null != n.left ? this.adIns.style.left = n.left : this.adIns.style.left = Math.round((i - t.width) / 2);
  };

  e.prototype.reCreateAd = function (t) {
    this.destroyAd();
    this.isAutoShow = t;
    this.loadAd();
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offResize) {
        this.adIns.offResize(this.onResize);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showBlock(this.style, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function () {
    t.prototype.onAdLoad.call(this);
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  return e;
}($baseAd.BaseAd);

exports.QQBlock = l;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFFRQmxvY2suanMiXSwibmFtZXMiOlsibyIsImV4cG9ydHMiLCJRUUJsb2NrIiwiJGFEQ29uZmlnIiwicmVxdWlyZSIsIiRiYXNlQWQiLCJhIiwid2luZG93IiwicXEiLCJsIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInN0eWxlIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwibG9hZEFkIiwiYWRVbml0SWQiLCJjcmVhdGVCbG9ja0FkIiwibGVmdCIsInRvcCIsInNpemUiLCJBRENvbmZpZyIsImJsb2NrX3NpemUiLCJvcmllbnRhdGlvbiIsImJsb2NrX29yaWVudGF0aW9uIiwiYWRJbnMiLCJvbkxvYWQiLCJvblJlc2l6ZSIsIm9uRXJyb3IiLCJjb25zb2xlIiwid2FybiIsImVycm9yIiwic2hvd0Jsb2NrIiwiaSIsInNob3dDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJpc0NhblNob3ciLCJpc0F1dG9TaG93IiwiaXNDb25zdW1lIiwicmVDcmVhdGVBZCIsImlzTG9hZGVkIiwic2hvdyIsIm4iLCJ0aGVuIiwiZm9yYmlkZGVuQmxvY2siLCJoaWRlQmxvY2siLCJkZXN0cm95QWQiLCJoaWRlIiwib25BZFJlc2l6ZSIsImdldFN5c3RlbUluZm9TeW5jIiwid2luZG93V2lkdGgiLCJ3aW5kb3dIZWlnaHQiLCJNYXRoIiwicm91bmQiLCJoZWlnaHQiLCJ3aWR0aCIsImNhbGwiLCJvZmZMb2FkIiwib2ZmUmVzaXplIiwib2ZmRXJyb3IiLCJkZXN0cm95IiwiYXV0b1Nob3ciLCJvbkFkTG9hZCIsIm9uQWRFcnJvciIsIkJhc2VBZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKO0FBQ0FDLE9BQU8sQ0FBQ0MsT0FBUixHQUFrQixLQUFLLENBQXZCOztBQUNBLElBQUlDLFNBQVMsR0FBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSUMsT0FBTyxH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LE9BQVg7TUFDSDs7TUFDRCxLQUFLbkMsS0FBTCxHQUFhLElBQWI7SUFDSDtFQUNKLENBakJEOztFQWtCQWhCLENBQUMsQ0FBQ0ssU0FBRixDQUFZK0MsUUFBWixHQUF1QixZQUFZO0lBQy9CLElBQUksS0FBS3hCLFVBQVQsRUFBcUI7TUFDakIsS0FBS0EsVUFBTCxHQUFrQixDQUFDLENBQW5CO01BQ0EsS0FBS0wsU0FBTCxDQUFlLEtBQUtwQixLQUFwQixFQUEyQixLQUFLc0IsWUFBaEMsRUFBOEMsS0FBS0MsYUFBbkQ7SUFDSDtFQUNKLENBTEQ7O0VBTUExQixDQUFDLENBQUNLLFNBQUYsQ0FBWWdELFFBQVosR0FBdUIsWUFBWTtJQUMvQnRELENBQUMsQ0FBQ00sU0FBRixDQUFZZ0QsUUFBWixDQUFxQk4sSUFBckIsQ0FBMEIsSUFBMUI7SUFDQSxLQUFLbEIsU0FBTCxHQUFpQixDQUFDLENBQWxCO0lBQ0EsS0FBS0UsUUFBTCxHQUFnQixDQUFDLENBQWpCO0lBQ0EsS0FBS3FCLFFBQUw7RUFDSCxDQUxEOztFQU1BcEQsQ0FBQyxDQUFDSyxTQUFGLENBQVlpRCxTQUFaLEdBQXdCLFVBQVV0RCxDQUFWLEVBQWE7SUFDakNELENBQUMsQ0FBQ00sU0FBRixDQUFZaUQsU0FBWixDQUFzQlAsSUFBdEIsQ0FBMkIsSUFBM0IsRUFBaUMvQyxDQUFqQzs7SUFDQSxJQUFJLEtBQUswQixhQUFULEVBQXdCO01BQ3BCLEtBQUtBLGFBQUw7SUFDSDs7SUFDRCxLQUFLVyxTQUFMO0VBQ0gsQ0FORDs7RUFPQSxPQUFPckMsQ0FBUDtBQUNILENBckpPLENBcUpMTixPQUFPLENBQUM2RCxNQXJKSCxDQUFSOztBQXNKQWpFLE9BQU8sQ0FBQ0MsT0FBUixHQUFrQk8sQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLlFRQmxvY2sgPSB2b2lkIDA7XHJcbnZhciAkYURDb25maWcgPSByZXF1aXJlKFwiLi9BRENvbmZpZ1wiKTtcclxudmFyICRiYXNlQWQgPSByZXF1aXJlKFwiLi9CYXNlQWRcIik7XHJcbnZhciBhID0gd2luZG93LnFxO1xyXG52YXIgbCA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLnN0eWxlID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmxvYWRBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAoYSAmJiBhLmNyZWF0ZUJsb2NrQWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5zdHlsZSB8fCB7fTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkVW5pdElkOiB0aGlzLmFkVW5pdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCB8fCAyMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0LnRvcCB8fCAyMDBcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNpemU6ICRhRENvbmZpZy5BRENvbmZpZy5xcS5ibG9ja19zaXplLFxyXG4gICAgICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uOiAkYURDb25maWcuQURDb25maWcucXEuYmxvY2tfb3JpZW50YXRpb25cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zID0gYS5jcmVhdGVCbG9ja0FkKGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25Mb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25SZXNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uUmVzaXplKHRoaXMub25SZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25FcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwi5b2T5YmN5bmz5Y+w5LiN5pSv5oyB5Yib5bu6QmxvY2tcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUVEgQmxvY2sgSUTkuLrnqbpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNob3dCbG9jayA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG8gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2hvd0NhbGxiYWNrID0gZTtcclxuICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2sgPSBpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2FuU2hvdykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliJvlu7rvvIzmiafooYzliJvlu7pcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMDtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZEFkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNDb25zdW1lKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlQ3JlYXRlQWQoITApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0xvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yqg6L295a6M5oiQ77yM56iN562JXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAodGhpcy5pc0F1dG9TaG93ID0gITApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucyAmJiB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHQudG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IHQudG9wO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHQubGVmdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5zdHlsZS5sZWZ0ID0gdC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUgPSB0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNDb25zdW1lID0gITE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMuc2hvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXMuYWRJbnMuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuICYmIG4udGhlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5pc0NvbnN1bWUgPSAhMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5zaG93Q2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93Q2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihvLmFkVW5pdElkLCBcIjpzaG936ZSZ6K+v77yM6YeN5paw5Yqg6L29XCIsIHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8ucmVDcmVhdGVBZCghMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOnNob3fmmL7npLrlpLHotKXvvIzph43mlrDliqDovb1cIiksIHRoaXMucmVDcmVhdGVBZCghMCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrlvZPliY3lub/lkYrnpoHmraLmmL7npLpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmZvcmJpZGRlbkJsb2NrID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmlzQ2FuU2hvdyA9ICF0O1xyXG4gICAgICAgIGlmICh0ICYmIHRoaXMuaXNDb25zdW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZUJsb2NrKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuaGlkZUJsb2NrID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0ID8gKHRoaXMuZGVzdHJveUFkKCksIHRoaXMucmVDcmVhdGVBZCghMSkpIDogdGhpcy5hZElucyAmJiB0aGlzLmFkSW5zLmhpZGUgJiYgdGhpcy5hZElucy5oaWRlKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZFJlc2l6ZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKFwib25CbG9ja1Jlc2l6ZVwiLCB0KTtcclxuICAgICAgICB2YXIgZSA9IGEuZ2V0U3lzdGVtSW5mb1N5bmMoKTtcclxuICAgICAgICB2YXIgaSA9IGUud2luZG93V2lkdGg7XHJcbiAgICAgICAgdmFyIG8gPSBlLndpbmRvd0hlaWdodDtcclxuICAgICAgICB2YXIgbiA9IHRoaXMuc3R5bGUgfHwge307XHJcbiAgICAgICAgbnVsbCAhPSBuLnRvcCA/ICh0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IG4udG9wKSA6ICh0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IE1hdGgucm91bmQobyAtIHQuaGVpZ2h0IC0gNTApKTtcclxuICAgICAgICBudWxsICE9IG4ubGVmdCA/ICh0aGlzLmFkSW5zLnN0eWxlLmxlZnQgPSBuLmxlZnQpIDogKHRoaXMuYWRJbnMuc3R5bGUubGVmdCA9IE1hdGgucm91bmQoKGkgLSB0LndpZHRoKSAvIDIpKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZUNyZWF0ZUFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lBZCgpO1xyXG4gICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9IHQ7XHJcbiAgICAgICAgdGhpcy5sb2FkQWQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5kZXN0cm95QWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUuZGVzdHJveUFkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZMb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZSZXNpemUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmUmVzaXplKHRoaXMub25SZXNpemUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZkVycm9yKHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMuZGVzdHJveSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5hZElucyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmF1dG9TaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQXV0b1Nob3cpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0F1dG9TaG93ID0gITE7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0Jsb2NrKHRoaXMuc3R5bGUsIHRoaXMuc2hvd0NhbGxiYWNrLCB0aGlzLmVycm9yQ2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkTG9hZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaXNDb25zdW1lID0gITE7XHJcbiAgICAgICAgdGhpcy5pc0xvYWRlZCA9ICEwO1xyXG4gICAgICAgIHRoaXMuYXV0b1Nob3coKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRFcnJvci5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlQWQuQmFzZUFkKTtcclxuZXhwb3J0cy5RUUJsb2NrID0gbDtcclxuIl19