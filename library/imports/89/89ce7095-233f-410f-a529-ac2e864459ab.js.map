{"version":3,"sources":["assets\\game_script\\scripts\\Egg1.js"],"names":["o","$assetsMap","require","$popupManager","$globalParam","$userDataContext","u","cc","_decorator","d","ccclass","p","property","f","t","e","apply","arguments","prop","box","count","dir","initPos","isKey","isTouchProp","dis","__extends","prototype","start","position","clone","on","Node","EventType","TOUCH_START","touchProp","TOUCH_MOVE","moveProp","TOUCH_END","endProp","TOUCH_CANCEL","touchBox","add","v3","getDelta","getDeltaX","renderProp","stopPropagationImmediate","sub","mag","active","getComponent","dragonBones","ArmatureDisplay","playAnimation","once","EventObject","COMPLETE","isGamePuase","PopupManager","instance","open","AssetsMap","PopUpBundles","prefabs","assetsList","EggKeyView","type","closeCallback","Ins","getEgg","children","length","__decorate","Component","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar u = cc._decorator;\r\nvar d = u.ccclass;\r\nvar p = u.property;\r\nvar f = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.prop = null;\r\n        e.box = null;\r\n        e.count = 0;\r\n        e.dir = -1;\r\n        e.initPos = null;\r\n        e.isKey = !1;\r\n        e.isTouchProp = !1;\r\n        e.dis = 0;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.start = function () {\r\n        this.initPos = this.prop.position.clone();\r\n        this.prop.on(cc.Node.EventType.TOUCH_START, this.touchProp, this);\r\n        this.prop.on(cc.Node.EventType.TOUCH_MOVE, this.moveProp, this);\r\n        this.prop.on(cc.Node.EventType.TOUCH_END, this.endProp, this);\r\n        this.prop.on(cc.Node.EventType.TOUCH_CANCEL, this.endProp, this);\r\n        this.box.on(cc.Node.EventType.TOUCH_START, this.touchBox, this);\r\n    };\r\n    e.prototype.touchProp = function () {\r\n        this.isTouchProp = !0;\r\n    };\r\n    e.prototype.moveProp = function (t) {\r\n        this.count >= 3\r\n            ? this.isTouchProp && (this.prop.position = this.prop.position.add(cc.v3(t.getDelta())))\r\n            : ((this.dis += t.getDeltaX()),\r\n              -1 === this.dir\r\n                  ? this.dis >= 30 && ((this.dis = 0), this.count++, (this.dir = 1), this.renderProp())\r\n                  : this.dis <= -30 && ((this.dis = 0), this.count++, (this.dir = -1), this.renderProp()),\r\n              this.count >= 3 && (t.stopPropagationImmediate(), (this.isTouchProp = !1), this.renderProp()));\r\n    };\r\n    e.prototype.endProp = function () {\r\n        this.isTouchProp = !1;\r\n        if (!(this.count < 3)) {\r\n            if (this.prop.position.sub(this.box.position).mag() < 100) {\r\n                this.prop.active = !1;\r\n                var t = this.box.getComponent(dragonBones.ArmatureDisplay);\r\n                this.prop.active = !1;\r\n                t.playAnimation(\"qiao_2\", 1);\r\n                t.once(\r\n                    dragonBones.EventObject.COMPLETE,\r\n                    function () {\r\n                        t.playAnimation(\"qiao_3\", 1);\r\n                    },\r\n                    this\r\n                );\r\n            } else {\r\n                this.prop.position = this.initPos.clone();\r\n            }\r\n        }\r\n    };\r\n    e.prototype.touchBox = function () {\r\n        var t = this;\r\n        if (!(this.prop.active || this.isKey || $globalParam.default.isGamePuase)) {\r\n            $globalParam.default.isGamePuase = !0;\r\n            $popupManager.PopupManager.instance.open(\r\n                $assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.EggKeyView,\r\n                {\r\n                    type: 1\r\n                },\r\n                {\r\n                    closeCallback: function () {\r\n                        $globalParam.default.isGamePuase = !1;\r\n                        if ($userDataContext.default.Ins.getEgg(1) >= 1) {\r\n                            t.box.getComponent(dragonBones.ArmatureDisplay).playAnimation(\"qiao_4\", 0);\r\n                            t.isKey = !0;\r\n                        }\r\n                    }\r\n                }\r\n            );\r\n        }\r\n    };\r\n    e.prototype.renderProp = function () {\r\n        for (var t = 0; t < this.prop.children.length; t++) {\r\n            this.prop.children[t].active = t === this.count;\r\n        }\r\n    };\r\n    __decorate([p(cc.Node)], e.prototype, \"prop\", void 0);\r\n    __decorate([p(cc.Node)], e.prototype, \"box\", void 0);\r\n    return __decorate([d], e);\r\n})(cc.Component);\r\nexports.default = f;\r\n"]}