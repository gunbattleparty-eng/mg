{"version":3,"sources":["assets\\game_script\\scripts\\Bullet_17.js"],"names":["o","$util","require","$gameSkillInfo","$baseBullet","$bullet_17_1","u","cc","_decorator","d","ccclass","p","property","f","size","Vec3","ZERO","h","t","e","apply","arguments","sourceNode","lineNode","lineBody","linePool","NodePool","lineBodyPool","currLineNodes","currLineBodyNodes","__extends","prototype","initButtle","i","call","clearStatus","atk","skillParam","skillAtk","Skill4Param","FINAL","render","length","n","getLine","active","push","parent","node","s","getLineBody","getComponent","insert","a","pop","width","put","remove","l","sub","position","x","y","id","dirConverAngle","angle","mag","setPosition","add","height","guideLaserWidth","children","refreshBullet17","get","instantiate","clear","forEach","onDestroy","removeSelf","updateFrame","__decorate","Node","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $util = require(\"./Util\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $bullet_17_1 = require(\"./Bullet_17_1\");\r\nvar u = cc._decorator;\r\nvar d = u.ccclass;\r\nvar p = u.property;\r\nvar f = (cc.size(0, 0), cc.Vec3.ZERO);\r\nvar h = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.sourceNode = null;\r\n        e.lineNode = null;\r\n        e.lineBody = null;\r\n        e.linePool = new cc.NodePool();\r\n        e.lineBodyPool = new cc.NodePool();\r\n        e.currLineNodes = [];\r\n        e.currLineBodyNodes = [];\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.initButtle = function (e, i) {\r\n        t.prototype.initButtle.call(this, null, i);\r\n        this.clearStatus();\r\n        this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];\r\n    };\r\n    e.prototype.render = function (t, e) {\r\n        if (t.length > this.currLineNodes.length) {\r\n            var i = t.length - this.currLineNodes.length;\r\n            for (var o = 0; o < i; o++) {\r\n                var n = this.getLine();\r\n                n.active = !0;\r\n                this.currLineNodes.push(n);\r\n                n.parent = this.node;\r\n                (s = this.getLineBody()).active = !0;\r\n                this.currLineBodyNodes.push(s);\r\n                s.getComponent($bullet_17_1.default).insert(this.node);\r\n            }\r\n        } else {\r\n            if (t.length < this.currLineNodes.length) {\r\n                i = this.currLineNodes.length - t.length;\r\n                for (o = 0; o < i; o++) {\r\n                    var s;\r\n                    var a = this.currLineNodes.pop();\r\n                    a.width = 0;\r\n                    this.linePool.put(a);\r\n                    (s = this.currLineBodyNodes.pop()).getComponent($bullet_17_1.default).remove(!1);\r\n                    s.parent = null;\r\n                    this.lineBodyPool.put(s);\r\n                }\r\n            }\r\n        }\r\n        var l = t[0].sub(this.node.position);\r\n        for (o = 0; o < t.length; o++) {\r\n            f.x = 0;\r\n            f.y = 0;\r\n            var u = this.currLineBodyNodes[o].getComponent($bullet_17_1.default);\r\n            var d = e && e.length > o ? e[o].id : -1;\r\n            if (0 === o) {\r\n                var p = $util.default.dirConverAngle(l);\r\n                this.currLineNodes[o].angle = p;\r\n                this.currLineNodes[o].width = l.mag();\r\n                this.sourceNode.angle = p;\r\n                this.currLineNodes[o].setPosition(0, 0);\r\n            } else {\r\n                this.currLineNodes[o].position = l.add(this.currLineNodes[o - 1].position);\r\n                l = t[o].sub(t[o - 1]);\r\n                this.currLineNodes[o].angle = $util.default.dirConverAngle(l);\r\n                this.currLineNodes[o].width = l.mag();\r\n            }\r\n            this.currLineNodes[o].height = this.lineNode.height * this.skillParam.guideLaserWidth;\r\n            this.currLineNodes[o].children[0].setPosition(this.currLineNodes[o].width, 0);\r\n            f.x = this.currLineNodes[o].x;\r\n            f.y = this.currLineNodes[o].y;\r\n            u.setPosition(f);\r\n            u.refreshBullet17(d, this.currLineNodes[o].angle, this.currLineNodes[o].width);\r\n        }\r\n    };\r\n    e.prototype.getLineBody = function () {\r\n        return this.lineBodyPool.size() > 0 ? this.lineBodyPool.get() : cc.instantiate(this.lineBody);\r\n    };\r\n    e.prototype.getLine = function () {\r\n        return this.linePool.size() > 0 ? this.linePool.get() : cc.instantiate(this.lineNode);\r\n    };\r\n    e.prototype.clear = function () {\r\n        var t = this;\r\n        this.currLineNodes.forEach(function (e) {\r\n            e.width = 0;\r\n            t.linePool.put(e);\r\n        });\r\n        this.currLineBodyNodes.forEach(function (e) {\r\n            e.getComponent($bullet_17_1.default).remove(!1);\r\n            e.parent = null;\r\n            t.lineBodyPool.put(e);\r\n        });\r\n        this.currLineNodes.length = 0;\r\n        this.currLineBodyNodes.length = 0;\r\n    };\r\n    e.prototype.onDestroy = function () {\r\n        this.linePool.clear();\r\n        this.lineBodyPool.clear();\r\n    };\r\n    e.prototype.removeSelf = function (e) {\r\n        if (void 0 === e) {\r\n            e = !0;\r\n        }\r\n        this.clear();\r\n        t.prototype.removeSelf.call(this, e);\r\n    };\r\n    e.prototype.updateFrame = function () {};\r\n    __decorate([p(cc.Node)], e.prototype, \"sourceNode\", void 0);\r\n    __decorate([p(cc.Node)], e.prototype, \"lineNode\", void 0);\r\n    __decorate([p(cc.Node)], e.prototype, \"lineBody\", void 0);\r\n    return __decorate([d], e);\r\n})($baseBullet.default);\r\nexports.default = h;\r\n"]}