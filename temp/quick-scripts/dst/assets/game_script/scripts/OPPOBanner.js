
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/OPPOBanner.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'd1b45VXjNxBrJhWY57+VyPO', 'OPPOBanner');
// game_script/scripts/OPPOBanner.js

"use strict";

var o;
exports.OPPOBanner = void 0;

var $aDConfig = require("./ADConfig");

var $baseAd = require("./BaseAd");

var a = window.qg;

var l = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.style = null;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (a && a.createBannerAd) {
        var t = this.style || {};
        var e = {
          adUnitId: this.adUnitId,
          style: {
            left: t.left || 0,
            top: t.top || 0,
            width: t.width || $aDConfig.ADConfig.oppo.banner_width,
            height: 0
          }
        };
        this.adIns = a.createBannerAd(e);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onHide) {
          this.adIns.onHide(this.onHide);
        }

        if (this.adIns.onResize) {
          this.adIns.onResize(this.onResize);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }
      } else {
        console.warn("当前平台不支持创建banner");
      }
    } else {
      console.warn("OPPOBanner ID为空");
    }
  };

  e.prototype.showBanner = function (t, e, i) {
    var o = this;
    this.showCallback = e;
    this.errorCallback = i;

    if (this.isCanShow) {
      if (this.hideing) {
        console.warn(this.adUnitId, ":正在影藏中稍后显示");
        return void (this.isAutoShow = !0);
      }

      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        return this.loadAd();
      }

      if (this.isConsume) {
        return this.reCreateAd(!0);
      }

      if (!this.isLoaded) {
        console.warn(this.adUnitId, ":未加载完成，稍等");
        return void (this.isAutoShow = !0);
      }

      if (this.adIns && t) {
        if (void 0 !== t.top) {
          this.adIns.style.top = t.top;
        }

        if (void 0 !== t.left) {
          this.adIns.style.left = t.left;
        }

        if (void 0 !== t.width) {
          this.adIns.style.width = t.width;
        }
      }

      this.showing = !1;
      this.isConsume = !1;

      if (this.adIns.show) {
        var n = this.adIns.show();
        n && n.then ? n.then(function () {
          o.isConsume = !0;
          o.showing = !0;

          if (o.showCallback) {
            o.showCallback();
          }

          o.showCallback = null;
        })["catch"](function (t) {
          console.warn(o.adUnitId, ":执行显示错误错误，重新加载", t);
          o.reCreateAd(!0);
        }) : (console.warn(this.adUnitId, ":执行显示错误显示失败，重新加载"), this.reCreateAd(!0));
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示");
    }
  };

  e.prototype.hideBanner = function (t) {
    t && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : this.adIns && this.adIns.hide && this.adIns.hide();
  };

  e.prototype.forbiddenBanner = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideBanner(!1);
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showBanner(this.style, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function () {
    console.log(this.adUnitId, ":===onAdload===");
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (t) {
    console.error("onAdError", this.adUnitId, t);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdHide = function () {
    console.log(this.adUnitId, "===onAdHide===");
    this.hideing = !1;
    this.autoShow();
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offHide) {
        this.adIns.offHide(this.onHide);
      }

      if (this.adIns.offResize) {
        this.adIns.offResize(this.onResize);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }
    }
  };

  return e;
}($baseAd.BaseAd);

exports.OPPOBanner = l;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXE9QUE9CYW5uZXIuanMiXSwibmFtZXMiOlsibyIsImV4cG9ydHMiLCJPUFBPQmFubmVyIiwiJGFEQ29uZmlnIiwicmVxdWlyZSIsIiRiYXNlQWQiLCJhIiwid2luZG93IiwicWciLCJsIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInN0eWxlIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwibG9hZEFkIiwiYWRVbml0SWQiLCJjcmVhdGVCYW5uZXJBZCIsImxlZnQiLCJ0b3AiLCJ3aWR0aCIsIkFEQ29uZmlnIiwib3BwbyIsImJhbm5lcl93aWR0aCIsImhlaWdodCIsImFkSW5zIiwib25Mb2FkIiwib25IaWRlIiwib25SZXNpemUiLCJvbkVycm9yIiwiY29uc29sZSIsIndhcm4iLCJzaG93QmFubmVyIiwiaSIsInNob3dDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJpc0NhblNob3ciLCJoaWRlaW5nIiwiaXNBdXRvU2hvdyIsImlzQ29uc3VtZSIsInJlQ3JlYXRlQWQiLCJpc0xvYWRlZCIsInNob3dpbmciLCJzaG93IiwibiIsInRoZW4iLCJoaWRlQmFubmVyIiwiZGVzdHJveUFkIiwiaGlkZSIsImZvcmJpZGRlbkJhbm5lciIsImF1dG9TaG93Iiwib25BZExvYWQiLCJsb2ciLCJvbkFkRXJyb3IiLCJlcnJvciIsIm9uQWRIaWRlIiwiY2FsbCIsIm9mZkxvYWQiLCJvZmZIaWRlIiwib2ZmUmVzaXplIiwib2ZmRXJyb3IiLCJCYXNlQWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjtBQUNBQyxPQUFPLENBQUNDLFVBQVIsR0FBcUIsS0FBSyxDQUExQjs7QUFDQSxJQUFJQyxTQUFTLEdBQUdDLE9BQU8sQ0FBQyxZQUFELENBQXZCOztBQUNBLElBQUlDLE9BQU8sR0FBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0EsSUFBSUUsQ0FBQyxHQUFHQyxNQUFN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QUFMLENBQVdpQyxPQUFmLEVBQXdCO1FBQ3BCLEtBQUtqQyxLQUFMLENBQVdpQyxPQUFYLENBQW1CLEtBQUsvQixNQUF4QjtNQUNIOztNQUNELElBQUksS0FBS0YsS0FBTCxDQUFXa0MsU0FBZixFQUEwQjtRQUN0QixLQUFLbEMsS0FBTCxDQUFXa0MsU0FBWCxDQUFxQixLQUFLL0IsUUFBMUI7TUFDSDs7TUFDRCxJQUFJLEtBQUtILEtBQUwsQ0FBV21DLFFBQWYsRUFBeUI7UUFDckIsS0FBS25DLEtBQUwsQ0FBV21DLFFBQVgsQ0FBb0IsS0FBSy9CLE9BQXpCO01BQ0g7SUFDSjtFQUNKLENBaEJEOztFQWlCQSxPQUFPcEIsQ0FBUDtBQUNILENBckpPLENBcUpMTixPQUFPLENBQUMwRCxNQXJKSCxDQUFSOztBQXNKQTlELE9BQU8sQ0FBQ0MsVUFBUixHQUFxQk8sQ0FBckIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLk9QUE9CYW5uZXIgPSB2b2lkIDA7XHJcbnZhciAkYURDb25maWcgPSByZXF1aXJlKFwiLi9BRENvbmZpZ1wiKTtcclxudmFyICRiYXNlQWQgPSByZXF1aXJlKFwiLi9CYXNlQWRcIik7XHJcbnZhciBhID0gd2luZG93LnFnO1xyXG52YXIgbCA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLnN0eWxlID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmxvYWRBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAoYSAmJiBhLmNyZWF0ZUJhbm5lckFkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdCA9IHRoaXMuc3R5bGUgfHwge307XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBhZFVuaXRJZDogdGhpcy5hZFVuaXRJZCxcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0LmxlZnQgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0LnRvcCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdC53aWR0aCB8fCAkYURDb25maWcuQURDb25maWcub3Bwby5iYW5uZXJfd2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zID0gYS5jcmVhdGVCYW5uZXJBZChlKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25Mb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uSGlkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25IaWRlKHRoaXMub25IaWRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uUmVzaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vblJlc2l6ZSh0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uRXJyb3IodGhpcy5vbkVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuW9k+WJjeW5s+WPsOS4jeaUr+aMgeWIm+W7umJhbm5lclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIk9QUE9CYW5uZXIgSUTkuLrnqbpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNob3dCYW5uZXIgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBvID0gdGhpcztcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gaTtcclxuICAgICAgICBpZiAodGhpcy5pc0NhblNob3cpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaGlkZWluZykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuato+WcqOW9seiXj+S4reeojeWQjuaYvuekulwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yib5bu677yM5omn6KGM5Yib5bu6XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0F1dG9TaG93ID0gITA7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2FkQWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0NvbnN1bWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlQ3JlYXRlQWQoITApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc0xvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuacquWKoOi9veWujOaIkO+8jOeojeetiVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMgJiYgdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdC50b3ApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IHQudG9wO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdC5sZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5zdHlsZS5sZWZ0ID0gdC5sZWZ0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdC53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuc3R5bGUud2lkdGggPSB0LndpZHRoO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5zaG93KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXMuYWRJbnMuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgbiAmJiBuLnRoZW5cclxuICAgICAgICAgICAgICAgICAgICA/IG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uaXNDb25zdW1lID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd2luZyA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoby5zaG93Q2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihvLmFkVW5pdElkLCBcIjrmiafooYzmmL7npLrplJnor6/plJnor6/vvIzph43mlrDliqDovb1cIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8ucmVDcmVhdGVBZCghMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65omn6KGM5pi+56S66ZSZ6K+v5pi+56S65aSx6LSl77yM6YeN5paw5Yqg6L29XCIpLCB0aGlzLnJlQ3JlYXRlQWQoITApKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrlvZPliY3lub/lkYrnpoHmraLmmL7npLpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmhpZGVCYW5uZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHQgJiYgdGhpcy5pc0NvbnN1bWVcclxuICAgICAgICAgICAgPyAodGhpcy5kZXN0cm95QWQoKSwgdGhpcy5yZUNyZWF0ZUFkKCExKSlcclxuICAgICAgICAgICAgOiB0aGlzLmFkSW5zICYmIHRoaXMuYWRJbnMuaGlkZSAmJiB0aGlzLmFkSW5zLmhpZGUoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5mb3JiaWRkZW5CYW5uZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHRoaXMuaXNDYW5TaG93ID0gIXQ7XHJcbiAgICAgICAgaWYgKHQgJiYgdGhpcy5pc0NvbnN1bWUpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWRlQmFubmVyKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYXV0b1Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvU2hvdykge1xyXG4gICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaG93QmFubmVyKHRoaXMuc3R5bGUsIHRoaXMuc2hvd0NhbGxiYWNrLCB0aGlzLmVycm9yQ2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFkVW5pdElkLCBcIjo9PT1vbkFkbG9hZD09PVwiKTtcclxuICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSAhMDtcclxuICAgICAgICB0aGlzLmF1dG9TaG93KCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZEVycm9yID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwib25BZEVycm9yXCIsIHRoaXMuYWRVbml0SWQsIHQpO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZEhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5hZFVuaXRJZCwgXCI9PT1vbkFkSGlkZT09PVwiKTtcclxuICAgICAgICB0aGlzLmhpZGVpbmcgPSAhMTtcclxuICAgICAgICB0aGlzLmF1dG9TaG93KCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmSGlkZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZIaWRlKHRoaXMub25IaWRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZSZXNpemUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmUmVzaXplKHRoaXMub25SZXNpemUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZkVycm9yKHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlQWQuQmFzZUFkKTtcclxuZXhwb3J0cy5PUFBPQmFubmVyID0gbDtcclxuIl19