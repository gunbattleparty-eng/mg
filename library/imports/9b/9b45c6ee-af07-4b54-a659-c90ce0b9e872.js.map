{"version":3,"sources":["assets\\game_script\\scripts\\RBullet_1.js"],"names":["o","$object","require","$motionTrail","$componentProxy","$seedUtil","$util","$gameContext","$baseBullet","f","cc","_decorator","h","ccclass","m","property","Vec3","ZERO","y","t","e","apply","arguments","buttleType","BulletType","r_bullet_1","angleSpeed","randomeAngle","targetEnemy","targetPos","tail","__extends","prototype","initRBullet","i","atk","speed","getPosition","clone","addDieCallback","dieEnemy","n","subtract","normalize","s","dirConverAngle","r","randomFrom","probability","angleConverDir","initButtle","call","velocity","set","multiplyScalar","node","getComponent","onTrigger","isUse","Trigger","enter","object","sufferAtk","skillSpecialitys","removeSelf","updateFrame","isActive","isDie","parent","x","trace","lerpAngleRes","setAngle","normalizeSelf","mulSelf","move","z","setPosition","checkBoundary","magSqr","Ins","removeObj","ins","putButtlePool","angle","Math","abs","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $motionTrail = require(\"./MotionTrail\");\r\nvar $componentProxy = require(\"./ComponentProxy\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar f = cc._decorator;\r\nvar h = f.ccclass;\r\nvar m = (f.property, cc.Vec3.ZERO);\r\nvar y = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.buttleType = $baseBullet.BulletType.r_bullet_1;\r\n        e.angleSpeed = 100;\r\n        e.randomeAngle = 30;\r\n        e.targetEnemy = null;\r\n        e.targetPos = null;\r\n        e.tail = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.initRBullet = function (e, i, o) {\r\n        this.atk = i;\r\n        this.speed = o;\r\n        this.targetPos = e.getPosition().clone();\r\n        this.targetEnemy = e;\r\n        this.targetEnemy.addDieCallback(this.dieEnemy, this);\r\n        var n = this.targetEnemy.getPosition().subtract(this.getPosition()).normalize();\r\n        var s = $util.default.dirConverAngle(n);\r\n        var r = $seedUtil.default.randomFrom(this.randomeAngle - 10, this.randomeAngle + 10);\r\n        s += r = $seedUtil.default.probability(50) ? r : -r;\r\n        n = $util.default.angleConverDir(s);\r\n        t.prototype.initButtle.call(this, n, null);\r\n        if (n) {\r\n            this.velocity.set(n).multiplyScalar(this.speed);\r\n        }\r\n        if (!this.tail) {\r\n            this.tail = this.node.getComponent($motionTrail.default);\r\n        }\r\n    };\r\n    e.prototype.dieEnemy = function (t) {\r\n        if (t === this.targetEnemy) {\r\n            this.targetPos = t.getPosition().clone();\r\n            this.targetEnemy = null;\r\n        }\r\n    };\r\n    e.prototype.onTrigger = function (t, e) {\r\n        if (!this.isUse) {\r\n            if (e == $object.Trigger.enter) {\r\n                t.object.sufferAtk({\r\n                    skillSpecialitys: [],\r\n                    atk: this.atk\r\n                });\r\n                this.targetEnemy = null;\r\n                this.removeSelf();\r\n            }\r\n        }\r\n    };\r\n    e.prototype.updateFrame = function (t) {\r\n        if (!this.tail.isActive) {\r\n            this.tail.isActive = !0;\r\n        }\r\n        if (this.targetEnemy) {\r\n            if (this.targetEnemy.isDie() || null == this.targetEnemy.node.parent) {\r\n                this.targetEnemy = null;\r\n                m.x = this.targetPos.x;\r\n                m.y = this.targetPos.y;\r\n                return void this.trace(m, t);\r\n            }\r\n            this.targetPos.set(this.targetEnemy.getPosition());\r\n            this.trace(this.targetEnemy.getPosition(), t);\r\n        } else {\r\n            m.x = this.targetPos.x;\r\n            m.y = this.targetPos.y;\r\n            this.trace(m, t);\r\n        }\r\n    };\r\n    e.prototype.trace = function (t, e) {\r\n        var i = this.lerpAngleRes(t.subtract(this.getPosition()), e);\r\n        this.setAngle(i);\r\n        this.velocity.set($util.default.angleConverDir(i).normalizeSelf()).mulSelf(this.speed);\r\n        this.move(e);\r\n    };\r\n    e.prototype.move = function (t) {\r\n        var e = this.getPosition();\r\n        var i = this.velocity;\r\n        m.x = e.x + i.x * t;\r\n        m.y = e.y + i.y * t;\r\n        m.z = e.z + i.z * t;\r\n        this.setPosition(m);\r\n        return this.checkBoundary()\r\n            ? !this.targetEnemy && m.subtract(this.targetPos).magSqr() <= 900\r\n                ? this.removeSelf()\r\n                : void 0\r\n            : this.removeSelf();\r\n    };\r\n    e.prototype.removeSelf = function (t) {\r\n        if (void 0 === t) {\r\n            t = !0;\r\n        }\r\n        this.tail.isActive = !1;\r\n        $componentProxy.default.Ins.removeObj(this);\r\n        if (t) {\r\n            $gameContext.default.ins.putButtlePool(this);\r\n        }\r\n    };\r\n    e.prototype.lerpAngleRes = function (t, e) {\r\n        var i = ($util.default.dirConverAngle(t) + 360) % 360;\r\n        var o = (this.node.angle + 360) % 360;\r\n        return Math.abs(o - i) <= this.angleSpeed * e\r\n            ? i\r\n            : ((o - i + 360) % 360 < (i - o + 360) % 360 ? (o -= this.angleSpeed * e) : (o += this.angleSpeed * e), o);\r\n    };\r\n    return __decorate([h], e);\r\n})($baseBullet.default);\r\nexports.default = y;\r\n"]}