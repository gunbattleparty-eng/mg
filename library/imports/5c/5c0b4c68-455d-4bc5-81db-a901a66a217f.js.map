{"version":3,"sources":["assets\\game_script\\scripts\\GeService.js"],"names":["exports","GeService","$login","require","$platform","$storageUtil","$switchContext","a","t","isRegister","isInit","ge","param","ttAccessToken","wxAccessToken","ksAccessToken","isDebug","prototype","start","Platform","currPlatForm","PlatformEnum","TOU_TIAO","WECHAT","KS","SwitchContext","geParam","StorageUtil","getItem","init","getOpenId","e","i","accessToken","clientId","autoTrack","appLaunch","appShow","appHide","name","debugMode","GravityAnalyticsAPI","setupAndStart","console","log","register","version","openid","enable_sync_attribution","initialize","then","JSON","stringify","setItem","error","reportBytedanceAdToGravity","Login","instance","ttOpenId","warn","reportWxAdToGravity","wxOpenId","adShowEvent","custom_param","ksOpenId"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.GeService = void 0;\r\nvar $login = require(\"./Login\");\r\nvar $platform = require(\"./Platform\");\r\nvar $storageUtil = require(\"./StorageUtil\");\r\nvar $switchContext = require(\"./SwitchContext\");\r\nvar a = (function () {\r\n    function t() {\r\n        this.isRegister = !1;\r\n        this.isInit = !1;\r\n        this.ge = null;\r\n        this.param = {\r\n            ttAccessToken: \"\",\r\n            wxAccessToken: \"\",\r\n            ksAccessToken: \"\",\r\n            isDebug: !1\r\n        };\r\n    }\r\n    t.prototype.start = function () {\r\n        if (\r\n            !(\r\n                $platform.Platform.currPlatForm !== $platform.PlatformEnum.TOU_TIAO &&\r\n                $platform.Platform.currPlatForm !== $platform.PlatformEnum.WECHAT &&\r\n                $platform.Platform.currPlatForm !== $platform.PlatformEnum.KS\r\n            )\r\n        ) {\r\n            this.param = $switchContext.SwitchContext.geParam;\r\n            this.isRegister = $storageUtil.StorageUtil.getItem(\"GE_ISREGISTER\", !1, !1);\r\n            this.init();\r\n        }\r\n    };\r\n    t.prototype.init = function () {\r\n        if (\r\n            $platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO ||\r\n            $platform.Platform.currPlatForm === $platform.PlatformEnum.KS ||\r\n            $platform.Platform.currPlatForm === $platform.PlatformEnum.WECHAT\r\n        ) {\r\n            var t = this.getOpenId();\r\n            if (\"\" !== t && !this.isInit) {\r\n                var e = \"\";\r\n                $platform.Platform.currPlatForm === $platform.PlatformEnum.WECHAT\r\n                    ? (e = this.param.wxAccessToken)\r\n                    : $platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO\r\n                    ? (e = this.param.ttAccessToken)\r\n                    : $platform.Platform.currPlatForm === $platform.PlatformEnum.KS && (e = this.param.ksAccessToken);\r\n                if (\"\" !== e) {\r\n                    var i = {\r\n                        accessToken: e,\r\n                        clientId: t,\r\n                        autoTrack: {\r\n                            appLaunch: !0,\r\n                            appShow: !0,\r\n                            appHide: !0\r\n                        },\r\n                        name: \"ge\",\r\n                        debugMode: this.param.isDebug ? \"debug\" : \"none\"\r\n                    };\r\n                    this.ge = new GravityAnalyticsAPI(i);\r\n                    this.ge.setupAndStart();\r\n                    this.isInit = !0;\r\n                    console.log(\"=========GE 初始化完成==========\");\r\n                    this.register();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    t.prototype.register = function () {\r\n        var t = this;\r\n        var e = \"\";\r\n        $platform.Platform.currPlatForm === $platform.PlatformEnum.WECHAT\r\n            ? (e = this.param.wxAccessToken)\r\n            : $platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO\r\n            ? (e = this.param.ttAccessToken)\r\n            : $platform.Platform.currPlatForm === $platform.PlatformEnum.KS && (e = this.param.ksAccessToken);\r\n        if (\"\" !== e) {\r\n            if (this.isRegister) {\r\n                console.log(\"=========玩家已经注册=======\");\r\n            } else {\r\n                {\r\n                    var i = this.getOpenId();\r\n                    \"\" !== i\r\n                        ? (console.log(\"参数：\", {\r\n                              name: i,\r\n                              version: 1,\r\n                              openid: i,\r\n                              enable_sync_attribution: !1\r\n                          }),\r\n                          this.ge\r\n                              .initialize({\r\n                                  name: i,\r\n                                  version: 1,\r\n                                  openid: i,\r\n                                  enable_sync_attribution: !1\r\n                              })\r\n                              .then(function (e) {\r\n                                  console.log(\"register success \" + JSON.stringify(e));\r\n                                  t.isRegister = !0;\r\n                                  $storageUtil.StorageUtil.setItem(\"GE_ISREGISTER\", !0, !1);\r\n                              })\r\n                              .catch(function (t) {\r\n                                  console.log(\"register failed, error is \" + JSON.stringify(t));\r\n                              }))\r\n                        : console.error(\"openID为空\");\r\n                }\r\n            }\r\n        }\r\n    };\r\n    t.prototype.reportBytedanceAdToGravity = function (t) {\r\n        if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {\r\n            this.isInit && this.isRegister && \"\" !== t && \"\" !== $login.Login.instance.ttOpenId\r\n                ? console.log(\"抖音AD上报-\", t)\r\n                : console.warn(\r\n                      \"条件不成立-不进行上报\",\r\n                      this.isInit,\r\n                      this.isRegister,\r\n                      t,\r\n                      $login.Login.instance.ttOpenId\r\n                  );\r\n        }\r\n    };\r\n    t.prototype.reportWxAdToGravity = function (t) {\r\n        if ($platform.Platform.currPlatForm === $platform.PlatformEnum.WECHAT) {\r\n            this.isInit && this.isRegister && \"\" !== t && \"\" !== $login.Login.instance.wxOpenId\r\n                ? (this.ge.adShowEvent(\"reward\", t, {\r\n                      custom_param: \"\"\r\n                  }),\r\n                  console.log(\"微信AD上报-\", t))\r\n                : console.warn(\r\n                      \"条件不成立-不进行上报\",\r\n                      this.isInit,\r\n                      this.isRegister,\r\n                      t,\r\n                      $login.Login.instance.wxOpenId\r\n                  );\r\n        }\r\n    };\r\n    t.prototype.getOpenId = function () {\r\n        return $platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO\r\n            ? $login.Login.instance.ttOpenId\r\n            : $platform.Platform.currPlatForm === $platform.PlatformEnum.WECHAT\r\n            ? $login.Login.instance.wxOpenId\r\n            : $login.Login.instance.ksOpenId;\r\n    };\r\n    t.instance = new t();\r\n    return t;\r\n})();\r\nexports.GeService = a;\r\n"]}