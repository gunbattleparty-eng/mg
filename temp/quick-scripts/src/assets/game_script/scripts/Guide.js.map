{"version":3,"sources":["assets\\game_script\\scripts\\Guide.js"],"names":["o","$hollowOut","require","$touchBlocker","u","cc","_decorator","d","ccclass","p","property","f","t","e","apply","arguments","hollowOut","touchBlocker","arrowTargetParent","arrowTarget","i","__extends","prototype","onLoad","currentStep","start","reset","self","remove","node","destroy","console","log","active","setNodeSize","passAll","startGuideMask","scheduleOnce","blockAll","n","width","s","height","target","l","convertToNodeSpaceAR","convertToWorldSpaceAR","Vec3","ZERO","clone","children","forEach","Promise","__awaiter","__generator","label","rectTo","v2","sent","setTarget","startGuideTest","c","position","add","v3","getComponent","Label","string","stopGuide","isValid","parent","setGuideStep","isEnd","__decorate","Component","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $hollowOut = require(\"./HollowOut\");\r\nvar $touchBlocker = require(\"./TouchBlocker\");\r\nvar u = cc._decorator;\r\nvar d = u.ccclass;\r\nvar p = u.property;\r\nvar f = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.hollowOut = null;\r\n        e.touchBlocker = null;\r\n        e.arrowTargetParent = null;\r\n        e.arrowTarget = null;\r\n        return e;\r\n    }\r\n    var i;\r\n    __extends(e, t);\r\n    i = e;\r\n    e.prototype.onLoad = function () {\r\n        i.currentStep = 1;\r\n    };\r\n    e.prototype.start = function () {\r\n        this.reset();\r\n        i.self = this;\r\n    };\r\n    e.prototype.remove = function () {\r\n        this.hollowOut.node.destroy();\r\n    };\r\n    e.prototype.reset = function () {\r\n        console.log(\"======================\");\r\n        this.hollowOut.node.active = !1;\r\n        this.hollowOut.setNodeSize();\r\n        this.touchBlocker.passAll();\r\n    };\r\n    e.prototype.startGuideMask = function (t, e) {\r\n        var i = this;\r\n        if (void 0 === e) {\r\n            e = -1;\r\n        }\r\n        this.scheduleOnce(function () {\r\n            i.hollowOut.node.active = !0;\r\n            i.touchBlocker.blockAll();\r\n            var o = t;\r\n            var n = o.width + 10;\r\n            var s = o.height + 10;\r\n            i.touchBlocker.target = t;\r\n            var l = i.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.Vec3.ZERO).clone());\r\n            i.hollowOut.node.children.forEach(function (t, i) {\r\n                t.active = i === e;\r\n            });\r\n            new Promise(function () {\r\n                return __awaiter(i, void 0, void 0, function () {\r\n                    return __generator(this, function (t) {\r\n                        switch (t.label) {\r\n                            case 0:\r\n                                return [4, this.hollowOut.rectTo(0.3, cc.v2(l), n, s, 5, 5)];\r\n                            case 1:\r\n                                t.sent();\r\n                                return [2];\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n            i.touchBlocker.setTarget(o);\r\n        }, 0.1);\r\n    };\r\n    e.prototype.startGuideTest = function (t, e) {\r\n        var i = this;\r\n        this.scheduleOnce(function () {\r\n            i.hollowOut.node.active = !0;\r\n            i.touchBlocker.blockAll();\r\n            var o = t;\r\n            var n = o.width + 10;\r\n            var s = o.height + 10;\r\n            i.touchBlocker.target = t;\r\n            var l = i.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.Vec3.ZERO).clone());\r\n            i.hollowOut.node.children.forEach(function (t) {\r\n                t.active = !1;\r\n            });\r\n            var c = i.hollowOut.node.children[2];\r\n            c.active = !0;\r\n            c.position = l.add(cc.v3(0, o.height));\r\n            c.getComponent(cc.Label).string = e;\r\n            new Promise(function () {\r\n                return __awaiter(i, void 0, void 0, function () {\r\n                    return __generator(this, function (t) {\r\n                        switch (t.label) {\r\n                            case 0:\r\n                                return [4, this.hollowOut.rectTo(0.3, cc.v2(l), n, s, 5, 5)];\r\n                            case 1:\r\n                                t.sent();\r\n                                return [2];\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n            i.touchBlocker.setTarget(o);\r\n        }, 0.1);\r\n    };\r\n    e.prototype.stopGuide = function () {\r\n        this.hollowOut.node.children.forEach(function (t) {\r\n            t.active = !1;\r\n        });\r\n        if (cc.isValid(this.arrowTarget)) {\r\n            this.arrowTarget.position = this.arrowTargetParent.convertToNodeSpaceAR(\r\n                this.arrowTarget.convertToWorldSpaceAR(cc.Vec3.ZERO).clone()\r\n            );\r\n            this.arrowTarget.parent = this.arrowTargetParent;\r\n            this.arrowTarget = null;\r\n            this.arrowTargetParent = null;\r\n        }\r\n        this.hollowOut.setNodeSize();\r\n        this.hollowOut.node.active = !1;\r\n        this.touchBlocker.target = null;\r\n        this.touchBlocker.passAll();\r\n    };\r\n    e.setGuideStep = function (t) {\r\n        if (!(t < i.currentStep)) {\r\n            i.currentStep = t;\r\n        }\r\n    };\r\n    e.isEnd = function () {\r\n        return this.currentStep >= 12;\r\n    };\r\n    e.currentStep = 1;\r\n    e.self = null;\r\n    __decorate([p($hollowOut.default)], e.prototype, \"hollowOut\", void 0);\r\n    __decorate([p($touchBlocker.default)], e.prototype, \"touchBlocker\", void 0);\r\n    return (i = __decorate([d], e));\r\n})(cc.Component);\r\nexports.default = f;\r\n"]}