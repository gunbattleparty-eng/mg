{"version":3,"sources":["assets\\game_script\\scripts\\RGun_1.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$configContext","$globalParam","$baseBullet","$gameContext","$gameSkillInfo","f","t","e","i","call","atk","cd","range","bulletSpeed","attackInterval","bulletCount","config","skin","tempPos","cc","Vec3","ZERO","lockEnemy","instance","robotConfigs","find","id","Petsskin_skill_value","Math","round","timeLeft","x","pointNode","position","y","__extends","prototype","updateF","isAttacking","isGamePuase","startGun","ins","getRangeRankEnemy","skillParam","skillInfo","getSkillById","addDieCallback","dieEnemy","ceil","skillAtk","Skill4Param","FINAL","playAnimation","schedulesOnce","isDie","createButtle","removeDieCallback","getRandomEnemy","getButtlePool","BulletType","r_bullet_1","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","RBullet_1","ResUtil","instantiate","buttleLayer","parent","getComponent","setPosition","initRBullet","insert","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar f = (function (t) {\r\n    function e(e, i) {\r\n        var o = t.call(this, e) || this;\r\n        o.atk = 0;\r\n        o.cd = 0;\r\n        o.range = 0;\r\n        o.bulletSpeed = 0;\r\n        o.attackInterval = 0;\r\n        o.bulletCount = 0;\r\n        o.config = null;\r\n        o.skin = null;\r\n        o.tempPos = cc.Vec3.ZERO;\r\n        o.lockEnemy = null;\r\n        o.config = $configContext.default.instance.robotConfigs.find(function (t) {\r\n            return 2 === t.id;\r\n        });\r\n        o.cd = o.config.Petsskin_skill_value[1];\r\n        o.range = o.config.Petsskin_skill_value[2];\r\n        o.bulletSpeed = o.config.Petsskin_skill_value[3];\r\n        o.attackInterval = o.config.Petsskin_skill_value[4];\r\n        o.bulletCount = Math.round(o.config.Petsskin_skill_value[5] / o.attackInterval);\r\n        o.timeLeft = o.cd;\r\n        o.skin = i;\r\n        o.tempPos.x = o.pointNode.position.x;\r\n        o.tempPos.y = o.pointNode.position.y + 150;\r\n        return o;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.updateF = function (e) {\r\n        t.prototype.updateF.call(this, e);\r\n        if (!(this.isAttacking || $globalParam.default.isGamePuase)) {\r\n            this.timeLeft -= e;\r\n            if (this.timeLeft <= 0) {\r\n                this.startGun();\r\n            }\r\n        }\r\n    };\r\n    e.prototype.startGun = function () {\r\n        var t = this;\r\n        this.lockEnemy = $gameContext.default.ins.getRangeRankEnemy(this.pointNode, this.range);\r\n        if (!this.lockEnemy) {\r\n            this.timeLeft = 1;\r\n            return !1;\r\n        }\r\n        if (!this.skillParam) {\r\n            this.skillParam = $gameContext.default.ins.skillInfo.getSkillById(1);\r\n        }\r\n        this.lockEnemy.addDieCallback(this.dieEnemy, this);\r\n        this.atk = Math.ceil(\r\n            this.config.Petsskin_skill_value[0] * this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL]\r\n        );\r\n        this.isAttacking = !0;\r\n        var e = 0;\r\n        this.skin.playAnimation(\"hit\", 0);\r\n        for (var i = 0; i < this.bulletCount; i++) {\r\n            this.schedulesOnce(function () {\r\n                if (t.lockEnemy && !t.lockEnemy.isDie()) {\r\n                    t.createButtle(t.lockEnemy);\r\n                }\r\n                if (++e >= t.bulletCount) {\r\n                    t.isAttacking = !1;\r\n                    t.timeLeft = t.cd;\r\n                    t.skin.playAnimation(\"stand\", 0);\r\n                    if (t.lockEnemy) {\r\n                        t.lockEnemy.removeDieCallback(t);\r\n                        t.lockEnemy = null;\r\n                    }\r\n                }\r\n            }, this.attackInterval * i);\r\n        }\r\n    };\r\n    e.prototype.dieEnemy = function (t) {\r\n        if (this.lockEnemy === t) {\r\n            this.lockEnemy = null;\r\n            this.lockEnemy = $gameContext.default.ins.getRandomEnemy(t);\r\n        }\r\n    };\r\n    e.prototype.createButtle = function (t) {\r\n        var e = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.r_bullet_1);\r\n        if (!e) {\r\n            var i = $assetsLoader.default.instance.getRes(\r\n                $assetsMap.BundleNames.Game,\r\n                $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.RBullet_1\r\n            );\r\n            e = $resUtil.ResUtil.instantiate(i, $gameContext.default.ins.buttleLayer.parent).getComponent(\r\n                $baseBullet.default\r\n            );\r\n        }\r\n        e.setPosition(this.tempPos);\r\n        e.initRBullet(t, this.atk, this.bulletSpeed);\r\n        e.insert($gameContext.default.ins.buttleLayer);\r\n    };\r\n    return e;\r\n})(require(\"./BaseGun\").default);\r\nexports.default = f;\r\n"]}