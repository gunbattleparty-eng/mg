
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_4.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ad6fcWUxApD7L7oOwJdMWS2', 'Bullet_4');
// game_script/scripts/Bullet_4.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var y = cc._decorator;
var g = y.ccclass;

var _ = (y.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.thermobaric_bullet;
    e.id = 23;
    e.anim = null;
    e.currButtlePenetrateLayer = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.currButtlePenetrateLayer = 0;
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
    this.speed = this.skillParam.thermobaricSpeed[$gameSkillInfo.Skill4Param.FINAL];
    this.velocity.set(e).multiplyScalar(this.speed);

    if (!this.anim) {
      this.anim = this.node.children[0].getComponent(cc.Animation);
    }

    this.setAnimation();
  };

  e.prototype.setAnimation = function (t) {
    if (void 0 === t) {
      t = "bullet_4";
    }

    if (this.skillParam.isAllPenetrateBoom) {
      t = "bullet_4_2";
    }

    this.anim.play(t);
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse && e == $object.Trigger.enter) {
      var i = t.object;
      i.sufferAtk({
        id: this.skillId,
        skillSpecialitys: this.skillSpecialitys,
        atk: this.atk
      });

      if (0 === this.currButtlePenetrateLayer) {
        if (this.skillParam.thermobaricBoomRange > 0) {
          this.createButtleBoom(i);
        }

        if (this.skillParam.thermobaricSplitCount > 0) {
          this.createSplitButtle(i);
        }
      }

      if (!(29 !== i.config.id && 30 !== i.config.id && 36 !== i.config.id)) {
        this.currButtlePenetrateLayer = this.skillParam.thermobaricPenetrateLayer;
      }

      this.currButtlePenetrateLayer++;

      if (this.skillParam.thermobaricPenetrateLayer <= this.currButtlePenetrateLayer) {
        this.isUse = !0;
        return this.removeSelf();
      }

      if (0 === this.currButtlePenetrateLayer) {
        for (var o = 0; o < this.skillParam.thermobaricStunParam.length; o++) {
          var n = this.skillParam.thermobaricStunParam;

          if ($seedUtil["default"].probability(100 * n[o][0])) {
            var s = {
              type: $enemyStatus.EnemyDebuffType.STUN,
              timeLeft: n[o][1],
              value: 0
            };
            i.sufferDebuff(s);
          }
        }
      } else {
        if (this.skillParam.isAllPenetrateBoom && this.currButtlePenetrateLayer > 1 && this.skillParam.thermobaricBoomRange > 0) {
          this.createButtleBoom(i);
        }
      }
    }
  };

  e.prototype.createSplitButtle = function (t) {
    var e = $gameContext["default"].ins.getNearbyN2(t.node, this.skillParam.thermobaricSplitCount);

    for (var i = 0; i < e.length; i++) {
      var o = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thermobaric_split);

      if (!o) {
        var n = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_7);
        (o = $resUtil.ResUtil.instantiate(n).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(23).skill_tpye;
      }

      o.setPosition(this.node.position.clone());
      o.targetEnemy = t;
      o.initButtle(e[i].node.position.sub(this.node.position).normalize(), this.skillId);
      o.insert($gameContext["default"].ins.buttleLayer);
    }
  };

  e.prototype.createButtleBoom = function (t) {
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thermobaric_boom);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_5);
      e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    e.setPosition(cc.v3(t.node.position.x, this.node.position.y));
    e.initButtle(null, this.skillId);
    e.insert($gameContext["default"].ins.lowBulletLayer);
    e.setAnimation(null);
  };

  return __decorate([g], e);
}($baseBullet["default"]));

exports["default"] = _;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF80LmpzIl0sIm5hbWVzIjpbIm8iLCIkb2JqZWN0IiwicmVxdWlyZSIsIiRhc3NldHNMb2FkZXIiLCIkYXNzZXRzTWFwIiwiJHJlc1V0aWwiLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRnYW1lQ29udGV4dCIsIiRnYW1lU2tpbGxJbmZvIiwiJGVuZW15U3RhdHVzIiwiJGJhc2VCdWxsZXQiLCJ5IiwiY2MiLCJfZGVjb3JhdG9yIiwiZyIsImNjY2xhc3MiLCJfIiwicHJvcGVydHkiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYnV0dGxlVHlwZSIsIkJ1bGxldFR5cGUiLCJ0aGVybW9iYXJpY19idWxsZXQiLCJpZCIsImFuaW0iLCJjdXJyQnV0dGxlUGVuZXRyYXRlTGF5ZXIiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0QnV0dGxlIiwiaSIsImNhbGwiLCJhdGsiLCJza2lsbFBhcmFtIiwic2tpbGxBdGsiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwic3BlZWQiLCJ0aGVybW9iYXJpY1NwZWVkIiwidmVsb2NpdHkiLCJzZXQiLCJtdWx0aXBseVNjYWxhciIsIm5vZGUiLCJjaGlsZHJlbiIsImdldENvbXBvbmVudCIsIkFuaW1hdGlvbiIsInNldEFuaW1hdGlvbiIsImlzQWxsUGVuZXRyYXRlQm9vbSIsInBsYXkiLCJvblRyaWdnZXIiLCJpc1VzZSIsIlRyaWdnZXIiLCJlbnRlciIsIm9iamVjdCIsInN1ZmZlckF0ayIsInNraWxsSWQiLCJza2lsbFNwZWNpYWxpdHlzIiwidGhlcm1vYmFyaWNCb29tUmFuZ2UiLCJjcmVhdGVCdXR0bGVCb29tIiwidGhlcm1vYmFyaWNTcGxpdENvdW50IiwiY3JlYXRlU3BsaXRCdXR0bGUiLCJjb25maWciLCJ0aGVybW9iYXJpY1BlbmV0cmF0ZUxheWVyIiwicmVtb3ZlU2VsZiIsInRoZXJtb2JhcmljU3R1blBhcmFtIiwibGVuZ3RoIiwibiIsInByb2JhYmlsaXR5IiwicyIsInR5cGUiLCJFbmVteURlYnVmZlR5cGUiLCJTVFVOIiwidGltZUxlZnQiLCJ2YWx1ZSIsInN1ZmZlckRlYnVmZiIsImlucyIsImdldE5lYXJieU4yIiwiZ2V0QnV0dGxlUG9vbCIsInRoZXJtb2JhcmljX3NwbGl0IiwiaW5zdGFuY2UiLCJnZXRSZXMiLCJCdW5kbGVOYW1lcyIsIkdhbWUiLCJBc3NldHNNYXAiLCJHYW1lQnVuZGxlcyIsInByZWZhYnMiLCJhc3NldHNMaXN0IiwiQnVsbGV0XzciLCJSZXNVdGlsIiwiaW5zdGFudGlhdGUiLCJiYXNpY1NraWxsQ29uZmlnTWFwIiwiZ2V0Iiwic2tpbGxfdHB5ZSIsInNldFBvc2l0aW9uIiwicG9zaXRpb24iLCJjbG9uZSIsInRhcmdldEVuZW15Iiwic3ViIiwibm9ybWFsaXplIiwiaW5zZXJ0IiwiYnV0dGxlTGF5ZXIiLCJ0aGVybW9iYXJpY19ib29tIiwiQnVsbGV0XzUiLCJsb3dCdWxsZXRMYXllciIsInBhcmVudCIsInYzIiwieCIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdELE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJRSxVQUFVLEdBQUdGLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlHLFFBQVEsR0FBR0gsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUksU0FBUyxHQUFHSixPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFDQSxJQUFJSyxjQUFjLEdBQUdMLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJTSxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlPLGNBQWMsR0FBR1AsT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlR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RixPQUFULENBQWlCQyxXQUFqQixDQUE2QjNELENBQTdCLEVBQWdDeEIsWUFBWSxXQUFaLENBQXFCcUUsR0FBckIsQ0FBeUI0QixjQUF6QixDQUF3Q0MsTUFBeEUsRUFBZ0Y1RCxZQUFoRixDQUNBbkMsV0FBVyxXQURYLENBQUo7SUFHSDs7SUFDRFMsQ0FBQyxDQUFDMkUsV0FBRixDQUFjbEYsRUFBRSxDQUFDOEYsRUFBSCxDQUFNeEYsQ0FBQyxDQUFDeUIsSUFBRixDQUFPb0QsUUFBUCxDQUFnQlksQ0FBdEIsRUFBeUIsS0FBS2hFLElBQUwsQ0FBVW9ELFFBQVYsQ0FBbUJwRixDQUE1QyxDQUFkO0lBQ0FRLENBQUMsQ0FBQ1csVUFBRixDQUFhLElBQWIsRUFBbUIsS0FBSzBCLE9BQXhCO0lBQ0FyQyxDQUFDLENBQUNpRixNQUFGLENBQVM3RixZQUFZLFdBQVosQ0FBcUJxRSxHQUFyQixDQUF5QjRCLGNBQWxDO0lBQ0FyRixDQUFDLENBQUM0QixZQUFGLENBQWUsSUFBZjtFQUNILENBZkQ7O0VBZ0JBLE9BQU82RCxVQUFVLENBQUMsQ0FBQzlGLENBQUQsQ0FBRCxFQUFNSyxDQUFOLENBQWpCO0FBQ0gsQ0FoSEQsQ0FnSEdULFdBQVcsV0FoSGQsQ0FGQyxDQUFMOztBQW1IQW1HLE9BQU8sV0FBUCxHQUFrQjdGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRvYmplY3QgPSByZXF1aXJlKFwiLi9PYmplY3RcIik7XHJcbnZhciAkYXNzZXRzTG9hZGVyID0gcmVxdWlyZShcIi4vQXNzZXRzTG9hZGVyXCIpO1xyXG52YXIgJGFzc2V0c01hcCA9IHJlcXVpcmUoXCIuL0Fzc2V0c01hcFwiKTtcclxudmFyICRyZXNVdGlsID0gcmVxdWlyZShcIi4vUmVzVXRpbFwiKTtcclxudmFyICRzZWVkVXRpbCA9IHJlcXVpcmUoXCIuL1NlZWRVdGlsXCIpO1xyXG52YXIgJGNvbmZpZ0NvbnRleHQgPSByZXF1aXJlKFwiLi9Db25maWdDb250ZXh0XCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZ2FtZVNraWxsSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVTa2lsbEluZm9cIik7XHJcbnZhciAkZW5lbXlTdGF0dXMgPSByZXF1aXJlKFwiLi9FbmVteVN0YXR1c1wiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyIHkgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgZyA9IHkuY2NjbGFzcztcclxudmFyIF8gPVxyXG4gICAgKHkucHJvcGVydHksXHJcbiAgICAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICAgICAgZS5idXR0bGVUeXBlID0gJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS50aGVybW9iYXJpY19idWxsZXQ7XHJcbiAgICAgICAgICAgIGUuaWQgPSAyMztcclxuICAgICAgICAgICAgZS5hbmltID0gbnVsbDtcclxuICAgICAgICAgICAgZS5jdXJyQnV0dGxlUGVuZXRyYXRlTGF5ZXIgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSwgaSkge1xyXG4gICAgICAgICAgICB0LnByb3RvdHlwZS5pbml0QnV0dGxlLmNhbGwodGhpcywgZSwgaSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyID0gMDtcclxuICAgICAgICAgICAgdGhpcy5hdGsgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5za2lsbFBhcmFtLnRoZXJtb2JhcmljU3BlZWRbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnNldChlKS5tdWx0aXBseVNjYWxhcih0aGlzLnNwZWVkKTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmFuaW0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYW5pbSA9IHRoaXMubm9kZS5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNldEFuaW1hdGlvbigpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuc2V0QW5pbWF0aW9uID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgaWYgKHZvaWQgMCA9PT0gdCkge1xyXG4gICAgICAgICAgICAgICAgdCA9IFwiYnVsbGV0XzRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmlzQWxsUGVuZXRyYXRlQm9vbSkge1xyXG4gICAgICAgICAgICAgICAgdCA9IFwiYnVsbGV0XzRfMlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbS5wbGF5KHQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUub25UcmlnZ2VyID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzVXNlICYmIGUgPT0gJG9iamVjdC5UcmlnZ2VyLmVudGVyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLnNraWxsSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2tpbGxTcGVjaWFsaXR5czogdGhpcy5za2lsbFNwZWNpYWxpdHlzLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0azogdGhpcy5hdGtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgPT09IHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS50aGVybW9iYXJpY0Jvb21SYW5nZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0bGVCb29tKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLnRoZXJtb2JhcmljU3BsaXRDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVTcGxpdEJ1dHRsZShpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoISgyOSAhPT0gaS5jb25maWcuaWQgJiYgMzAgIT09IGkuY29uZmlnLmlkICYmIDM2ICE9PSBpLmNvbmZpZy5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJCdXR0bGVQZW5ldHJhdGVMYXllciA9IHRoaXMuc2tpbGxQYXJhbS50aGVybW9iYXJpY1BlbmV0cmF0ZUxheWVyO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyQnV0dGxlUGVuZXRyYXRlTGF5ZXIrKztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0udGhlcm1vYmFyaWNQZW5ldHJhdGVMYXllciA8PSB0aGlzLmN1cnJCdXR0bGVQZW5ldHJhdGVMYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNVc2UgPSAhMDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdGhpcy5jdXJyQnV0dGxlUGVuZXRyYXRlTGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IHRoaXMuc2tpbGxQYXJhbS50aGVybW9iYXJpY1N0dW5QYXJhbS5sZW5ndGg7IG8rKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXMuc2tpbGxQYXJhbS50aGVybW9iYXJpY1N0dW5QYXJhbTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRzZWVkVXRpbC5kZWZhdWx0LnByb2JhYmlsaXR5KDEwMCAqIG5bb11bMF0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLlNUVU4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZUxlZnQ6IG5bb11bMV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZihzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uaXNBbGxQZW5ldHJhdGVCb29tICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyID4gMSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0udGhlcm1vYmFyaWNCb29tUmFuZ2UgPiAwXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlQnV0dGxlQm9vbShpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZVNwbGl0QnV0dGxlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0TmVhcmJ5TjIodC5ub2RlLCB0aGlzLnNraWxsUGFyYW0udGhlcm1vYmFyaWNTcGxpdENvdW50KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbyA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUudGhlcm1vYmFyaWNfc3BsaXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfN1xyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgKG8gPSAkcmVzVXRpbC5SZXNVdGlsLmluc3RhbnRpYXRlKG4pLmdldENvbXBvbmVudCgkYmFzZUJ1bGxldC5kZWZhdWx0KSkuc2tpbGxTcGVjaWFsaXR5cyA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQoMjMpLnNraWxsX3RweWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvLnNldFBvc2l0aW9uKHRoaXMubm9kZS5wb3NpdGlvbi5jbG9uZSgpKTtcclxuICAgICAgICAgICAgICAgIG8udGFyZ2V0RW5lbXkgPSB0O1xyXG4gICAgICAgICAgICAgICAgby5pbml0QnV0dGxlKGVbaV0ubm9kZS5wb3NpdGlvbi5zdWIodGhpcy5ub2RlLnBvc2l0aW9uKS5ub3JtYWxpemUoKSwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgICAgIG8uaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZUJ1dHRsZUJvb20gPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUudGhlcm1vYmFyaWNfYm9vbSk7XHJcbiAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzVcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBlID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShpLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlLnNldFBvc2l0aW9uKGNjLnYzKHQubm9kZS5wb3NpdGlvbi54LCB0aGlzLm5vZGUucG9zaXRpb24ueSkpO1xyXG4gICAgICAgICAgICBlLmluaXRCdXR0bGUobnVsbCwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgZS5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyKTtcclxuICAgICAgICAgICAgZS5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gX19kZWNvcmF0ZShbZ10sIGUpO1xyXG4gICAgfSkoJGJhc2VCdWxsZXQuZGVmYXVsdCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBfO1xyXG4iXX0=