
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_8.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a3bcfNJRKhAz7yXEdmznRbu', 'Gun_8');
// game_script/scripts/Gun_8.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $roleContext = require("./RoleContext");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameGemInfo = require("./GameGemInfo");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseGun = require("./BaseGun");

var k = cc.Vec3.ZERO;

var v = function (t) {
  function e(e) {
    var i = t.call(this, e) || this;
    i.militX = 0;
    i.skillId = 135;
    i.skinAtkLeftCd = 0;
    i.skinAtkCurrCount = 0;
    i.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(i.skillId);
    return i;
  }

  __extends(e, t);

  e.prototype.updateF = function (e) {
    t.prototype.updateF.call(this, e);

    if (!(this.isAttacking || $globalParam["default"].isGamePuase)) {
      if (7 === $roleContext["default"].ins.currSkinInfo.skin && this.skinAtkCurrCount >= $gameContext["default"].ins.skillInfo.skinAtkTargetCount) {
        this.skinAtkLeftCd -= e;

        if (this.skinAtkLeftCd <= 0) {
          this.sendSkinBullet();
        }
      }

      this.timeLeft -= e;
      this.timeLeft <= 0 ? (this.isAttacking = !0, this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0, -1), this.starGun() || (this.isAttacking = !1, this.timeLeft = 0)) : $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1);
    }
  };

  e.prototype.sendSkinBullet = function () {
    $eventManager["default"].send($localEventName["default"].SEND_SKILL_ANIM);
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.s_bullet_7);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.SBullet_7);
      t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    k.x = 0;
    k.y = -550;
    t.setPosition(k);
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.lowBulletLayer);
    this.skinAtkLeftCd = $gameContext["default"].ins.skillInfo.skinAtkCd;
    this.skinAtkCurrCount = 0;
    return !0;
  };

  e.prototype.starGun = function () {
    var t = this;
    var e = this.skillParam.iceBoomCount;

    if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) && $seedUtil["default"].probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))) {
      e *= 2;
    }

    var i = $gameContext["default"].ins.getRandomEnemys(this.pointNode, e, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);

    if (i.length <= 0) {
      return !1;
    }

    var o = function o(e) {
      n.schedulesOnce(function () {
        t.sendButtle(i[e].getPosition().clone());
      }, 0.1 * e);
    };

    var n = this;

    for (var s = 0; s < i.length; s++) {
      o(s);
    }

    this.isAttacking = !1;
    return !0;
  };

  e.prototype.sendButtle = function (t) {
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.ice_boom);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_19);
      (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    this.militX = 360 - e.node.width / 2 * this.skillParam.iceBoomAtkRange;

    if (t.x <= -this.militX) {
      t.x = -this.militX;
    }

    if (t.x >= this.militX) {
      t.x = this.militX;
    }

    e.setPosition(t);
    e.initButtle(null, this.skillId);
    e.insert($gameContext["default"].ins.lowBulletLayer);
    e.setAnimation("");
    this.skinAtkCurrCount++;
  };

  return e;
}($baseGun["default"]);

exports["default"] = v;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl84LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRldmVudE1hbmFnZXIiLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRnbG9iYWxQYXJhbSIsIiRsb2NhbEV2ZW50TmFtZSIsIiRyb2xlQ29udGV4dCIsIiRiYXNlQnVsbGV0IiwiJGdhbWVDb250ZXh0IiwiJGdhbWVHZW1JbmZvIiwiJGdhbWVTa2lsbEluZm8iLCIkYmFzZUd1biIsImsiLCJjYyIsIlZlYzMiLCJaRVJPIiwidiIsInQiLCJlIiwiaSIsImNhbGwiLCJtaWxpdFgiLCJza2lsbElkIiwic2tpbkF0a0xlZnRDZCIsInNraW5BdGtDdXJyQ291bnQiLCJza2lsbFBhcmFtIiwiaW5zIiwic2tpbGxJbmZvIiwiZ2V0U2tpbGxCeUlkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwidXBkYXRlRiIsImlzQXR0YWNraW5nIiwiaXNHYW1lUHVhc2UiLCJjdXJyU2tpbkluZm8iLCJza2luIiwic2tpbkF0a1RhcmdldENvdW50Iiwic2VuZFNraW5CdWxsZXQiLCJ0aW1lTGVmdCIsInNraWxsQ0QiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwic2VuZCIsIlJFTkRFUl9TS0lMTF9DRF9JTkZPIiwic3Rhckd1biIsIlNFTkRfU0tJTExfQU5JTSIsImdldEJ1dHRsZVBvb2wiLCJCdWxsZXRUeXBlIiwic19idWxsZXRfNyIsImluc3RhbmNlIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIlNCdWxsZXRfNyIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImxvd0J1bGxldExheWVyIiwicGFyZW50IiwiZ2V0Q29tcG9uZW50IiwieCIsInkiLCJzZXRQb3NpdGlvbiIsImluaXRCdXR0bGUiLCJpbnNlcnQiLCJza2luQXRrQ2QiLCJpY2VCb29tQ291bnQiLCJHYW1lR2VtSW5mbyIsImhhc0dlbSIsIkdlbVR5cGUiLCJBZGRTa2lsbCIsInByb2JhYmlsaXR5IiwiZ2V0MSIsImdldFJhbmRvbUVuZW15cyIsInBvaW50Tm9kZSIsInNraWxsQXRrUmFuZ2UiLCJsZW5ndGgiLCJuIiwic2NoZWR1bGVzT25jZSIsInNlbmRCdXR0bGUiLCJnZXRQb3NpdGlvbiIsImNsb25lIiwicyIsImljZV9ib29tIiwiQnVsbGV0XzE5Iiwic2tpbGxTcGVjaWFsaXR5cyIsImJhc2ljU2tpbGxDb25maWdNYXAiLCJnZXQiLCJza2lsbF90cHllIiwibm9kZSIsIndpZHRoIiwiaWNlQm9vbUF0a1JhbmdlIiwic2V0QW5pbWF0aW9uIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlDLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUUsUUFBUSxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJRyxhQUFhLEdBQUdILE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJSSxTQUFTLEdBQUdKLE9BQU8sQ0FBQyxZQUFELENBQXZCOztBQUNBLElBQUlLLGNBQWMsR0FBR0wsT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlNLFlBQVksR0FBR04sT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSU8sZUFBZSxHQUFHUCxPQUFPLENBQUMsa0JBQUQsQ0FBN0I7O0FBQ0EsSUFBSVEsWUFBWSxHQUFHUixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJUyxXQUFXLEdBQUdULE9BQU8sQ0FBQyxjQUFELENBQXpCOztBQUNBLElBQUlVLFlBQVksR0FBR1YsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FB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QyxNQUFaO0lBQ0g7O0lBQ0QsSUFBSUosQ0FBQyxDQUFDOEMsQ0FBRixJQUFPLEtBQUsxQyxNQUFoQixFQUF3QjtNQUNwQkosQ0FBQyxDQUFDOEMsQ0FBRixHQUFNLEtBQUsxQyxNQUFYO0lBQ0g7O0lBQ0RILENBQUMsQ0FBQytDLFdBQUYsQ0FBY2hELENBQWQ7SUFDQUMsQ0FBQyxDQUFDZ0QsVUFBRixDQUFhLElBQWIsRUFBbUIsS0FBSzVDLE9BQXhCO0lBQ0FKLENBQUMsQ0FBQ2lELE1BQUYsQ0FBUzNELFlBQVksV0FBWixDQUFxQmtCLEdBQXJCLENBQXlCa0MsY0FBbEM7SUFDQTFDLENBQUMsQ0FBQzZFLFlBQUYsQ0FBZSxFQUFmO0lBQ0EsS0FBS3ZFLGdCQUFMO0VBQ0gsQ0F2QkQ7O0VBd0JBLE9BQU9OLENBQVA7QUFDSCxDQWhITyxDQWdITFAsUUFBUSxXQWhISCxDQUFSOztBQWlIQXFGLE9BQU8sV0FBUCxHQUFrQmhGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRzZWVkVXRpbCA9IHJlcXVpcmUoXCIuL1NlZWRVdGlsXCIpO1xyXG52YXIgJGNvbmZpZ0NvbnRleHQgPSByZXF1aXJlKFwiLi9Db25maWdDb250ZXh0XCIpO1xyXG52YXIgJGdsb2JhbFBhcmFtID0gcmVxdWlyZShcIi4vR2xvYmFsUGFyYW1cIik7XHJcbnZhciAkbG9jYWxFdmVudE5hbWUgPSByZXF1aXJlKFwiLi9Mb2NhbEV2ZW50TmFtZVwiKTtcclxudmFyICRyb2xlQ29udGV4dCA9IHJlcXVpcmUoXCIuL1JvbGVDb250ZXh0XCIpO1xyXG52YXIgJGJhc2VCdWxsZXQgPSByZXF1aXJlKFwiLi9CYXNlQnVsbGV0XCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZ2FtZUdlbUluZm8gPSByZXF1aXJlKFwiLi9HYW1lR2VtSW5mb1wiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRiYXNlR3VuID0gcmVxdWlyZShcIi4vQmFzZUd1blwiKTtcclxudmFyIGsgPSBjYy5WZWMzLlpFUk87XHJcbnZhciB2ID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKGUpIHtcclxuICAgICAgICB2YXIgaSA9IHQuY2FsbCh0aGlzLCBlKSB8fCB0aGlzO1xyXG4gICAgICAgIGkubWlsaXRYID0gMDtcclxuICAgICAgICBpLnNraWxsSWQgPSAxMzU7XHJcbiAgICAgICAgaS5za2luQXRrTGVmdENkID0gMDtcclxuICAgICAgICBpLnNraW5BdGtDdXJyQ291bnQgPSAwO1xyXG4gICAgICAgIGkuc2tpbGxQYXJhbSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uZ2V0U2tpbGxCeUlkKGkuc2tpbGxJZCk7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS51cGRhdGVGLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKCEodGhpcy5pc0F0dGFja2luZyB8fCAkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZSkpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgNyA9PT0gJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmN1cnJTa2luSW5mby5za2luICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQgPj0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luQXRrVGFyZ2V0Q291bnRcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraW5BdGtMZWZ0Q2QgLT0gZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraW5BdGtMZWZ0Q2QgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZFNraW5CdWxsZXQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnRpbWVMZWZ0IC09IGU7XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgPD0gMFxyXG4gICAgICAgICAgICAgICAgPyAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICh0aGlzLnRpbWVMZWZ0ID0gdGhpcy5za2lsbFBhcmFtLnNraWxsQ0RbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdKSxcclxuICAgICAgICAgICAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuUkVOREVSX1NLSUxMX0NEX0lORk8sIHRoaXMuc2tpbGxJZCwgMCwgLTEpLFxyXG4gICAgICAgICAgICAgICAgICB0aGlzLnN0YXJHdW4oKSB8fCAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMSksICh0aGlzLnRpbWVMZWZ0ID0gMCkpKVxyXG4gICAgICAgICAgICAgICAgOiAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZChcclxuICAgICAgICAgICAgICAgICAgICAgICRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAvIHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSxcclxuICAgICAgICAgICAgICAgICAgICAgIC0xXHJcbiAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNlbmRTa2luQnVsbGV0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlNFTkRfU0tJTExfQU5JTSk7XHJcbiAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnNfYnVsbGV0XzcpO1xyXG4gICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9ICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5nZXRSZXMoXHJcbiAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuU0J1bGxldF83XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHQgPSAkcmVzVXRpbC5SZXNVdGlsLmluc3RhbnRpYXRlKGUsICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllci5wYXJlbnQpLmdldENvbXBvbmVudChcclxuICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgay54ID0gMDtcclxuICAgICAgICBrLnkgPSAtNTUwO1xyXG4gICAgICAgIHQuc2V0UG9zaXRpb24oayk7XHJcbiAgICAgICAgdC5pbml0QnV0dGxlKG51bGwsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgdC5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyKTtcclxuICAgICAgICB0aGlzLnNraW5BdGtMZWZ0Q2QgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnNraW5BdGtDZDtcclxuICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQgPSAwO1xyXG4gICAgICAgIHJldHVybiAhMDtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zdGFyR3VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICB2YXIgZSA9IHRoaXMuc2tpbGxQYXJhbS5pY2VCb29tQ291bnQ7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uaW5zLmhhc0dlbSgkZ2FtZUdlbUluZm8uR2VtVHlwZS5BZGRTa2lsbCkgJiZcclxuICAgICAgICAgICAgJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkoMTAwICogJGdhbWVHZW1JbmZvLkdhbWVHZW1JbmZvLmlucy5nZXQxKCRnYW1lR2VtSW5mby5HZW1UeXBlLkFkZFNraWxsKSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgZSAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSYW5kb21FbmVteXMoXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnROb2RlLFxyXG4gICAgICAgICAgICBlLFxyXG4gICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtSYW5nZVskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF1cclxuICAgICAgICApO1xyXG4gICAgICAgIGlmIChpLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG8gPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBuLnNjaGVkdWxlc09uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdC5zZW5kQnV0dGxlKGlbZV0uZ2V0UG9zaXRpb24oKS5jbG9uZSgpKTtcclxuICAgICAgICAgICAgfSwgMC4xICogZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBpLmxlbmd0aDsgcysrKSB7XHJcbiAgICAgICAgICAgIG8ocyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaXNBdHRhY2tpbmcgPSAhMTtcclxuICAgICAgICByZXR1cm4gITA7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2VuZEJ1dHRsZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLmljZV9ib29tKTtcclxuICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8xOVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAoZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICApKS5za2lsbFNwZWNpYWxpdHlzID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5iYXNpY1NraWxsQ29uZmlnTWFwLmdldCh0aGlzLnNraWxsSWQpLnNraWxsX3RweWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWlsaXRYID0gMzYwIC0gKGUubm9kZS53aWR0aCAvIDIpICogdGhpcy5za2lsbFBhcmFtLmljZUJvb21BdGtSYW5nZTtcclxuICAgICAgICBpZiAodC54IDw9IC10aGlzLm1pbGl0WCkge1xyXG4gICAgICAgICAgICB0LnggPSAtdGhpcy5taWxpdFg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0LnggPj0gdGhpcy5taWxpdFgpIHtcclxuICAgICAgICAgICAgdC54ID0gdGhpcy5taWxpdFg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGUuc2V0UG9zaXRpb24odCk7XHJcbiAgICAgICAgZS5pbml0QnV0dGxlKG51bGwsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgZS5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyKTtcclxuICAgICAgICBlLnNldEFuaW1hdGlvbihcIlwiKTtcclxuICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQrKztcclxuICAgIH07XHJcbiAgICByZXR1cm4gZTtcclxufSkoJGJhc2VHdW4uZGVmYXVsdCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHY7XHJcbiJdfQ==