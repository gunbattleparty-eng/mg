{"version":3,"sources":["assets\\game_script\\scripts\\CountDownUtil.js"],"names":["exports","CountDownUtil","s","t","scheduleOnce","e","i","countDownManager","has","console","warn","addTime","o","r","set","scheduleOnceForReplace","replaceTime","get","error","unSchedule","update","__values","a","next","done","l","__read","value","c","push","call","u","length","residueTime","time","currTime","Map","prototype","successCb","bind"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.CountDownUtil = void 0;\r\nvar s = (function () {\r\n    function t() {}\r\n    t.scheduleOnce = function (t, e, i) {\r\n        if (this.countDownManager.has(e)) {\r\n            console.warn(\"该定时器已存在,执行时间叠加\", e);\r\n            this.addTime(e, i);\r\n        } else {\r\n            {\r\n                var o = new r();\r\n                o.scheduleOnce(t, e, i);\r\n                this.countDownManager.set(e, o);\r\n            }\r\n        }\r\n    };\r\n    t.scheduleOnceForReplace = function (t, e, i) {\r\n        if (this.countDownManager.has(e)) {\r\n            this.replaceTime(e, i);\r\n        } else {\r\n            {\r\n                var o = new r();\r\n                o.scheduleOnce(t, e, i);\r\n                this.countDownManager.set(e, o);\r\n            }\r\n        }\r\n    };\r\n    t.replaceTime = function (t, e) {\r\n        this.countDownManager.has(t) ? this.countDownManager.get(t).replaceTime(e) : console.error(\"定时器不存在\", t);\r\n    };\r\n    t.addTime = function (t, e) {\r\n        this.countDownManager.has(t) ? this.countDownManager.get(t).addTime(e) : console.error(\"定时器不存在\", t);\r\n    };\r\n    t.unSchedule = function (t) {\r\n        if (this.countDownManager.has(t)) {\r\n            this.countDownManager.delete(t);\r\n        }\r\n    };\r\n    t.update = function (t) {\r\n        var e;\r\n        var i;\r\n        var s = [];\r\n        try {\r\n            var r = __values(this.countDownManager);\r\n            for (var a = r.next(); !a.done; a = r.next()) {\r\n                var l = __read(a.value, 2);\r\n                var c = l[0];\r\n                if (l[1].update(t)) {\r\n                    s.push(c);\r\n                }\r\n            }\r\n        } catch (t) {\r\n            e = {\r\n                error: t\r\n            };\r\n        } finally {\r\n            try {\r\n                if (a && !a.done && (i = r.return)) {\r\n                    i.call(r);\r\n                }\r\n            } finally {\r\n                if (e) {\r\n                    throw e.error;\r\n                }\r\n            }\r\n        }\r\n        for (var u = 0; u < s.length; u++) {\r\n            if (this.countDownManager.get(s[u]).residueTime <= 0) {\r\n                this.countDownManager.delete(s[u]);\r\n            }\r\n        }\r\n    };\r\n    t.time = 0;\r\n    t.currTime = 0;\r\n    t.countDownManager = new Map();\r\n    return t;\r\n})();\r\nexports.CountDownUtil = s;\r\nvar r = (function () {\r\n    function t() {}\r\n    t.prototype.addTime = function (t) {\r\n        this.residueTime += t;\r\n    };\r\n    t.prototype.replaceTime = function (t) {\r\n        this.residueTime = t;\r\n    };\r\n    t.prototype.scheduleOnce = function (t, e, i) {\r\n        this.successCb = t.bind(e);\r\n        this.residueTime = i;\r\n    };\r\n    t.prototype.update = function (t) {\r\n        return (\r\n            !(this.residueTime <= 0) &&\r\n            ((this.residueTime -= t), this.residueTime <= 0 && (this.successCb && this.successCb(), !0))\r\n        );\r\n    };\r\n    return t;\r\n})();\r\n"]}