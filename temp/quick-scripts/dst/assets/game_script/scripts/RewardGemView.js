
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/RewardGemView.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '8ead3QudrtMvK+xslJ3WlIL', 'RewardGemView');
// game_script/scripts/RewardGemView.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $list = require("./List");

var $popupManager = require("./PopupManager");

var $popupView = require("./PopupView");

var $remoteAudio = require("./RemoteAudio");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $localEventName = require("./LocalEventName");

var $roleContext = require("./RoleContext");

var $taskContext = require("./TaskContext");

var $startView = require("./StartView");

var v = cc._decorator;
var b = v.ccclass;
var w = v.property;

var A = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.list = null;
    e.btnSure = null;
    e.gemIds = [];
    e.newGemConfigs = [];
    return e;
  }

  __extends(e, t);

  e.prototype.onResetView = function () {
    this.gemIds = this.uiParam.param.gemIds;
    this.list.numItems = this.gemIds.length;
  };

  e.prototype.addEvent = function () {
    this.btnSure.on("click", this.clickSure, this);
  };

  e.prototype.removeEvent = function () {
    this.btnSure.off("click", this.clickSure, this);
  };

  e.prototype.clickSure = function () {
    $remoteAudio["default"].instance.playEffectMusic("Click");
    var e = 0;
    var i = [];

    var o = function o() {
      var t = $roleContext["default"].ins.getPackInfo(n.gemIds[e]).grade + 1;
      var o = $configContext["default"].instance.gemConfigs.filter(function (e) {
        return e.Grade === t;
      });
      var s = o[$seedUtil["default"].randomFrom(0, o.length - 1)];
      $roleContext["default"].ins.addPackItem(s, 1);
      i.push({
        type: 5,
        ext: s.id,
        num: 1
      });
      n.newGemConfigs.push(s);
      e += 5;
    };

    for (var n = this; e < this.gemIds.length;) {
      o();
    }

    var s = [];
    var r = [];

    for (var l = 0; l < this.gemIds.length; l++) {
      var u = s.indexOf(this.gemIds[l]);
      -1 === u ? (s.push(this.gemIds[l]), r.push(1)) : r[u]++;
    }

    $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.RewardView, {
      infos: i
    });

    for (var p = 0; p < s.length; p++) {
      $roleContext["default"].ins.delPackItem(s[p], r[p]);
    }

    $taskContext["default"].Ins.setTaskRecord(2, Math.round(this.gemIds.length / 5));
    $eventManager["default"].send($localEventName["default"].RENDER_GEM);
    $eventManager["default"].send($localEventName["default"].RENDER_DOT, $startView.MenuType.Role);
    t.prototype.onClickClose.call(this);
  };

  e.prototype.renderItem = function (t, e) {
    var i = this;
    var o = $roleContext["default"].ins.getPackInfo(this.gemIds[e]);
    $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public, ["/textures/gem/g" + o.part + "_" + o.grade, "/textures/gem/k" + o.grade], cc.SpriteFrame, null, function (e, o) {
      var n = t.children[0].getComponent(cc.Sprite);
      var s = t.getComponent(cc.Sprite);
      var r = o[0];

      if (r && cc.isValid(n)) {
        n.spriteFrame = $resUtil.ResUtil.assignWith(r, i.node);
        s.spriteFrame = $resUtil.ResUtil.assignWith(o[1], i.node);
      }
    });
  };

  __decorate([w($list["default"])], e.prototype, "list", void 0);

  __decorate([w(cc.Node)], e.prototype, "btnSure", void 0);

  return __decorate([b], e);
}($popupView.PopupView);

exports["default"] = A;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFJld2FyZEdlbVZpZXcuanMiXSwibmFtZXMiOlsibyIsIiRhc3NldHNMb2FkZXIiLCJyZXF1aXJlIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGV2ZW50TWFuYWdlciIsIiRsaXN0IiwiJHBvcHVwTWFuYWdlciIsIiRwb3B1cFZpZXciLCIkcmVtb3RlQXVkaW8iLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRsb2NhbEV2ZW50TmFtZSIsIiRyb2xlQ29udGV4dCIsIiR0YXNrQ29udGV4dCIsIiRzdGFydFZpZXciLCJ2IiwiY2MiLCJfZGVjb3JhdG9yIiwiYiIsImNjY2xhc3MiLCJ3IiwicHJvcGVydHkiLCJBIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsImxpc3QiLCJidG5TdXJlIiwiZ2VtSWRzIiwibmV3R2VtQ29uZmlncyIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsIm9uUmVzZXRWaWV3IiwidWlQYXJhbSIsInBhcmFtIiwibnVtSXRlbXMiLCJsZW5ndGgiLCJhZGRFdmVudCIsIm9uIiwiY2xpY2tTdXJlIiwicmVtb3ZlRXZlbnQiLCJvZmYiLCJpbnN0YW5jZSIsInBsYXlFZmZlY3RNdXNpYyIsImkiLCJpbnMiLCJnZXRQYWNrSW5mbyIsIm4iLCJncmFkZSIsImdlbUNvbmZpZ3MiLCJmaWx0ZXIiLCJHcmFkZSIsInMiLCJyYW5kb21Gcm9tIiwiYWRkUGFja0l0ZW0iLCJwdXNoIiwidHlwZSIsImV4dCIsImlkIiwibnVtIiwiciIsImwiLCJ1IiwiaW5kZXhPZiIsIlBvcHVwTWFuYWdlciIsIm9wZW4iLCJBc3NldHNNYXAiLCJQb3BVcEJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIlJld2FyZFZpZXciLCJpbmZvcyIsInAiLCJkZWxQYWNrSXRlbSIsIklucyIsInNldFRhc2tSZWNvcmQiLCJNYXRoIiwicm91bmQiLCJzZW5kIiwiUkVOREVSX0dFTSIsIlJFTkRFUl9ET1QiLCJNZW51VHlwZSIsIlJvbGUiLCJvbkNsaWNrQ2xvc2UiLCJjYWxsIiwicmVuZGVySXRlbSIsImxvYWRSZXMiLCJCdW5kbGVOYW1lcyIsIlB1YmxpYyIsInBhcnQiLCJTcHJpdGVGcmFtZSIsImNoaWxkcmVuIiwiZ2V0Q29tcG9uZW50IiwiU3ByaXRlIiwiaXNWYWxpZCIsInNwcml0ZUZyYW1lIiwiUmVzVXRpbCIsImFzc2lnbldpdGgiLCJub2RlIiwiX19kZWNvcmF0ZSIsIk5vZGUiLCJQb3B1cFZpZXciLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlHLGFBQWEsR0FBR0gsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlJLEtBQUssR0FBR0osT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSUssYUFBYSxHQUFHTCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSU0sVUFBVSxHQUFHTixPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJTyxZQUFZLEdBQUdQLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlRLFNBQVMsR0FBR1IsT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSVMsY0FBYyxHQUFHVCxPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSVUsZUFBZSxHQUFHVixPQUFPLENBQUMsa0JBQUQsQ0FBN0I7O0FBQ0EsSUFBSVcsWUFBWSxHQUFHWCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJWSxZQUFZLEdBQUdaLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlhLFVBQVUsR0FBR2IsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSWMsQ0FBQyxHQUFHQyxFQUFFLENBQUNDLFVBQVg7QUFDQSxJQUFJQyxDQUFDLEdBQUdILENBQUMsQ0FBQ0ksT0FBVjtBQUNBLElBQUlDLENBQUMsR0FBR0wsQ0FBQyxDQUFDTSxRQUFWOztBQUNBLElBQUlDLENBQUMsR0FBSSxVQUFVQyxDQUFWLEVBQWE7RUFDbEIsU0FBU0MsQ0FBVCxHQUFhO0lBQ1QsSUFBSUEsQ0FBQyxHQUFJLFNBQVNELENBQVQsSUFBY0EsQ0FBQyxDQUFDRSxLQUFGLENBQVEsSUFBUixFQUFjQyxTQUFkLENBQWYsSUFBNEMsSUFBcEQ7SUFDQUYsQ0FBQyxDQUFDRyxJQUFGLEdBQVMsSUFBVDtJQUNBSCxDQUFDLENBQUNJLE9BQUYsR0FBWSxJQUFaO0lBQ0FKLENBQUMsQ0FBQ0ssTUFBRixHQUFXLEVBQVg7SUFDQUwsQ0FBQyxDQUFDTSxhQUFGLEdBQWtCLEVBQWxCO0lBQ0EsT0FBT04sQ0FBUDtFQUNIOztFQUNETyxTQUFTLENBQUNQLENBQUQsRUFBSUQsQ0FBSixDQUFUOztFQUNBQyxDQUFDLENBQUNRLFNBQUYsQ0FBWUMsV0FBWixHQUEwQixZQUFZO0lBQ2xDLEtBQUtKLE1BQUwsR0FBYyxLQUFLSyxPQUFMLENBQWFDLEtBQWIsQ0FBbUJOLE1BQWpDO0lBQ0EsS0FBS0YsSUFBTCxDQUFVUyxRQUFWLEdBQXFCLEtBQUtQLE1BQUwsQ0FBWVEsTUFBakM7RUFDSCxDQUhEOztFQUlBYixDQUFDLENBQUNRLFNBQUYsQ0FBWU0sUUFBWixHQUF1QixZQUFZO0lBQy9CLEtBQUtWLE9BQUwsQ0FBYVcsRUFBYixDQUFnQixPQUFoQixFQUF5QixLQUFLQyxTQUE5QixFQUF5QyxJQUF6QztFQUNILENBRkQ7O0VBR0FoQixDQUFDLENBQUNRLFNBQUYsQ0FBWVMsV0FBWixHQUEwQixZQUFZO0lBQ2xDLEtBQUtiLE9BQUwsQ0FBYWMsR0FBYixDQUFpQixPQUFqQixFQUEwQixLQUFLRixTQUEvQixFQUEwQyxJQUExQztFQUNILENBRkQ7O0VBR0FoQixDQUFDLENBQUNRLFNBQUYsQ0FBWVEsU0FBWixHQUF3QixZQUFZO0lBQ2hDaEMsWUFBWSxXQUFaLENBQXFCbUMsUUFBckIsQ0FBOEJDLGVBQTlCLENBQThDLE9BQTlDO0lBQ0EsSUFBSXBCLENBQUMsR0FBRyxDQUFSO0lBQ0EsSUFBSXFCLENBQUMsR0FBRyxFQUFSOztJQUNBLElBQUk5QyxDQUFDLEdBQUcsYUFBWTtNQUNoQixJQUFJd0IsQ0FBQyxHQUFHWCxZQUFZLFdBQVosQ0FBcUJrQyxHQUFyQixDQUF5QkMsV0FBekIsQ0FBcUNDLENBQUMsQ0FBQ25CLE1BQUYsQ0FBU0wsQ0FBVCxDQUFyQyxFQUFrRHlCLEtBQWxELEdBQTBELENBQWxFO01BQ0EsSUFBSWxELENBQUMsR0FBR1csY0FBYyxXQUFkLENBQXVCaUMsUUFBdkIsQ0FBZ0NPLFVBQWhDLENBQTJDQyxNQUEzQyxDQUFrRCxVQUFVM0IsQ0FBVixFQUFhO1FBQ25FLE9BQU9BLENBQUMsQ0FBQzRCLEtBQUYsS0FBWTdCLENBQW5CO01BQ0gsQ0FGTyxDQUFSO01BR0EsSUFBSThCLENBQUMsR0FBR3RELENBQUMsQ0FBQ1UsU0FBUyxXQUFULENBQWtCNkMsVUFBbEIsQ0FBNkIsQ0FBN0IsRUFBZ0N2RCxDQUFDLENBQUNzQyxNQUFGLEdBQVcsQ0FBM0MsQ0FBRCxDQUFUO01BQ0F6QixZQUFZLFdBQVosQ0FBcUJrQyxHQUFyQixDQUF5QlMsV0FBekIsQ0FBcUNGLENBQXJDLEVBQXdDLENBQXhDO01BQ0FSLENBQUMsQ0FBQ1csSUFBRixDQUFPO1FBQ0hDLElBQUksRUFBRSxDQURIO1FBRUhDLEdBQUcsRUFBRUwsQ0FBQyxDQUFDTSxFQUZKO1FBR0hDLEdBQUcsRUFBRTtNQUhGLENBQVA7TUFLQVosQ0FBQyxDQUFDbEIsYUFBRixDQUFnQjBCLElBQWhCLENBQXFCSCxDQUFyQjtNQUNBN0IsQ0FBQyxJQUFJLENBQUw7SUFDSCxDQWREOztJQWVBLEtBQUssSUFBSXdCLENBQUMsR0FBRyxJQUFiLEVBQW1CeEIsQ0FBQyxHQUFHLEtBQUtLLE1BQUwsQ0FBWVEsTUFBbkMsR0FBNkM7TUFDekN0QyxDQUFDO0lBQ0o7O0lBQ0QsSUFBSXNELENBQUMsR0FBRyxFQUFSO0lBQ0EsSUFBSVEsQ0FBQyxHQUFHLEVBQVI7O0lBQ0EsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtqQyxNQUFMLENBQVlRLE1BQWhDLEVBQXdDeUIsQ0FBQyxFQUF6QyxFQUE2QztNQUN6QyxJQUFJQyxDQUFDLEdBQUdWLENBQUMsQ0FBQ1csT0FBRixDQUFVLEtBQUtuQyxNQUFMLENBQVlpQyxDQUFaLENBQVYsQ0FBUjtNQUNBLENBQUMsQ0FBRCxLQUFPQyxDQUFQLElBQVlWLENBQUMsQ0FBQ0csSUFBRixDQUFPLEtBQUszQixNQUFMLENBQVlpQyxDQUFaLENBQVAsR0FBd0JELENBQUMsQ0FBQ0wsSUFBRixDQUFPLENBQVAsQ0FBcEMsSUFBaURLLENBQUMsQ0FBQ0UsQ0FBRCxDQUFELEVBQWpEO0lBQ0g7O0lBQ0R6RCxhQUFhLENBQUMyRCxZQUFkLENBQTJCdEIsUUFBM0IsQ0FBb0N1QixJQUFwQyxDQUF5Q2hFLFVBQVUsQ0FBQ2lFLFNBQVgsQ0FBcUJDLFlBQXJCLENBQWtDQyxPQUFsQyxDQUEwQ0MsVUFBMUMsQ0FBcURDLFVBQTlGLEVBQTBHO01BQ3RHQyxLQUFLLEVBQUUzQjtJQUQrRixDQUExRzs7SUFHQSxLQUFLLElBQUk0QixDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHcEIsQ0FBQyxDQUFDaEIsTUFBdEIsRUFBOEJvQyxDQUFDLEVBQS9CLEVBQW1DO01BQy9CN0QsWUFBWSxXQUFaLENBQXFCa0MsR0FBckIsQ0FBeUI0QixXQUF6QixDQUFxQ3JCLENBQUMsQ0FBQ29CLENBQUQsQ0FBdEMsRUFBMkNaLENBQUMsQ0FBQ1ksQ0FBRCxDQUE1QztJQUNIOztJQUNENUQsWUFBWSxXQUFaLENBQXFCOEQsR0FBckIsQ0FBeUJDLGFBQXpCLENBQXVDLENBQXZDLEVBQTBDQyxJQUFJLENBQUNDLEtBQUwsQ0FBVyxLQUFLakQsTUFBTCxDQUFZUSxNQUFaLEdBQXFCLENBQWhDLENBQTFDO0lBQ0FqQyxhQUFhLFdBQWIsQ0FBc0IyRSxJQUF0QixDQUEyQnBFLGVBQWUsV0FBZixDQUF3QnFFLFVBQW5EO0lBQ0E1RSxhQUFhLFdBQWIsQ0FBc0IyRSxJQUF0QixDQUEyQnBFLGVBQWUsV0FBZixDQUF3QnNFLFVBQW5ELEVBQStEbkUsVUFBVSxDQUFDb0UsUUFBWCxDQUFvQkMsSUFBbkY7SUFDQTVELENBQUMsQ0FBQ1MsU0FBRixDQUFZb0QsWUFBWixDQUF5QkMsSUFBekIsQ0FBOEIsSUFBOUI7RUFDSCxDQXRDRDs7RUF1Q0E3RCxDQUFDLENBQUNRLFNBQUYsQ0FBWXNELFVBQVosR0FBeUIsVUFBVS9ELENBQVYsRUFBYUMsQ0FBYixFQUFnQjtJQUNyQyxJQUFJcUIsQ0FBQyxHQUFHLElBQVI7SUFDQSxJQUFJOUMsQ0FBQyxHQUFHYSxZQUFZLFdBQVosQ0FBcUJrQyxHQUFyQixDQUF5QkMsV0FBekIsQ0FBcUMsS0FBS2xCLE1BQUwsQ0FBWUwsQ0FBWixDQUFyQyxDQUFSO0lBQ0F4QixhQUFhLFdBQWIsQ0FBc0IyQyxRQUF0QixDQUErQjRDLE9BQS9CLENBQ0lyRixVQUFVLENBQUNzRixXQUFYLENBQXVCQyxNQUQzQixFQUVJLENBQUMsb0JBQW9CMUYsQ0FBQyxDQUFDMkYsSUFBdEIsR0FBNkIsR0FBN0IsR0FBbUMzRixDQUFDLENBQUNrRCxLQUF0QyxFQUE2QyxvQkFBb0JsRCxDQUFDLENBQUNrRCxLQUFuRSxDQUZKLEVBR0lqQyxFQUFFLENBQUMyRSxXQUhQLEVBSUksSUFKSixFQUtJLFVBQVVuRSxDQUFWLEVBQWF6QixDQUFiLEVBQWdCO01BQ1osSUFBSWlELENBQUMsR0FBR3pCLENBQUMsQ0FBQ3FFLFFBQUYsQ0FBVyxDQUFYLEVBQWNDLFlBQWQsQ0FBMkI3RSxFQUFFLENBQUM4RSxNQUE5QixDQUFSO01BQ0EsSUFBSXpDLENBQUMsR0FBRzlCLENBQUMsQ0FBQ3NFLFlBQUYsQ0FBZTdFLEVBQUUsQ0FBQzhFLE1BQWxCLENBQVI7TUFDQSxJQUFJakMsQ0FBQyxHQUFHOUQsQ0FBQyxDQUFDLENBQUQsQ0FBVDs7TUFDQSxJQUFJOEQsQ0FBQyxJQUFJN0MsRUFBRSxDQUFDK0UsT0FBSCxDQUFXL0MsQ0FBWCxDQUFULEVBQXdCO1FBQ3BCQSxDQUFDLENBQUNnRCxXQUFGLEdBQWdCN0YsUUFBUSxDQUFDOEYsT0FBVCxDQUFpQkMsVUFBakIsQ0FBNEJyQyxDQUE1QixFQUErQmhCLENBQUMsQ0FBQ3NELElBQWpDLENBQWhCO1FBQ0E5QyxDQUFDLENBQUMyQyxXQUFGLEdBQWdCN0YsUUFBUSxDQUFDOEYsT0FBVCxDQUFpQkMsVUFBakIsQ0FBNEJuRyxDQUFDLENBQUMsQ0FBRCxDQUE3QixFQUFrQzhDLENBQUMsQ0FBQ3NELElBQXBDLENBQWhCO01BQ0g7SUFDSixDQWJMO0VBZUgsQ0FsQkQ7O0VBbUJBQyxVQUFVLENBQUMsQ0FBQ2hGLENBQUMsQ0FBQ2YsS0FBSyxXQUFOLENBQUYsQ0FBRCxFQUFxQm1CLENBQUMsQ0FBQ1EsU0FBdkIsRUFBa0MsTUFBbEMsRUFBMEMsS0FBSyxDQUEvQyxDQUFWOztFQUNBb0UsVUFBVSxDQUFDLENBQUNoRixDQUFDLENBQUNKLEVBQUUsQ0FBQ3FGLElBQUosQ0FBRixDQUFELEVBQWU3RSxDQUFDLENBQUNRLFNBQWpCLEVBQTRCLFNBQTVCLEVBQXVDLEtBQUssQ0FBNUMsQ0FBVjs7RUFDQSxPQUFPb0UsVUFBVSxDQUFDLENBQUNsRixDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBakZPLENBaUZMakIsVUFBVSxDQUFDK0YsU0FqRk4sQ0FBUjs7QUFrRkFDLE9BQU8sV0FBUCxHQUFrQmpGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRsaXN0ID0gcmVxdWlyZShcIi4vTGlzdFwiKTtcclxudmFyICRwb3B1cE1hbmFnZXIgPSByZXF1aXJlKFwiLi9Qb3B1cE1hbmFnZXJcIik7XHJcbnZhciAkcG9wdXBWaWV3ID0gcmVxdWlyZShcIi4vUG9wdXBWaWV3XCIpO1xyXG52YXIgJHJlbW90ZUF1ZGlvID0gcmVxdWlyZShcIi4vUmVtb3RlQXVkaW9cIik7XHJcbnZhciAkc2VlZFV0aWwgPSByZXF1aXJlKFwiLi9TZWVkVXRpbFwiKTtcclxudmFyICRjb25maWdDb250ZXh0ID0gcmVxdWlyZShcIi4vQ29uZmlnQ29udGV4dFwiKTtcclxudmFyICRsb2NhbEV2ZW50TmFtZSA9IHJlcXVpcmUoXCIuL0xvY2FsRXZlbnROYW1lXCIpO1xyXG52YXIgJHJvbGVDb250ZXh0ID0gcmVxdWlyZShcIi4vUm9sZUNvbnRleHRcIik7XHJcbnZhciAkdGFza0NvbnRleHQgPSByZXF1aXJlKFwiLi9UYXNrQ29udGV4dFwiKTtcclxudmFyICRzdGFydFZpZXcgPSByZXF1aXJlKFwiLi9TdGFydFZpZXdcIik7XHJcbnZhciB2ID0gY2MuX2RlY29yYXRvcjtcclxudmFyIGIgPSB2LmNjY2xhc3M7XHJcbnZhciB3ID0gdi5wcm9wZXJ0eTtcclxudmFyIEEgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5saXN0ID0gbnVsbDtcclxuICAgICAgICBlLmJ0blN1cmUgPSBudWxsO1xyXG4gICAgICAgIGUuZ2VtSWRzID0gW107XHJcbiAgICAgICAgZS5uZXdHZW1Db25maWdzID0gW107XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5vblJlc2V0VmlldyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmdlbUlkcyA9IHRoaXMudWlQYXJhbS5wYXJhbS5nZW1JZHM7XHJcbiAgICAgICAgdGhpcy5saXN0Lm51bUl0ZW1zID0gdGhpcy5nZW1JZHMubGVuZ3RoO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmFkZEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuU3VyZS5vbihcImNsaWNrXCIsIHRoaXMuY2xpY2tTdXJlLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0blN1cmUub2ZmKFwiY2xpY2tcIiwgdGhpcy5jbGlja1N1cmUsIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmNsaWNrU3VyZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkcmVtb3RlQXVkaW8uZGVmYXVsdC5pbnN0YW5jZS5wbGF5RWZmZWN0TXVzaWMoXCJDbGlja1wiKTtcclxuICAgICAgICB2YXIgZSA9IDA7XHJcbiAgICAgICAgdmFyIGkgPSBbXTtcclxuICAgICAgICB2YXIgbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UGFja0luZm8obi5nZW1JZHNbZV0pLmdyYWRlICsgMTtcclxuICAgICAgICAgICAgdmFyIG8gPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmdlbUNvbmZpZ3MuZmlsdGVyKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5HcmFkZSA9PT0gdDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBzID0gb1skc2VlZFV0aWwuZGVmYXVsdC5yYW5kb21Gcm9tKDAsIG8ubGVuZ3RoIC0gMSldO1xyXG4gICAgICAgICAgICAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuYWRkUGFja0l0ZW0ocywgMSk7XHJcbiAgICAgICAgICAgIGkucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiA1LFxyXG4gICAgICAgICAgICAgICAgZXh0OiBzLmlkLFxyXG4gICAgICAgICAgICAgICAgbnVtOiAxXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBuLm5ld0dlbUNvbmZpZ3MucHVzaChzKTtcclxuICAgICAgICAgICAgZSArPSA1O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yICh2YXIgbiA9IHRoaXM7IGUgPCB0aGlzLmdlbUlkcy5sZW5ndGg7ICkge1xyXG4gICAgICAgICAgICBvKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzID0gW107XHJcbiAgICAgICAgdmFyIHIgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IHRoaXMuZ2VtSWRzLmxlbmd0aDsgbCsrKSB7XHJcbiAgICAgICAgICAgIHZhciB1ID0gcy5pbmRleE9mKHRoaXMuZ2VtSWRzW2xdKTtcclxuICAgICAgICAgICAgLTEgPT09IHUgPyAocy5wdXNoKHRoaXMuZ2VtSWRzW2xdKSwgci5wdXNoKDEpKSA6IHJbdV0rKztcclxuICAgICAgICB9XHJcbiAgICAgICAgJHBvcHVwTWFuYWdlci5Qb3B1cE1hbmFnZXIuaW5zdGFuY2Uub3BlbigkYXNzZXRzTWFwLkFzc2V0c01hcC5Qb3BVcEJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LlJld2FyZFZpZXcsIHtcclxuICAgICAgICAgICAgaW5mb3M6IGlcclxuICAgICAgICB9KTtcclxuICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IHMubGVuZ3RoOyBwKyspIHtcclxuICAgICAgICAgICAgJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmRlbFBhY2tJdGVtKHNbcF0sIHJbcF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkdGFza0NvbnRleHQuZGVmYXVsdC5JbnMuc2V0VGFza1JlY29yZCgyLCBNYXRoLnJvdW5kKHRoaXMuZ2VtSWRzLmxlbmd0aCAvIDUpKTtcclxuICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZCgkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfR0VNKTtcclxuICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZCgkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfRE9ULCAkc3RhcnRWaWV3Lk1lbnVUeXBlLlJvbGUpO1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQ2xpY2tDbG9zZS5jYWxsKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbmRlckl0ZW0gPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIHZhciBpID0gdGhpcztcclxuICAgICAgICB2YXIgbyA9ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRQYWNrSW5mbyh0aGlzLmdlbUlkc1tlXSk7XHJcbiAgICAgICAgJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmxvYWRSZXMoXHJcbiAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuUHVibGljLFxyXG4gICAgICAgICAgICBbXCIvdGV4dHVyZXMvZ2VtL2dcIiArIG8ucGFydCArIFwiX1wiICsgby5ncmFkZSwgXCIvdGV4dHVyZXMvZ2VtL2tcIiArIG8uZ3JhZGVdLFxyXG4gICAgICAgICAgICBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKGUsIG8pIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdC5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gdC5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgICAgIHZhciByID0gb1swXTtcclxuICAgICAgICAgICAgICAgIGlmIChyICYmIGNjLmlzVmFsaWQobikpIHtcclxuICAgICAgICAgICAgICAgICAgICBuLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKHIsIGkubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5zcHJpdGVGcmFtZSA9ICRyZXNVdGlsLlJlc1V0aWwuYXNzaWduV2l0aChvWzFdLCBpLm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBfX2RlY29yYXRlKFt3KCRsaXN0LmRlZmF1bHQpXSwgZS5wcm90b3R5cGUsIFwibGlzdFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbdyhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImJ0blN1cmVcIiwgdm9pZCAwKTtcclxuICAgIHJldHVybiBfX2RlY29yYXRlKFtiXSwgZSk7XHJcbn0pKCRwb3B1cFZpZXcuUG9wdXBWaWV3KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gQTtcclxuIl19