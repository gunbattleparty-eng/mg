
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/UIManager.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c9d3aXiE5JC36NLmHRXWXbR', 'UIManager');
// game_script/scripts/UIManager.js

"use strict";

exports.UIManager = void 0;

var $assetsMap = require("./AssetsMap");

var $resManager = require("./ResManager");

var $resUtil = require("./ResUtil");

var $uIView = require("./UIView");

var $uICache = require("./UICache");

var $uIParam = require("./UIParam");

var c = function () {
  function t() {
    this.baseUIType = [$uIParam.LayerType.DIALOG, $uIParam.LayerType.WAITING, $uIParam.LayerType.LOADING, $uIParam.LayerType.TOAST];
    this.rootView = null;
    this.uiCache = $uICache.UICache.instance;
    this.resManager = $resManager.ResManager.instance;
    this.layerUI = null;
    this.layerPop = null;
    this.layerLoadingView = null;
    this.layerWaitding = null;
    this.layerConfirm = null;
    this.layerToast = null;
    this.currLoingView = null;
  }

  t.prototype.isCurrPage = function (t) {
    return this.layerUI.children.length > 0 && this.layerUI.children[0].name === t;
  };

  t.prototype.init = function (t, e, i) {
    this.rootView = t;
    this.createLayer();
    this.uiCache.setBaseUI($uIParam.LayerType.LOADING, e);
    this.uiCache.setBaseUI($uIParam.LayerType.DIALOG, i);
  };

  t.prototype.changeLoadingView = function (t) {
    var e = this.resManager.get(t);
    this.uiCache.getBaseUI($uIParam.LayerType.LOADING).destroy();
    this.uiCache.removeBaseUICache($uIParam.LayerType.LOADING);
    this.uiCache.setBaseUI($uIParam.LayerType.LOADING, e);
  };

  t.prototype.loadBaseUI = function () {
    this.uiCache.setBaseUI($uIParam.LayerType.WAITING, this.resManager.get($assetsMap.AssetsMap.ResourcesBundle.prefabs.assetsList.WaitingView));
    this.uiCache.setBaseUI($uIParam.LayerType.TOAST, this.resManager.get($assetsMap.AssetsMap.ResourcesBundle.prefabs.assetsList.ToastView));
    this.uiCache.popBgPrefab = this.resManager.get($assetsMap.AssetsMap.ResourcesBundle.prefabs.assetsList.PopMaskBg);
  };

  t.prototype.replaceView = function (t, e) {
    if (void 0 === e) {
      e = null;
    }

    for (var i = this.uiCache.getCurrView($uIParam.LayerType.POPUP); i.length > 0;) {
      this.uiRemoveScene($uIParam.LayerType.POPUP, i[0]);
      i = this.uiCache.getCurrView($uIParam.LayerType.POPUP);
    }

    var o = this.uiCache.getCurrView($uIParam.LayerType.UI);

    for (var n = 0; n < o.length; n++) {
      this.uiRemoveScene($uIParam.LayerType.UI, o[n]);
    }

    var a = this.uiCache.getCacheView(t);
    $resUtil.ResUtil.getResKeeper(a, !0);
    var c = {
      uuid: a.uuid,
      viewPath: t,
      param: e,
      rooNode: this.layerUI
    };
    var u = a.getComponent($uIView.UIView);
    u ? (u.uiParam = c, this.uiAddScene($uIParam.LayerType.UI, u), this.layerUI.addChild(u.node)) : console.error("当前UI不存在，或者没有绑定脚本");
  };

  t.prototype.lodingView = function (t, e, i, o) {
    var n = this;

    if (void 0 === o) {
      o = !0;
    }

    var s = !1;

    for (var r = 0; r < t.length; r++) {
      if (!this.resManager.isBundleLoaded(t[r])) {
        s = !0;
        break;
      }

      if (!this.resManager.hasBundleLoadedAssets(t[r])) {
        s = !0;
      }
    }

    if (s) {
      var a = this.uiCache.getBaseUI($uIParam.LayerType.LOADING);
      this.currLoingView = a;
      this.uiAddScene($uIParam.LayerType.LOADING, a);
      a.node.parent = this.layerLoadingView;
      this.resManager.loadBundles(t, function (t) {
        a.setProgress(t);
      }, function () {
        var t = !1;
        a.setProgress(0, !0);
        a.registerCB(function () {
          t ? (i && i(), o && (n.currLoingView = null, n.uiRemoveScene($uIParam.LayerType.LOADING, a))) : t = !0;
        }, n);
        n.resManager.loadArray(e, function (t) {
          a.setProgress(t);
        }, function () {
          t ? (i && i(), o && (n.currLoingView = null, n.uiRemoveScene($uIParam.LayerType.LOADING, a))) : t = !0;
        });
      });
    } else {
      if (i) {
        i();
      }
    }
  };

  t.prototype.removeLoadingView = function () {
    if (this.currLoingView) {
      this.uiRemoveScene($uIParam.LayerType.LOADING, this.currLoingView);
    }
  };

  t.prototype.showToast = function () {
    var t = this.uiCache.getBaseUI($uIParam.LayerType.TOAST);
    var e = {
      uuid: t.node.uuid,
      viewPath: "",
      param: {
        msg: arguments[0] || "",
        time: arguments[1] || 1,
        pos: arguments[2] || cc.v2(0, 200)
      },
      rooNode: this.layerToast
    };
    t.uiParam = e;
    this.uiAddScene($uIParam.LayerType.TOAST, t);
    t.node.parent = this.layerToast;
  };

  t.prototype.hideToast = function (t) {
    this.uiRemoveScene($uIParam.LayerType.TOAST, t);
  };

  t.prototype.uiAddScene = function (t, e) {
    e.node.active = !0;
    this.uiCache.putCurrView(t, e);
    e.innerAddToScreen();
  };

  t.prototype.uiRemoveScene = function (t, e) {
    e.innerRemoveToScreen();

    if (this.uiCache.removeCurrView(t, e)) {
      e.node.active = !1;
      e.node.parent = null;
      this.baseUIType.includes(e.uiType) ? this.uiCache.cacheBaseUI(t, e) : this.uiCache.cacheView(e.uiParam.viewPath, e);
    }
  };

  t.prototype.createLayer = function () {
    this.layerUI = this.rootView.getChildByName("layer_ui");

    if (!cc.isValid(this.layerUI)) {
      this.layerUI = this.generateDefaultLayer("layer_ui", $uIParam.LayerType.UI);
    }

    this.layerPop = this.rootView.getChildByName("layer_pop");

    if (!cc.isValid(this.layerPop)) {
      this.layerPop = this.generateDefaultLayer("layer_pop", $uIParam.LayerType.POPUP);
    }

    this.layerLoadingView = this.rootView.getChildByName("loading_view");

    if (!cc.isValid(this.layerLoadingView)) {
      this.layerLoadingView = this.generateDefaultLayer("loading_view", $uIParam.LayerType.LOADING);
    }

    this.layerConfirm = this.rootView.getChildByName("layer_confirm");

    if (!cc.isValid(this.layerConfirm)) {
      this.layerConfirm = this.generateDefaultLayer("layer_confirm", $uIParam.LayerType.DIALOG);
    }

    this.layerWaitding = this.rootView.getChildByName("layer_waiting");

    if (!cc.isValid(this.layerWaitding)) {
      this.layerWaitding = this.generateDefaultLayer("layer_waiting", $uIParam.LayerType.WAITING);
    }

    this.layerToast = this.rootView.getChildByName("layerToast");

    if (!cc.isValid(this.layerToast)) {
      this.layerToast = this.generateDefaultLayer("layerToast", $uIParam.LayerType.TOAST);
    }
  };

  t.prototype.generateDefaultLayer = function (t, e) {
    var i = new cc.Node();
    var o = i.addComponent(cc.Widget);
    o.isAlignLeft = o.isAlignRight = o.isAlignTop = o.isAlignBottom = !0;
    o.left = o.right = o.top = o.bottom = 0;
    o.alignMode = cc.Widget.AlignMode.ALWAYS;
    o.enabled = !0;
    i.setSiblingIndex(e);
    i.name = t;
    this.rootView.addChild(i);
    return i;
  };

  t.prototype.getLayer = function (t) {
    return t === $uIParam.LayerType.UI ? this.layerUI : t === $uIParam.LayerType.LOADING ? this.layerLoadingView : t === $uIParam.LayerType.POPUP ? this.layerPop : t === $uIParam.LayerType.WAITING ? this.layerWaitding : t === $uIParam.LayerType.DIALOG ? this.layerConfirm : t === $uIParam.LayerType.TOAST ? this.layerToast : void 0;
  };

  t.instance = new t();
  return t;
}();

exports.UIManager = c;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFVJTWFuYWdlci5qcyJdLCJuYW1lcyI6WyJleHBvcnRzIiwiVUlNYW5hZ2VyIiwiJGFzc2V0c01hcCIsInJlcXVpcmUiLCIkcmVzTWFuYWdlciIsIiRyZXNVdGlsIiwiJHVJVmlldyIsIiR1SUNhY2hlIiwiJHVJUGFyYW0iLCJjIiwidCIsImJhc2VVSVR5cGUiLCJMYXllclR5cGUiLCJESUFMT0ciLCJXQUlUSU5HIiwiTE9BRElORyIsIlRPQVNUIiwicm9vdFZpZXciLCJ1aUNhY2hlIiwiVUlDYWNoZSIsImluc3RhbmNlIiwicmVzTWFuYWdlciIsIlJlc01hbmFnZXIiLCJsYXllclVJIiwibGF5ZXJQb3AiLCJsYXllckxvYWRpbmdWaWV3IiwibGF5ZXJXYWl0ZGluZyIsImxheWVyQ29uZmlybSIsImxheWVyVG9hc3QiLCJjdXJyTG9pbmdWaWV3IiwicHJvdG90eXBlIiwiaXNDdXJyUGFnZSIsImNoaWxkcmVuIiwibGVuZ3RoIiwibmFtZSIsImluaXQiLCJlIiwiaSIsImNyZWF0ZUxheWVyIiwic2V0QmFzZVVJIiwiY2hhbmdlTG9hZGluZ1ZpZXciLCJnZXQiLCJnZXRCYXNlVUkiLCJkZXN0cm95IiwicmVtb3ZlQmFzZVVJQ2FjaGUiLCJsb2FkQmFzZVVJIiwiQXNzZXRzTWFwIiwiUmVzb3VyY2VzQnVuZGxlIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJXYWl0aW5nVmlldyIsIlRvYXN0VmlldyIsInBvcEJnUHJlZmFiIiwiUG9wTWFza0JnIiwicmVwbGFjZVZpZXciLCJnZXRDdXJyVmlldyIsIlBPUFVQIiwidWlSZW1vdmVTY2VuZSIsIm8iLCJVSSIsIm4iLCJhIiwiZ2V0Q2FjaGVWaWV3IiwiUmVzVXRpbCIsImdldFJlc0tlZXBlciIsInV1aWQiLCJ2aWV3UGF0aCIsInBhcmFtIiwicm9vTm9kZSIsInUiLCJnZXRDb21wb25lbnQiLCJVSVZpZXciLCJ1aVBhcmFtIiwidWlBZGRTY2VuZSIsImFkZENoaWxkIiwibm9kZSIsImNvbnNvbGUiLCJlcnJvciIsImxvZGluZ1ZpZXciLCJzIiwiciIsImlzQnVuZGxlTG9hZGVkIiwiaGFzQnVuZGxlTG9hZGVkQXNzZXRzIiwicGFyZW50IiwibG9hZEJ1bmRsZXMiLCJzZXRQcm9ncmVzcyIsInJlZ2lzdGVyQ0IiLCJsb2FkQXJyYXkiLCJyZW1vdmVMb2FkaW5nVmlldyIsInNob3dUb2FzdCIsIm1zZyIsImFyZ3VtZW50cyIsInRpbWUiLCJwb3MiLCJjYyIsInYyIiwiaGlkZVRvYXN0IiwiYWN0aXZlIiwicHV0Q3VyclZpZXciLCJpbm5lckFkZFRvU2NyZWVuIiwiaW5uZXJSZW1vdmVUb1NjcmVlbiIsInJlbW92ZUN1cnJWaWV3IiwiaW5jbHVkZXMiLCJ1aVR5cGUiLCJjYWNoZUJhc2VVSSIsImNhY2hlVmlldyIsImdldENoaWxkQnlOYW1lIiwiaXNWYWxpZCIsImdlbmVyYXRlRGVmYXVsdExheWVyIiwiTm9kZSIsImFkZENvbXBvbmVudCIsIldpZGdldCIsImlzQWxpZ25MZWZ0IiwiaXNBbGlnblJpZ2h0IiwiaXNBbGlnblRvcCIsImlzQWxpZ25Cb3R0b20iLCJsZWZ0IiwicmlnaHQiLCJ0b3AiLCJib3R0b20iLCJhbGlnbk1vZGUiLCJBbGlnbk1vZGUiLCJBTFdBWVMiLCJlbmFibGVkIiwic2V0U2libGluZ0luZGV4IiwiZ2V0TGF5ZXIiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUFBLE9BQU8sQ0FBQ0MsU0FBUixHQUFvQixLQUFLLENBQXpCOztBQUNBLElBQUlDLFVBQVUsR0FBR0MsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUMsV0FBVyxHQUFHRCxPQUFPLENBQUMsY0FBRCxDQUF6Qjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlHLE9BQU8sR0FBR0gsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0EsSUFBSUksUUFBUSxHQUFHSixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFD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QUtZLGFBREwsR0FFQWhCLENBQUMsS0FBS0YsUUFBUSxDQUFDSSxTQUFULENBQW1CQyxNQUF6QixHQUNBLEtBQUtjLFlBREwsR0FFQWpCLENBQUMsS0FBS0YsUUFBUSxDQUFDSSxTQUFULENBQW1CSSxLQUF6QixHQUNBLEtBQUtZLFVBREwsR0FFQSxLQUFLLENBWlg7RUFhSCxDQWREOztFQWVBbEIsQ0FBQyxDQUFDVSxRQUFGLEdBQWEsSUFBSVYsQ0FBSixFQUFiO0VBQ0EsT0FBT0EsQ0FBUDtBQUNILENBNU5PLEVBQVI7O0FBNk5BVixPQUFPLENBQUNDLFNBQVIsR0FBb0JRLENBQXBCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnRzLlVJTWFuYWdlciA9IHZvaWQgMDtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzTWFuYWdlciA9IHJlcXVpcmUoXCIuL1Jlc01hbmFnZXJcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkdUlWaWV3ID0gcmVxdWlyZShcIi4vVUlWaWV3XCIpO1xyXG52YXIgJHVJQ2FjaGUgPSByZXF1aXJlKFwiLi9VSUNhY2hlXCIpO1xyXG52YXIgJHVJUGFyYW0gPSByZXF1aXJlKFwiLi9VSVBhcmFtXCIpO1xyXG52YXIgYyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiB0KCkge1xyXG4gICAgICAgIHRoaXMuYmFzZVVJVHlwZSA9IFtcclxuICAgICAgICAgICAgJHVJUGFyYW0uTGF5ZXJUeXBlLkRJQUxPRyxcclxuICAgICAgICAgICAgJHVJUGFyYW0uTGF5ZXJUeXBlLldBSVRJTkcsXHJcbiAgICAgICAgICAgICR1SVBhcmFtLkxheWVyVHlwZS5MT0FESU5HLFxyXG4gICAgICAgICAgICAkdUlQYXJhbS5MYXllclR5cGUuVE9BU1RcclxuICAgICAgICBdO1xyXG4gICAgICAgIHRoaXMucm9vdFZpZXcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudWlDYWNoZSA9ICR1SUNhY2hlLlVJQ2FjaGUuaW5zdGFuY2U7XHJcbiAgICAgICAgdGhpcy5yZXNNYW5hZ2VyID0gJHJlc01hbmFnZXIuUmVzTWFuYWdlci5pbnN0YW5jZTtcclxuICAgICAgICB0aGlzLmxheWVyVUkgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubGF5ZXJQb3AgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubGF5ZXJMb2FkaW5nVmlldyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5sYXllcldhaXRkaW5nID0gbnVsbDtcclxuICAgICAgICB0aGlzLmxheWVyQ29uZmlybSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5sYXllclRvYXN0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmN1cnJMb2luZ1ZpZXcgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgdC5wcm90b3R5cGUuaXNDdXJyUGFnZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGF5ZXJVSS5jaGlsZHJlbi5sZW5ndGggPiAwICYmIHRoaXMubGF5ZXJVSS5jaGlsZHJlblswXS5uYW1lID09PSB0O1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHRoaXMucm9vdFZpZXcgPSB0O1xyXG4gICAgICAgIHRoaXMuY3JlYXRlTGF5ZXIoKTtcclxuICAgICAgICB0aGlzLnVpQ2FjaGUuc2V0QmFzZVVJKCR1SVBhcmFtLkxheWVyVHlwZS5MT0FESU5HLCBlKTtcclxuICAgICAgICB0aGlzLnVpQ2FjaGUuc2V0QmFzZVVJKCR1SVBhcmFtLkxheWVyVHlwZS5ESUFMT0csIGkpO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLmNoYW5nZUxvYWRpbmdWaWV3ID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXMucmVzTWFuYWdlci5nZXQodCk7XHJcbiAgICAgICAgdGhpcy51aUNhY2hlLmdldEJhc2VVSSgkdUlQYXJhbS5MYXllclR5cGUuTE9BRElORykuZGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMudWlDYWNoZS5yZW1vdmVCYXNlVUlDYWNoZSgkdUlQYXJhbS5MYXllclR5cGUuTE9BRElORyk7XHJcbiAgICAgICAgdGhpcy51aUNhY2hlLnNldEJhc2VVSSgkdUlQYXJhbS5MYXllclR5cGUuTE9BRElORywgZSk7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUubG9hZEJhc2VVSSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnVpQ2FjaGUuc2V0QmFzZVVJKFxyXG4gICAgICAgICAgICAkdUlQYXJhbS5MYXllclR5cGUuV0FJVElORyxcclxuICAgICAgICAgICAgdGhpcy5yZXNNYW5hZ2VyLmdldCgkYXNzZXRzTWFwLkFzc2V0c01hcC5SZXNvdXJjZXNCdW5kbGUucHJlZmFicy5hc3NldHNMaXN0LldhaXRpbmdWaWV3KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy51aUNhY2hlLnNldEJhc2VVSShcclxuICAgICAgICAgICAgJHVJUGFyYW0uTGF5ZXJUeXBlLlRPQVNULFxyXG4gICAgICAgICAgICB0aGlzLnJlc01hbmFnZXIuZ2V0KCRhc3NldHNNYXAuQXNzZXRzTWFwLlJlc291cmNlc0J1bmRsZS5wcmVmYWJzLmFzc2V0c0xpc3QuVG9hc3RWaWV3KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy51aUNhY2hlLnBvcEJnUHJlZmFiID0gdGhpcy5yZXNNYW5hZ2VyLmdldChcclxuICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuUmVzb3VyY2VzQnVuZGxlLnByZWZhYnMuYXNzZXRzTGlzdC5Qb3BNYXNrQmdcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLnJlcGxhY2VWaWV3ID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICBpZiAodm9pZCAwID09PSBlKSB7XHJcbiAgICAgICAgICAgIGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy51aUNhY2hlLmdldEN1cnJWaWV3KCR1SVBhcmFtLkxheWVyVHlwZS5QT1BVUCk7IGkubGVuZ3RoID4gMDsgKSB7XHJcbiAgICAgICAgICAgIHRoaXMudWlSZW1vdmVTY2VuZSgkdUlQYXJhbS5MYXllclR5cGUuUE9QVVAsIGlbMF0pO1xyXG4gICAgICAgICAgICBpID0gdGhpcy51aUNhY2hlLmdldEN1cnJWaWV3KCR1SVBhcmFtLkxheWVyVHlwZS5QT1BVUCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvID0gdGhpcy51aUNhY2hlLmdldEN1cnJWaWV3KCR1SVBhcmFtLkxheWVyVHlwZS5VSSk7XHJcbiAgICAgICAgZm9yICh2YXIgbiA9IDA7IG4gPCBvLmxlbmd0aDsgbisrKSB7XHJcbiAgICAgICAgICAgIHRoaXMudWlSZW1vdmVTY2VuZSgkdUlQYXJhbS5MYXllclR5cGUuVUksIG9bbl0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYSA9IHRoaXMudWlDYWNoZS5nZXRDYWNoZVZpZXcodCk7XHJcbiAgICAgICAgJHJlc1V0aWwuUmVzVXRpbC5nZXRSZXNLZWVwZXIoYSwgITApO1xyXG4gICAgICAgIHZhciBjID0ge1xyXG4gICAgICAgICAgICB1dWlkOiBhLnV1aWQsXHJcbiAgICAgICAgICAgIHZpZXdQYXRoOiB0LFxyXG4gICAgICAgICAgICBwYXJhbTogZSxcclxuICAgICAgICAgICAgcm9vTm9kZTogdGhpcy5sYXllclVJXHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdSA9IGEuZ2V0Q29tcG9uZW50KCR1SVZpZXcuVUlWaWV3KTtcclxuICAgICAgICB1XHJcbiAgICAgICAgICAgID8gKCh1LnVpUGFyYW0gPSBjKSwgdGhpcy51aUFkZFNjZW5lKCR1SVBhcmFtLkxheWVyVHlwZS5VSSwgdSksIHRoaXMubGF5ZXJVSS5hZGRDaGlsZCh1Lm5vZGUpKVxyXG4gICAgICAgICAgICA6IGNvbnNvbGUuZXJyb3IoXCLlvZPliY1VSeS4jeWtmOWcqO+8jOaIluiAheayoeaciee7keWumuiEmuacrFwiKTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5sb2RpbmdWaWV3ID0gZnVuY3Rpb24gKHQsIGUsIGksIG8pIHtcclxuICAgICAgICB2YXIgbiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gbykge1xyXG4gICAgICAgICAgICBvID0gITA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzID0gITE7XHJcbiAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5yZXNNYW5hZ2VyLmlzQnVuZGxlTG9hZGVkKHRbcl0pKSB7XHJcbiAgICAgICAgICAgICAgICBzID0gITA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXRoaXMucmVzTWFuYWdlci5oYXNCdW5kbGVMb2FkZWRBc3NldHModFtyXSkpIHtcclxuICAgICAgICAgICAgICAgIHMgPSAhMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMudWlDYWNoZS5nZXRCYXNlVUkoJHVJUGFyYW0uTGF5ZXJUeXBlLkxPQURJTkcpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJMb2luZ1ZpZXcgPSBhO1xyXG4gICAgICAgICAgICB0aGlzLnVpQWRkU2NlbmUoJHVJUGFyYW0uTGF5ZXJUeXBlLkxPQURJTkcsIGEpO1xyXG4gICAgICAgICAgICBhLm5vZGUucGFyZW50ID0gdGhpcy5sYXllckxvYWRpbmdWaWV3O1xyXG4gICAgICAgICAgICB0aGlzLnJlc01hbmFnZXIubG9hZEJ1bmRsZXMoXHJcbiAgICAgICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBhLnNldFByb2dyZXNzKHQpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdCA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgIGEuc2V0UHJvZ3Jlc3MoMCwgITApO1xyXG4gICAgICAgICAgICAgICAgICAgIGEucmVnaXN0ZXJDQihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKGkgJiYgaSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvICYmICgobi5jdXJyTG9pbmdWaWV3ID0gbnVsbCksIG4udWlSZW1vdmVTY2VuZSgkdUlQYXJhbS5MYXllclR5cGUuTE9BRElORywgYSkpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAodCA9ICEwKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBuKTtcclxuICAgICAgICAgICAgICAgICAgICBuLnJlc01hbmFnZXIubG9hZEFycmF5KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5zZXRQcm9ncmVzcyh0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKGkgJiYgaSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbyAmJiAoKG4uY3VyckxvaW5nVmlldyA9IG51bGwpLCBuLnVpUmVtb3ZlU2NlbmUoJHVJUGFyYW0uTGF5ZXJUeXBlLkxPQURJTkcsIGEpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICh0ID0gITApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoaSkge1xyXG4gICAgICAgICAgICAgICAgaSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLnJlbW92ZUxvYWRpbmdWaWV3ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJMb2luZ1ZpZXcpIHtcclxuICAgICAgICAgICAgdGhpcy51aVJlbW92ZVNjZW5lKCR1SVBhcmFtLkxheWVyVHlwZS5MT0FESU5HLCB0aGlzLmN1cnJMb2luZ1ZpZXcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5zaG93VG9hc3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzLnVpQ2FjaGUuZ2V0QmFzZVVJKCR1SVBhcmFtLkxheWVyVHlwZS5UT0FTVCk7XHJcbiAgICAgICAgdmFyIGUgPSB7XHJcbiAgICAgICAgICAgIHV1aWQ6IHQubm9kZS51dWlkLFxyXG4gICAgICAgICAgICB2aWV3UGF0aDogXCJcIixcclxuICAgICAgICAgICAgcGFyYW06IHtcclxuICAgICAgICAgICAgICAgIG1zZzogYXJndW1lbnRzWzBdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiBhcmd1bWVudHNbMV0gfHwgMSxcclxuICAgICAgICAgICAgICAgIHBvczogYXJndW1lbnRzWzJdIHx8IGNjLnYyKDAsIDIwMClcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcm9vTm9kZTogdGhpcy5sYXllclRvYXN0XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0LnVpUGFyYW0gPSBlO1xyXG4gICAgICAgIHRoaXMudWlBZGRTY2VuZSgkdUlQYXJhbS5MYXllclR5cGUuVE9BU1QsIHQpO1xyXG4gICAgICAgIHQubm9kZS5wYXJlbnQgPSB0aGlzLmxheWVyVG9hc3Q7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUuaGlkZVRvYXN0ID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLnVpUmVtb3ZlU2NlbmUoJHVJUGFyYW0uTGF5ZXJUeXBlLlRPQVNULCB0KTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS51aUFkZFNjZW5lID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICBlLm5vZGUuYWN0aXZlID0gITA7XHJcbiAgICAgICAgdGhpcy51aUNhY2hlLnB1dEN1cnJWaWV3KHQsIGUpO1xyXG4gICAgICAgIGUuaW5uZXJBZGRUb1NjcmVlbigpO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLnVpUmVtb3ZlU2NlbmUgPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIGUuaW5uZXJSZW1vdmVUb1NjcmVlbigpO1xyXG4gICAgICAgIGlmICh0aGlzLnVpQ2FjaGUucmVtb3ZlQ3VyclZpZXcodCwgZSkpIHtcclxuICAgICAgICAgICAgZS5ub2RlLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgICAgICBlLm5vZGUucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5iYXNlVUlUeXBlLmluY2x1ZGVzKGUudWlUeXBlKVxyXG4gICAgICAgICAgICAgICAgPyB0aGlzLnVpQ2FjaGUuY2FjaGVCYXNlVUkodCwgZSlcclxuICAgICAgICAgICAgICAgIDogdGhpcy51aUNhY2hlLmNhY2hlVmlldyhlLnVpUGFyYW0udmlld1BhdGgsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5jcmVhdGVMYXllciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmxheWVyVUkgPSB0aGlzLnJvb3RWaWV3LmdldENoaWxkQnlOYW1lKFwibGF5ZXJfdWlcIik7XHJcbiAgICAgICAgaWYgKCFjYy5pc1ZhbGlkKHRoaXMubGF5ZXJVSSkpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXllclVJID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMYXllcihcImxheWVyX3VpXCIsICR1SVBhcmFtLkxheWVyVHlwZS5VSSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGF5ZXJQb3AgPSB0aGlzLnJvb3RWaWV3LmdldENoaWxkQnlOYW1lKFwibGF5ZXJfcG9wXCIpO1xyXG4gICAgICAgIGlmICghY2MuaXNWYWxpZCh0aGlzLmxheWVyUG9wKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxheWVyUG9wID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMYXllcihcImxheWVyX3BvcFwiLCAkdUlQYXJhbS5MYXllclR5cGUuUE9QVVApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxheWVyTG9hZGluZ1ZpZXcgPSB0aGlzLnJvb3RWaWV3LmdldENoaWxkQnlOYW1lKFwibG9hZGluZ192aWV3XCIpO1xyXG4gICAgICAgIGlmICghY2MuaXNWYWxpZCh0aGlzLmxheWVyTG9hZGluZ1ZpZXcpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGF5ZXJMb2FkaW5nVmlldyA9IHRoaXMuZ2VuZXJhdGVEZWZhdWx0TGF5ZXIoXCJsb2FkaW5nX3ZpZXdcIiwgJHVJUGFyYW0uTGF5ZXJUeXBlLkxPQURJTkcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxheWVyQ29uZmlybSA9IHRoaXMucm9vdFZpZXcuZ2V0Q2hpbGRCeU5hbWUoXCJsYXllcl9jb25maXJtXCIpO1xyXG4gICAgICAgIGlmICghY2MuaXNWYWxpZCh0aGlzLmxheWVyQ29uZmlybSkpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXllckNvbmZpcm0gPSB0aGlzLmdlbmVyYXRlRGVmYXVsdExheWVyKFwibGF5ZXJfY29uZmlybVwiLCAkdUlQYXJhbS5MYXllclR5cGUuRElBTE9HKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5sYXllcldhaXRkaW5nID0gdGhpcy5yb290Vmlldy5nZXRDaGlsZEJ5TmFtZShcImxheWVyX3dhaXRpbmdcIik7XHJcbiAgICAgICAgaWYgKCFjYy5pc1ZhbGlkKHRoaXMubGF5ZXJXYWl0ZGluZykpIHtcclxuICAgICAgICAgICAgdGhpcy5sYXllcldhaXRkaW5nID0gdGhpcy5nZW5lcmF0ZURlZmF1bHRMYXllcihcImxheWVyX3dhaXRpbmdcIiwgJHVJUGFyYW0uTGF5ZXJUeXBlLldBSVRJTkcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxheWVyVG9hc3QgPSB0aGlzLnJvb3RWaWV3LmdldENoaWxkQnlOYW1lKFwibGF5ZXJUb2FzdFwiKTtcclxuICAgICAgICBpZiAoIWNjLmlzVmFsaWQodGhpcy5sYXllclRvYXN0KSkge1xyXG4gICAgICAgICAgICB0aGlzLmxheWVyVG9hc3QgPSB0aGlzLmdlbmVyYXRlRGVmYXVsdExheWVyKFwibGF5ZXJUb2FzdFwiLCAkdUlQYXJhbS5MYXllclR5cGUuVE9BU1QpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5nZW5lcmF0ZURlZmF1bHRMYXllciA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdmFyIGkgPSBuZXcgY2MuTm9kZSgpO1xyXG4gICAgICAgIHZhciBvID0gaS5hZGRDb21wb25lbnQoY2MuV2lkZ2V0KTtcclxuICAgICAgICBvLmlzQWxpZ25MZWZ0ID0gby5pc0FsaWduUmlnaHQgPSBvLmlzQWxpZ25Ub3AgPSBvLmlzQWxpZ25Cb3R0b20gPSAhMDtcclxuICAgICAgICBvLmxlZnQgPSBvLnJpZ2h0ID0gby50b3AgPSBvLmJvdHRvbSA9IDA7XHJcbiAgICAgICAgby5hbGlnbk1vZGUgPSBjYy5XaWRnZXQuQWxpZ25Nb2RlLkFMV0FZUztcclxuICAgICAgICBvLmVuYWJsZWQgPSAhMDtcclxuICAgICAgICBpLnNldFNpYmxpbmdJbmRleChlKTtcclxuICAgICAgICBpLm5hbWUgPSB0O1xyXG4gICAgICAgIHRoaXMucm9vdFZpZXcuYWRkQ2hpbGQoaSk7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUuZ2V0TGF5ZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHJldHVybiB0ID09PSAkdUlQYXJhbS5MYXllclR5cGUuVUlcclxuICAgICAgICAgICAgPyB0aGlzLmxheWVyVUlcclxuICAgICAgICAgICAgOiB0ID09PSAkdUlQYXJhbS5MYXllclR5cGUuTE9BRElOR1xyXG4gICAgICAgICAgICA/IHRoaXMubGF5ZXJMb2FkaW5nVmlld1xyXG4gICAgICAgICAgICA6IHQgPT09ICR1SVBhcmFtLkxheWVyVHlwZS5QT1BVUFxyXG4gICAgICAgICAgICA/IHRoaXMubGF5ZXJQb3BcclxuICAgICAgICAgICAgOiB0ID09PSAkdUlQYXJhbS5MYXllclR5cGUuV0FJVElOR1xyXG4gICAgICAgICAgICA/IHRoaXMubGF5ZXJXYWl0ZGluZ1xyXG4gICAgICAgICAgICA6IHQgPT09ICR1SVBhcmFtLkxheWVyVHlwZS5ESUFMT0dcclxuICAgICAgICAgICAgPyB0aGlzLmxheWVyQ29uZmlybVxyXG4gICAgICAgICAgICA6IHQgPT09ICR1SVBhcmFtLkxheWVyVHlwZS5UT0FTVFxyXG4gICAgICAgICAgICA/IHRoaXMubGF5ZXJUb2FzdFxyXG4gICAgICAgICAgICA6IHZvaWQgMDtcclxuICAgIH07XHJcbiAgICB0Lmluc3RhbmNlID0gbmV3IHQoKTtcclxuICAgIHJldHVybiB0O1xyXG59KSgpO1xyXG5leHBvcnRzLlVJTWFuYWdlciA9IGM7XHJcbiJdfQ==