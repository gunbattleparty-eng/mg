
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Player.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '72eeeuRLqNLwoN7G3zS17D8', 'Player');
// game_script/scripts/Player.js

"use strict";

var o;

var $eventManager = require("./EventManager");

var $componentProxy = require("./ComponentProxy");

var $remoteAudio = require("./RemoteAudio");

var $util = require("./Util");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $roleContext = require("./RoleContext");

var $playerSkin = require("./PlayerSkin");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $gun_1 = require("./Gun_1");

var g = cc._decorator;
var _ = g.ccclass;
var k = g.property;

var v = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.skin = null;
    e.skin2 = null;
    e.robotSkin = null;
    e.gun = null;
    e.cd = 0.5;
    e.residuCD = 0;
    e.isChangeBullet = !1;
    e.skilling = !1;
    e.angleBack = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {
    this.gun = this.node.getComponent($gun_1["default"]);
  };

  e.prototype.start = function () {
    $componentProxy["default"].Ins.pushObj(this);
    $eventManager["default"].on($localEventName["default"].CHANGE_RELOAD_ANIM, this.changeReloadAnim, this);
    $eventManager["default"].on($localEventName["default"].SEND_SKILL_ANIM, this.playSkillAnim, this);
    var t = $roleContext["default"].ins.currSkinInfo;
    this.skin.armatureName = "juese" + t.skin + "_1";
    this.skin2.armatureName = "juese" + t.skin + "_2";
    this.robotSkin.armatureName = "jqr" + t.robot;
    this.node.getComponent($playerSkin.PlayerSkin).checkGun(t.gun);
  };

  e.prototype.onDestroy = function () {
    $componentProxy["default"].Ins.removeObj(this);
    $eventManager["default"].off($localEventName["default"].CHANGE_RELOAD_ANIM, this.changeReloadAnim, this);
    $eventManager["default"].off($localEventName["default"].SEND_SKILL_ANIM, this.playSkillAnim, this);
  };

  e.prototype.changeReloadAnim = function (t) {
    if (t) {
      this.isChangeBullet = !0;
      $remoteAudio["default"].instance.playEffectMusic("gunexchange");
      return void (this.skilling || this.skin.playAnimation("huandan", 0));
    }

    if (!this.skilling) {
      this.skin.playAnimation("stand", 0);
    }

    this.isChangeBullet = !1;
  };

  e.prototype.playSkillAnim = function () {
    var t = this;
    this.skilling = !0;
    this.angleBack = this.node.angle;
    this.node.angle = 90;
    this.skin.off(dragonBones.EventObject.COMPLETE);
    this.skin.playAnimation("skill", 1);
    this.skin.once(dragonBones.EventObject.COMPLETE, function () {
      t.skilling = !1;
      t.isChangeBullet ? t.skin.playAnimation("huandan", 0) : (t.node.angle = t.angleBack, t.skin.playAnimation("stand", 0));
    });
  };

  e.prototype.updateFrame = function (t) {
    this.gun.updateF(t);

    if (!this.gun.isAttacking) {
      this.residuCD -= t;

      if (this.residuCD <= 0) {
        this.residuCD = this.cd;
        this.startGun();
      }
    }
  };

  e.prototype.update = function () {
    this.proccessSpeed();
  };

  e.prototype.proccessSpeed = function () {
    $globalParam["default"].isGamePuase ? 0 !== this.skin.timeScale && (this.skin.timeScale = 0) : this.skin.timeScale !== $gameContext["default"].ins.gameRatio && (this.skin.timeScale = $gameContext["default"].ins.gameRatio);
  };

  e.prototype.startGun = function () {
    var t = this;

    if (!this.isChangeBullet && !this.skilling) {
      if (!this.skillParam) {
        this.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(1);
      }

      var e = $gameContext["default"].ins.getRangeRankEnemy(this.node, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);

      if (e) {
        $remoteAudio["default"].instance.playEffectMusic("gun");

        if (!this.skilling) {
          this.skin.playAnimation("sheji", 1);
          this.skin.once(dragonBones.EventObject.COMPLETE, function () {
            t.skin.playAnimation("stand", 0);
          }, this);
        }

        var i = e.node.position.subtract(this.node.position).normalize();
        this.gun.sendButtle(i);
        var o = $util["default"].dirConverAngle(i);
        this.node.angle = o;
      }
    }
  };

  __decorate([k(dragonBones.ArmatureDisplay)], e.prototype, "skin", void 0);

  __decorate([k(dragonBones.ArmatureDisplay)], e.prototype, "skin2", void 0);

  __decorate([k(dragonBones.ArmatureDisplay)], e.prototype, "robotSkin", void 0);

  return __decorate([_], e);
}(cc.Component);

exports["default"] = v;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFBsYXllci5qcyJdLCJuYW1lcyI6WyJvIiwiJGV2ZW50TWFuYWdlciIsInJlcXVpcmUiLCIkY29tcG9uZW50UHJveHkiLCIkcmVtb3RlQXVkaW8iLCIkdXRpbCIsIiRnbG9iYWxQYXJhbSIsIiRsb2NhbEV2ZW50TmFtZSIsIiRyb2xlQ29udGV4dCIsIiRwbGF5ZXJTa2luIiwiJGdhbWVDb250ZXh0IiwiJGdhbWVTa2lsbEluZm8iLCIkZ3VuXzEiLCJnIiwiY2MiLCJfZGVjb3JhdG9yIiwiXyIsImNjY2xhc3MiLCJrIiwicHJvcGVydHkiLCJ2IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInNraW4iLCJza2luMiIsInJvYm90U2tpbiIsImd1biIsImNkIiwicmVzaWR1Q0QiLCJpc0NoYW5nZUJ1bGxldCIsInNraWxsaW5nIiwiYW5nbGVCYWNrIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwibm9kZSIsImdldENvbXBvbmVudCIsInN0YXJ0IiwiSW5zIiwicHVzaE9iaiIsIm9uIiwiQ0hBTkdFX1JFTE9BRF9BTklNIiwiY2hhbmdlUmVsb2FkQW5pbSIsIlNFTkRfU0tJTExfQU5JTSIsInBsYXlTa2lsbEFuaW0iLCJpbnMiLCJjdXJyU2tpbkluZm8iLCJhcm1hdHVyZU5hbWUiLCJyb2JvdCIsIlBsYXllclNraW4iLCJjaGVja0d1biIsIm9uRGVzdHJveSIsInJlbW92ZU9iaiIsIm9mZiIsImluc3RhbmNlIiwicGxheUVmZmVjdE11c2ljIiwicGxheUFuaW1hdGlvbiIsImFuZ2xlIiwiZHJhZ29uQm9uZXMiLCJFdmVudE9iamVjdCIsIkNPTVBMRVRFIiwib25jZSIsInVwZGF0ZUZyYW1lIiwidXBkYXRlRiIsImlzQXR0YWNraW5nIiwic3RhcnRHdW4iLCJ1cGRhdGUiLCJwcm9jY2Vzc1NwZWVkIiwiaXNHYW1lUHVhc2UiLCJ0aW1lU2NhbGUiLCJnYW1lUmF0aW8iLCJza2lsbFBhcmFtIiwic2tpbGxJbmZvIiwiZ2V0U2tpbGxCeUlkIiwiZ2V0UmFuZ2VSYW5rRW5lbXkiLCJza2lsbEF0a1JhbmdlIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsImkiLCJwb3NpdGlvbiIsInN1YnRyYWN0Iiwibm9ybWFsaXplIiwic2VuZEJ1dHRsZSIsImRpckNvbnZlckFuZ2xlIiwiX19kZWNvcmF0ZSIsIkFybWF0dXJlRGlzcGxheSIsIkNvbXBvbmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJQyxlQUFlLEdBQUdELE9BQU8sQ0FBQyxrQkFBRCxDQUE3Qjs7QUFDQSxJQUFJRSxZQUFZLEdBQUdGLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlHLEtBQUssR0FBR0gsT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSUksWUFBWSxHQUFHSixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJSyxlQUFlLEdBQUdMLE9BQU8sQ0FBQyxrQkFBRCxDQUE3Qjs7QUFDQSxJQUFJTSxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlPLFdBQVcsR0FBR1AsT0FBTyxDQUFDLGNBQUQsQ0FBekI7O0FBQ0EsSUFBSVEsWUFBWSxHQUFHUixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJUyxjQUFjLEdBQUdULE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJVSxNQUFNLEdBQUdWLE9BQU8sQ0FBQyxTQUFELENBQXBCOztBQUNBLElBQUlXLENBQUMsR0FBR0MsRUFBRSxDQUFDQyxVQUFYO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHSCxDQUFDLENBQUNJLE9BQVY7QUFDQSxJQUFJQyxDQUFDLEdBQUdMLENBQUMsQ0FBQ00sUUFBVjs7QUFDQSxJQUFJQyxDQUFDLEdBQUksVUFBVUMsQ0FBVixFQUFhO0VBQ2xC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RixDQUFELEVBQW1DakUsQ0FBQyxDQUFDYSxTQUFyQyxFQUFnRCxPQUFoRCxFQUF5RCxLQUFLLENBQTlELENBQVY7O0VBQ0FtRCxVQUFVLENBQUMsQ0FBQ3BFLENBQUMsQ0FBQzBDLFdBQVcsQ0FBQzJCLGVBQWIsQ0FBRixDQUFELEVBQW1DakUsQ0FBQyxDQUFDYSxTQUFyQyxFQUFnRCxXQUFoRCxFQUE2RCxLQUFLLENBQWxFLENBQVY7O0VBQ0EsT0FBT21ELFVBQVUsQ0FBQyxDQUFDdEUsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBakI7QUFDSCxDQTlHTyxDQThHTFIsRUFBRSxDQUFDMEUsU0E5R0UsQ0FBUjs7QUErR0FDLE9BQU8sV0FBUCxHQUFrQnJFLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRldmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9FdmVudE1hbmFnZXJcIik7XHJcbnZhciAkY29tcG9uZW50UHJveHkgPSByZXF1aXJlKFwiLi9Db21wb25lbnRQcm94eVwiKTtcclxudmFyICRyZW1vdGVBdWRpbyA9IHJlcXVpcmUoXCIuL1JlbW90ZUF1ZGlvXCIpO1xyXG52YXIgJHV0aWwgPSByZXF1aXJlKFwiLi9VdGlsXCIpO1xyXG52YXIgJGdsb2JhbFBhcmFtID0gcmVxdWlyZShcIi4vR2xvYmFsUGFyYW1cIik7XHJcbnZhciAkbG9jYWxFdmVudE5hbWUgPSByZXF1aXJlKFwiLi9Mb2NhbEV2ZW50TmFtZVwiKTtcclxudmFyICRyb2xlQ29udGV4dCA9IHJlcXVpcmUoXCIuL1JvbGVDb250ZXh0XCIpO1xyXG52YXIgJHBsYXllclNraW4gPSByZXF1aXJlKFwiLi9QbGF5ZXJTa2luXCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZ2FtZVNraWxsSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVTa2lsbEluZm9cIik7XHJcbnZhciAkZ3VuXzEgPSByZXF1aXJlKFwiLi9HdW5fMVwiKTtcclxudmFyIGcgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgXyA9IGcuY2NjbGFzcztcclxudmFyIGsgPSBnLnByb3BlcnR5O1xyXG52YXIgdiA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLnNraW4gPSBudWxsO1xyXG4gICAgICAgIGUuc2tpbjIgPSBudWxsO1xyXG4gICAgICAgIGUucm9ib3RTa2luID0gbnVsbDtcclxuICAgICAgICBlLmd1biA9IG51bGw7XHJcbiAgICAgICAgZS5jZCA9IDAuNTtcclxuICAgICAgICBlLnJlc2lkdUNEID0gMDtcclxuICAgICAgICBlLmlzQ2hhbmdlQnVsbGV0ID0gITE7XHJcbiAgICAgICAgZS5za2lsbGluZyA9ICExO1xyXG4gICAgICAgIGUuYW5nbGVCYWNrID0gMDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLm9uTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmd1biA9IHRoaXMubm9kZS5nZXRDb21wb25lbnQoJGd1bl8xLmRlZmF1bHQpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICRjb21wb25lbnRQcm94eS5kZWZhdWx0Lklucy5wdXNoT2JqKHRoaXMpO1xyXG4gICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5vbigkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5DSEFOR0VfUkVMT0FEX0FOSU0sIHRoaXMuY2hhbmdlUmVsb2FkQW5pbSwgdGhpcyk7XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0Lm9uKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlNFTkRfU0tJTExfQU5JTSwgdGhpcy5wbGF5U2tpbGxBbmltLCB0aGlzKTtcclxuICAgICAgICB2YXIgdCA9ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm87XHJcbiAgICAgICAgdGhpcy5za2luLmFybWF0dXJlTmFtZSA9IFwianVlc2VcIiArIHQuc2tpbiArIFwiXzFcIjtcclxuICAgICAgICB0aGlzLnNraW4yLmFybWF0dXJlTmFtZSA9IFwianVlc2VcIiArIHQuc2tpbiArIFwiXzJcIjtcclxuICAgICAgICB0aGlzLnJvYm90U2tpbi5hcm1hdHVyZU5hbWUgPSBcImpxclwiICsgdC5yb2JvdDtcclxuICAgICAgICB0aGlzLm5vZGUuZ2V0Q29tcG9uZW50KCRwbGF5ZXJTa2luLlBsYXllclNraW4pLmNoZWNrR3VuKHQuZ3VuKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJGNvbXBvbmVudFByb3h5LmRlZmF1bHQuSW5zLnJlbW92ZU9iaih0aGlzKTtcclxuICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQub2ZmKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LkNIQU5HRV9SRUxPQURfQU5JTSwgdGhpcy5jaGFuZ2VSZWxvYWRBbmltLCB0aGlzKTtcclxuICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQub2ZmKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlNFTkRfU0tJTExfQU5JTSwgdGhpcy5wbGF5U2tpbGxBbmltLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jaGFuZ2VSZWxvYWRBbmltID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICB0aGlzLmlzQ2hhbmdlQnVsbGV0ID0gITA7XHJcbiAgICAgICAgICAgICRyZW1vdGVBdWRpby5kZWZhdWx0Lmluc3RhbmNlLnBsYXlFZmZlY3RNdXNpYyhcImd1bmV4Y2hhbmdlXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gdm9pZCAodGhpcy5za2lsbGluZyB8fCB0aGlzLnNraW4ucGxheUFuaW1hdGlvbihcImh1YW5kYW5cIiwgMCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuc2tpbGxpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5za2luLnBsYXlBbmltYXRpb24oXCJzdGFuZFwiLCAwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0NoYW5nZUJ1bGxldCA9ICExO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnBsYXlTa2lsbEFuaW0gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2tpbGxpbmcgPSAhMDtcclxuICAgICAgICB0aGlzLmFuZ2xlQmFjayA9IHRoaXMubm9kZS5hbmdsZTtcclxuICAgICAgICB0aGlzLm5vZGUuYW5nbGUgPSA5MDtcclxuICAgICAgICB0aGlzLnNraW4ub2ZmKGRyYWdvbkJvbmVzLkV2ZW50T2JqZWN0LkNPTVBMRVRFKTtcclxuICAgICAgICB0aGlzLnNraW4ucGxheUFuaW1hdGlvbihcInNraWxsXCIsIDEpO1xyXG4gICAgICAgIHRoaXMuc2tpbi5vbmNlKGRyYWdvbkJvbmVzLkV2ZW50T2JqZWN0LkNPTVBMRVRFLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHQuc2tpbGxpbmcgPSAhMTtcclxuICAgICAgICAgICAgdC5pc0NoYW5nZUJ1bGxldFxyXG4gICAgICAgICAgICAgICAgPyB0LnNraW4ucGxheUFuaW1hdGlvbihcImh1YW5kYW5cIiwgMClcclxuICAgICAgICAgICAgICAgIDogKCh0Lm5vZGUuYW5nbGUgPSB0LmFuZ2xlQmFjayksIHQuc2tpbi5wbGF5QW5pbWF0aW9uKFwic3RhbmRcIiwgMCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnVwZGF0ZUZyYW1lID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmd1bi51cGRhdGVGKHQpO1xyXG4gICAgICAgIGlmICghdGhpcy5ndW4uaXNBdHRhY2tpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNpZHVDRCAtPSB0O1xyXG4gICAgICAgICAgICBpZiAodGhpcy5yZXNpZHVDRCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2lkdUNEID0gdGhpcy5jZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRHdW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5wcm9jY2Vzc1NwZWVkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucHJvY2Nlc3NTcGVlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZVxyXG4gICAgICAgICAgICA/IDAgIT09IHRoaXMuc2tpbi50aW1lU2NhbGUgJiYgKHRoaXMuc2tpbi50aW1lU2NhbGUgPSAwKVxyXG4gICAgICAgICAgICA6IHRoaXMuc2tpbi50aW1lU2NhbGUgIT09ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nYW1lUmF0aW8gJiZcclxuICAgICAgICAgICAgICAodGhpcy5za2luLnRpbWVTY2FsZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nYW1lUmF0aW8pO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJ0R3VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICBpZiAoIXRoaXMuaXNDaGFuZ2VCdWxsZXQgJiYgIXRoaXMuc2tpbGxpbmcpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNraWxsUGFyYW0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uZ2V0U2tpbGxCeUlkKDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBlID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldFJhbmdlUmFua0VuZW15KFxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrUmFuZ2VbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmIChlKSB7XHJcbiAgICAgICAgICAgICAgICAkcmVtb3RlQXVkaW8uZGVmYXVsdC5pbnN0YW5jZS5wbGF5RWZmZWN0TXVzaWMoXCJndW5cIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2tpbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNraW4ucGxheUFuaW1hdGlvbihcInNoZWppXCIsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbi5vbmNlKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkcmFnb25Cb25lcy5FdmVudE9iamVjdC5DT01QTEVURSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5za2luLnBsYXlBbmltYXRpb24oXCJzdGFuZFwiLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IGUubm9kZS5wb3NpdGlvbi5zdWJ0cmFjdCh0aGlzLm5vZGUucG9zaXRpb24pLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ndW4uc2VuZEJ1dHRsZShpKTtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gJHV0aWwuZGVmYXVsdC5kaXJDb252ZXJBbmdsZShpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5hbmdsZSA9IG87XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbayhkcmFnb25Cb25lcy5Bcm1hdHVyZURpc3BsYXkpXSwgZS5wcm90b3R5cGUsIFwic2tpblwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhkcmFnb25Cb25lcy5Bcm1hdHVyZURpc3BsYXkpXSwgZS5wcm90b3R5cGUsIFwic2tpbjJcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soZHJhZ29uQm9uZXMuQXJtYXR1cmVEaXNwbGF5KV0sIGUucHJvdG90eXBlLCBcInJvYm90U2tpblwiLCB2b2lkIDApO1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW19dLCBlKTtcclxufSkoY2MuQ29tcG9uZW50KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gdjtcclxuIl19