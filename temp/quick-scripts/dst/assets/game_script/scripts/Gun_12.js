
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_12.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '043acmKB09B4KkVyK/o/A3Y', 'Gun_12');
// game_script/scripts/Gun_12.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $seedUtil = require("./SeedUtil");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var g = function (t) {
  function e(e) {
    var i = t.call(this, e) || this;
    i.skillId = 153;
    i.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(i.skillId);
    return i;
  }

  __extends(e, t);

  e.prototype.updateF = function (e) {
    t.prototype.updateF.call(this, e);

    if (!$globalParam["default"].isGamePuase) {
      this.timeLeft -= e;
      this.timeLeft <= 0 ? (this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0), this.startGun() ? (this.releaseing = !0, this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 1)) : this.timeLeft = 0) : $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1);
    }
  };

  e.prototype.startGun = function () {
    var t = this.skillParam.releaseCount;

    if ($seedUtil["default"].probability(this.skillParam.releaseProbability)) {
      t += 1;
    }

    var e = $gameContext["default"].ins.getRandomEnemys(this.pointNode, t, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);

    if (e.length <= 0) {
      return !1;
    }

    var i = Math.min(e.length, t);

    for (var o = 0; o < i; o++) {
      this.createBullet(e[o]);
    }

    return !0;
  };

  e.prototype.createBullet = function (t) {
    if (t && $util["default"].isValid(t.node)) {
      var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thunder_chain);

      if (!e) {
        var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_31);
        (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
      }

      e.setPosition(this.pointNode.position);
      e.initBullet31(t, this.skillId);
      e.initButtle(null, this.skillId);
      e.insert($gameContext["default"].ins.lowBulletLayer);
    }
  };

  return e;
}(require("./BaseGun")["default"]);

exports["default"] = g;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl8xMi5qcyJdLCJuYW1lcyI6WyJvIiwiJGFzc2V0c0xvYWRlciIsInJlcXVpcmUiLCIkYXNzZXRzTWFwIiwiJHJlc1V0aWwiLCIkZXZlbnRNYW5hZ2VyIiwiJHNlZWRVdGlsIiwiJHV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRnbG9iYWxQYXJhbSIsIiRsb2NhbEV2ZW50TmFtZSIsIiRiYXNlQnVsbGV0IiwiJGdhbWVDb250ZXh0IiwiJGdhbWVTa2lsbEluZm8iLCJnIiwidCIsImUiLCJpIiwiY2FsbCIsInNraWxsSWQiLCJza2lsbFBhcmFtIiwiaW5zIiwic2tpbGxJbmZvIiwiZ2V0U2tpbGxCeUlkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwidXBkYXRlRiIsImlzR2FtZVB1YXNlIiwidGltZUxlZnQiLCJza2lsbENEIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsInNlbmQiLCJSRU5ERVJfU0tJTExfQ0RfSU5GTyIsInN0YXJ0R3VuIiwicmVsZWFzZWluZyIsInJlbGVhc2VDb3VudCIsInByb2JhYmlsaXR5IiwicmVsZWFzZVByb2JhYmlsaXR5IiwiZ2V0UmFuZG9tRW5lbXlzIiwicG9pbnROb2RlIiwic2tpbGxBdGtSYW5nZSIsImxlbmd0aCIsIk1hdGgiLCJtaW4iLCJjcmVhdGVCdWxsZXQiLCJpc1ZhbGlkIiwibm9kZSIsImdldEJ1dHRsZVBvb2wiLCJCdWxsZXRUeXBlIiwidGh1bmRlcl9jaGFpbiIsImluc3RhbmNlIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkJ1bGxldF8zMSIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImxvd0J1bGxldExheWVyIiwicGFyZW50IiwiZ2V0Q29tcG9uZW50Iiwic2tpbGxTcGVjaWFsaXR5cyIsImJhc2ljU2tpbGxDb25maWdNYXAiLCJnZXQiLCJza2lsbF90cHllIiwic2V0UG9zaXRpb24iLCJwb3NpdGlvbiIsImluaXRCdWxsZXQzMSIsImluaXRCdXR0bGUiLCJpbnNlcnQiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlHLGFBQWEsR0FBR0gsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlJLFNBQVMsR0FBR0osT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSUssS0FBSyxHQUFHTCxPQUFPLENBQUMsUUFBRCxDQUFuQjs7QUFDQSxJQUFJTSxjQUFjLEdBQUdOLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJTyxZQUFZLEdBQUdQLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlRLGVBQWUsR0FBR1IsT0FBTyxDQUFDLGtCQUFELENBQTdCOztBQUNBLElBQUlTLFdBQVcsR0FBR1QsT0FBTyxDQUFDLGNBQUQsQ0FBekI7O0FBQ0EsSUFBSVUsWUFBWSxHQUFHVixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJVyxjQUFjLEdBQUdYLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJWSxDQUFDLEdBQUksVUFBVUMsQ0FBVixFQUFhO0VBQ2xCLFNBQVNDLENBQVQsQ0FBV0EsQ0FBWCxFQUFjO0lBQ1YsSUFBSUMsQ0FBQyxHQUFHRixDQUFDLENBQUNHLElBQUYsQ0FBTyxJQUFQLEVBQWFGLENBQWIsS0FBbUIsSUFBM0I7SUFDQUMsQ0FBQyxDQUFDRSxPQUFGLEdBQVksR0FBWjtJQUNBRixDQUFDLENBQUNHLFVBQUYsR0FBZVIsWUFBWSxXQUFaLENBQXFCUyxHQUFyQixDQUF5QkMsU0FBekIsQ0FB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LENBQVAsV0FsRUssQ0FBUjs7QUFtRUF3RSxPQUFPLFdBQVAsR0FBa0I1RCxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkYXNzZXRzTG9hZGVyID0gcmVxdWlyZShcIi4vQXNzZXRzTG9hZGVyXCIpO1xyXG52YXIgJGFzc2V0c01hcCA9IHJlcXVpcmUoXCIuL0Fzc2V0c01hcFwiKTtcclxudmFyICRyZXNVdGlsID0gcmVxdWlyZShcIi4vUmVzVXRpbFwiKTtcclxudmFyICRldmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9FdmVudE1hbmFnZXJcIik7XHJcbnZhciAkc2VlZFV0aWwgPSByZXF1aXJlKFwiLi9TZWVkVXRpbFwiKTtcclxudmFyICR1dGlsID0gcmVxdWlyZShcIi4vVXRpbFwiKTtcclxudmFyICRjb25maWdDb250ZXh0ID0gcmVxdWlyZShcIi4vQ29uZmlnQ29udGV4dFwiKTtcclxudmFyICRnbG9iYWxQYXJhbSA9IHJlcXVpcmUoXCIuL0dsb2JhbFBhcmFtXCIpO1xyXG52YXIgJGxvY2FsRXZlbnROYW1lID0gcmVxdWlyZShcIi4vTG9jYWxFdmVudE5hbWVcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyIGcgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoZSkge1xyXG4gICAgICAgIHZhciBpID0gdC5jYWxsKHRoaXMsIGUpIHx8IHRoaXM7XHJcbiAgICAgICAgaS5za2lsbElkID0gMTUzO1xyXG4gICAgICAgIGkuc2tpbGxQYXJhbSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uZ2V0U2tpbGxCeUlkKGkuc2tpbGxJZCk7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS51cGRhdGVGLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKCEkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZSkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVMZWZ0IC09IGU7XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgPD0gMFxyXG4gICAgICAgICAgICAgICAgPyAoKHRoaXMudGltZUxlZnQgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF0pLFxyXG4gICAgICAgICAgICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZCgkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfU0tJTExfQ0RfSU5GTywgdGhpcy5za2lsbElkLCAwKSxcclxuICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydEd1bigpXHJcbiAgICAgICAgICAgICAgICAgICAgICA/ICgodGhpcy5yZWxlYXNlaW5nID0gITApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAodGhpcy50aW1lTGVmdCA9IHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLCB0aGlzLnNraWxsSWQsIDEpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgOiAodGhpcy50aW1lTGVmdCA9IDApKVxyXG4gICAgICAgICAgICAgICAgOiAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZChcclxuICAgICAgICAgICAgICAgICAgICAgICRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAvIHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSxcclxuICAgICAgICAgICAgICAgICAgICAgIC0xXHJcbiAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJ0R3VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcy5za2lsbFBhcmFtLnJlbGVhc2VDb3VudDtcclxuICAgICAgICBpZiAoJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkodGhpcy5za2lsbFBhcmFtLnJlbGVhc2VQcm9iYWJpbGl0eSkpIHtcclxuICAgICAgICAgICAgdCArPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSYW5kb21FbmVteXMoXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnROb2RlLFxyXG4gICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtSYW5nZVskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF1cclxuICAgICAgICApO1xyXG4gICAgICAgIGlmIChlLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGkgPSBNYXRoLm1pbihlLmxlbmd0aCwgdCk7XHJcbiAgICAgICAgZm9yICh2YXIgbyA9IDA7IG8gPCBpOyBvKyspIHtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVCdWxsZXQoZVtvXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAhMDtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jcmVhdGVCdWxsZXQgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIGlmICh0ICYmICR1dGlsLmRlZmF1bHQuaXNWYWxpZCh0Lm5vZGUpKSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS50aHVuZGVyX2NoYWluKTtcclxuICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9ICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5nZXRSZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfMzFcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAoZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICkpLnNraWxsU3BlY2lhbGl0eXMgPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmJhc2ljU2tpbGxDb25maWdNYXAuZ2V0KHRoaXMuc2tpbGxJZCkuc2tpbGxfdHB5ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlLnNldFBvc2l0aW9uKHRoaXMucG9pbnROb2RlLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgZS5pbml0QnVsbGV0MzEodCwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgZS5pbml0QnV0dGxlKG51bGwsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgIGUuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBlO1xyXG59KShyZXF1aXJlKFwiLi9CYXNlR3VuXCIpLmRlZmF1bHQpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBnO1xyXG4iXX0=