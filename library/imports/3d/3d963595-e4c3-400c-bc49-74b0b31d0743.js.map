{"version":3,"sources":["assets\\game_script\\scripts\\Bullet_12.js"],"names":["o","$gamePool","require","$util","$gameContext","$gameSkillInfo","$baseBullet","d","cc","_decorator","p","ccclass","f","property","h","Size","m","Vec3","y","t","e","apply","arguments","buttleType","BulletType","thunder_puncture","animPrefab","currAtkEnemyCount","currTargetPos","currTarget","targetIsExist","tailNode","__extends","prototype","initButtle","i","call","atk","skillParam","thunderPierceAtk","Skill4Param","FINAL","initBullet12","skillId","isUse","getPosition","length","updateFrame","isValid","node","parent","position","clone","velocity","x","z","setPosition","sub","magSqr","sufferAtk","id","skillSpecialitys","ins","getRangeRandomEnemyLayer","thunderPierceRange","getRangeRandomEnemyLayerByPos","thunderPierceCount","destoryBullet","n","instance","get","PoolKey","THUNDER_PUNCTURE_ANIMS","instantiate","buttleLayer","width","setContentSize","s","c","dirConverAngle","normalize","angle","speed","u","set","mulSelf","scheduleOnce","put","removeSelf","__decorate","Prefab","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $gamePool = require(\"./GamePool\");\r\nvar $util = require(\"./Util\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar d = cc._decorator;\r\nvar p = d.ccclass;\r\nvar f = d.property;\r\nvar h = new cc.Size(0, 20);\r\nvar m = new cc.Vec3();\r\nvar y = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.buttleType = $baseBullet.BulletType.thunder_puncture;\r\n        e.animPrefab = null;\r\n        e.currAtkEnemyCount = 0;\r\n        e.currTargetPos = null;\r\n        e.currTarget = null;\r\n        e.targetIsExist = !0;\r\n        e.tailNode = [];\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.initButtle = function (e, i) {\r\n        t.prototype.initButtle.call(this, e, i);\r\n        this.atk = this.skillParam.thunderPierceAtk[$gameSkillInfo.Skill4Param.FINAL];\r\n    };\r\n    e.prototype.initBullet12 = function (t, e) {\r\n        this.skillId = e;\r\n        this.isUse = !1;\r\n        this.currAtkEnemyCount = 0;\r\n        this.targetIsExist = !0;\r\n        this.currTarget = t;\r\n        this.currTargetPos = t.getPosition();\r\n        this.tailNode.length = 0;\r\n    };\r\n    e.prototype.updateFrame = function (t) {\r\n        if (!this.isUse) {\r\n            if (this.targetIsExist) {\r\n                if (!(cc.isValid(this.currTarget) && this.currTarget.node.parent)) {\r\n                    this.targetIsExist = !1;\r\n                    this.currTargetPos = this.node.position.clone();\r\n                }\r\n            }\r\n            var e = this.getPosition();\r\n            var i = this.velocity;\r\n            m.x = e.x + i.x * t;\r\n            m.y = e.y + i.y * t;\r\n            m.z = e.z + i.z * t;\r\n            this.setPosition(m);\r\n            if (this.node.position.sub(this.currTargetPos).magSqr() < 400) {\r\n                var o = null;\r\n                this.targetIsExist\r\n                    ? (this.currTarget.sufferAtk({\r\n                          id: 61,\r\n                          skillSpecialitys: this.skillSpecialitys,\r\n                          atk: this.atk\r\n                      }),\r\n                      (o = $gameContext.default.ins.getRangeRandomEnemyLayer(\r\n                          this.currTarget.node,\r\n                          this.skillParam.thunderPierceRange\r\n                      )))\r\n                    : (o = $gameContext.default.ins.getRangeRandomEnemyLayerByPos(\r\n                          this.currTargetPos,\r\n                          this.skillParam.thunderPierceRange\r\n                      ));\r\n                this.currAtkEnemyCount++;\r\n                if (!o || this.currAtkEnemyCount >= this.skillParam.thunderPierceCount) {\r\n                    return void this.destoryBullet();\r\n                }\r\n                this.targetIsExist = !0;\r\n                this.currTarget = o;\r\n                this.currTargetPos = o.getPosition();\r\n            }\r\n            if (this.tailNode.length < this.currAtkEnemyCount + 1) {\r\n                var n = $gamePool.default.instance.get($gamePool.PoolKey.THUNDER_PUNCTURE_ANIMS);\r\n                if (!cc.isValid(n)) {\r\n                    n = cc.instantiate(this.animPrefab);\r\n                }\r\n                n.parent = $gameContext.default.ins.buttleLayer;\r\n                n.position = this.getPosition().clone();\r\n                h.width = 0;\r\n                n.setContentSize(h);\r\n                this.tailNode[this.currAtkEnemyCount] = n;\r\n            }\r\n            var s = this.tailNode[this.currAtkEnemyCount];\r\n            var c = $util.default.dirConverAngle(this.node.position.sub(s.position).normalize());\r\n            s.angle = c;\r\n            h.width = s.width + this.speed * t;\r\n            s.setContentSize(h);\r\n            var u = this.currTargetPos.sub(this.node.position).normalize();\r\n            this.speed = 1200;\r\n            this.velocity.set(u).mulSelf(this.speed);\r\n        }\r\n    };\r\n    e.prototype.destoryBullet = function () {\r\n        var t = this;\r\n        this.isUse = !0;\r\n        this.scheduleOnce(function () {\r\n            for (var e = 0; e < t.tailNode.length; e++) {\r\n                $gamePool.default.instance.put($gamePool.PoolKey.THUNDER_PUNCTURE_ANIMS, t.tailNode[e]);\r\n            }\r\n            t.removeSelf();\r\n        }, 0.15);\r\n    };\r\n    __decorate([f(cc.Prefab)], e.prototype, \"animPrefab\", void 0);\r\n    return __decorate([p], e);\r\n})($baseBullet.default);\r\nexports.default = y;\r\n"]}