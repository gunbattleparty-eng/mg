
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_9.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '5fd6aD6gV5H3ISYG7K6B8Fl', 'Bullet_9');
// game_script/scripts/Bullet_9.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var m = cc._decorator;
var y = m.ccclass;
var g = (m.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.thunder_bullet;
    e.targetEnemy = null;
    e.isExtra = !1;
    e.targetPos = null;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.skillId = i;
    this.clearStatus();
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
  };

  e.prototype.initParam = function (t) {
    this.atk = t;
  };

  e.prototype.setAnimation = function () {
    var t = this;
    var e = this.node.children[0].getComponent(cc.Animation);
    e.getAnimationState("bullet_9").time = $gameContext["default"].ins.gameRatio;
    e.play("bullet_9");
    e.once(cc.Animation.EventType.FINISHED, function () {
      if ($util["default"].isValid(t.targetEnemy.node)) {
        t.attackEnemy();
      }

      t.removeSelf();
    }, this);
  };

  e.prototype.attackEnemy = function () {
    var t = this.targetEnemy.sufferAtk({
      id: this.skillId,
      skillSpecialitys: this.skillSpecialitys,
      atk: this.atk
    });

    if (this.skillParam.thunderSplitCount > 0) {
      this.createSplitBullet();
    }

    if (this.skillParam.thunderBoomRangeAdd > 0) {
      this.createBoom();
    }

    if (t && !this.isExtra) {
      this.createExtra();
    }

    if (this.skillParam.thunderPierceCount > 0) {
      this.createPierce();
    }

    if (this.skillParam.thunderParalysisTime > 0) {
      var e = {
        type: $enemyStatus.EnemyDebuffType.PARALYSIS,
        timeLeft: this.skillParam.thunderParalysisTime,
        value: 0
      };
      this.targetEnemy.sufferDebuff(e);
    }

    if (this.skillParam.thunderMatrixRange > 0) {
      this.createThunderMatrix();
    }
  };

  e.prototype.createPierce = function () {
    var t = $gameContext["default"].ins.getRangeRandomEnemyLayerByPos(this.targetPos, this.skillParam.thunderPierceRange);

    if (t && $util["default"].isValid(t.node)) {
      var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thunder_puncture);

      if (!e) {
        var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_12);
        (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
      }

      e.setPosition(this.targetPos.clone());
      e.initBullet12(t, this.skillId);
      e.initButtle(null, this.skillId);
      e.insert($gameContext["default"].ins.buttleLayer);
    }
  };

  e.prototype.createExtra = function () {
    var t = this;

    if (!(this.skillParam.thunderExtraAtkRange <= 0)) {
      for (var e = 0; e < this.skillParam.thunderExtraAtkCount; e++) {
        setTimeout(function () {
          if (cc.isValid(t.targetEnemy)) {
            var e = $gameContext["default"].ins.getRangeRandomEnemyLayer(t.targetEnemy.node, t.skillParam.thunderExtraAtkRange);

            if (!cc.isValid(e)) {
              return;
            }

            t.createButtle(e);
          }
        }, 300 * e);
      }
    }
  };

  e.prototype.createButtle = function (t) {
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thunder_bullet);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_9);
      (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    e.setPosition(t.getPosition().clone());
    e.targetEnemy = t;
    e.isExtra = !0;
    e.initButtle(null, this.skillId);
    e.insert($gameContext["default"].ins.buttleLayer);
    e.setAnimation("");
  };

  e.prototype.createThunderMatrix = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thunder_matrix);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_15);
      (t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    t.setPosition(this.targetPos.add(cc.v3(0, -50)));
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.floorLayer);
    t.setAnimation(null);
  };

  e.prototype.createBoom = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thunder_boom);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_11);
      t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    t.setPosition(this.targetPos.clone());
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.lowBulletLayer);
    t.setAnimation(null);
  };

  e.prototype.createSplitBullet = function () {
    var t = 0;

    for (var e = 0; e < this.skillParam.thunderSplitCount; e++) {
      var i = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thunder_split);

      if (!i) {
        var o = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_10);
        (i = $resUtil.ResUtil.instantiate(o).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(61).skill_tpye;
      }

      i.setPosition(this.targetPos.clone());
      var n = $util["default"].angleConverDir(t);
      i.initButtle(n, this.skillId);
      i.targetEnemy = this.targetEnemy;
      i.insert($gameContext["default"].ins.buttleLayer);
      t += 360 / this.skillParam.thunderSplitCount;
    }
  };

  e.prototype.updateFrame = function () {};

  return __decorate([y], e);
}($baseBullet["default"]));
exports["default"] = g;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF85LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiR1dGlsIiwiJGNvbmZpZ0NvbnRleHQiLCIkZ2FtZUNvbnRleHQiLCIkZ2FtZVNraWxsSW5mbyIsIiRlbmVteVN0YXR1cyIsIiRiYXNlQnVsbGV0IiwibSIsImNjIiwiX2RlY29yYXRvciIsInkiLCJjY2NsYXNzIiwiZyIsInByb3BlcnR5IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsImJ1dHRsZVR5cGUiLCJCdWxsZXRUeXBlIiwidGh1bmRlcl9idWxsZXQiLCJ0YXJnZXRFbmVteSIsImlzRXh0cmEiLCJ0YXJnZXRQb3MiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0QnV0dGxlIiwiaSIsImNhbGwiLCJza2lsbElkIiwiY2xlYXJTdGF0dXMiLCJhdGsiLCJza2lsbFBhcmFtIiwic2tpbGxBdGsiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwiaW5pdFBhcmFtIiwic2V0QW5pbWF0aW9uIiwibm9kZSIsImNoaWxkcmVuIiwiZ2V0Q29tcG9uZW50IiwiQW5pbWF0aW9uIiwiZ2V0QW5pbWF0aW9uU3RhdGUiLCJ0aW1lIiwiaW5zIiwiZ2FtZVJhdGlvIiwicGxheSIsIm9uY2UiLCJFdmVudFR5cGUiLCJGSU5JU0hFRCIsImlzVmFsaWQiLCJhdHRhY2tFbmVteSIsInJlbW92ZVNlbGYiLCJzdWZmZXJBdGsiLCJpZCIsInNraWxsU3BlY2lhbGl0eXMiLCJ0aHVuZGVyU3BsaXRDb3VudCIsImNyZWF0ZVNwbGl0QnVsbGV0IiwidGh1bmRlckJvb21SYW5nZUFkZCIsImNyZWF0ZUJvb20iLCJjcmVhdGVFeHRyYSIsInRodW5kZXJQaWVyY2VDb3VudCIsImNyZWF0ZVBpZXJjZSIsInRodW5kZXJQYXJhbHlzaXNUaW1lIiwidHlwZSIsIkVuZW15RGVidWZmVHlwZSIsIlBBUkFMWVNJUyIsInRpbWVMZWZ0IiwidmFsdWUiLCJzdWZmZXJEZWJ1ZmYiLCJ0aHVuZGVyTWF0cml4UmFuZ2UiLCJjcmVhdGVUaHVuZGVyTWF0cml4IiwiZ2V0UmFuZ2VSYW5kb21FbmVteUxheWVyQnlQb3MiLCJ0aHVuZGVyUGllcmNlUmFuZ2UiLCJnZXRCdXR0bGVQb29sIiwidGh1bmRlcl9wdW5jdHVyZSIsImluc3RhbmNlIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkJ1bGxldF8xMiIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImJ1dHRsZUxheWVyIiwicGFyZW50IiwiYmFzaWNTa2lsbENvbmZpZ01hcCIsImdldCIsInNraWxsX3RweWUiLCJzZXRQb3NpdGlvbiIsImNsb25lIiwiaW5pdEJ1bGxldDEyIiwiaW5zZXJ0IiwidGh1bmRlckV4dHJhQXRrUmFuZ2UiLCJ0aHVuZGVyRXh0cmFBdGtDb3VudCIsInNldFRpbWVvdXQiLCJnZXRSYW5nZVJhbmRvbUVuZW15TGF5ZXIiLCJjcmVhdGVCdXR0bGUiLCJCdWxsZXRfOSIsImdldFBvc2l0aW9uIiwidGh1bmRlcl9tYXRyaXgiLCJCdWxsZXRfMTUiLCJhZGQiLCJ2MyIsImZsb29yTGF5ZXIiLCJ0aHVuZGVyX2Jvb20iLCJCdWxsZXRfMTEiLCJsb3dCdWxsZXRMYXllciIsInRodW5kZXJfc3BsaXQiLCJCdWxsZXRfMTAiLCJuIiwiYW5nbGVDb252ZXJEaXIiLCJ1cGRhdGVGcmFtZSIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlHLEtBQUssR0FBR0gsT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSUksY0FBYyxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSUssWUFBWSxHQUFHTCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJTSxjQUFjLEdBQUdOLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJTyxZQUFZLEdBQUdQLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlRLFdBQVcsR0FBR1IsT0FBTyxDQUFDLGNBQUQsQ0FBekI7O0FBQ0EsSUFBSVMsQ0FBQyxHQUFHQyxFQUFFLENBQUNDLFVBQVg7QUFDQSxJQUFJQyxDQUFDLEdBQUdILENBQUMsQ0FBQ0ksT0FBVjtBQUNBLElBQUlDLENBQUMsSUFDQUwsQ0FBQyxDQUFDTSxRQUFGLEVBQ0EsVUFBVUMsQ0FBVixFQUFhO0VBQ1YsU0FBU0MsQ0FBVCxHQUFhO0lBQ1QsSUFBSUEsQ0FBQyxHQUFJLFNBQVNELENBQVQsSUFBY0EsQ0FBQyxDQUFDRSxLQUFGLENBQVEsSUFBUixFQUFjQyxTQUFkLENBQWYsSUFBNEMsSUFBcEQ7SUFDQUYsQ0FBQyxDQUFDRyxVQUFGLEdBQWVaLFdBQVcsQ0FBQ2EsVUFBWixDQUF1QkMsY0FBdEM7SUFDQUwsQ0FBQyxDQUFDTSxXQUFGLEdBQWdCLElBQWhCO0lBQ0FOLENBQUMsQ0FBQ08sT0FBRixHQUFZLENBQUMsQ0FBYjtJQUNBUCxDQUFDLENBQUNRLFNBQUYsR0FBYyxJQUFkO0lBQ0EsT0FBT1IsQ0FBUDtFQUNIOztFQUNEUyxTQUFTLENBQUNULENBQUQsRUFBSUQsQ0FBSixDQUFUOztFQUNBQyxDQUFDLENBQUNVLFNBQUYsQ0FBWUMsVUFBWixHQUF5QixVQUFVWCxDQUFWLEVBQWFZLENBQWIsRUFBZ0I7SUFDckNiLENBQUMsQ0FBQ1csU0FBRixDQUFZQyxVQUFaLENBQXVCRSxJQUF2QixDQUE0QixJQUE1QixFQUFrQ2IsQ0FBbEMsRUFBcUNZLENBQXJDO0lBQ0EsS0FBS0UsT0FBTCxHQUFlRixDQUFmO0lBQ0EsS0FBS0csV0FBTDtJQUNBLEtBQUtDLEdBQUwsR0FBVyxLQUFLQyxVQUFMLENBQWdCQyxRQUFoQixDQUF5QjdCLGNBQWMsQ0FBQzhCLFdBQWYsQ0FBMkJDLEtBQXBELENBQVg7RUFDSCxDQUxEOztFQU1BcEIsQ0FBQyxDQUFDVSxTQUFGLENBQVlXLFNBQVosR0FBd0IsVUFBVXRCLENBQVYsRUFBYTtJQUNqQyxLQUFLaUIsR0FBTCxHQUFXakIsQ0FBWDtFQUNILENBRkQ7O0VBR0FDLENBQUMsQ0FBQ1UsU0FBRixDQUFZWSxZQUFaLEdBQTJCLFlBQVk7SUFDbkMsSUFBSXZCLENBQUMsR0FBRyxJQUFSO0lBQ0EsSUFBSUMsQ0FBQyxHQUFHLEtBQUt1QixJQUFMLENBQVVDLFFBQVYsQ0FBbUIsQ0FBbkIsRUFBc0JDLFlBQXRCLENBQW1DaEMsRUFBRSxDQUFDaUMsU0FBdEMsQ0FBUjtJQUNBMUIsQ0FBQyxDQUFDMkIsaUJBQUYsQ0FBb0IsVUFBcEIsRUFBZ0NDLElBQWhDLEdBQXVDeEMsWUFBWSxXQUFaLENBQXFCeUMsR0FBckIsQ0FBeUJDLFNBQWhFO0lBQ0E5QixDQUFDLENBQUMrQixJQUFGLENBQU8sVUFBUDtJQUNBL0IsQ0FBQyxDQUFDZ0MsSUFBRixDQUNJdkMsRUFBRSxDQUFDaUMsU0FBSCxDQUFhTyxTQUFiLENBQXVCQyxRQUQzQixFQUVJLFlBQVk7TUFDUixJQUFJaEQsS0FBSyxXQUFMLENBQWNpRCxPQUFkLENBQXNCcEMsQ0FBQyxDQUFDTyxXQUFGLENBQWNpQixJQUFwQyxDQUFKLEVBQStDO1FBQzNDeEIsQ0FBQyxDQUFDcUMsV0FBRjtNQUNIOztNQUNEckMsQ0FBQyxDQUFDc0MsVUFBRjtJQUNILENBUEwsRUFRSSxJQVJKO0VBVUgsQ0FmRDs7RUFnQkFyQyxDQUFDLENBQUNVLFNBQUYsQ0FBWTBCLFdBQVosR0FBMEIsWUFBWTtJQUNsQyxJQUFJckMsQ0FBQyxHQUFHLEtBQUtPLFdBQUwsQ0FBaUJnQyxTQUFqQixDQUEyQjtNQUMvQkMsRUFBRSxFQUFFLEtBQUt6QixPQURzQjtNQUUvQjBCLGdCQUFnQixFQUFFLEtBQUtBLGdCQUZRO01BRy9CeEIsR0FBRyxFQUFFLEtBQUtBO0lBSHFCLENBQTNCLENBQVI7O0lBS0EsSUFBSSxLQUFLQyxVQUFMLENBQWdCd0IsaUJBQWhCLEdBQW9DLENBQXhDLEVBQTJDO01BQ3ZDLEtBQUtDLGlCQUFMO0lBQ0g7O0lBQ0QsSUFBSSxLQUFLekIsVUFBTCxDQUFnQjBCLG1CQUFoQixHQUFzQyxDQUExQyxFQUE2QztNQUN6QyxLQUFLQyxVQUFMO0lBQ0g7O0lBQ0QsSUFBSTdDLENBQUMsSUFBSSxDQUFDLEtBQUtRLE9BQWYsRUFBd0I7TUFDcEIsS0FBS3NDLFdBQUw7SUFDSDs7SUFDRCxJQUFJLEtBQUs1QixVQUFMLENBQWdCNkIsa0JBQWhCLEdBQXFDLENBQXpDLEVBQTRDO01BQ3hDLEtBQUtDLFlBQUw7SUFDSDs7SUFDRCxJQUFJLEtBQUs5QixVQUFMLENBQWdCK0Isb0JBQWhCLEdBQXVDLENBQTNDLEVBQThDO01BQzFDLElBQUloRCxDQUFDLEdBQUc7UUFDSmlELElBQUksRUFBRTNELFlBQVksQ0FBQzRELGVBQWIsQ0FBNkJDLFNBRC9CO1FBRUpDLFFBQVEsRUFBRSxLQUFLbkMsVUFBTCxDQUFnQitCLG9CQUZ0QjtRQUdKSyxLQUFLLEVBQUU7TUFISCxDQUFSO01BS0EsS0FBSy9DLFdBQUwsQ0FBaUJnRCxZQUFqQixDQUE4QnRELENBQTlCO0lBQ0g7O0lBQ0QsSUFBSSxLQUFLaUIsVUFBTCxDQUFnQnNDLGtCQUFoQixHQUFxQyxDQUF6QyxFQUE0QztNQUN4QyxLQUFLQyxtQkFBTDtJQUNIO0VBQ0osQ0E3QkQ7O0VBOEJBeEQsQ0FBQyxDQUFDVSxTQUFGLENBQVlxQyxZQUFaLEdBQTJCLFlBQVk7SUFDbkMsSUFBSWhELENBQUMsR0FBR1gsWUFBWSxXQUFaLENBQXFCeUMsR0FBckIsQ0FBeUI0Qiw2QkFBekIsQ0FDSixLQUFLakQsU0FERCxFQUVKLEtBQUtTLFVBQUwsQ0FBZ0J5QyxrQkFGWixDQUFSOztJQUlBLElBQUkzRCxDQUFDLElBQUliLEtBQUssV0FBTCxDQUFjaUQsT0FBZCxDQUFzQnBDLENBQUMsQ0FBQ3dCLElBQXhCLENBQVQsRUFBd0M7TUFDcEMsSUFBSXZCLENBQUMsR0FBR1osWUFBWSxXQUFaLENBQXFCeUMsR0FBckIsQ0FBeUI4QixhQUF6QixDQUF1Q3BFLFdBQVcsQ0FBQ2EsVUFBWixDQUF1QndELGdCQUE5RCxDQUFSOztNQUNBLElBQUksQ0FBQzVELENBQUwsRUFBUTtRQUNKLElBQUlZLENBQUMsR0FBRzlCLGFBQWEsV0FBYixDQUFzQitFLFFBQXRCLENBQStCQyxNQUEvQixDQUNKOUUsVUFBVSxDQUFDK0UsV0FBWCxDQUF1QkMsSUFEbkIsRUFFSmhGLFVBQVUsQ0FBQ2lGLFNBQVgsQ0FBcUJDLFdBQXJCLENBQWlDQyxPQUFqQyxDQUF5Q0MsVUFBekMsQ0FBb0RDLFNBRmhELENBQVI7UUFJQSxDQUFDckUsQ0FBQyxHQUFHZixRQUFRLENBQUNxRixPQUFULENBQWlCQyxXQUFqQixDQUE2QjNELENBQTdCLEVBQWdDeEIsWUFBWSxXQUFaLENBQXFCeUMsR0FBckIsQ0FBeUIyQyxXQUF6QixDQUFxQ0MsTUFBckUsRUFBNkVoRCxZQUE3RSxDQUNEbEMsV0FBVyxXQURWLENBQUwsRUFFR2lELGdCQUZILEdBRXNCckQsY0FBYyxXQUFkLENBQXVCMEUsUUFBdkIsQ0FBZ0NhLG1CQUFoQyxDQUFvREMsR0FBcEQsQ0FDbEIsS0FBSzdELE9BRGEsRUFFcEI4RCxVQUpGO01BS0g7O01BQ0Q1RSxDQUFDLENBQUM2RSxXQUFGLENBQWMsS0FBS3JFLFNBQUwsQ0FBZXNFLEtBQWYsRUFBZDtNQUNBOUUsQ0FBQyxDQUFDK0UsWUFBRixDQUFlaEYsQ0FBZixFQUFrQixLQUFLZSxPQUF2QjtNQUNBZCxDQUFDLENBQUNXLFVBQUYsQ0FBYSxJQUFiLEVBQW1CLEtBQUtHLE9BQXhCO01BQ0FkLENBQUMsQ0FBQ2dGLE1BQUYsQ0FBUzVGLFlBQVksV0FBWixDQUFxQnlDLEdBQXJCLENBQXlCMkMsV0FBbEM7SUFDSDtFQUNKLENBdkJEOztFQXdCQXhFLENBQUMsQ0FBQ1UsU0FBRixDQUFZbUMsV0FBWixHQUEwQixZQUFZO0lBQ2xDLElBQUk5QyxDQUFDLEdBQUcsSUFBUjs7SUFDQSxJQUFJLEVBQUUsS0FBS2tCLFVBQUwsQ0FBZ0JnRSxvQkFBaEIsSUFBd0MsQ0FBMUMsQ0FBSixFQUFrRDtNQUM5QyxLQUFLLElBQUlqRixDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtpQixVQUFMLENBQWdCaUUsb0JBQXBDLEVBQTBEbEYsQ0FBQyxFQUEzRCxFQUErRDtRQUMzRG1GLFVBQVUsQ0FBQyxZQUFZO1VBQ25CLElBQUkxRixFQUFFLENBQUMwQyxPQUFILENBQVdwQyxDQUFDLENBQUNPLFdBQWIsQ0FBSixFQUErQjtZQUMzQixJQUFJTixDQUFDLEdBQUdaLFlBQVksV0FBWixDQUFxQnlDLEdBQXJCLENBQXlCdUQsd0JBQXpCLENBQ0pyRixDQUFDLENBQUNPLFdBQUYsQ0FBY2lCLElBRFYsRUFFSnhCLENBQUMsQ0FBQ2tCLFVBQUYsQ0FBYWdFLG9CQUZULENBQVI7O1lBSUEsSUFBSSxDQUFDeEYsRUFBRSxDQUFDMEMsT0FBSCxDQUFXbkMsQ0FBWCxDQUFMLEVBQW9CO2NBQ2hCO1lBQ0g7O1lBQ0RELENBQUMsQ0FBQ3NGLFlBQUYsQ0FBZXJGLENBQWY7VUFDSDtRQUNKLENBWFMsRUFXUCxNQUFNQSxDQVhDLENBQVY7TUFZSDtJQUNKO0VBQ0osQ0FsQkQ7O0VBbUJBQSxDQUFDLENBQUNVLFNBQUYsQ0FBWTJFLFlBQVosR0FBMkIsVUFBVXRGLENBQVYsRUFBYTtJQUNwQyxJQUFJQyxDQUFDLEdBQUdaLFlBQVksV0FBWixDQUFxQnlDLEdBQXJCLENBQXlCOEIsYUFBekIsQ0FBdUNwRSxXQUFXLENBQUNhLFVBQVosQ0FBdUJDLGNBQTlELENBQVI7O0lBQ0EsSUFBSSxDQUFDTCxDQUFMLEVBQVE7TUFDSixJQUFJWSxDQUFDLEdBQUc5QixhQUFhLFdBQWIsQ0FBc0IrRSxRQUF0QixDQUErQkMsTUFBL0IsQ0FDSjlFLFVBQVUsQ0FBQytFLFdBQVgsQ0FBdUJDLElBRG5CLEVBRUpoRixVQUFVLENBQUNpRixTQUFYLENBQXFCQyxXQUFyQixDQUFpQ0MsT0FBakMsQ0FBeUNDLFVBQXpDLENBQW9Ea0IsUUFGaEQsQ0FBUjtNQUlBLENBQUN0RixDQUFDLEdBQUdmLFFBQVEsQ0FBQ3FGLE9BQVQsQ0FBaUJDLFdBQWpCLENBQTZCM0QsQ0FBN0IsRUFBZ0N4QixZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QjJDLFdBQXpCLENBQXFDQyxNQUFyRSxFQUE2RWhELFlBQTdFLENBQ0RsQyxXQUFXLFdBRFYsQ0FBTCxFQUVHaUQsZ0JBRkgsR0FFc0JyRCxjQUFjLFdBQWQsQ0FBdUIwRSxRQUF2QixDQUFnQ2EsbUJBQWhDLENBQW9EQyxHQUFwRCxDQUF3RCxLQUFLN0QsT0FBN0QsRUFBc0U4RCxVQUY1RjtJQUdIOztJQUNENUUsQ0FBQyxDQUFDNkUsV0FBRixDQUFjOUUsQ0FBQyxDQUFDd0YsV0FBRixHQUFnQlQsS0FBaEIsRUFBZDtJQUNBOUUsQ0FBQyxDQUFDTSxXQUFGLEdBQWdCUCxDQUFoQjtJQUNBQyxDQUFDLENBQUNPLE9BQUYsR0FBWSxDQUFDLENBQWI7SUFDQVAsQ0FBQyxDQUFDVyxVQUFGLENBQWEsSUFBYixFQUFtQixLQUFLRyxPQUF4QjtJQUNBZCxDQUFDLENBQUNnRixNQUFGLENBQVM1RixZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QjJDLFdBQWxDO0lBQ0F4RSxDQUFDLENBQUNzQixZQUFGLENBQWUsRUFBZjtFQUNILENBakJEOztFQWtCQXRCLENBQUMsQ0FBQ1UsU0FBRixDQUFZOEMsbUJBQVosR0FBa0MsWUFBWTtJQUMxQyxJQUFJekQsQ0FBQyxHQUFHWCxZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QjhCLGFBQXpCLENBQXVDcEUsV0FBVyxDQUFDYSxVQUFaLENBQXVCb0YsY0FBOUQsQ0FBUjs7SUFDQSxJQUFJLENBQUN6RixDQUFMLEVBQVE7TUFDSixJQUFJQyxDQUFDLEdBQUdsQixhQUFhLFdBQWIsQ0FBc0IrRSxRQUF0QixDQUErQkMsTUFBL0IsQ0FDSjlFLFVBQVUsQ0FBQytFLFdBQVgsQ0FBdUJDLElBRG5CLEVBRUpoRixVQUFVLENBQUNpRixTQUFYLENBQXFCQyxXQUFyQixDQUFpQ0MsT0FBakMsQ0FBeUNDLFVBQXpDLENBQW9EcUIsU0FGaEQsQ0FBUjtNQUlBLENBQUMxRixDQUFDLEdBQUdkLFFBQVEsQ0FBQ3FGLE9BQVQsQ0FBaUJDLFdBQWpCLENBQTZCdkUsQ0FBN0IsRUFBZ0NaLFlBQVksV0FBWixDQUFxQnlDLEdBQXJCLENBQXlCMkMsV0FBekIsQ0FBcUNDLE1BQXJFLEVBQTZFaEQsWUFBN0UsQ0FDRGxDLFdBQVcsV0FEVixDQUFMLEVBRUdpRCxnQkFGSCxHQUVzQnJELGNBQWMsV0FBZCxDQUF1QjBFLFFBQXZCLENBQWdDYSxtQkFBaEMsQ0FBb0RDLEdBQXBELENBQXdELEtBQUs3RCxPQUE3RCxFQUFzRThELFVBRjVGO0lBR0g7O0lBQ0Q3RSxDQUFDLENBQUM4RSxXQUFGLENBQWMsS0FBS3JFLFNBQUwsQ0FBZWtGLEdBQWYsQ0FBbUJqRyxFQUFFLENBQUNrRyxFQUFILENBQU0sQ0FBTixFQUFTLENBQUMsRUFBVixDQUFuQixDQUFkO0lBQ0E1RixDQUFDLENBQUNZLFVBQUYsQ0FBYSxJQUFiLEVBQW1CLEtBQUtHLE9BQXhCO0lBQ0FmLENBQUMsQ0FBQ2lGLE1BQUYsQ0FBUzVGLFlBQVksV0FBWixDQUFxQnlDLEdBQXJCLENBQXlCK0QsVUFBbEM7SUFDQTdGLENBQUMsQ0FBQ3VCLFlBQUYsQ0FBZSxJQUFmO0VBQ0gsQ0FmRDs7RUFnQkF0QixDQUFDLENBQUNVLFNBQUYsQ0FBWWtDLFVBQVosR0FBeUIsWUFBWTtJQUNqQyxJQUFJN0MsQ0FBQyxHQUFHWCxZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QjhCLGFBQXpCLENBQXVDcEUsV0FBVyxDQUFDYSxVQUFaLENBQXVCeUYsWUFBOUQsQ0FBUjs7SUFDQSxJQUFJLENBQUM5RixDQUFMLEVBQVE7TUFDSixJQUFJQyxDQUFDLEdBQUdsQixhQUFhLFdBQWIsQ0FBc0IrRSxRQUF0QixDQUErQkMsTUFBL0IsQ0FDSjlFLFVBQVUsQ0FBQytFLFdBQVgsQ0FBdUJDLElBRG5CLEVBRUpoRixVQUFVLENBQUNpRixTQUFYLENBQXFCQyxXQUFyQixDQUFpQ0MsT0FBakMsQ0FBeUNDLFVBQXpDLENBQW9EMEIsU0FGaEQsQ0FBUjtNQUlBL0YsQ0FBQyxHQUFHZCxRQUFRLENBQUNxRixPQUFULENBQWlCQyxXQUFqQixDQUE2QnZFLENBQTdCLEVBQWdDWixZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QmtFLGNBQXpCLENBQXdDdEIsTUFBeEUsRUFBZ0ZoRCxZQUFoRixDQUNBbEMsV0FBVyxXQURYLENBQUo7SUFHSDs7SUFDRFEsQ0FBQyxDQUFDOEUsV0FBRixDQUFjLEtBQUtyRSxTQUFMLENBQWVzRSxLQUFmLEVBQWQ7SUFDQS9FLENBQUMsQ0FBQ1ksVUFBRixDQUFhLElBQWIsRUFBbUIsS0FBS0csT0FBeEI7SUFDQWYsQ0FBQyxDQUFDaUYsTUFBRixDQUFTNUYsWUFBWSxXQUFaLENBQXFCeUMsR0FBckIsQ0FBeUJrRSxjQUFsQztJQUNBaEcsQ0FBQyxDQUFDdUIsWUFBRixDQUFlLElBQWY7RUFDSCxDQWZEOztFQWdCQXRCLENBQUMsQ0FBQ1UsU0FBRixDQUFZZ0MsaUJBQVosR0FBZ0MsWUFBWTtJQUN4QyxJQUFJM0MsQ0FBQyxHQUFHLENBQVI7O0lBQ0EsS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtpQixVQUFMLENBQWdCd0IsaUJBQXBDLEVBQXVEekMsQ0FBQyxFQUF4RCxFQUE0RDtNQUN4RCxJQUFJWSxDQUFDLEdBQUd4QixZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QjhCLGFBQXpCLENBQXVDcEUsV0FBVyxDQUFDYSxVQUFaLENBQXVCNEYsYUFBOUQsQ0FBUjs7TUFDQSxJQUFJLENBQUNwRixDQUFMLEVBQVE7UUFDSixJQUFJL0IsQ0FBQyxHQUFHQyxhQUFhLFdBQWIsQ0FBc0IrRSxRQUF0QixDQUErQkMsTUFBL0IsQ0FDSjlFLFVBQVUsQ0FBQytFLFdBQVgsQ0FBdUJDLElBRG5CLEVBRUpoRixVQUFVLENBQUNpRixTQUFYLENBQXFCQyxXQUFyQixDQUFpQ0MsT0FBakMsQ0FBeUNDLFVBQXpDLENBQW9ENkIsU0FGaEQsQ0FBUjtRQUlBLENBQUNyRixDQUFDLEdBQUczQixRQUFRLENBQUNxRixPQUFULENBQWlCQyxXQUFqQixDQUE2QjFGLENBQTdCLEVBQWdDNEMsWUFBaEMsQ0FBNkNsQyxXQUFXLFdBQXhELENBQUwsRUFBd0VpRCxnQkFBeEUsR0FDSXJELGNBQWMsV0FBZCxDQUF1QjBFLFFBQXZCLENBQWdDYSxtQkFBaEMsQ0FBb0RDLEdBQXBELENBQXdELEVBQXhELEVBQTREQyxVQURoRTtNQUVIOztNQUNEaEUsQ0FBQyxDQUFDaUUsV0FBRixDQUFjLEtBQUtyRSxTQUFMLENBQWVzRSxLQUFmLEVBQWQ7TUFDQSxJQUFJb0IsQ0FBQyxHQUFHaEgsS0FBSyxXQUFMLENBQWNpSCxjQUFkLENBQTZCcEcsQ0FBN0IsQ0FBUjtNQUNBYSxDQUFDLENBQUNELFVBQUYsQ0FBYXVGLENBQWIsRUFBZ0IsS0FBS3BGLE9BQXJCO01BQ0FGLENBQUMsQ0FBQ04sV0FBRixHQUFnQixLQUFLQSxXQUFyQjtNQUNBTSxDQUFDLENBQUNvRSxNQUFGLENBQVM1RixZQUFZLFdBQVosQ0FBcUJ5QyxHQUFyQixDQUF5QjJDLFdBQWxDO01BQ0F6RSxDQUFDLElBQUksTUFBTSxLQUFLa0IsVUFBTCxDQUFnQndCLGlCQUEzQjtJQUNIO0VBQ0osQ0FuQkQ7O0VBb0JBekMsQ0FBQyxDQUFDVSxTQUFGLENBQVkwRixXQUFaLEdBQTBCLFlBQVksQ0FBRSxDQUF4Qzs7RUFDQSxPQUFPQyxVQUFVLENBQUMsQ0FBQzFHLENBQUQsQ0FBRCxFQUFNSyxDQUFOLENBQWpCO0FBQ0gsQ0FwTEQsQ0FvTEdULFdBQVcsV0FwTGQsQ0FGQyxDQUFMO0FBdUxBK0csT0FBTyxXQUFQLEdBQWtCekcsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkdXRpbCA9IHJlcXVpcmUoXCIuL1V0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRlbmVteVN0YXR1cyA9IHJlcXVpcmUoXCIuL0VuZW15U3RhdHVzXCIpO1xyXG52YXIgJGJhc2VCdWxsZXQgPSByZXF1aXJlKFwiLi9CYXNlQnVsbGV0XCIpO1xyXG52YXIgbSA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciB5ID0gbS5jY2NsYXNzO1xyXG52YXIgZyA9XHJcbiAgICAobS5wcm9wZXJ0eSxcclxuICAgIChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgICAgICBlLmJ1dHRsZVR5cGUgPSAkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnRodW5kZXJfYnVsbGV0O1xyXG4gICAgICAgICAgICBlLnRhcmdldEVuZW15ID0gbnVsbDtcclxuICAgICAgICAgICAgZS5pc0V4dHJhID0gITE7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0UG9zID0gbnVsbDtcclxuICAgICAgICAgICAgcmV0dXJuIGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgICAgICBlLnByb3RvdHlwZS5pbml0QnV0dGxlID0gZnVuY3Rpb24gKGUsIGkpIHtcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUuaW5pdEJ1dHRsZS5jYWxsKHRoaXMsIGUsIGkpO1xyXG4gICAgICAgICAgICB0aGlzLnNraWxsSWQgPSBpO1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyU3RhdHVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYXRrID0gdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmluaXRQYXJhbSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXRrID0gdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLnNldEFuaW1hdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXMubm9kZS5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgZS5nZXRBbmltYXRpb25TdGF0ZShcImJ1bGxldF85XCIpLnRpbWUgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2FtZVJhdGlvO1xyXG4gICAgICAgICAgICBlLnBsYXkoXCJidWxsZXRfOVwiKTtcclxuICAgICAgICAgICAgZS5vbmNlKFxyXG4gICAgICAgICAgICAgICAgY2MuQW5pbWF0aW9uLkV2ZW50VHlwZS5GSU5JU0hFRCxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHV0aWwuZGVmYXVsdC5pc1ZhbGlkKHQudGFyZ2V0RW5lbXkubm9kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5hdHRhY2tFbmVteSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5hdHRhY2tFbmVteSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnRhcmdldEVuZW15LnN1ZmZlckF0ayh7XHJcbiAgICAgICAgICAgICAgICBpZDogdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgc2tpbGxTcGVjaWFsaXR5czogdGhpcy5za2lsbFNwZWNpYWxpdHlzLFxyXG4gICAgICAgICAgICAgICAgYXRrOiB0aGlzLmF0a1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS50aHVuZGVyU3BsaXRDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlU3BsaXRCdWxsZXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLnRodW5kZXJCb29tUmFuZ2VBZGQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUJvb20oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodCAmJiAhdGhpcy5pc0V4dHJhKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUV4dHJhKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS50aHVuZGVyUGllcmNlQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVBpZXJjZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0udGh1bmRlclBhcmFseXNpc1RpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLlBBUkFMWVNJUyxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogdGhpcy5za2lsbFBhcmFtLnRodW5kZXJQYXJhbHlzaXNUaW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy50YXJnZXRFbmVteS5zdWZmZXJEZWJ1ZmYoZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS50aHVuZGVyTWF0cml4UmFuZ2UgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVRodW5kZXJNYXRyaXgoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuY3JlYXRlUGllcmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSYW5nZVJhbmRvbUVuZW15TGF5ZXJCeVBvcyhcclxuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0UG9zLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnRodW5kZXJQaWVyY2VSYW5nZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAodCAmJiAkdXRpbC5kZWZhdWx0LmlzVmFsaWQodC5ub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnRodW5kZXJfcHVuY3R1cmUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfMTJcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIChlID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShpLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICAgICApKS5za2lsbFNwZWNpYWxpdHlzID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5iYXNpY1NraWxsQ29uZmlnTWFwLmdldChcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbElkXHJcbiAgICAgICAgICAgICAgICAgICAgKS5za2lsbF90cHllO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZS5zZXRQb3NpdGlvbih0aGlzLnRhcmdldFBvcy5jbG9uZSgpKTtcclxuICAgICAgICAgICAgICAgIGUuaW5pdEJ1bGxldDEyKHQsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgICAgICBlLmluaXRCdXR0bGUobnVsbCwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgICAgIGUuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZUV4dHJhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdCA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghKHRoaXMuc2tpbGxQYXJhbS50aHVuZGVyRXh0cmFBdGtSYW5nZSA8PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLnNraWxsUGFyYW0udGh1bmRlckV4dHJhQXRrQ291bnQ7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2MuaXNWYWxpZCh0LnRhcmdldEVuZW15KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UmFuZ2VSYW5kb21FbmVteUxheWVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQudGFyZ2V0RW5lbXkubm9kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnNraWxsUGFyYW0udGh1bmRlckV4dHJhQXRrUmFuZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWNjLmlzVmFsaWQoZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmNyZWF0ZUJ1dHRsZShlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMCAqIGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5jcmVhdGVCdXR0bGUgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUudGh1bmRlcl9idWxsZXQpO1xyXG4gICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF85XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgKGUgPSAkcmVzVXRpbC5SZXNVdGlsLmluc3RhbnRpYXRlKGksICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllci5wYXJlbnQpLmdldENvbXBvbmVudChcclxuICAgICAgICAgICAgICAgICAgICAkYmFzZUJ1bGxldC5kZWZhdWx0XHJcbiAgICAgICAgICAgICAgICApKS5za2lsbFNwZWNpYWxpdHlzID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5iYXNpY1NraWxsQ29uZmlnTWFwLmdldCh0aGlzLnNraWxsSWQpLnNraWxsX3RweWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZS5zZXRQb3NpdGlvbih0LmdldFBvc2l0aW9uKCkuY2xvbmUoKSk7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0RW5lbXkgPSB0O1xyXG4gICAgICAgICAgICBlLmlzRXh0cmEgPSAhMDtcclxuICAgICAgICAgICAgZS5pbml0QnV0dGxlKG51bGwsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgIGUuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgICAgIGUuc2V0QW5pbWF0aW9uKFwiXCIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuY3JlYXRlVGh1bmRlck1hdHJpeCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnRodW5kZXJfbWF0cml4KTtcclxuICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9ICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5nZXRSZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfMTVcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAodCA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoZSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICkpLnNraWxsU3BlY2lhbGl0eXMgPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmJhc2ljU2tpbGxDb25maWdNYXAuZ2V0KHRoaXMuc2tpbGxJZCkuc2tpbGxfdHB5ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnNldFBvc2l0aW9uKHRoaXMudGFyZ2V0UG9zLmFkZChjYy52MygwLCAtNTApKSk7XHJcbiAgICAgICAgICAgIHQuaW5pdEJ1dHRsZShudWxsLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICB0Lmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZmxvb3JMYXllcik7XHJcbiAgICAgICAgICAgIHQuc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuY3JlYXRlQm9vbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnRodW5kZXJfYm9vbSk7XHJcbiAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzExXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgdCA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoZSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5zZXRQb3NpdGlvbih0aGlzLnRhcmdldFBvcy5jbG9uZSgpKTtcclxuICAgICAgICAgICAgdC5pbml0QnV0dGxlKG51bGwsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgIHQuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgICAgIHQuc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuY3JlYXRlU3BsaXRCdWxsZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gMDtcclxuICAgICAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0aGlzLnNraWxsUGFyYW0udGh1bmRlclNwbGl0Q291bnQ7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnRodW5kZXJfc3BsaXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfMTBcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIChpID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShvKS5nZXRDb21wb25lbnQoJGJhc2VCdWxsZXQuZGVmYXVsdCkpLnNraWxsU3BlY2lhbGl0eXMgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmJhc2ljU2tpbGxDb25maWdNYXAuZ2V0KDYxKS5za2lsbF90cHllO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaS5zZXRQb3NpdGlvbih0aGlzLnRhcmdldFBvcy5jbG9uZSgpKTtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gJHV0aWwuZGVmYXVsdC5hbmdsZUNvbnZlckRpcih0KTtcclxuICAgICAgICAgICAgICAgIGkuaW5pdEJ1dHRsZShuLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICAgICAgaS50YXJnZXRFbmVteSA9IHRoaXMudGFyZ2V0RW5lbXk7XHJcbiAgICAgICAgICAgICAgICBpLmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIpO1xyXG4gICAgICAgICAgICAgICAgdCArPSAzNjAgLyB0aGlzLnNraWxsUGFyYW0udGh1bmRlclNwbGl0Q291bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLnVwZGF0ZUZyYW1lID0gZnVuY3Rpb24gKCkge307XHJcbiAgICAgICAgcmV0dXJuIF9fZGVjb3JhdGUoW3ldLCBlKTtcclxuICAgIH0pKCRiYXNlQnVsbGV0LmRlZmF1bHQpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gZztcclxuIl19