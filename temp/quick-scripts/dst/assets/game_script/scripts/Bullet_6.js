
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_6.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c94a9MiyEROeJwDsacQwO7M', 'Bullet_6');
// game_script/scripts/Bullet_6.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var y = cc._decorator;
var g = y.ccclass;

var _ = (y.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.freeze_bullet;
    e.currPenetrateLayer = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.currPenetrateLayer = 0;
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
    this.speed = this.skillParam.freezeSpeed[$gameSkillInfo.Skill4Param.FINAL];
    this.velocity.set(e).multiplyScalar(this.speed);
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse && e == $object.Trigger.enter) {
      var i = t.object;
      i.sufferAtk({
        id: this.skillId,
        skillSpecialitys: this.skillSpecialitys,
        bulletBuff: $baseBullet.BulletBuff.paralysis_damage,
        value: this.skillParam.freezeSuffParalysisAdd,
        atk: this.atk
      });

      if (this.skillParam.freezeBack[$gameSkillInfo.Skill4Param.FINAL] > 0) {
        var o = {
          type: $enemyStatus.EnemyDebuffType.BACK,
          timeLeft: -1,
          value: this.skillParam.freezeBack[$gameSkillInfo.Skill4Param.FINAL]
        };
        i.sufferDebuff(o);
      }

      for (var n = 0; n < this.skillParam.freezeEnemyAtkAddParam.length; n++) {
        var s = this.skillParam.freezeEnemyAtkAddParam;
        var a = {
          type: $enemyStatus.EnemyDebuffType.ALL_ATK_ADD,
          timeLeft: s[n][0],
          value: s[n][1]
        };
        i.sufferDebuff(a);
      }

      if (this.skillParam.freezeTime > 0) {
        o = {
          type: $enemyStatus.EnemyDebuffType.FREEZE,
          timeLeft: this.skillParam.freezeTime,
          value: 0
        };
        i.sufferDebuff(o);
      }

      if (0 === this.currPenetrateLayer && this.skillParam.freezeSplitCount > 0) {
        this.createSplitButtle(i);
      }

      if (!(29 !== i.config.id && 30 !== i.config.id && 36 !== i.config.id)) {
        this.currPenetrateLayer = this.skillParam.freezePenetrateLayer;
      }

      this.currPenetrateLayer++;

      if (this.skillParam.freezePenetrateLayer <= this.currPenetrateLayer) {
        this.isUse = !0;
        this.removeSelf();
      }
    }
  };

  e.prototype.createSplitButtle = function (t) {
    var e = $gameContext["default"].ins.getNearbyN2(t.node, this.skillParam.freezeSplitCount);

    for (var i = 0; i < e.length; i++) {
      var o = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.thermobaric_split);

      if (!o) {
        var n = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_8);
        (o = $resUtil.ResUtil.instantiate(n).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
      }

      o.setPosition(this.node.position.clone());
      o.initButtle(e[i].node.position.sub(this.node.position).normalize(), this.skillId);
      o.targetEnemy = t;
      o.insert($gameContext["default"].ins.buttleLayer);
    }
  };

  e.prototype.checkBoundary = function () {
    if (!this.skillParam.freezeIsReflect) {
      return t.prototype.checkBoundary.call(this);
    }

    var e = cc.winSize.width / 2;
    var i = cc.winSize.height / 2;
    this.node.x <= -e ? (this.velocity.x = Math.abs(this.velocity.x), this.setAngle($util["default"].dirConverAngle(this.velocity))) : this.node.x >= e && (this.velocity.x = -Math.abs(this.velocity.x), this.setAngle($util["default"].dirConverAngle(this.velocity)));

    if (this.node.y >= i) {
      this.velocity.y = -Math.abs(this.velocity.y);
      this.setAngle($util["default"].dirConverAngle(this.velocity));
    }

    return !(this.node.y <= -cc.winSize.height / 2 - 100);
  };

  return __decorate([g], e);
}($baseBullet["default"]));

exports["default"] = _;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF82LmpzIl0sIm5hbWVzIjpbIm8iLCIkb2JqZWN0IiwicmVxdWlyZSIsIiRhc3NldHNMb2FkZXIiLCIkYXNzZXRzTWFwIiwiJHJlc1V0aWwiLCIkdXRpbCIsIiRjb25maWdDb250ZXh0IiwiJGdhbWVDb250ZXh0IiwiJGdhbWVTa2lsbEluZm8iLCIkZW5lbXlTdGF0dXMiLCIkYmFzZUJ1bGxldCIsInkiLCJjYyIsIl9kZWNvcmF0b3IiLCJnIiwiY2NjbGFzcyIsIl8iLCJwcm9wZXJ0eSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJidXR0bGVUeXBlIiwiQnVsbGV0VHlwZSIsImZyZWV6ZV9idWxsZXQiLCJjdXJyUGVuZXRyYXRlTGF5ZXIiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0QnV0dGxlIiwiaSIsImNhbGwiLCJhdGsiLCJza2lsbFBhcmFtIiwic2tpbGxBdGsiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwic3BlZWQiLCJmcmVlemVTcGVlZCIsInZlbG9jaXR5Iiwic2V0IiwibXVsdGlwbHlTY2FsYXIiLCJvblRyaWdnZXIiLCJpc1VzZSIsIlRyaWdnZXIiLCJlbnRlciIsIm9iamVjdCIsInN1ZmZlckF0ayIsImlkIiwic2tpbGxJZCIsInNraWxsU3BlY2lhbGl0eXMiLCJidWxsZXRCdWZmIiwiQnVsbGV0QnVmZiIsInBhcmFseXNpc19kYW1hZ2UiLCJ2YWx1ZSIsImZyZWV6ZVN1ZmZQYXJhbHlzaXNBZGQiLCJmcmVlemVCYWNrIiwidHlwZSIsIkVuZW15RGVidWZmVHlwZSIsIkJBQ0siLCJ0aW1lTGVmdCIsInN1ZmZlckRlYnVmZiIsIm4iLCJmcmVlemVFbmVteUF0a0FkZFBhcmFtIiwibGVuZ3RoIiwicyIsImEiLCJBTExfQVRLX0FERCIsImZyZWV6ZVRpbWUiLCJGUkVFWkUiLCJmcmVlemVTcGxpdENvdW50IiwiY3JlYXRlU3BsaXRCdXR0bGUiLCJjb25maWciLCJmcmVlemVQZW5ldHJhdGVMYXllciIsInJlbW92ZVNlbGYiLCJpbnMiLCJnZXROZWFyYnlOMiIsIm5vZGUiLCJnZXRCdXR0bGVQb29sIiwidGhlcm1vYmFyaWNfc3BsaXQiLCJpbnN0YW5jZSIsImdldFJlcyIsIkJ1bmRsZU5hbWVzIiwiR2FtZSIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJCdWxsZXRfOCIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImdldENvbXBvbmVudCIsImJhc2ljU2tpbGxDb25maWdNYXAiLCJnZXQiLCJza2lsbF90cHllIiwic2V0UG9zaXRpb24iLCJwb3NpdGlvbiIsImNsb25lIiwic3ViIiwibm9ybWFsaXplIiwidGFyZ2V0RW5lbXkiLCJpbnNlcnQiLCJidXR0bGVMYXllciIsImNoZWNrQm91bmRhcnkiLCJmcmVlemVJc1JlZmxlY3QiLCJ3aW5TaXplIiwid2lkdGgiLCJoZWlnaHQiLCJ4IiwiTWF0aCIsImFicyIsInNldEFuZ2xlIiwiZGlyQ29udmVyQW5nbGUiLCJfX2RlY29yYXRlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHRCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUUsVUFBVSxHQUFHRixPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRyxRQUFRLEdBQUdILE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlJLEtBQUssR0FBR0osT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSUssY0FBYyxHQUFHTCxPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSU0sWUFBWSxHQUFHTixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJTyxjQUFjLEdBQUdQLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFD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QUwsQ0FBUyxLQUFLdkUsUUFBTCxDQUFjcUUsQ0FBdkIsQ0FBcEIsRUFDRCxLQUFLRyxRQUFMLENBQWN6RyxLQUFLLFdBQUwsQ0FBYzBHLGNBQWQsQ0FBNkIsS0FBS3pFLFFBQWxDLENBQWQsQ0FGQSxDQUhOOztJQU1BLElBQUksS0FBS3NDLElBQUwsQ0FBVWpFLENBQVYsSUFBZWtCLENBQW5CLEVBQXNCO01BQ2xCLEtBQUtTLFFBQUwsQ0FBYzNCLENBQWQsR0FBa0IsQ0FBQ2lHLElBQUksQ0FBQ0MsR0FBTCxDQUFTLEtBQUt2RSxRQUFMLENBQWMzQixDQUF2QixDQUFuQjtNQUNBLEtBQUttRyxRQUFMLENBQWN6RyxLQUFLLFdBQUwsQ0FBYzBHLGNBQWQsQ0FBNkIsS0FBS3pFLFFBQWxDLENBQWQ7SUFDSDs7SUFDRCxPQUFPLEVBQUUsS0FBS3NDLElBQUwsQ0FBVWpFLENBQVYsSUFBZSxDQUFDQyxFQUFFLENBQUM0RixPQUFILENBQVdFLE1BQVosR0FBcUIsQ0FBckIsR0FBeUIsR0FBMUMsQ0FBUDtFQUNILENBakJEOztFQWtCQSxPQUFPTSxVQUFVLENBQUMsQ0FBQ2xHLENBQUQsQ0FBRCxFQUFNSyxDQUFOLENBQWpCO0FBQ0gsQ0FwR0QsQ0FvR0dULFdBQVcsV0FwR2QsQ0FGQyxDQUFMOztBQXVHQXVHLE9BQU8sV0FBUCxHQUFrQmpHLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRvYmplY3QgPSByZXF1aXJlKFwiLi9PYmplY3RcIik7XHJcbnZhciAkYXNzZXRzTG9hZGVyID0gcmVxdWlyZShcIi4vQXNzZXRzTG9hZGVyXCIpO1xyXG52YXIgJGFzc2V0c01hcCA9IHJlcXVpcmUoXCIuL0Fzc2V0c01hcFwiKTtcclxudmFyICRyZXNVdGlsID0gcmVxdWlyZShcIi4vUmVzVXRpbFwiKTtcclxudmFyICR1dGlsID0gcmVxdWlyZShcIi4vVXRpbFwiKTtcclxudmFyICRjb25maWdDb250ZXh0ID0gcmVxdWlyZShcIi4vQ29uZmlnQ29udGV4dFwiKTtcclxudmFyICRnYW1lQ29udGV4dCA9IHJlcXVpcmUoXCIuL0dhbWVDb250ZXh0XCIpO1xyXG52YXIgJGdhbWVTa2lsbEluZm8gPSByZXF1aXJlKFwiLi9HYW1lU2tpbGxJbmZvXCIpO1xyXG52YXIgJGVuZW15U3RhdHVzID0gcmVxdWlyZShcIi4vRW5lbXlTdGF0dXNcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciB5ID0gY2MuX2RlY29yYXRvcjtcclxudmFyIGcgPSB5LmNjY2xhc3M7XHJcbnZhciBfID1cclxuICAgICh5LnByb3BlcnR5LFxyXG4gICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgICAgIGUuYnV0dGxlVHlwZSA9ICRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuZnJlZXplX2J1bGxldDtcclxuICAgICAgICAgICAgZS5jdXJyUGVuZXRyYXRlTGF5ZXIgPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSwgaSkge1xyXG4gICAgICAgICAgICB0LnByb3RvdHlwZS5pbml0QnV0dGxlLmNhbGwodGhpcywgZSwgaSk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VyclBlbmV0cmF0ZUxheWVyID0gMDtcclxuICAgICAgICAgICAgdGhpcy5hdGsgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5za2lsbFBhcmFtLmZyZWV6ZVNwZWVkWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXTtcclxuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoZSkubXVsdGlwbHlTY2FsYXIodGhpcy5zcGVlZCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5vblRyaWdnZXIgPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNVc2UgJiYgZSA9PSAkb2JqZWN0LlRyaWdnZXIuZW50ZXIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gdC5vYmplY3Q7XHJcbiAgICAgICAgICAgICAgICBpLnN1ZmZlckF0ayh7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuc2tpbGxJZCxcclxuICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiB0aGlzLnNraWxsU3BlY2lhbGl0eXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYnVsbGV0QnVmZjogJGJhc2VCdWxsZXQuQnVsbGV0QnVmZi5wYXJhbHlzaXNfZGFtYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnNraWxsUGFyYW0uZnJlZXplU3VmZlBhcmFseXNpc0FkZCxcclxuICAgICAgICAgICAgICAgICAgICBhdGs6IHRoaXMuYXRrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0uZnJlZXplQmFja1skZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuQkFDSyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZUxlZnQ6IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5za2lsbFBhcmFtLmZyZWV6ZUJhY2tbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZihvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwOyBuIDwgdGhpcy5za2lsbFBhcmFtLmZyZWV6ZUVuZW15QXRrQWRkUGFyYW0ubGVuZ3RoOyBuKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IHRoaXMuc2tpbGxQYXJhbS5mcmVlemVFbmVteUF0a0FkZFBhcmFtO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkFMTF9BVEtfQURELFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogc1tuXVswXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHNbbl1bMV1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc3VmZmVyRGVidWZmKGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS5mcmVlemVUaW1lID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG8gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuRlJFRVpFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogdGhpcy5za2lsbFBhcmFtLmZyZWV6ZVRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZihvKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICgwID09PSB0aGlzLmN1cnJQZW5ldHJhdGVMYXllciAmJiB0aGlzLnNraWxsUGFyYW0uZnJlZXplU3BsaXRDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVNwbGl0QnV0dGxlKGkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCEoMjkgIT09IGkuY29uZmlnLmlkICYmIDMwICE9PSBpLmNvbmZpZy5pZCAmJiAzNiAhPT0gaS5jb25maWcuaWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyUGVuZXRyYXRlTGF5ZXIgPSB0aGlzLnNraWxsUGFyYW0uZnJlZXplUGVuZXRyYXRlTGF5ZXI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJQZW5ldHJhdGVMYXllcisrO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS5mcmVlemVQZW5ldHJhdGVMYXllciA8PSB0aGlzLmN1cnJQZW5ldHJhdGVMYXllcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNVc2UgPSAhMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGYoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuY3JlYXRlU3BsaXRCdXR0bGUgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXROZWFyYnlOMih0Lm5vZGUsIHRoaXMuc2tpbGxQYXJhbS5mcmVlemVTcGxpdENvdW50KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbyA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUudGhlcm1vYmFyaWNfc3BsaXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfOFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgKG8gPSAkcmVzVXRpbC5SZXNVdGlsLmluc3RhbnRpYXRlKG4pLmdldENvbXBvbmVudCgkYmFzZUJ1bGxldC5kZWZhdWx0KSkuc2tpbGxTcGVjaWFsaXR5cyA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQodGhpcy5za2lsbElkKS5za2lsbF90cHllO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgby5zZXRQb3NpdGlvbih0aGlzLm5vZGUucG9zaXRpb24uY2xvbmUoKSk7XHJcbiAgICAgICAgICAgICAgICBvLmluaXRCdXR0bGUoZVtpXS5ub2RlLnBvc2l0aW9uLnN1Yih0aGlzLm5vZGUucG9zaXRpb24pLm5vcm1hbGl6ZSgpLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICAgICAgby50YXJnZXRFbmVteSA9IHQ7XHJcbiAgICAgICAgICAgICAgICBvLmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5jaGVja0JvdW5kYXJ5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuc2tpbGxQYXJhbS5mcmVlemVJc1JlZmxlY3QpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0LnByb3RvdHlwZS5jaGVja0JvdW5kYXJ5LmNhbGwodGhpcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGUgPSBjYy53aW5TaXplLndpZHRoIC8gMjtcclxuICAgICAgICAgICAgdmFyIGkgPSBjYy53aW5TaXplLmhlaWdodCAvIDI7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS54IDw9IC1lXHJcbiAgICAgICAgICAgICAgICA/ICgodGhpcy52ZWxvY2l0eS54ID0gTWF0aC5hYnModGhpcy52ZWxvY2l0eS54KSksXHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QW5nbGUoJHV0aWwuZGVmYXVsdC5kaXJDb252ZXJBbmdsZSh0aGlzLnZlbG9jaXR5KSkpXHJcbiAgICAgICAgICAgICAgICA6IHRoaXMubm9kZS54ID49IGUgJiZcclxuICAgICAgICAgICAgICAgICAgKCh0aGlzLnZlbG9jaXR5LnggPSAtTWF0aC5hYnModGhpcy52ZWxvY2l0eS54KSksXHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QW5nbGUoJHV0aWwuZGVmYXVsdC5kaXJDb252ZXJBbmdsZSh0aGlzLnZlbG9jaXR5KSkpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5ub2RlLnkgPj0gaSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS55ID0gLU1hdGguYWJzKHRoaXMudmVsb2NpdHkueSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEFuZ2xlKCR1dGlsLmRlZmF1bHQuZGlyQ29udmVyQW5nbGUodGhpcy52ZWxvY2l0eSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAhKHRoaXMubm9kZS55IDw9IC1jYy53aW5TaXplLmhlaWdodCAvIDIgLSAxMDApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIF9fZGVjb3JhdGUoW2ddLCBlKTtcclxuICAgIH0pKCRiYXNlQnVsbGV0LmRlZmF1bHQpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gXztcclxuIl19