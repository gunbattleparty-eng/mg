
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_30.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e2c21ZV8PJOlIixfSCJFMNr', 'Bullet_30');
// game_script/scripts/Bullet_30.js

"use strict";

var o;

var $object = require("./Object");

var $shape = require("./Shape");

var $countDownUtil = require("./CountDownUtil");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseBullet = require("./BaseBullet");

var p = cc._decorator;
var f = p.ccclass;
var h = (p.property, cc.Vec3.ZERO);

var m = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.drat_release;
    e._type = $shape.ShapeType.Sphere;
    e.isStop = !1;
    e.countTime = 0;
    e.time = 0;
    e.leftTime = 0;
    e.r = 70;
    e.countSpeed = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.isStop = !1;
    this.speed = 0;
    this.countSpeed = 1.6 * this.skillParam.speed[$gameSkillInfo.Skill4Param.FINAL];
    var o = this.skillParam.releaseSize;
    this.setScale(cc.v3(o, o));
    this.r = 70 * o;
    this.countTime = this.skillParam.releaseDistance / this.countSpeed;
    this.time = 0;
    this.leftTime = this.skillParam.releaseTime;
    this.atk = this.skillParam.releaseAtk[$gameSkillInfo.Skill4Param.FINAL];
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse && e == $object.Trigger.stay) {
      var i = t.object;

      if ($countDownUtil.CountDownUtil.time - i.getLastAtkTime(9) <= this.skillParam.releaseInterval / $gameContext["default"].ins.gameRatio) {
        return;
      }

      i.setLastAtkTime(9, $countDownUtil.CountDownUtil.time);
      i.sufferAtk({
        id: this.skillId,
        skillSpecialitys: this.skillSpecialitys,
        atk: this.atk
      });
    }
  };

  e.prototype.updateFrame = function (t) {
    if (!this.isUse) {
      this.leftTime -= t;

      if (this.leftTime <= 0) {
        this.isUse = !0;
        this.removeSelf();
      }

      if (!this.isStop) {
        this.time += t;

        if (this.time >= this.countTime) {
          this.isStop = !0;
        }

        this.move(t);
      }
    }
  };

  e.prototype.move = function (t) {
    this.speed = this.easeCos(this.time, 0, this.countSpeed, this.countTime);
    var e = this.getPosition();
    var i = this.velocity;
    h.x = e.x + i.x * t * this.speed;
    h.y = e.y + i.y * t * this.speed;
    h.z = e.z + i.z * t * this.speed;
    h.x < -360 + this.r || h.x > 360 - this.r ? (h.x = e.x, this.isStop = !0) : (h.y < -450 + this.r || h.y > cc.winSize.height / 2 - this.r) && (h.y = e.y, this.isStop = !0);
    this.setPosition(h);
  };

  e.prototype.easeCos = function (t, e, i, o) {
    return i * Math.cos(t / o * Math.PI / 2) + e;
  };

  return __decorate([f], e);
}($baseBullet["default"]);

exports["default"] = m;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8zMC5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkc2hhcGUiLCIkY291bnREb3duVXRpbCIsIiRnYW1lQ29udGV4dCIsIiRnYW1lU2tpbGxJbmZvIiwiJGJhc2VCdWxsZXQiLCJwIiwiY2MiLCJfZGVjb3JhdG9yIiwiZiIsImNjY2xhc3MiLCJoIiwicHJvcGVydHkiLCJWZWMzIiwiWkVSTyIsIm0iLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYnV0dGxlVHlwZSIsIkJ1bGxldFR5cGUiLCJkcmF0X3JlbGVhc2UiLCJfdHlwZSIsIlNoYXBlVHlwZSIsIlNwaGVyZSIsImlzU3RvcCIsImNvdW50VGltZSIsInRpbWUiLCJsZWZ0VGltZSIsInIiLCJjb3VudFNwZWVkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEJ1dHRsZSIsImkiLCJjYWxsIiwic3BlZWQiLCJza2lsbFBhcmFtIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsInJlbGVhc2VTaXplIiwic2V0U2NhbGUiLCJ2MyIsInJlbGVhc2VEaXN0YW5jZSIsInJlbGVhc2VUaW1lIiwiYXRrIiwicmVsZWFzZUF0ayIsIm9uVHJpZ2dlciIsImlzVXNlIiwiVHJpZ2dlciIsInN0YXkiLCJvYmplY3QiLCJDb3VudERvd25VdGlsIiwiZ2V0TGFzdEF0a1RpbWUiLCJyZWxlYXNlSW50ZXJ2YWwiLCJpbnMiLCJnYW1lUmF0aW8iLCJzZXRMYXN0QXRrVGltZSIsInN1ZmZlckF0ayIsImlkIiwic2tpbGxJZCIsInNraWxsU3BlY2lhbGl0eXMiLCJ1cGRhdGVGcmFtZSIsInJlbW92ZVNlbGYiLCJtb3ZlIiwiZWFzZUNvcyIsImdldFBvc2l0aW9uIiwidmVsb2NpdHkiLCJ4IiwieSIsInoiLCJ3aW5TaXplIiwiaGVpZ2h0Iiwic2V0UG9zaXRpb24iLCJNYXRoIiwiY29zIiwiUEkiLCJfX2RlY29yYXRlIiwiZXhwb3J0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Q0FBQyxDQUFDcUQsQ0FBVCxFQUFjLEtBQUs1QyxNQUFMLEdBQWMsQ0FBQyxDQUEvRixDQUZOO0lBR0EsS0FBS2dELFdBQUwsQ0FBaUIvRCxDQUFqQjtFQUNILENBWEQ7O0VBWUFNLENBQUMsQ0FBQ2dCLFNBQUYsQ0FBWWlDLE9BQVosR0FBc0IsVUFBVWxELENBQVYsRUFBYUMsQ0FBYixFQUFnQmtCLENBQWhCLEVBQW1CckMsQ0FBbkIsRUFBc0I7SUFDeEMsT0FBT3FDLENBQUMsR0FBR3dDLElBQUksQ0FBQ0MsR0FBTCxDQUFXNUQsQ0FBQyxHQUFHbEIsQ0FBTCxHQUFVNkUsSUFBSSxDQUFDRSxFQUFoQixHQUFzQixDQUEvQixDQUFKLEdBQXdDNUQsQ0FBL0M7RUFDSCxDQUZEOztFQUdBLE9BQU82RCxVQUFVLENBQUMsQ0FBQ3JFLENBQUQsQ0FBRCxFQUFNUSxDQUFOLENBQWpCO0FBQ0gsQ0E1RU8sQ0E0RUxaLFdBQVcsV0E1RU4sQ0FBUjs7QUE2RUEwRSxPQUFPLFdBQVAsR0FBa0JoRSxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkb2JqZWN0ID0gcmVxdWlyZShcIi4vT2JqZWN0XCIpO1xyXG52YXIgJHNoYXBlID0gcmVxdWlyZShcIi4vU2hhcGVcIik7XHJcbnZhciAkY291bnREb3duVXRpbCA9IHJlcXVpcmUoXCIuL0NvdW50RG93blV0aWxcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyIHAgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgZiA9IHAuY2NjbGFzcztcclxudmFyIGggPSAocC5wcm9wZXJ0eSwgY2MuVmVjMy5aRVJPKTtcclxudmFyIG0gPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5idXR0bGVUeXBlID0gJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5kcmF0X3JlbGVhc2U7XHJcbiAgICAgICAgZS5fdHlwZSA9ICRzaGFwZS5TaGFwZVR5cGUuU3BoZXJlO1xyXG4gICAgICAgIGUuaXNTdG9wID0gITE7XHJcbiAgICAgICAgZS5jb3VudFRpbWUgPSAwO1xyXG4gICAgICAgIGUudGltZSA9IDA7XHJcbiAgICAgICAgZS5sZWZ0VGltZSA9IDA7XHJcbiAgICAgICAgZS5yID0gNzA7XHJcbiAgICAgICAgZS5jb3VudFNwZWVkID0gMDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSwgaSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmluaXRCdXR0bGUuY2FsbCh0aGlzLCBlLCBpKTtcclxuICAgICAgICB0aGlzLmlzU3RvcCA9ICExO1xyXG4gICAgICAgIHRoaXMuc3BlZWQgPSAwO1xyXG4gICAgICAgIHRoaXMuY291bnRTcGVlZCA9IDEuNiAqIHRoaXMuc2tpbGxQYXJhbS5zcGVlZFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgdmFyIG8gPSB0aGlzLnNraWxsUGFyYW0ucmVsZWFzZVNpemU7XHJcbiAgICAgICAgdGhpcy5zZXRTY2FsZShjYy52MyhvLCBvKSk7XHJcbiAgICAgICAgdGhpcy5yID0gNzAgKiBvO1xyXG4gICAgICAgIHRoaXMuY291bnRUaW1lID0gdGhpcy5za2lsbFBhcmFtLnJlbGVhc2VEaXN0YW5jZSAvIHRoaXMuY291bnRTcGVlZDtcclxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMubGVmdFRpbWUgPSB0aGlzLnNraWxsUGFyYW0ucmVsZWFzZVRpbWU7XHJcbiAgICAgICAgdGhpcy5hdGsgPSB0aGlzLnNraWxsUGFyYW0ucmVsZWFzZUF0a1skZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25UcmlnZ2VyID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNVc2UgJiYgZSA9PSAkb2JqZWN0LlRyaWdnZXIuc3RheSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAkY291bnREb3duVXRpbC5Db3VudERvd25VdGlsLnRpbWUgLSBpLmdldExhc3RBdGtUaW1lKDkpIDw9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0ucmVsZWFzZUludGVydmFsIC8gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdhbWVSYXRpb1xyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpLnNldExhc3RBdGtUaW1lKDksICRjb3VudERvd25VdGlsLkNvdW50RG93blV0aWwudGltZSk7XHJcbiAgICAgICAgICAgIGkuc3VmZmVyQXRrKHtcclxuICAgICAgICAgICAgICAgIGlkOiB0aGlzLnNraWxsSWQsXHJcbiAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiB0aGlzLnNraWxsU3BlY2lhbGl0eXMsXHJcbiAgICAgICAgICAgICAgICBhdGs6IHRoaXMuYXRrXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGcmFtZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzVXNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGVmdFRpbWUgLT0gdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMubGVmdFRpbWUgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc1VzZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzU3RvcCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lICs9IHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1lID49IHRoaXMuY291bnRUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1N0b3AgPSAhMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMubW92ZSh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5lYXNlQ29zKHRoaXMudGltZSwgMCwgdGhpcy5jb3VudFNwZWVkLCB0aGlzLmNvdW50VGltZSk7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzLmdldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdmFyIGkgPSB0aGlzLnZlbG9jaXR5O1xyXG4gICAgICAgIGgueCA9IGUueCArIGkueCAqIHQgKiB0aGlzLnNwZWVkO1xyXG4gICAgICAgIGgueSA9IGUueSArIGkueSAqIHQgKiB0aGlzLnNwZWVkO1xyXG4gICAgICAgIGgueiA9IGUueiArIGkueiAqIHQgKiB0aGlzLnNwZWVkO1xyXG4gICAgICAgIGgueCA8IC0zNjAgKyB0aGlzLnIgfHwgaC54ID4gMzYwIC0gdGhpcy5yXHJcbiAgICAgICAgICAgID8gKChoLnggPSBlLngpLCAodGhpcy5pc1N0b3AgPSAhMCkpXHJcbiAgICAgICAgICAgIDogKGgueSA8IC00NTAgKyB0aGlzLnIgfHwgaC55ID4gY2Mud2luU2l6ZS5oZWlnaHQgLyAyIC0gdGhpcy5yKSAmJiAoKGgueSA9IGUueSksICh0aGlzLmlzU3RvcCA9ICEwKSk7XHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbihoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5lYXNlQ29zID0gZnVuY3Rpb24gKHQsIGUsIGksIG8pIHtcclxuICAgICAgICByZXR1cm4gaSAqIE1hdGguY29zKCgodCAvIG8pICogTWF0aC5QSSkgLyAyKSArIGU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2ZdLCBlKTtcclxufSkoJGJhc2VCdWxsZXQuZGVmYXVsdCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IG07XHJcbiJdfQ==