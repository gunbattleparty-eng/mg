{"version":3,"sources":["assets\\game_script\\scripts\\Body.js"],"names":["exports","cBody","$object","require","n","cc","Mat3","s","Quat","Vec3","r","t","id","mask","group","shape","object","priority","isDirty","lower","upper","aabb","isRemove","isRetrieve","isIdentity","inCollider","raidus","points","center","rotMat3","halfSize","scale","isAgent","maxNeighbors","neighborDist","maxVelocity","newVelocity","prefVelocity","orcaLines","prototype","updateBound","Dirty","NON","e","i","velocity","x","y","a","S","l","getScale","z","R","getRotation","w","updateAABB","getRotMat3","c","u","d","getPosition","clear","length","worldScale","worldPosition","worldRotation","worldRotatioMat3","getCenter","getRaidus","radius","Math","max","getHalfSize","size","getPoints","m","o","point2Ds","Vec2"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.cBody = void 0;\r\nvar $object = require(\"./Object\");\r\nvar n = cc.Mat3;\r\nvar s = (cc.Quat, cc.Vec3);\r\nvar r = (function () {\r\n    function t(t) {\r\n        this.id = 0;\r\n        this.mask = 0;\r\n        this.group = 0;\r\n        this.shape = null;\r\n        this.object = null;\r\n        this.priority = 0;\r\n        this.isDirty = 15;\r\n        this.lower = 0;\r\n        this.upper = 0;\r\n        this.aabb = [0, 0, 0, 0, 0, 0];\r\n        this.isRemove = !1;\r\n        this.isRetrieve = !1;\r\n        this.isIdentity = !1;\r\n        this.inCollider = !1;\r\n        this.raidus = 0;\r\n        this.points = [];\r\n        this.center = new s();\r\n        this.rotMat3 = new n();\r\n        this.halfSize = new s();\r\n        this.scale = new s(1, 1, 1);\r\n        this.isAgent = !1;\r\n        this.maxNeighbors = 0;\r\n        this.neighborDist = 0;\r\n        this.maxVelocity = 0;\r\n        this.newVelocity = new s();\r\n        this.prefVelocity = new s();\r\n        this.orcaLines = [];\r\n        this.object = t;\r\n    }\r\n    t.prototype.updateBound = function (t) {\r\n        if (void 0 === t) {\r\n            t = $object.Dirty.NON;\r\n        }\r\n        var e;\r\n        var i = this.object;\r\n        var n = t | i.isDirty;\r\n        if (this.isAgent) {\r\n            var s = i.velocity;\r\n            this.newVelocity.x = s.x;\r\n            this.newVelocity.y = s.y;\r\n        }\r\n        if (n > 0) {\r\n            var r = !1;\r\n            var a = this.shape;\r\n            if (n & $object.Dirty.S) {\r\n                r = !0;\r\n                var l = this.getScale();\r\n                this.scale.x = l.x >= 0 ? l.x : -l.x;\r\n                this.scale.y = l.y >= 0 ? l.y : -l.y;\r\n                this.scale.z = l.z >= 0 ? l.z : -l.z;\r\n            }\r\n            if (n & $object.Dirty.R) {\r\n                this.isIdentity = 0 == (e = this.getRotation()).x && 0 == e.y && 0 == e.z && 1 == e.w;\r\n                r = !0;\r\n            }\r\n            if (r) {\r\n                a.updateAABB(this.getScale(), this.getRotMat3(), this.isIdentity);\r\n            }\r\n            var c = this.aabb;\r\n            var u = a.aabb;\r\n            var d = this.getPosition();\r\n            c[0] = u[0] + d.x;\r\n            c[1] = u[1] + d.y;\r\n            c[2] = u[2] + d.z;\r\n            c[3] = u[3] + d.x;\r\n            c[4] = u[4] + d.y;\r\n            c[5] = u[5] + d.z;\r\n            this.isDirty = 15;\r\n            i.isDirty = $object.Dirty.NON;\r\n            return !0;\r\n        }\r\n        return !1;\r\n    };\r\n    t.prototype.clear = function () {\r\n        this.shape = null;\r\n        this.object = null;\r\n        this.isRemove = !1;\r\n        this.inCollider = !1;\r\n        this.orcaLines.length = 0;\r\n    };\r\n    t.prototype.getScale = function () {\r\n        return this.object.worldScale;\r\n    };\r\n    t.prototype.getPosition = function () {\r\n        return this.object.worldPosition;\r\n    };\r\n    t.prototype.getRotation = function () {\r\n        return this.object.worldRotation;\r\n    };\r\n    t.prototype.getRotMat3 = function () {\r\n        return this.object.worldRotatioMat3;\r\n    };\r\n    t.prototype.getCenter = function () {\r\n        if (1 & this.isDirty) {\r\n            this.isDirty &= -2;\r\n            var t = this.aabb;\r\n            var e = this.center;\r\n            e.x = 0.5 * (t[0] + t[3]);\r\n            e.y = 0.5 * (t[1] + t[4]);\r\n            e.z = 0.5 * (t[2] + t[5]);\r\n        }\r\n        return this.center;\r\n    };\r\n    t.prototype.getRaidus = function () {\r\n        if (2 & this.isDirty) {\r\n            this.isDirty &= -3;\r\n            var t = this.scale;\r\n            var e = this.shape.radius;\r\n            this.raidus = Math.max(t.x, t.y, t.z) * e;\r\n        }\r\n        return this.raidus;\r\n    };\r\n    t.prototype.getHalfSize = function () {\r\n        if (4 & this.isDirty) {\r\n            this.isDirty &= -5;\r\n            var t = this.scale;\r\n            var e = this.shape.size;\r\n            var i = this.halfSize;\r\n            i.x = t.x * e.x * 0.5;\r\n            i.y = t.y * e.y * 0.5;\r\n            i.z = t.z * e.z * 0.5;\r\n        }\r\n        return this.halfSize;\r\n    };\r\n    t.prototype.getPoints = function () {\r\n        if (8 & this.isDirty) {\r\n            this.isDirty &= -9;\r\n            var t = this.scale;\r\n            var e = this.getRotMat3().m;\r\n            var i = this.getCenter();\r\n            var o = this.points;\r\n            var n = this.shape.point2Ds;\r\n            var s = n.length;\r\n            for (var r = 0; r < s; r++) {\r\n                var a = n[r].x * t.x;\r\n                var l = n[r].y * t.y;\r\n                if (null == o[r]) {\r\n                    o[r] = new cc.Vec2();\r\n                }\r\n                o[r].x = a * e[0] + l * e[3] + 0 * e[6] + i.x;\r\n                o[r].y = a * e[1] + l * e[4] + 0 * e[7] + i.y;\r\n            }\r\n            o.length = s;\r\n        }\r\n        return this.points;\r\n    };\r\n    return t;\r\n})();\r\nexports.cBody = r;\r\n"]}