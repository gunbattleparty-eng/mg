
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_26.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '4dfdcNkgK9GHrl3po+vYf6p', 'Bullet_26');
// game_script/scripts/Bullet_26.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $countDownUtil = require("./CountDownUtil");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var m = cc._decorator;
var y = m.ccclass;
var g = (m.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.oil_burn_area;
    e.leftTime = 0;
    e.attackEnemy = new Set();
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    var o = this.skillParam.oilBurnAreaRange[$gameSkillInfo.Skill4Param.FINAL];
    this.setScale(cc.v3(o, o));
    this.atk = this.skillParam.oilBurnAreaAtk[$gameSkillInfo.Skill4Param.FINAL];
    this.leftTime = this.skillParam.oilBurnAreaTime;
    this.node.children[0].children[0].active = 1 === this.skillParam.oilSkin;
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse) {
      if (e == $object.Trigger.enter || e == $object.Trigger.stay) {
        var i = t.object;

        if (!(!this.skillParam.oilNoRecover || this.attackEnemy.has(i) && i.hasDebuff($enemyStatus.EnemyDebuffType.FORBID_RECOVER))) {
          this.attackEnemy.add(i);
          i.sufferDebuff({
            type: $enemyStatus.EnemyDebuffType.FORBID_RECOVER,
            timeLeft: -1,
            value: 0
          });
        }

        if ($countDownUtil.CountDownUtil.time - i.getLastAtkTime(6) <= this.skillParam.oilBurnAreaInterval / $gameContext["default"].ins.gameRatio) {
          return;
        }

        i.setLastAtkTime(6, $countDownUtil.CountDownUtil.time);
        this.skillParam.oilLiftAtkAdd > 0 ? i.sufferAtk({
          id: this.skillId,
          skillSpecialitys: this.skillSpecialitys,
          atk: this.atk,
          bulletBuff: $baseBullet.BulletBuff.atk_life,
          value: this.skillParam.oilLiftAtkAdd
        }) : i.sufferAtk({
          id: this.skillId,
          skillSpecialitys: this.skillSpecialitys,
          atk: this.atk
        });

        if (this.skillParam.oilBurnAreaSlow < 0) {
          i.sufferDebuff({
            type: $enemyStatus.EnemyDebuffType.SLOW,
            timeLeft: this.skillParam.oilBurnAreaInterval + 0.1,
            value: this.skillParam.oilBurnAreaSlow
          });
        }
      } else {
        if (e == $object.Trigger.exit) {
          i = t.object;
          this.attackEnemy["delete"](i);
          i.removeDebuff($enemyStatus.EnemyDebuffType.FORBID_RECOVER);
        }
      }
    }
  };

  e.prototype.updateFrame = function (t) {
    if (!this.isUse) {
      this.leftTime -= t;

      if (this.leftTime <= 0) {
        this.isUse = !0;
        this.createBoom();
        this.attackEnemy.forEach(function (t) {
          t.removeDebuff($enemyStatus.EnemyDebuffType.FORBID_RECOVER);
        });
        this.attackEnemy.clear();
        this.removeSelf();
      }
    }
  };

  e.prototype.createBoom = function () {
    if (!(this.skillParam.oilBurnAreaBoomRange <= 0)) {
      var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.oil_burn_area_boom);

      if (!t) {
        var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_27);
        (t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = this.skillSpecialitys;
      }

      t.setPosition(this.getPosition());
      t.initButtle(null, this.skillId);
      t.insert($gameContext["default"].ins.lowBulletLayer);
      t.setAnimation(null);
    }
  };

  return __decorate([y], e);
}($baseBullet["default"]));
exports["default"] = g;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8yNi5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkYXNzZXRzTG9hZGVyIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGNvdW50RG93blV0aWwiLCIkZ2FtZUNvbnRleHQiLCIkZ2FtZVNraWxsSW5mbyIsIiRlbmVteVN0YXR1cyIsIiRiYXNlQnVsbGV0IiwibSIsImNjIiwiX2RlY29yYXRvciIsInkiLCJjY2NsYXNzIiwiZyIsInByb3BlcnR5IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsImJ1dHRsZVR5cGUiLCJCdWxsZXRUeXBlIiwib2lsX2J1cm5fYXJlYSIsImxlZnRUaW1lIiwiYXR0YWNrRW5lbXkiLCJTZXQiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0QnV0dGxlIiwiaSIsImNhbGwiLCJza2lsbFBhcmFtIiwib2lsQnVybkFyZWFSYW5nZSIsIlNraWxsNFBhcmFtIiwiRklOQUwiLCJzZXRTY2FsZSIsInYzIiwiYXRrIiwib2lsQnVybkFyZWFBdGsiLCJvaWxCdXJuQXJlYVRpbWUiLCJub2RlIiwiY2hpbGRyZW4iLCJhY3RpdmUiLCJvaWxTa2luIiwib25UcmlnZ2VyIiwiaXNVc2UiLCJUcmlnZ2VyIiwiZW50ZXIiLCJzdGF5Iiwib2JqZWN0Iiwib2lsTm9SZWNvdmVyIiwiaGFzIiwiaGFzRGVidWZmIiwiRW5lbXlEZWJ1ZmZUeXBlIiwiRk9SQklEX1JFQ09WRVIiLCJhZGQiLCJzdWZmZXJEZWJ1ZmYiLCJ0eXBlIiwidGltZUxlZnQiLCJ2YWx1ZSIsIkNvdW50RG93blV0aWwiLCJ0aW1lIiwiZ2V0TGFzdEF0a1RpbWUiLCJvaWxCdXJuQXJlYUludGVydmFsIiwiaW5zIiwiZ2FtZVJhdGlvIiwic2V0TGFzdEF0a1RpbWUiLCJvaWxMaWZ0QXRrQWRkIiwic3VmZmVyQXRrIiwiaWQiLCJza2lsbElkIiwic2tpbGxTcGVjaWFsaXR5cyIsImJ1bGxldEJ1ZmYiLCJCdWxsZXRCdWZmIiwiYXRrX2xpZmUiLCJvaWxCdXJuQXJlYVNsb3ciLCJTTE9XIiwiZXhpdCIsInJlbW92ZURlYnVmZiIsInVwZGF0ZUZyYW1lIiwiY3JlYXRlQm9vbSIsImZvckVhY2giLCJjbGVhciIsInJlbW92ZVNlbGYiLCJvaWxCdXJuQXJlYUJvb21SYW5nZSIsImdldEJ1dHRsZVBvb2wiLCJvaWxfYnVybl9hcmVhX2Jvb20iLCJpbnN0YW5jZSIsImdldFJlcyIsIkJ1bmRsZU5hbWVzIiwiR2FtZSIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJCdWxsZXRfMjciLCJSZXNVdGlsIiwiaW5zdGFudGlhdGUiLCJsb3dCdWxsZXRMYXllciIsInBhcmVudCIsImdldENvbXBvbmVudCIsInNldFBvc2l0aW9uIiwiZ2V0UG9zaXRpb24iLCJpbnNlcnQiLCJzZXRBbmltYXRpb24iLCJfX2RlY29yYXRlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHRCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUUsVUFBVSxHQUFHRixPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRyxRQUFRLEdBQUdILE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlJLGNBQWMsR0FBR0osT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlLLFlBQVksR0FBR0wsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSU0sY0FBYyxHQUFHTixPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSU8sWUFBWSxHQUFHUCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJUSxXQUFXLEdBQUdSLE9BQU8sQ0FBQyxjQUFELENBQXpCOztBQUNBLElBQUlTLENB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N0IsRUFBZ0NaLFlBQVksV0FBWixDQUFxQjJELEdBQXJCLENBQXlCa0MsY0FBekIsQ0FBd0NDLE1BQXhFLEVBQWdGQyxZQUFoRixDQUNENUYsV0FBVyxXQURWLENBQUwsRUFFRytELGdCQUZILEdBRXNCLEtBQUtBLGdCQUYzQjtNQUdIOztNQUNEdkQsQ0FBQyxDQUFDcUYsV0FBRixDQUFjLEtBQUtDLFdBQUwsRUFBZDtNQUNBdEYsQ0FBQyxDQUFDWSxVQUFGLENBQWEsSUFBYixFQUFtQixLQUFLMEMsT0FBeEI7TUFDQXRELENBQUMsQ0FBQ3VGLE1BQUYsQ0FBU2xHLFlBQVksV0FBWixDQUFxQjJELEdBQXJCLENBQXlCa0MsY0FBbEM7TUFDQWxGLENBQUMsQ0FBQ3dGLFlBQUYsQ0FBZSxJQUFmO0lBQ0g7RUFDSixDQWpCRDs7RUFrQkEsT0FBT0MsVUFBVSxDQUFDLENBQUM3RixDQUFELENBQUQsRUFBTUssQ0FBTixDQUFqQjtBQUNILENBdkdELENBdUdHVCxXQUFXLFdBdkdkLENBRkMsQ0FBTDtBQTBHQWtHLE9BQU8sV0FBUCxHQUFrQjVGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRvYmplY3QgPSByZXF1aXJlKFwiLi9PYmplY3RcIik7XHJcbnZhciAkYXNzZXRzTG9hZGVyID0gcmVxdWlyZShcIi4vQXNzZXRzTG9hZGVyXCIpO1xyXG52YXIgJGFzc2V0c01hcCA9IHJlcXVpcmUoXCIuL0Fzc2V0c01hcFwiKTtcclxudmFyICRyZXNVdGlsID0gcmVxdWlyZShcIi4vUmVzVXRpbFwiKTtcclxudmFyICRjb3VudERvd25VdGlsID0gcmVxdWlyZShcIi4vQ291bnREb3duVXRpbFwiKTtcclxudmFyICRnYW1lQ29udGV4dCA9IHJlcXVpcmUoXCIuL0dhbWVDb250ZXh0XCIpO1xyXG52YXIgJGdhbWVTa2lsbEluZm8gPSByZXF1aXJlKFwiLi9HYW1lU2tpbGxJbmZvXCIpO1xyXG52YXIgJGVuZW15U3RhdHVzID0gcmVxdWlyZShcIi4vRW5lbXlTdGF0dXNcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciBtID0gY2MuX2RlY29yYXRvcjtcclxudmFyIHkgPSBtLmNjY2xhc3M7XHJcbnZhciBnID1cclxuICAgIChtLnByb3BlcnR5LFxyXG4gICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgICAgIGUuYnV0dGxlVHlwZSA9ICRiYXNlQnVsbGV0LkJ1bGxldFR5cGUub2lsX2J1cm5fYXJlYTtcclxuICAgICAgICAgICAgZS5sZWZ0VGltZSA9IDA7XHJcbiAgICAgICAgICAgIGUuYXR0YWNrRW5lbXkgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgICAgIHJldHVybiBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICAgICAgZS5wcm90b3R5cGUuaW5pdEJ1dHRsZSA9IGZ1bmN0aW9uIChlLCBpKSB7XHJcbiAgICAgICAgICAgIHQucHJvdG90eXBlLmluaXRCdXR0bGUuY2FsbCh0aGlzLCBlLCBpKTtcclxuICAgICAgICAgICAgdmFyIG8gPSB0aGlzLnNraWxsUGFyYW0ub2lsQnVybkFyZWFSYW5nZVskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgICAgIHRoaXMuc2V0U2NhbGUoY2MudjMobywgbykpO1xyXG4gICAgICAgICAgICB0aGlzLmF0ayA9IHRoaXMuc2tpbGxQYXJhbS5vaWxCdXJuQXJlYUF0a1skZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgICAgIHRoaXMubGVmdFRpbWUgPSB0aGlzLnNraWxsUGFyYW0ub2lsQnVybkFyZWFUaW1lO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uYWN0aXZlID0gMSA9PT0gdGhpcy5za2lsbFBhcmFtLm9pbFNraW47XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5vblRyaWdnZXIgPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNVc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5lbnRlciB8fCBlID09ICRvYmplY3QuVHJpZ2dlci5zdGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSB0Lm9iamVjdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5za2lsbFBhcmFtLm9pbE5vUmVjb3ZlciB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMuYXR0YWNrRW5lbXkuaGFzKGkpICYmIGkuaGFzRGVidWZmKCRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuRk9SQklEX1JFQ09WRVIpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNrRW5lbXkuYWRkKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkZPUkJJRF9SRUNPVkVSLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZUxlZnQ6IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50RG93blV0aWwuQ291bnREb3duVXRpbC50aW1lIC0gaS5nZXRMYXN0QXRrVGltZSg2KSA8PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0ub2lsQnVybkFyZWFJbnRlcnZhbCAvICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nYW1lUmF0aW9cclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpLnNldExhc3RBdGtUaW1lKDYsICRjb3VudERvd25VdGlsLkNvdW50RG93blV0aWwudGltZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLm9pbExpZnRBdGtBZGQgPiAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiB0aGlzLnNraWxsU3BlY2lhbGl0eXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0azogdGhpcy5hdGssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGxldEJ1ZmY6ICRiYXNlQnVsbGV0LkJ1bGxldEJ1ZmYuYXRrX2xpZmUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnNraWxsUGFyYW0ub2lsTGlmdEF0a0FkZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiB0aGlzLnNraWxsU3BlY2lhbGl0eXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0azogdGhpcy5hdGtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLm9pbEJ1cm5BcmVhU2xvdyA8IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zdWZmZXJEZWJ1ZmYoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5TTE9XLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZUxlZnQ6IHRoaXMuc2tpbGxQYXJhbS5vaWxCdXJuQXJlYUludGVydmFsICsgMC4xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2tpbGxQYXJhbS5vaWxCdXJuQXJlYVNsb3dcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZSA9PSAkb2JqZWN0LlRyaWdnZXIuZXhpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpID0gdC5vYmplY3Q7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNrRW5lbXkuZGVsZXRlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnJlbW92ZURlYnVmZigkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkZPUkJJRF9SRUNPVkVSKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLnVwZGF0ZUZyYW1lID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzVXNlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxlZnRUaW1lIC09IHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0VGltZSA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1VzZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlQm9vbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNrRW5lbXkuZm9yRWFjaChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0LnJlbW92ZURlYnVmZigkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkZPUkJJRF9SRUNPVkVSKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dGFja0VuZW15LmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZUJvb20gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghKHRoaXMuc2tpbGxQYXJhbS5vaWxCdXJuQXJlYUJvb21SYW5nZSA8PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLm9pbF9idXJuX2FyZWFfYm9vbSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9ICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5nZXRSZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8yN1xyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgKHQgPSAkcmVzVXRpbC5SZXNVdGlsLmluc3RhbnRpYXRlKGUsICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllci5wYXJlbnQpLmdldENvbXBvbmVudChcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgICAgICkpLnNraWxsU3BlY2lhbGl0eXMgPSB0aGlzLnNraWxsU3BlY2lhbGl0eXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0LnNldFBvc2l0aW9uKHRoaXMuZ2V0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgICAgICB0LmluaXRCdXR0bGUobnVsbCwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgICAgIHQuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgICAgICAgICB0LnNldEFuaW1hdGlvbihudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIF9fZGVjb3JhdGUoW3ldLCBlKTtcclxuICAgIH0pKCRiYXNlQnVsbGV0LmRlZmF1bHQpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gZztcclxuIl19