
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_10.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a3489ksAdNLrbeKG5j/+nyb', 'Gun_10');
// game_script/scripts/Gun_10.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameGemInfo = require("./GameGemInfo");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseGun = require("./BaseGun");

var _ = (cc.Vec3.ZERO, function (t) {
  function e(e) {
    var i = t.call(this, e) || this;
    i.skillId = 227;
    i.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(i.skillId);
    return i;
  }

  __extends(e, t);

  e.prototype.updateF = function (e) {
    t.prototype.updateF.call(this, e);

    if (!(this.isAttacking || $globalParam["default"].isGamePuase)) {
      this.timeLeft -= e;
      this.timeLeft <= 0 ? (this.isAttacking = !0, this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0, -1), this.starGun() || (this.isAttacking = !1, this.timeLeft = 0)) : $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1);
    }
  };

  e.prototype.starGun = function () {
    var t = this;
    var e = this.skillParam.oilCount;

    if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) && $seedUtil["default"].probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))) {
      e += 1;
    }

    var i = $gameContext["default"].ins.getRandomEnemys(this.pointNode, e, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);

    if (i.length <= 0) {
      return !1;
    }

    var o = function o(e) {
      n.schedulesOnce(function () {
        t.sendButtle(i[e].getPosition().clone(), i[e]);
      }, 0.1 * e);
    };

    var n = this;

    for (var s = 0; s < i.length; s++) {
      o(s);
    }

    this.isAttacking = !1;
    return !0;
  };

  e.prototype.sendButtle = function (t, e) {
    var i = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.oil);

    if (!i) {
      var o = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_24);
      (i = $resUtil.ResUtil.instantiate(o, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    i.targetPos = t;
    i.targetEnemy = e;
    var n = $gameContext["default"].ins.buttleLayer.convertToNodeSpaceAR(this.pointNode.convertToWorldSpaceAR(cc.Vec3.ZERO));
    i.setPosition(n);
    var l = t.sub(n).normalize();
    i.initButtle(l, this.skillId);
    i.insert($gameContext["default"].ins.buttleLayer);
  };

  return e;
}($baseGun["default"]));

exports["default"] = _;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl8xMC5qcyJdLCJuYW1lcyI6WyJvIiwiJGFzc2V0c0xvYWRlciIsInJlcXVpcmUiLCIkYXNzZXRzTWFwIiwiJHJlc1V0aWwiLCIkZXZlbnRNYW5hZ2VyIiwiJHNlZWRVdGlsIiwiJGNvbmZpZ0NvbnRleHQiLCIkZ2xvYmFsUGFyYW0iLCIkbG9jYWxFdmVudE5hbWUiLCIkYmFzZUJ1bGxldCIsIiRnYW1lQ29udGV4dCIsIiRnYW1lR2VtSW5mbyIsIiRnYW1lU2tpbGxJbmZvIiwiJGJhc2VHdW4iLCJfIiwiY2MiLCJWZWMzIiwiWkVSTyIsInQiLCJlIiwiaSIsImNhbGwiLCJza2lsbElkIiwic2tpbGxQYXJhbSIsImlucyIsInNraWxsSW5mbyIsImdldFNraWxsQnlJZCIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsInVwZGF0ZUYiLCJpc0F0dGFja2luZyIsImlzR2FtZVB1YXNlIiwidGltZUxlZnQiLCJza2lsbENEIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsInNlbmQiLCJSRU5ERVJfU0tJTExfQ0RfSU5GTyIsInN0YXJHdW4iLCJvaWxDb3VudCIsIkdhbWVHZW1JbmZvIiwiaGFzR2VtIiwiR2VtVHlwZSIsIkFkZFNraWxsIiwicHJvYmFiaWxpdHkiLCJnZXQxIiwiZ2V0UmFuZG9tRW5lbXlzIiwicG9pbnROb2RlIiwic2tpbGxBdGtSYW5nZSIsImxlbmd0aCIsIm4iLCJzY2hlZHVsZXNPbmNlIiwic2VuZEJ1dHRsZSIsImdldFBvc2l0aW9uIiwiY2xvbmUiLCJzIiwiZ2V0QnV0dGxlUG9vbCIsIkJ1bGxldFR5cGUiLCJvaWwiLCJpbnN0YW5jZSIsImdldFJlcyIsIkJ1bmRsZU5hbWVzIiwiR2FtZSIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJCdWxsZXRfMjQiLCJSZXNVdGlsIiwiaW5zdGFudGlhdGUiLCJidXR0bGVMYXllciIsInBhcmVudCIsImdldENvbXBvbmVudCIsInNraWxsU3BlY2lhbGl0eXMiLCJiYXNpY1NraWxsQ29uZmlnTWFwIiwiZ2V0Iiwic2tpbGxfdHB5ZSIsInRhcmdldFBvcyIsInRhcmdldEVuZW15IiwiY29udmVydFRvTm9kZVNwYWNlQVIiLCJjb252ZXJ0VG9Xb3JsZFNwYWNlQVIiLCJzZXRQb3NpdGlvbiIsImwiLCJzdWIiLCJub3JtYWxpemUiLCJpbml0QnV0dGxlIiwiaW5zZXJ0IiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlDLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUUsUUFBUSxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJRyxhQUFhLEdBQUdILE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJSSxTQUFTLEdBQUdKLE9BQU8sQ0FBQyxZQUFELENBQXZCOztBQUNBLElBQUlLLGNBQWMsR0FBR0wsT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlNLFlBQVksR0FBR04sT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSU8sZUFBZSxHQUFHUCxPQUFPLENBQUMsa0JBQUQsQ0FBN0I7O0FBQ0EsSUFBSVEsV0FBVyxHQUFHUixPQUFPLENBQUMsY0FBRCxDQUF6Qjs7QUFDQSxJQUFJUyxZQUFZLEdBQUdULE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlVLFlBQVksR0FBR1YsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSVcsY0FBYyxHQUFHWCxPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSVksUUFBUSxHQUFHWixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJYSxDQUFDLElBQ0FDLEVBQUUsQ0FBQ0MsSUFBSCxDQUFRQyxJQUFSLEVBQ0EsVUFBVUMsQ0FB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QUFXLFdBRFYsQ0FBTCxFQUVHZ0UsZ0JBRkgsR0FFc0JuRSxjQUFjLFdBQWQsQ0FBdUJxRCxRQUF2QixDQUFnQ2UsbUJBQWhDLENBQW9EQyxHQUFwRCxDQUF3RCxLQUFLckQsT0FBN0QsRUFBc0VzRCxVQUY1RjtJQUdIOztJQUNEeEQsQ0FBQyxDQUFDeUQsU0FBRixHQUFjM0QsQ0FBZDtJQUNBRSxDQUFDLENBQUMwRCxXQUFGLEdBQWdCM0QsQ0FBaEI7SUFDQSxJQUFJK0IsQ0FBQyxHQUFHeEMsWUFBWSxXQUFaLENBQXFCYyxHQUFyQixDQUF5QjhDLFdBQXpCLENBQXFDUyxvQkFBckMsQ0FDSixLQUFLaEMsU0FBTCxDQUFlaUMscUJBQWYsQ0FBcUNqRSxFQUFFLENBQUNDLElBQUgsQ0FBUUMsSUFBN0MsQ0FESSxDQUFSO0lBR0FHLENBQUMsQ0FBQzZELFdBQUYsQ0FBYy9CLENBQWQ7SUFDQSxJQUFJZ0MsQ0FBQyxHQUFHaEUsQ0FBQyxDQUFDaUUsR0FBRixDQUFNakMsQ0FBTixFQUFTa0MsU0FBVCxFQUFSO0lBQ0FoRSxDQUFDLENBQUNpRSxVQUFGLENBQWFILENBQWIsRUFBZ0IsS0FBSzVELE9BQXJCO0lBQ0FGLENBQUMsQ0FBQ2tFLE1BQUYsQ0FBUzVFLFlBQVksV0FBWixDQUFxQmMsR0FBckIsQ0FBeUI4QyxXQUFsQztFQUNILENBcEJEOztFQXFCQSxPQUFPbkQsQ0FBUDtBQUNILENBNUVELENBNEVHTixRQUFRLFdBNUVYLENBRkMsQ0FBTDs7QUErRUEwRSxPQUFPLFdBQVAsR0FBa0J6RSxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkYXNzZXRzTG9hZGVyID0gcmVxdWlyZShcIi4vQXNzZXRzTG9hZGVyXCIpO1xyXG52YXIgJGFzc2V0c01hcCA9IHJlcXVpcmUoXCIuL0Fzc2V0c01hcFwiKTtcclxudmFyICRyZXNVdGlsID0gcmVxdWlyZShcIi4vUmVzVXRpbFwiKTtcclxudmFyICRldmVudE1hbmFnZXIgPSByZXF1aXJlKFwiLi9FdmVudE1hbmFnZXJcIik7XHJcbnZhciAkc2VlZFV0aWwgPSByZXF1aXJlKFwiLi9TZWVkVXRpbFwiKTtcclxudmFyICRjb25maWdDb250ZXh0ID0gcmVxdWlyZShcIi4vQ29uZmlnQ29udGV4dFwiKTtcclxudmFyICRnbG9iYWxQYXJhbSA9IHJlcXVpcmUoXCIuL0dsb2JhbFBhcmFtXCIpO1xyXG52YXIgJGxvY2FsRXZlbnROYW1lID0gcmVxdWlyZShcIi4vTG9jYWxFdmVudE5hbWVcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lR2VtSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVHZW1JbmZvXCIpO1xyXG52YXIgJGdhbWVTa2lsbEluZm8gPSByZXF1aXJlKFwiLi9HYW1lU2tpbGxJbmZvXCIpO1xyXG52YXIgJGJhc2VHdW4gPSByZXF1aXJlKFwiLi9CYXNlR3VuXCIpO1xyXG52YXIgXyA9XHJcbiAgICAoY2MuVmVjMy5aRVJPLFxyXG4gICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZShlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gdC5jYWxsKHRoaXMsIGUpIHx8IHRoaXM7XHJcbiAgICAgICAgICAgIGkuc2tpbGxJZCA9IDIyNztcclxuICAgICAgICAgICAgaS5za2lsbFBhcmFtID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5nZXRTa2lsbEJ5SWQoaS5za2lsbElkKTtcclxuICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgICAgICBlLnByb3RvdHlwZS51cGRhdGVGID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUudXBkYXRlRi5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgICAgICBpZiAoISh0aGlzLmlzQXR0YWNraW5nIHx8ICRnbG9iYWxQYXJhbS5kZWZhdWx0LmlzR2FtZVB1YXNlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAtPSBlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCA8PSAwXHJcbiAgICAgICAgICAgICAgICAgICAgPyAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAodGhpcy50aW1lTGVmdCA9IHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZCgkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfU0tJTExfQ0RfSU5GTywgdGhpcy5za2lsbElkLCAwLCAtMSksXHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJHdW4oKSB8fCAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMSksICh0aGlzLnRpbWVMZWZ0ID0gMCkpKVxyXG4gICAgICAgICAgICAgICAgICAgIDogJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuUkVOREVSX1NLSUxMX0NEX0lORk8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZUxlZnQgLyB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLTFcclxuICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLnN0YXJHdW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnNraWxsUGFyYW0ub2lsQ291bnQ7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICRnYW1lR2VtSW5mby5HYW1lR2VtSW5mby5pbnMuaGFzR2VtKCRnYW1lR2VtSW5mby5HZW1UeXBlLkFkZFNraWxsKSAmJlxyXG4gICAgICAgICAgICAgICAgJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkoMTAwICogJGdhbWVHZW1JbmZvLkdhbWVHZW1JbmZvLmlucy5nZXQxKCRnYW1lR2VtSW5mby5HZW1UeXBlLkFkZFNraWxsKSlcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICBlICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGkgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UmFuZG9tRW5lbXlzKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb2ludE5vZGUsXHJcbiAgICAgICAgICAgICAgICBlLFxyXG4gICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrUmFuZ2VbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmIChpLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gITE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG8gPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgbi5zY2hlZHVsZXNPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LnNlbmRCdXR0bGUoaVtlXS5nZXRQb3NpdGlvbigpLmNsb25lKCksIGlbZV0pO1xyXG4gICAgICAgICAgICAgICAgfSwgMC4xICogZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBpLmxlbmd0aDsgcysrKSB7XHJcbiAgICAgICAgICAgICAgICBvKHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuaXNBdHRhY2tpbmcgPSAhMTtcclxuICAgICAgICAgICAgcmV0dXJuICEwO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuc2VuZEJ1dHRsZSA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5vaWwpO1xyXG4gICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8yNFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIChpID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShvLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKSkuc2tpbGxTcGVjaWFsaXR5cyA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQodGhpcy5za2lsbElkKS5za2lsbF90cHllO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGkudGFyZ2V0UG9zID0gdDtcclxuICAgICAgICAgICAgaS50YXJnZXRFbmVteSA9IGU7XHJcbiAgICAgICAgICAgIHZhciBuID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyLmNvbnZlcnRUb05vZGVTcGFjZUFSKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5wb2ludE5vZGUuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLlZlYzMuWkVSTylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaS5zZXRQb3NpdGlvbihuKTtcclxuICAgICAgICAgICAgdmFyIGwgPSB0LnN1YihuKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgaS5pbml0QnV0dGxlKGwsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgIGkuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH0pKCRiYXNlR3VuLmRlZmF1bHQpKTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gXztcclxuIl19