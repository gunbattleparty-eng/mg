{"version":3,"sources":["assets\\game_script\\scripts\\GemListItem.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$listItem","$popupManager","$configContext","$equipmentContext","$globalParam","h","cc","_decorator","m","ccclass","y","property","g","t","e","apply","arguments","gemIcon","partIcon","countLable","maskNode","lockNode","id","__extends","prototype","render","instance","loadRes","BundleNames","Public","part","grade","SpriteFrame","i","isValid","spriteFrame","ResUtil","assignWith","node","children","getComponent","Sprite","string","num","toString","gemConfigs","find","active","Ins","hasGemTypeByPart","SkillPool","isLock","start","on","Node","EventType","TOUCH_END","touchItem","currGemIdInfo","PopupManager","closeAll","open","AssetsMap","PopUpBundles","prefabs","assetsList","GemInfoView","gemId","__decorate","Label","exports"],"mappings":";;;;;;AAAA,IAAIA,CAAJ;;AACA,IAAIC,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIG,SAAS,GAAGH,OAAO,CAAC,YAAD,CAAvB;;AACA,IAAII,aAAa,GAAGJ,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIK,cAAc,GAAGL,OAAO,CAAC,iBAAD,CAA5B;;AACA,IAAIM,iBAAiB,GAAGN,OAAO,CAAC,oBAAD,CAA/B;;AACA,IAAIO,YAAY,GAAGP,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIQ,CAAC,GAAGC,EAAE,CAACC,UAAX;AACA,IAAIC,CAAC,GAAGH,CAAC,CAACI,OAAV;AACA,IAAIC,CAAC,GAAGL,CAAC,CAACM,QAAV;;AACA,IAAIC,CAAC,GAAI,UAAUC,CAAV,EAAa;EAClB,SAASC,CAAT,GAAa;IACT,IAAIA,CAAC,GAAI,SAASD,CAAT,IAAcA,CAAC,CAACE,KAAF,CAAQ,IAAR,EAAcC,SAAd,CAAf,IAA4C,IAApD;IACAF,CAAC,CAACG,OAAF,GAAY,IAAZ;IACAH,CAAC,CAACI,QAAF,GAAa,IAAb;IACAJ,CAAC,CAACK,UAAF,GAAe,IAAf;IACAL,CAAC,CAACM,QAAF,GAAa,IAAb;IACAN,CAAC,CAACO,QAAF,GAAa,IAAb;IACAP,CAAC,CAACQ,EAAF,GAAO,CAAC,CAAR;IACA,OAAOR,CAAP;EACH;;EACDS,SAAS,CAACT,CAAD,EAAID,CAAJ,CAAT;;EACAC,CAAC,CAACU,SAAF,CAAYC,MAAZ,GAAqB,UAAUZ,CAAV,EAAa;IAC9B,IAAIC,CAAC,GAAG,IAAR;;IACA,IAAI,KAAKQ,EAAL,KAAYT,CAAC,CAACS,EAAlB,EAAsB;MAClB1B,aAAa,WAAb,CAAsB8B,QAAtB,CAA+BC,OAA/B,CACI7B,UAAU,CAAC8B,WAAX,CAAuBC,MAD3B,EAEI,CAAC,oBAAoBhB,CAAC,CAACiB,IAAtB,GAA6B,GAA7B,GAAmCjB,CAAC,CAACkB,KAAtC,EAA6C,qBAAqBlB,CAAC,CAACiB,IAApE,EAA0E,oBAAoBjB,CAAC,CAACkB,KAAhG,CAFJ,EAGIzB,EAAE,CAAC0B,WAHP,EAII,IAJJ,EAKI,UAAUnB,CAAV,EAAaoB,CAAb,EAAgB;QACZ,IAAItC,CAAC,GAAGsC,CAAC,CAAC,CAAD,CAAT;;QACA,IAAItC,CAAC,IAAIW,EAAE,CAAC4B,OAAH,CAAWpB,CAAC,CAACG,OAAb,CAAT,EAAgC;UAC5BH,CAAC,CAACG,OAAF,CAAUkB,WAAV,GAAwBpC,QAAQ,CAACqC,OAAT,CAAiBC,UAAjB,CAA4B1C,CAA5B,EAA+BmB,CAAC,CAACwB,IAAjC,CAAxB;UACAxB,CAAC,CAACI,QAAF,CAAWiB,WAAX,GAAyBpC,QAAQ,CAACqC,OAAT,CAAiBC,UAAjB,CAA4BJ,CAAC,CAAC,CAAD,CAA7B,EAAkCnB,CAAC,CAACwB,IAApC,CAAzB;UACAxB,CAAC,CAACwB,IAAF,CAAOC,QAAP,CAAgB,CAAhB,EAAmBC,YAAnB,CAAgClC,EAAE,CAACmC,MAAnC,EAA2CN,WAA3C,GAAyDpC,QAAQ,CAACqC,OAAT,CAAiBC,UAAjB,CACrDJ,CAAC,CAAC,CAAD,CADoD,EAErDnB,CAAC,CAACwB,IAFmD,CAAzD;QAIH;MACJ,CAfL;IAiBH;;IACD,KAAKhB,EAAL,GAAUT,CAAC,CAACS,EAAZ;IACA,KAAKH,UAAL,CAAgBuB,MAAhB,GAAyB7B,CAAC,CAAC8B,GAAF,CAAMC,QAAN,EAAzB;IACA,IAAIX,CAAC,GAAG/B,cAAc,WAAd,CAAuBwB,QAAvB,CAAgCmB,UAAhC,CAA2CC,IAA3C,CAAgD,UAAUhC,CAAV,EAAa;MACjE,OAAOA,CAAC,CAACQ,EAAF,KAAST,CAAC,CAACS,EAAlB;IACH,CAFO,CAAR;IAGA,KAAKF,QAAL,CAAc2B,MAAd,GAAuB5C,iBAAiB,WAAjB,CAA0B6C,GAA1B,CAA8BC,gBAA9B,CAA+CpC,CAAC,CAACiB,IAAjD,EAAuDG,CAAC,CAACiB,SAAzD,CAAvB;IACA,KAAK7B,QAAL,CAAc0B,MAAd,GAAuBlC,CAAC,CAACsC,MAAzB;EACH,CA5BD;;EA6BArC,CAAC,CAACU,SAAF,CAAY4B,KAAZ,GAAoB,YAAY;IAC5B,KAAKd,IAAL,CAAUe,EAAV,CAAa/C,EAAE,CAACgD,IAAH,CAAQC,SAAR,CAAkBC,SAA/B,EAA0C,KAAKC,SAA/C,EAA0D,IAA1D;EACH,CAFD;;EAGA3C,CAAC,CAACU,SAAF,CAAYiC,SAAZ,GAAwB,YAAY;IAChC,IAAI,KAAKnC,EAAL,KAAYlB,YAAY,WAAZ,CAAqBsD,aAArC,EAAoD;MAChDtD,YAAY,WAAZ,CAAqBsD,aAArB,GAAqC,KAAKpC,EAA1C;MACArB,aAAa,CAAC0D,YAAd,CAA2BjC,QAA3B,CAAoCkC,QAApC;MACA3D,aAAa,CAAC0D,YAAd,CAA2BjC,QAA3B,CAAoCmC,IAApC,CAAyC/D,UAAU,CAACgE,SAAX,CAAqBC,YAArB,CAAkCC,OAAlC,CAA0CC,UAA1C,CAAqDC,WAA9F,EAA2G;QACvGC,KAAK,EAAE,KAAK7C;MAD2F,CAA3G;IAGH;EACJ,CARD;;EASA8C,UAAU,CAAC,CAAC1D,CAAC,CAACJ,EAAE,CAACmC,MAAJ,CAAF,CAAD,EAAiB3B,CAAC,CAACU,SAAnB,EAA8B,SAA9B,EAAyC,KAAK,CAA9C,CAAV;;EACA4C,UAAU,CAAC,CAAC1D,CAAC,CAACJ,EAAE,CAACmC,MAAJ,CAAF,CAAD,EAAiB3B,CAAC,CAACU,SAAnB,EAA8B,UAA9B,EAA0C,KAAK,CAA/C,CAAV;;EACA4C,UAAU,CAAC,CAAC1D,CAAC,CAACJ,EAAE,CAAC+D,KAAJ,CAAF,CAAD,EAAgBvD,CAAC,CAACU,SAAlB,EAA6B,YAA7B,EAA2C,KAAK,CAAhD,CAAV;;EACA4C,UAAU,CAAC,CAAC1D,CAAC,CAACJ,EAAE,CAACgD,IAAJ,CAAF,CAAD,EAAexC,CAAC,CAACU,SAAjB,EAA4B,UAA5B,EAAwC,KAAK,CAA7C,CAAV;;EACA4C,UAAU,CAAC,CAAC1D,CAAC,CAACJ,EAAE,CAACgD,IAAJ,CAAF,CAAD,EAAexC,CAAC,CAACU,SAAjB,EAA4B,UAA5B,EAAwC,KAAK,CAA7C,CAAV;;EACA,OAAO4C,UAAU,CAAC,CAAC5D,CAAD,CAAD,EAAMM,CAAN,CAAjB;AACH,CA3DO,CA2DLd,SAAS,WA3DJ,CAAR;;AA4DAsE,OAAO,WAAP,GAAkB1D,CAAlB","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $listItem = require(\"./ListItem\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $equipmentContext = require(\"./EquipmentContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar h = cc._decorator;\r\nvar m = h.ccclass;\r\nvar y = h.property;\r\nvar g = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.gemIcon = null;\r\n        e.partIcon = null;\r\n        e.countLable = null;\r\n        e.maskNode = null;\r\n        e.lockNode = null;\r\n        e.id = -1;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.render = function (t) {\r\n        var e = this;\r\n        if (this.id !== t.id) {\r\n            $assetsLoader.default.instance.loadRes(\r\n                $assetsMap.BundleNames.Public,\r\n                [\"/textures/gem/g\" + t.part + \"_\" + t.grade, \"/textures/gem/zb\" + t.part, \"/textures/gem/k\" + t.grade],\r\n                cc.SpriteFrame,\r\n                null,\r\n                function (t, i) {\r\n                    var o = i[0];\r\n                    if (o && cc.isValid(e.gemIcon)) {\r\n                        e.gemIcon.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);\r\n                        e.partIcon.spriteFrame = $resUtil.ResUtil.assignWith(i[1], e.node);\r\n                        e.node.children[1].getComponent(cc.Sprite).spriteFrame = $resUtil.ResUtil.assignWith(\r\n                            i[2],\r\n                            e.node\r\n                        );\r\n                    }\r\n                }\r\n            );\r\n        }\r\n        this.id = t.id;\r\n        this.countLable.string = t.num.toString();\r\n        var i = $configContext.default.instance.gemConfigs.find(function (e) {\r\n            return e.id === t.id;\r\n        });\r\n        this.maskNode.active = $equipmentContext.default.Ins.hasGemTypeByPart(t.part, i.SkillPool);\r\n        this.lockNode.active = t.isLock;\r\n    };\r\n    e.prototype.start = function () {\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.touchItem, this);\r\n    };\r\n    e.prototype.touchItem = function () {\r\n        if (this.id !== $globalParam.default.currGemIdInfo) {\r\n            $globalParam.default.currGemIdInfo = this.id;\r\n            $popupManager.PopupManager.instance.closeAll();\r\n            $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.GemInfoView, {\r\n                gemId: this.id\r\n            });\r\n        }\r\n    };\r\n    __decorate([y(cc.Sprite)], e.prototype, \"gemIcon\", void 0);\r\n    __decorate([y(cc.Sprite)], e.prototype, \"partIcon\", void 0);\r\n    __decorate([y(cc.Label)], e.prototype, \"countLable\", void 0);\r\n    __decorate([y(cc.Node)], e.prototype, \"maskNode\", void 0);\r\n    __decorate([y(cc.Node)], e.prototype, \"lockNode\", void 0);\r\n    return __decorate([m], e);\r\n})($listItem.default);\r\nexports.default = g;\r\n"]}