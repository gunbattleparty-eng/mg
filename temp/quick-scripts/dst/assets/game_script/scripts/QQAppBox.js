
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/QQAppBox.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1c571agATlPspQFidDCrHla', 'QQAppBox');
// game_script/scripts/QQAppBox.js

"use strict";

var o;

var $baseAd = require("./BaseAd");

var r = window.qq;

var a = function (t) {
  function e() {
    return null !== t && t.apply(this, arguments) || this;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (r && r.createAppBox) {
        var t = {
          adUnitId: this.adUnitId
        };
        this.adIns = r.createAppBox(t);

        if (this.adIns.onClose) {
          this.adIns.onClose(this.onClose);
        }

        this.isLoaded = !1;
        this.loadAppBox();
      } else {
        console.warn("不支持创建该组件createAppBox");
      }
    } else {
      console.error("QQ APPBOX ID为空");
    }
  };

  e.prototype.loadAppBox = function () {
    var t = this;

    if (this.adIns.load) {
      this.adIns.load().then(function () {
        t.onAdLoad();
      })["catch"](function (e) {
        t.onAdError(e);
      });
    }
  };

  e.prototype.showAppBox = function (t, e, i) {
    var o = this;
    this.showCallback = t;
    this.closeCallback = e;
    this.errorCallback = i;
    return this.adIns ? this.isConsume ? this.reCreateAd(!0) : this.isLoaded ? void (this.showing ? console.warn(this.adUnitId, ":正在显示中，不给显示") : this.adIns ? this.adIns.show && this.adIns.show().then(function () {
      o.showing = !0;

      if (o.showCallback) {
        o.showCallback();
      }

      o.showCallback = null;
    })["catch"](function (t) {
      o.showing = !1;
      console.warn("interstitial show error:", t);
      o.destroyAd();
    }) : (console.warn("interstitial,interstitial对象未创建,将在创建完成后自动显示"), this.reCreateAd(!0))) : (console.warn(this.adUnitId, ":未加载完成，稍等"), void (this.isAutoShow = !0)) : (console.warn(this.adUnitId, ":未创建，执行创建"), this.isAutoShow = !0, this.loadAd());
  };

  e.prototype.reCreateAd = function (t) {
    var e = this;
    this.destroyAd();
    this.isAutoShow = t;
    setTimeout(function () {
      e.loadAd();
    }, 100);
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offClose) {
        this.adIns.offClose(this.onLoad);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onLoad);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.onAdLoad = function () {
    t.prototype.onAdLoad.call(this);
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);
    this.showing = !1;

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdClose = function () {
    t.prototype.onAdClose.call(this);
    this.showing = !1;

    if (this.closeCallback) {
      this.closeCallback();
    }

    this.reCreateAd(!1);
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showAppBox(this.showCallback, this.closeCallback, this.errorCallback);
    }
  };

  return e;
}($baseAd.BaseAd);

exports["default"] = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFFRQXBwQm94LmpzIl0sIm5hbWVzIjpbIm8iLCIkYmFzZUFkIiwicmVxdWlyZSIsInIiLCJ3aW5kb3ciLCJxcSIsImEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwibG9hZEFkIiwiYWRVbml0SWQiLCJjcmVhdGVBcHBCb3giLCJhZElucyIsIm9uQ2xvc2UiLCJpc0xvYWRlZCIsImxvYWRBcHBCb3giLCJjb25zb2xlIiwid2FybiIsImVycm9yIiwibG9hZCIsInRoZW4iLCJvbkFkTG9hZCIsIm9uQWRFcnJvciIsInNob3dBcHBCb3giLCJpIiwic2hvd0NhbGxiYWNrIiwiY2xvc2VDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJpc0NvbnN1bWUiLCJyZUNyZWF0ZUFkIiwic2hvd2luZyIsInNob3ciLCJkZXN0cm95QWQiLCJpc0F1dG9TaG93Iiwic2V0VGltZW91dCIsImNhbGwiLCJvZmZMb2FkIiwib25Mb2FkIiwib2ZmQ2xvc2UiLCJvZmZFcnJvciIsImRlc3Ryb3kiLCJhdXRvU2hvdyIsIm9uQWRDbG9zZSIsIkJhc2VBZCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXJCOztBQUNBLElBQUlDLENBQUMsR0FBR0MsTUFBTSxDQUFDQyxFQUFmOztBQUNBLElBQUlDLENBQUMsR0FBSSxVQUFVQyxDQUFWLEVBQWE7RUFDbEIsU0FBU0MsQ0FBVCxHQUFhO0lBQ1QsT0FBUSxTQUFTRCxDQUFULElBQWNBLENBQUMsQ0FBQ0UsS0FBRixDQUFRLElBQVIsRUFBY0MsU0FBZCxDQUFmLElBQTRDLElBQW5EO0VBQ0g7O0VBQ0RDLFNBQVMsQ0FBQ0gsQ0FBRCxFQUFJRCxDQUFKLENBQVQ7O0VBQ0FDLENBQUMsQ0FBQ0ksU0FBRixDQUFZ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QWxCO0lBQ0EsS0FBS2QsUUFBTCxHQUFnQixDQUFDLENBQWpCO0lBQ0EsS0FBSzJCLFFBQUw7RUFDSCxDQUxEOztFQU1BckMsQ0FBQyxDQUFDSSxTQUFGLENBQVljLFNBQVosR0FBd0IsVUFBVWxCLENBQVYsRUFBYTtJQUNqQ0QsQ0FBQyxDQUFDSyxTQUFGLENBQVljLFNBQVosQ0FBc0JhLElBQXRCLENBQTJCLElBQTNCLEVBQWlDL0IsQ0FBakM7SUFDQSxLQUFLMEIsT0FBTCxHQUFlLENBQUMsQ0FBaEI7O0lBQ0EsSUFBSSxLQUFLSCxhQUFULEVBQXdCO01BQ3BCLEtBQUtBLGFBQUw7SUFDSDs7SUFDRCxLQUFLSyxTQUFMO0VBQ0gsQ0FQRDs7RUFRQTVCLENBQUMsQ0FBQ0ksU0FBRixDQUFZa0MsU0FBWixHQUF3QixZQUFZO0lBQ2hDdkMsQ0FBQyxDQUFDSyxTQUFGLENBQVlrQyxTQUFaLENBQXNCUCxJQUF0QixDQUEyQixJQUEzQjtJQUNBLEtBQUtMLE9BQUwsR0FBZSxDQUFDLENBQWhCOztJQUNBLElBQUksS0FBS0osYUFBVCxFQUF3QjtNQUNwQixLQUFLQSxhQUFMO0lBQ0g7O0lBQ0QsS0FBS0csVUFBTCxDQUFnQixDQUFDLENBQWpCO0VBQ0gsQ0FQRDs7RUFRQXpCLENBQUMsQ0FBQ0ksU0FBRixDQUFZaUMsUUFBWixHQUF1QixZQUFZO0lBQy9CLElBQUksS0FBS1IsVUFBVCxFQUFxQjtNQUNqQixLQUFLQSxVQUFMLEdBQWtCLENBQUMsQ0FBbkI7TUFDQSxLQUFLVixVQUFMLENBQWdCLEtBQUtFLFlBQXJCLEVBQW1DLEtBQUtDLGFBQXhDLEVBQXVELEtBQUtDLGFBQTVEO0lBQ0g7RUFDSixDQUxEOztFQU1BLE9BQU92QixDQUFQO0FBQ0gsQ0E1SE8sQ0E0SExQLE9BQU8sQ0FBQzhDLE1BNUhILENBQVI7O0FBNkhBQyxPQUFPLFdBQVAsR0FBa0IxQyxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkYmFzZUFkID0gcmVxdWlyZShcIi4vQmFzZUFkXCIpO1xyXG52YXIgciA9IHdpbmRvdy5xcTtcclxudmFyIGEgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgcmV0dXJuIChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmxvYWRBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLmNyZWF0ZUFwcEJveCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRVbml0SWQ6IHRoaXMuYWRVbml0SWRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zID0gci5jcmVhdGVBcHBCb3godCk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vbkNsb3NlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkNsb3NlKHRoaXMub25DbG9zZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGVkID0gITE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRBcHBCb3goKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuS4jeaUr+aMgeWIm+W7uuivpee7hOS7tmNyZWF0ZUFwcEJveFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJRUSBBUFBCT1ggSUTkuLrnqbpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmxvYWRBcHBCb3ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zLmxvYWQpIHtcclxuICAgICAgICAgICAgdGhpcy5hZEluc1xyXG4gICAgICAgICAgICAgICAgLmxvYWQoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQub25BZExvYWQoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0Lm9uQWRFcnJvcihlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zaG93QXBwQm94ID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zaG93Q2FsbGJhY2sgPSB0O1xyXG4gICAgICAgIHRoaXMuY2xvc2VDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gaTtcclxuICAgICAgICByZXR1cm4gdGhpcy5hZEluc1xyXG4gICAgICAgICAgICA/IHRoaXMuaXNDb25zdW1lXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMucmVDcmVhdGVBZCghMClcclxuICAgICAgICAgICAgICAgIDogdGhpcy5pc0xvYWRlZFxyXG4gICAgICAgICAgICAgICAgPyB2b2lkICh0aGlzLnNob3dpbmdcclxuICAgICAgICAgICAgICAgICAgICAgID8gY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuato+WcqOaYvuekuuS4re+8jOS4jee7meaYvuekulwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLmFkSW5zXHJcbiAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuYWRJbnMuc2hvdyAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93aW5nID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uc2hvd0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnNob3dpbmcgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJpbnRlcnN0aXRpYWwgc2hvdyBlcnJvcjpcIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kZXN0cm95QWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4oXCJpbnRlcnN0aXRpYWwsaW50ZXJzdGl0aWFs5a+56LGh5pyq5Yib5bu6LOWwhuWcqOWIm+W7uuWujOaIkOWQjuiHquWKqOaYvuekulwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCEwKSkpXHJcbiAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yqg6L295a6M5oiQ77yM56iN562JXCIpLCB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCkpXHJcbiAgICAgICAgICAgIDogKGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliJvlu7rvvIzmiafooYzliJvlu7pcIiksICh0aGlzLmlzQXV0b1Nob3cgPSAhMCksIHRoaXMubG9hZEFkKCkpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlQ3JlYXRlQWQgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHZhciBlID0gdGhpcztcclxuICAgICAgICB0aGlzLmRlc3Ryb3lBZCgpO1xyXG4gICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9IHQ7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGUubG9hZEFkKCk7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5kZXN0cm95QWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUuZGVzdHJveUFkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZMb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZDbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZDbG9zZSh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmRXJyb3IodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLmRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkTG9hZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaXNDb25zdW1lID0gITE7XHJcbiAgICAgICAgdGhpcy5pc0xvYWRlZCA9ICEwO1xyXG4gICAgICAgIHRoaXMuYXV0b1Nob3coKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRFcnJvci5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZENsb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRDbG9zZS5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmNsb3NlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVDcmVhdGVBZCghMSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYXV0b1Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvU2hvdykge1xyXG4gICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaG93QXBwQm94KHRoaXMuc2hvd0NhbGxiYWNrLCB0aGlzLmNsb3NlQ2FsbGJhY2ssIHRoaXMuZXJyb3JDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBlO1xyXG59KSgkYmFzZUFkLkJhc2VBZCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGE7XHJcbiJdfQ==