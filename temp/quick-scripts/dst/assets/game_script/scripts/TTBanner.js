
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/TTBanner.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '28c47Q/izdLgb3ZrLwiNIcu', 'TTBanner');
// game_script/scripts/TTBanner.js

"use strict";

var o;
exports.TTBanner = void 0;

var $baseAd = require("./BaseAd");

var r = window.tt;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.isOpenPreLoad = !1;
    e.style = null;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (r && r.createBannerAd) {
        var t = this.style || {};
        var e = r.getSystemInfoSync();
        var i = e.windowWidth;
        var o = e.windowHeight;
        var n = {
          adUnitId: this.adUnitId,
          style: {
            left: t.left || 0,
            top: t.top || o - 300,
            width: t.width || Math.floor(i)
          }
        };
        this.adIns = r.createBannerAd(n);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onResize) {
          this.adIns.onResize(this.onResize);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }
      } else {
        console.warn("当前平台不支持创建banner");
      }
    } else {
      console.error("头条Banner ID为空");
    }
  };

  e.prototype.showBanner = function (t, e, i) {
    var o = this;
    this.showCallback = e;
    this.errorCallback = i;

    if (this.isCanShow) {
      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        return this.loadAd();
      }

      if (this.isConsume) {
        this.reCreateAd(!0);
      } else {
        {
          if (!this.isLoaded) {
            console.warn(this.adUnitId, ":未加载完成，稍等");
            return void (this.isAutoShow = !0);
          }

          if (this.adIns && t) {
            if (void 0 !== t.top) {
              this.adIns.style.top = t.top;
            }

            if (void 0 !== t.left) {
              this.adIns.style.left = t.left;
            }

            if (void 0 !== t.width) {
              this.adIns.style.width = t.width;
            }
          }

          this.isConsume = !1;

          if (this.adIns.show) {
            var n = this.adIns.show();
            n && n.then ? n.then(function () {
              o.isConsume = !0;

              if (o.showCallback) {
                o.showCallback();
              }

              o.showCallback = null;
            })["catch"](function (t) {
              console.warn(o.adUnitId, ":show错误，重新加载", t);
              o.reCreateAd(!0);
            }) : (console.warn(this.adUnitId, ":show显示失败，重新加载"), this.reCreateAd(!0));
          }
        }
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示");
    }
  };

  e.prototype.forbiddenBanner = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideBanner(!1);
    }
  };

  e.prototype.hideBanner = function (t) {
    t && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : this.adIns && this.adIns.hide && this.adIns.hide();
  };

  e.prototype.onAdResize = function (e) {
    t.prototype.onAdResize.call(this, e);
    var i = r.getSystemInfoSync();
    var o = i.windowWidth;
    var n = i.windowHeight;
    var s = this.style || {};
    null != s.top ? this.adIns.style.top = s.top : this.adIns.style.top = Math.round(n - e.height + 0.1);
    null != s.left ? this.adIns.style.left = s.left : this.adIns.style.left = Math.round((o - e.width) / 2 + 0.1);
  };

  e.prototype.reCreateAd = function (t) {
    this.destroyAd();
    this.isAutoShow = t;
    this.loadAd();
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offResize) {
        this.adIns.offResize(this.onResize);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showBanner(this.style, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function () {
    t.prototype.onAdLoad.call(this);
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  return e;
}($baseAd.BaseAd);

exports.TTBanner = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFRUQmFubmVyLmpzIl0sIm5hbWVzIjpbIm8iLCJleHBvcnRzIiwiVFRCYW5uZXIiLCIkYmFzZUFkIiwicmVxdWlyZSIsInIiLCJ3aW5kb3ciLCJ0dCIsImEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiaXNPcGVuUHJlTG9hZCIsInN0eWxlIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwibG9hZEFkIiwiYWRVbml0SWQiLCJjcmVhdGVCYW5uZXJBZCIsImdldFN5c3RlbUluZm9TeW5jIiwiaSIsIndpbmRvd1dpZHRoIiwid2luZG93SGVpZ2h0IiwibiIsImxlZnQiLCJ0b3AiLCJ3aWR0aCIsIk1hdGgiLCJmbG9vciIsImFkSW5zIiwib25Mb2FkIiwib25SZXNpemUiLCJvbkVycm9yIiwiY29uc29sZSIsIndhcm4iLCJlcnJvciIsInNob3dCYW5uZXIiLCJzaG93Q2FsbGJhY2siLCJlcnJvckNhbGxiYWNrIiwiaXNDYW5TaG93IiwiaXNBdXRvU2hvdyIsImlzQ29uc3VtZSIsInJlQ3JlYXRlQWQiLCJpc0xvYWRlZCIsInNob3ciLCJ0aGVuIiwiZm9yYmlkZGVuQmFubmVyIiwiaGlkZUJhbm5lciIsImRlc3Ryb3lBZCIsImhpZGUiLCJvbkFkUmVzaXplIiwiY2FsbCIsInMiLCJyb3VuZCIsImhlaWdodCIsIm9mZkxvYWQiLCJvZmZSZXNpemUiLCJvZmZFcnJvciIsImRlc3Ryb3kiLCJhdXRvU2hvdyIsIm9uQWRMb2FkIiwib25BZEVycm9yIiwiQmFzZUFkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7QUFDQUMsT0FBTyxDQUFDQyxRQUFSLEdBQW1CLEtBQUssQ0FBeEI7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1BQU0sQ0FBQ0MsRUFBZjs7QUFDQSxJQUFJQyxDQUFDLEdBQUks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SCxDQTlKTyxDQThKTFAsT0FBTyxDQUFDNEQsTUE5SkgsQ0FBUjs7QUErSkE5RCxPQUFPLENBQUNDLFFBQVIsR0FBbUJNLENBQW5CIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxuZXhwb3J0cy5UVEJhbm5lciA9IHZvaWQgMDtcclxudmFyICRiYXNlQWQgPSByZXF1aXJlKFwiLi9CYXNlQWRcIik7XHJcbnZhciByID0gd2luZG93LnR0O1xyXG52YXIgYSA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLmlzT3BlblByZUxvYWQgPSAhMTtcclxuICAgICAgICBlLnN0eWxlID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmxvYWRBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLmNyZWF0ZUJhbm5lckFkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdCA9IHRoaXMuc3R5bGUgfHwge307XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHIuZ2V0U3lzdGVtSW5mb1N5bmMoKTtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gZS53aW5kb3dXaWR0aDtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gZS53aW5kb3dIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICBhZFVuaXRJZDogdGhpcy5hZFVuaXRJZCxcclxuICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiB0LmxlZnQgfHwgMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0LnRvcCB8fCBvIC0gMzAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogdC53aWR0aCB8fCBNYXRoLmZsb29yKGkpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMgPSByLmNyZWF0ZUJhbm5lckFkKG4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25Mb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25SZXNpemUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uUmVzaXplKHRoaXMub25SZXNpemUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25FcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwi5b2T5YmN5bmz5Y+w5LiN5pSv5oyB5Yib5bu6YmFubmVyXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIuWktOadoUJhbm5lciBJROS4uuepulwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2hvd0Jhbm5lciA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG8gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2hvd0NhbGxiYWNrID0gZTtcclxuICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2sgPSBpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2FuU2hvdykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliJvlu7rvvIzmiafooYzliJvlu7pcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxvYWRBZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQ29uc3VtZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCEwKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNMb2FkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuacquWKoOi9veWujOaIkO+8jOeojeetiVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgKHRoaXMuaXNBdXRvU2hvdyA9ICEwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMgJiYgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LnRvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5zdHlsZS50b3AgPSB0LnRvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LmxlZnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuc3R5bGUubGVmdCA9IHQubGVmdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLnN0eWxlLndpZHRoID0gdC53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLnNob3cpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB0aGlzLmFkSW5zLnNob3coKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbiAmJiBuLnRoZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uaXNDb25zdW1lID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uc2hvd0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oby5hZFVuaXRJZCwgXCI6c2hvd+mUmeivr++8jOmHjeaWsOWKoOi9vVwiLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnJlQ3JlYXRlQWQoITApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjpzaG935pi+56S65aSx6LSl77yM6YeN5paw5Yqg6L29XCIpLCB0aGlzLnJlQ3JlYXRlQWQoITApKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65b2T5YmN5bm/5ZGK56aB5q2i5pi+56S6XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5mb3JiaWRkZW5CYW5uZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHRoaXMuaXNDYW5TaG93ID0gIXQ7XHJcbiAgICAgICAgaWYgKHQgJiYgdGhpcy5pc0NvbnN1bWUpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWRlQmFubmVyKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuaGlkZUJhbm5lciA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdCAmJiB0aGlzLmlzQ29uc3VtZVxyXG4gICAgICAgICAgICA/ICh0aGlzLmRlc3Ryb3lBZCgpLCB0aGlzLnJlQ3JlYXRlQWQoITEpKVxyXG4gICAgICAgICAgICA6IHRoaXMuYWRJbnMgJiYgdGhpcy5hZElucy5oaWRlICYmIHRoaXMuYWRJbnMuaGlkZSgpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRSZXNpemUgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRSZXNpemUuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICB2YXIgaSA9IHIuZ2V0U3lzdGVtSW5mb1N5bmMoKTtcclxuICAgICAgICB2YXIgbyA9IGkud2luZG93V2lkdGg7XHJcbiAgICAgICAgdmFyIG4gPSBpLndpbmRvd0hlaWdodDtcclxuICAgICAgICB2YXIgcyA9IHRoaXMuc3R5bGUgfHwge307XHJcbiAgICAgICAgbnVsbCAhPSBzLnRvcCA/ICh0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IHMudG9wKSA6ICh0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IE1hdGgucm91bmQobiAtIGUuaGVpZ2h0ICsgMC4xKSk7XHJcbiAgICAgICAgbnVsbCAhPSBzLmxlZnRcclxuICAgICAgICAgICAgPyAodGhpcy5hZElucy5zdHlsZS5sZWZ0ID0gcy5sZWZ0KVxyXG4gICAgICAgICAgICA6ICh0aGlzLmFkSW5zLnN0eWxlLmxlZnQgPSBNYXRoLnJvdW5kKChvIC0gZS53aWR0aCkgLyAyICsgMC4xKSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVDcmVhdGVBZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSB0O1xyXG4gICAgICAgIHRoaXMubG9hZEFkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmUmVzaXplKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZlJlc2l6ZSh0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZFcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLmRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5hdXRvU2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F1dG9TaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dCYW5uZXIodGhpcy5zdHlsZSwgdGhpcy5zaG93Q2FsbGJhY2ssIHRoaXMuZXJyb3JDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRMb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRMb2FkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgdGhpcy5pc0NvbnN1bWUgPSAhMTtcclxuICAgICAgICB0aGlzLmlzTG9hZGVkID0gITA7XHJcbiAgICAgICAgdGhpcy5hdXRvU2hvdygpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRFcnJvciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZEVycm9yLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3JDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZTtcclxufSkoJGJhc2VBZC5CYXNlQWQpO1xyXG5leHBvcnRzLlRUQmFubmVyID0gYTtcclxuIl19