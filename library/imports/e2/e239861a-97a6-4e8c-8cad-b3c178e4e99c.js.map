{"version":3,"sources":["assets\\game_script\\scripts\\Enemy_27.js"],"names":["o","$assetsMap","require","$resManager","$resUtil","$eventManager","$gamePool","$localEventName","$baseBullet","$gameContext","$baseEnemy","$healthBar","y","cc","_decorator","g","ccclass","_","property","k","t","e","apply","arguments","healthBar","invulnerabilityCount","__extends","prototype","initEnemy","i","call","statusManager","specialityAtkAdd","set","BulletSpeciality","physics","config","value","energy","init","hp","hp_num","sufferDebuff","playShield","instance","get","PoolKey","Shield","ResUtil","instantiate","ResManager","AssetsMap","GameBundles","prefabs","assetsList","ins","enemyLayer","parent","debuffLayer","zIndex","node","setPosition","getPosition","add","position","scale","getAnimPos","send","HURT_ANIM","getComponentInChildren","Animation","play","speed","gameRatio","on","EventType","FINISHED","put","sufferAtk","sufferAttack","isDie","render","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resManager = require(\"./ResManager\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $gamePool = require(\"./GamePool\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $baseEnemy = require(\"./BaseEnemy\");\r\nvar $healthBar = require(\"./HealthBar\");\r\nvar y = cc._decorator;\r\nvar g = y.ccclass;\r\nvar _ = y.property;\r\nvar k = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.healthBar = null;\r\n        e.invulnerabilityCount = 0;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.initEnemy = function (e, i, o) {\r\n        if (void 0 === o) {\r\n            o = 0;\r\n        }\r\n        t.prototype.initEnemy.call(this, e, i, o);\r\n        this.statusManager.specialityAtkAdd.set($baseBullet.BulletSpeciality.physics, this.config.value[0]);\r\n        this.statusManager.specialityAtkAdd.set($baseBullet.BulletSpeciality.energy, this.config.value[1]);\r\n        this.invulnerabilityCount = this.config.value[2];\r\n        if (this.healthBar) {\r\n            this.healthBar.init(this.statusManager.hp, e.hp_num);\r\n        }\r\n    };\r\n    e.prototype.sufferDebuff = function (e) {\r\n        if (!(this.invulnerabilityCount > 0)) {\r\n            t.prototype.sufferDebuff.call(this, e);\r\n        }\r\n    };\r\n    e.prototype.playShield = function () {\r\n        var t = $gamePool.default.instance.get($gamePool.PoolKey.Shield);\r\n        if (!t) {\r\n            t = $resUtil.ResUtil.instantiate(\r\n                $resManager.ResManager.instance.get($assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Shield),\r\n                $gameContext.default.ins.enemyLayer.parent\r\n            );\r\n        }\r\n        t.parent = $gameContext.default.ins.debuffLayer;\r\n        t.zIndex = this.node.zIndex;\r\n        t.setPosition(this.getPosition().add(this.debuffLayer.position));\r\n        t.scale = this.debuffLayer.scale;\r\n        var e = this.getAnimPos();\r\n        $eventManager.default.send($localEventName.default.HURT_ANIM, e, -1, 1);\r\n        var i = t.getComponentInChildren(cc.Animation);\r\n        i.play().speed = $gameContext.default.ins.gameRatio;\r\n        i.on(\r\n            cc.Animation.EventType.FINISHED,\r\n            function () {\r\n                $gamePool.default.instance.put($gamePool.PoolKey.Shield, t);\r\n            },\r\n            this\r\n        );\r\n    };\r\n    e.prototype.sufferAtk = function (e) {\r\n        return this.invulnerabilityCount > 0\r\n            ? (this.invulnerabilityCount--, this.playShield(), !1)\r\n            : t.prototype.sufferAtk.call(this, e);\r\n    };\r\n    e.prototype.sufferAttack = function (e, i) {\r\n        if (this.statusManager.isDie) {\r\n            return !1;\r\n        }\r\n        var o = t.prototype.sufferAttack.call(this, e, i);\r\n        if (this.healthBar) {\r\n            this.healthBar.render(this.statusManager.hp);\r\n        }\r\n        return o;\r\n    };\r\n    __decorate([_($healthBar.default)], e.prototype, \"healthBar\", void 0);\r\n    return __decorate([g], e);\r\n})($baseEnemy.default);\r\nexports.default = k;\r\n"]}