
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/HWBanner.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '80f3d1nhvFJ4qxW+aQ+yUKr', 'HWBanner');
// game_script/scripts/HWBanner.js

"use strict";

var o;
exports.HWBanner = void 0;

var $baseAd = require("./BaseAd");

var r = window.qg;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.style = null;
    e.isOpenPreLoad = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    var t = this;

    if (this.adUnitId) {
      if (r && r.createBannerAd) {
        var e = r.getSystemInfoSync();
        console.log("on getSystemInfoSync: success =" + JSON.stringify(e));
        var i = e.safeArea.height;
        var o = {
          adUnitId: this.adUnitId,
          style: {
            top: i - 57,
            left: 0,
            height: 57,
            width: 360
          }
        };
        this.adIns = r.createBannerAd(o);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onClose) {
          this.adIns.onClose(this.onAdClose);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }

        setTimeout(function () {
          t.isLoaded = !0;
          t.autoShow();
        }, 1e3);
      } else {
        console.warn("当前平台不支持创建banner");
      }
    } else {
      console.error("Banner ID为空");
    }
  };

  e.prototype.onAdLoad = function () {
    t.prototype.onAdLoad.call(this);

    if (this.showCallback) {
      this.showCallback();
    }

    this.showCallback = null;
  };

  e.prototype.showBanner = function (t, e, i) {
    this.showCallback = e;
    this.errorCallback = i;

    if (this.isCanShow) {
      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        this.loadAd();
      }

      return this.isConsume ? (console.log("banner 已消耗重新创建"), this.reCreateAd(!0)) : this.isLoaded ? (this.isConsume = !1, this.adIns.show ? (this.isConsume = !0, this.adIns.show(), void console.log("显示banner")) : void 0) : (console.warn(this.adUnitId, ":未加载完成，稍等"), void (this.isAutoShow = !0));
    }

    console.warn(this.adUnitId, ":当前广告禁止显示");
  };

  e.prototype.forbiddenBanner = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideBanner(!1);
    }
  };

  e.prototype.hideBanner = function (t) {
    t && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : this.adIns && this.adIns.hide && this.adIns.hide();
  };

  e.prototype.reCreateAd = function (t) {
    var e = this;
    this.destroyAd();
    this.isAutoShow = t;
    setTimeout(function () {
      e.loadAd();
    }, 100);
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offClose) {
        this.adIns.offClose(this.onAdClose);
      }

      if (this.adIns.offSize) {
        this.adIns.offSize(this.onResize);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showBanner(this.style, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);
    this.showing = !1;

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.errorCallback = null;
    this.destroyAd();
  };

  e.prototype.onAdClose = function () {
    t.prototype.onAdClose.call(this);
    this.showing = !1;

    if (this.closeCallback) {
      this.closeCallback();
    }

    this.closeCallback = null;
    this.destroyAd();

    if (this.isOpenPreLoad) {
      this.reCreateAd(!1);
    }
  };

  e.prototype.onAdHide = function () {
    t.prototype.onAdHide.call(this);
    this.showing = !1;
    this.hideing = !1;

    if (this.isOpenPreLoad) {
      this.reCreateAd(!1);
    }
  };

  return e;
}($baseAd.BaseAd);

exports.HWBanner = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEhXQmFubmVyLmpzIl0sIm5hbWVzIjpbIm8iLCJleHBvcnRzIiwiSFdCYW5uZXIiLCIkYmFzZUFkIiwicmVxdWlyZSIsInIiLCJ3aW5kb3ciLCJxZyIsImEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwic3R5bGUiLCJpc09wZW5QcmVMb2FkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwibG9hZEFkIiwiYWRVbml0SWQiLCJjcmVhdGVCYW5uZXJBZCIsImdldFN5c3RlbUluZm9TeW5jIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJpIiwic2FmZUFyZWEiLCJoZWlnaHQiLCJ0b3AiLCJsZWZ0Iiwid2lkdGgiLCJhZElucyIsIm9uTG9hZCIsIm9uQ2xvc2UiLCJvbkFkQ2xvc2UiLCJvbkVycm9yIiwic2V0VGltZW91dCIsImlzTG9hZGVkIiwiYXV0b1Nob3ciLCJ3YXJuIiwiZXJyb3IiLCJvbkFkTG9hZCIsImNhbGwiLCJzaG93Q2FsbGJhY2siLCJzaG93QmFubmVyIiwiZXJyb3JDYWxsYmFjayIsImlzQ2FuU2hvdyIsImlzQXV0b1Nob3ciLCJpc0NvbnN1bWUiLCJyZUNyZWF0ZUFkIiwic2hvdyIsImZvcmJpZGRlbkJhbm5lciIsImhpZGVCYW5uZXIiLCJkZXN0cm95QWQiLCJoaWRlIiwib2ZmTG9hZCIsIm9mZkNsb3NlIiwib2ZmU2l6ZSIsIm9uUmVzaXplIiwib2ZmRXJyb3IiLCJkZXN0cm95Iiwib25BZEVycm9yIiwic2hvd2luZyIsImNsb3NlQ2FsbGJhY2siLCJvbkFkSGlkZSIsImhpZGVpbmciLCJCYXNlQWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjtBQUNBQyxPQUFPLENBQUNDLFFBQVIsR0FBbUIsS0FBSyxDQUF4Qjs7QUFDQSxJQUFJQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXJCOztBQUNBLElBQUlDLENB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QixJQUExQjtJQUNBLEtBQUtvQixPQUFMLEdBQWUsQ0FBQyxDQUFoQjtJQUNBLEtBQUtHLE9BQUwsR0FBZSxDQUFDLENBQWhCOztJQUNBLElBQUksS0FBS25ELGFBQVQsRUFBd0I7TUFDcEIsS0FBS21DLFVBQUwsQ0FBZ0IsQ0FBQyxDQUFqQjtJQUNIO0VBQ0osQ0FQRDs7RUFRQSxPQUFPdkMsQ0FBUDtBQUNILENBbEpPLENBa0pMUCxPQUFPLENBQUMrRCxNQWxKSCxDQUFSOztBQW1KQWpFLE9BQU8sQ0FBQ0MsUUFBUixHQUFtQk0sQ0FBbkIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLkhXQmFubmVyID0gdm9pZCAwO1xyXG52YXIgJGJhc2VBZCA9IHJlcXVpcmUoXCIuL0Jhc2VBZFwiKTtcclxudmFyIHIgPSB3aW5kb3cucWc7XHJcbnZhciBhID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuc3R5bGUgPSBudWxsO1xyXG4gICAgICAgIGUuaXNPcGVuUHJlTG9hZCA9ICExO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUubG9hZEFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLmNyZWF0ZUJhbm5lckFkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHIuZ2V0U3lzdGVtSW5mb1N5bmMoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib24gZ2V0U3lzdGVtSW5mb1N5bmM6IHN1Y2Nlc3MgPVwiICsgSlNPTi5zdHJpbmdpZnkoZSkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSBlLnNhZmVBcmVhLmhlaWdodDtcclxuICAgICAgICAgICAgICAgIHZhciBvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkVW5pdElkOiB0aGlzLmFkVW5pdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogaSAtIDU3LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDU3LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMzYwXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMgPSByLmNyZWF0ZUJhbm5lckFkKG8pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25Mb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25DbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25DbG9zZSh0aGlzLm9uQWRDbG9zZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkVycm9yKHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0LmlzTG9hZGVkID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hdXRvU2hvdygpO1xyXG4gICAgICAgICAgICAgICAgfSwgMWUzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuW9k+WJjeW5s+WPsOS4jeaUr+aMgeWIm+W7umJhbm5lclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJCYW5uZXIgSUTkuLrnqbpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRMb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRMb2FkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd0NhbGxiYWNrID0gbnVsbDtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zaG93QmFubmVyID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gaTtcclxuICAgICAgICBpZiAodGhpcy5pc0NhblNob3cpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yib5bu677yM5omn6KGM5Yib5bu6XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0F1dG9TaG93ID0gITA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWRBZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzQ29uc3VtZVxyXG4gICAgICAgICAgICAgICAgPyAoY29uc29sZS5sb2coXCJiYW5uZXIg5bey5raI6ICX6YeN5paw5Yib5bu6XCIpLCB0aGlzLnJlQ3JlYXRlQWQoITApKVxyXG4gICAgICAgICAgICAgICAgOiB0aGlzLmlzTG9hZGVkXHJcbiAgICAgICAgICAgICAgICA/ICgodGhpcy5pc0NvbnN1bWUgPSAhMSksXHJcbiAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuc2hvdyA/ICgodGhpcy5pc0NvbnN1bWUgPSAhMCksIHRoaXMuYWRJbnMuc2hvdygpLCB2b2lkIGNvbnNvbGUubG9nKFwi5pi+56S6YmFubmVyXCIpKSA6IHZvaWQgMClcclxuICAgICAgICAgICAgICAgIDogKGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliqDovb3lrozmiJDvvIznqI3nrYlcIiksIHZvaWQgKHRoaXMuaXNBdXRvU2hvdyA9ICEwKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrlvZPliY3lub/lkYrnpoHmraLmmL7npLpcIik7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZm9yYmlkZGVuQmFubmVyID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmlzQ2FuU2hvdyA9ICF0O1xyXG4gICAgICAgIGlmICh0ICYmIHRoaXMuaXNDb25zdW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZUJhbm5lcighMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmhpZGVCYW5uZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHQgJiYgdGhpcy5pc0NvbnN1bWVcclxuICAgICAgICAgICAgPyAodGhpcy5kZXN0cm95QWQoKSwgdGhpcy5yZUNyZWF0ZUFkKCExKSlcclxuICAgICAgICAgICAgOiB0aGlzLmFkSW5zICYmIHRoaXMuYWRJbnMuaGlkZSAmJiB0aGlzLmFkSW5zLmhpZGUoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZUNyZWF0ZUFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSB0O1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBlLmxvYWRBZCgpO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmQ2xvc2UodGhpcy5vbkFkQ2xvc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZlNpemUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmU2l6ZSh0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZFcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLmRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5hdXRvU2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F1dG9TaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dCYW5uZXIodGhpcy5zdHlsZSwgdGhpcy5zaG93Q2FsbGJhY2ssIHRoaXMuZXJyb3JDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRFcnJvciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZEVycm9yLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gITE7XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3JDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lBZCgpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRDbG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkQ2xvc2UuY2FsbCh0aGlzKTtcclxuICAgICAgICB0aGlzLnNob3dpbmcgPSAhMTtcclxuICAgICAgICBpZiAodGhpcy5jbG9zZUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2VDYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNsb3NlQ2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuUHJlTG9hZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlQ3JlYXRlQWQoITEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkSGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkSGlkZS5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIHRoaXMuaGlkZWluZyA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmlzT3BlblByZUxvYWQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlQWQuQmFzZUFkKTtcclxuZXhwb3J0cy5IV0Jhbm5lciA9IGE7XHJcbiJdfQ==