
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/OPPOGamePortal.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c644efCKENC8KfT6GeHzEN2', 'OPPOGamePortal');
// game_script/scripts/OPPOGamePortal.js

"use strict";

var o = window.qg;

var n = function () {
  function t() {
    this.adUnitId = null;
    this._adIns = null;
    this.isLoaded = !1;
    this.isAutoShow = !1;
    this.isConsume = !1;
    this.showing = !1;
    this.onLoad = null;
    this.onError = null;
    this.onClose = null;
    this.showCallback = null;
    this.closeCallback = null;
    this.errorCallback = null;
  }

  t.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (o && o.createGamePortalAd) {
        var t = {
          adUnitId: this.adUnitId
        };
        this._adIns = o.createGamePortalAd(t);

        if (this._adIns.onLoad) {
          this._adIns.onLoad(this.onLoad);
        }

        if (this._adIns.onClose) {
          this._adIns.onClose(this.onClose);
        }

        if (this._adIns.onError) {
          this._adIns.onError(this.onError);
        }

        this.isLoaded = !1;

        this._adIns.load();
      } else {
        console.warn("当前平台不支持创建OPPOGamePortal");
      }
    } else {
      console.error("oppo OPPOGamePortal ID为空");
    }
  };

  t.prototype.initAd = function (t) {
    this.adUnitId = t;
    this.onLoad = this.onAdLoad.bind(this);
    this.onClose = this.onAdClose.bind(this);
    this.onError = this.onAdError.bind(this);
  };

  t.prototype.showGamePortal = function (t, e, i) {
    var o = this;
    this.showCallback = t;
    this.closeCallback = e;
    this.errorCallback = i;
    return this._adIns ? this.isConsume ? this.reCreateAd(!0) : this.isLoaded ? void (this.showing ? console.warn(this.adUnitId, ":正在显示中，不给显示") : this._adIns ? this._adIns.show && this._adIns.show().then(function () {
      o.showing = !0;

      if (o.showCallback) {
        o.showCallback();
      }

      o.showCallback = null;
    })["catch"](function (t) {
      o.showing = !1;
      console.warn("interstitial show error:", t);
      o.destroyAd();
    }) : (console.warn("interstitial,interstitial对象未创建,将在创建完成后自动显示"), this.reCreateAd(!0))) : (console.warn(this.adUnitId, ":未加载完成，稍等"), void (this.isAutoShow = !0)) : (console.warn(this.adUnitId, ":未创建，执行创建"), this.isAutoShow = !0, this.loadAd());
  };

  t.prototype.reCreateAd = function (t) {
    this.destroyAd();
    this.isAutoShow = t;
    this.loadAd();
  };

  t.prototype.destroyAd = function () {
    console.log(this.adUnitId, ":===destroyAd===");
    this.isLoaded = !1;
    this.isAutoShow = !1;
    this.isConsume = !1;
    this.showCallback = null;
    this.errorCallback = null;

    if (this._adIns) {
      if (this._adIns.offLoad) {
        this._adIns.offLoad(this.onLoad);
      }

      if (this._adIns.offClose) {
        this._adIns.offClose(this.onClose);
      }

      if (this._adIns.offError) {
        this._adIns.offError(this.onError);
      }

      if (this._adIns.destroy) {
        this._adIns.destroy();
      }

      this._adIns = null;
    }
  };

  t.prototype.onAdLoad = function () {
    console.log(this.adUnitId, ":===onAdload===");
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  t.prototype.onAdError = function (t) {
    console.log(this.adUnitId, t);
    this.showing = !1;

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  t.prototype.onAdClose = function () {
    console.log(this.adUnitId, ":===onAdClose===");
    this.showing = !1;

    if (this.closeCallback) {
      this.closeCallback();
    }

    this.reCreateAd(!1);
  };

  t.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showGamePortal(this.showCallback, this.closeCallback, this.errorCallback);
    }
  };

  return t;
}();

exports["default"] = n;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXE9QUE9HYW1lUG9ydGFsLmpzIl0sIm5hbWVzIjpbIm8iLCJ3aW5kb3ciLCJxZyIsIm4iLCJ0IiwiYWRVbml0SWQiLCJfYWRJbnMiLCJpc0xvYWRlZCIsImlzQXV0b1Nob3ciLCJpc0NvbnN1bWUiLCJzaG93aW5nIiwib25Mb2FkIiwib25FcnJvciIsIm9uQ2xvc2UiLCJzaG93Q2FsbGJhY2siLCJjbG9zZUNhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsInByb3RvdHlwZSIsImxvYWRBZCIsImNyZWF0ZUdhbWVQb3J0YWxBZCIsImxvYWQiLCJjb25zb2xlIiwid2FybiIsImVycm9yIiwiaW5pdEFkIiwib25BZExvYWQiLCJiaW5kIiwib25BZENsb3NlIiwib25BZEVycm9yIiwic2hvd0dhbWVQb3J0YWwiLCJlIiwiaSIsInJlQ3JlYXRlQWQiLCJzaG93IiwidGhlbiIsImRlc3Ryb3lBZCIsImxvZyIsIm9mZkxvYWQiLCJvZmZDbG9zZSIsIm9mZkVycm9yIiwiZGVzdHJveSIsImF1dG9TaG93IiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFDLEdBQUdDLE1BQU0sQ0FBQ0MsRUFBZjs7QUFDQSxJQUFJQyxDQUFDLEdBQUksWUFBWTtFQUNqQixTQUFTQyxDQUFULEdBQWE7SUFDVCxLQUFLQyxRQUFMLEdBQWdCLElBQWhCO0lBQ0EsS0FBS0MsTUFBTCxHQUFjLElBQWQ7SUFDQSxLQUFLQyxRQUFMLEdBQWdCLENBQUMsQ0FBakI7SUFDQSxLQUFLQyxVQUFMLEdBQWtCLENBQUMsQ0FBbkI7SUFDQSxLQUFLQyxTQUFMLEdBQWlCLENBQUMsQ0FBbEI7SUFDQSxLQUFLQyxPQUFMLEdBQWUsQ0FBQyxDQUFoQjtJQUNBLEtBQUtDLE1BQUwsR0FBYyxJQUFkO0lBQ0EsS0FBS0MsT0FBTCxHQUFlLElBQWY7SUFDQSxLQUFLQyxPQUFMLEdBQWUsSUFBZjtJQUNBLEtBQUtD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LENBQVl3QixRQUFaLEdBQXVCLFlBQVk7SUFDL0IsSUFBSSxLQUFLakMsVUFBVCxFQUFxQjtNQUNqQixLQUFLQSxVQUFMLEdBQWtCLENBQUMsQ0FBbkI7TUFDQSxLQUFLcUIsY0FBTCxDQUFvQixLQUFLZixZQUF6QixFQUF1QyxLQUFLQyxhQUE1QyxFQUEyRCxLQUFLQyxhQUFoRTtJQUNIO0VBQ0osQ0FMRDs7RUFNQSxPQUFPWixDQUFQO0FBQ0gsQ0F2SU8sRUFBUjs7QUF3SUFzQyxPQUFPLFdBQVAsR0FBa0J2QyxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG8gPSB3aW5kb3cucWc7XHJcbnZhciBuID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIHQoKSB7XHJcbiAgICAgICAgdGhpcy5hZFVuaXRJZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSAhMTtcclxuICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIHRoaXMub25Mb2FkID0gbnVsbDtcclxuICAgICAgICB0aGlzLm9uRXJyb3IgPSBudWxsO1xyXG4gICAgICAgIHRoaXMub25DbG9zZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zaG93Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2xvc2VDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gbnVsbDtcclxuICAgIH1cclxuICAgIHQucHJvdG90eXBlLmxvYWRBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBvLmNyZWF0ZUdhbWVQb3J0YWxBZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRVbml0SWQ6IHRoaXMuYWRVbml0SWRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZElucyA9IG8uY3JlYXRlR2FtZVBvcnRhbEFkKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2FkSW5zLm9uTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkSW5zLm9uTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWRJbnMub25DbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkSW5zLm9uQ2xvc2UodGhpcy5vbkNsb3NlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hZElucy5vbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRJbnMub25FcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRlZCA9ICExO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYWRJbnMubG9hZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwi5b2T5YmN5bmz5Y+w5LiN5pSv5oyB5Yib5bu6T1BQT0dhbWVQb3J0YWxcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwib3BwbyBPUFBPR2FtZVBvcnRhbCBJROS4uuepulwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUuaW5pdEFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmFkVW5pdElkID0gdDtcclxuICAgICAgICB0aGlzLm9uTG9hZCA9IHRoaXMub25BZExvYWQuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLm9uQ2xvc2UgPSB0aGlzLm9uQWRDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMub25FcnJvciA9IHRoaXMub25BZEVycm9yLmJpbmQodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUuc2hvd0dhbWVQb3J0YWwgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBvID0gdGhpcztcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IHQ7XHJcbiAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrID0gZTtcclxuICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2sgPSBpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hZEluc1xyXG4gICAgICAgICAgICA/IHRoaXMuaXNDb25zdW1lXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMucmVDcmVhdGVBZCghMClcclxuICAgICAgICAgICAgICAgIDogdGhpcy5pc0xvYWRlZFxyXG4gICAgICAgICAgICAgICAgPyB2b2lkICh0aGlzLnNob3dpbmdcclxuICAgICAgICAgICAgICAgICAgICAgID8gY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuato+WcqOaYvuekuuS4re+8jOS4jee7meaYvuekulwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLl9hZEluc1xyXG4gICAgICAgICAgICAgICAgICAgICAgPyB0aGlzLl9hZElucy5zaG93ICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkSW5zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93aW5nID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uc2hvd0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uc2hvd0NhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnNob3dpbmcgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJpbnRlcnN0aXRpYWwgc2hvdyBlcnJvcjpcIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5kZXN0cm95QWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4oXCJpbnRlcnN0aXRpYWwsaW50ZXJzdGl0aWFs5a+56LGh5pyq5Yib5bu6LOWwhuWcqOWIm+W7uuWujOaIkOWQjuiHquWKqOaYvuekulwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCEwKSkpXHJcbiAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yqg6L295a6M5oiQ77yM56iN562JXCIpLCB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCkpXHJcbiAgICAgICAgICAgIDogKGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliJvlu7rvvIzmiafooYzliJvlu7pcIiksICh0aGlzLmlzQXV0b1Nob3cgPSAhMCksIHRoaXMubG9hZEFkKCkpO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLnJlQ3JlYXRlQWQgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICAgICAgdGhpcy5pc0F1dG9TaG93ID0gdDtcclxuICAgICAgICB0aGlzLmxvYWRBZCgpO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFkVW5pdElkLCBcIjo9PT1kZXN0cm95QWQ9PT1cIik7XHJcbiAgICAgICAgdGhpcy5pc0xvYWRlZCA9ICExO1xyXG4gICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICExO1xyXG4gICAgICAgIHRoaXMuaXNDb25zdW1lID0gITE7XHJcbiAgICAgICAgdGhpcy5zaG93Q2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZXJyb3JDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuX2FkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hZElucy5vZmZMb2FkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZElucy5vZmZMb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5fYWRJbnMub2ZmQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2FkSW5zLm9mZkNsb3NlKHRoaXMub25DbG9zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuX2FkSW5zLm9mZkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZElucy5vZmZFcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9hZElucy5kZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hZElucy5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5vbkFkTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFkVW5pdElkLCBcIjo9PT1vbkFkbG9hZD09PVwiKTtcclxuICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSAhMDtcclxuICAgICAgICB0aGlzLmF1dG9TaG93KCk7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUub25BZEVycm9yID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFkVW5pdElkLCB0KTtcclxuICAgICAgICB0aGlzLnNob3dpbmcgPSAhMTtcclxuICAgICAgICBpZiAodGhpcy5lcnJvckNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXJyb3JDYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRlc3Ryb3lBZCgpO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLm9uQWRDbG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFkVW5pdElkLCBcIjo9PT1vbkFkQ2xvc2U9PT1cIik7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gITE7XHJcbiAgICAgICAgaWYgKHRoaXMuY2xvc2VDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCExKTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5hdXRvU2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F1dG9TaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dHYW1lUG9ydGFsKHRoaXMuc2hvd0NhbGxiYWNrLCB0aGlzLmNsb3NlQ2FsbGJhY2ssIHRoaXMuZXJyb3JDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiB0O1xyXG59KSgpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBuO1xyXG4iXX0=