
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/AssetsLoader.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '05b2dIqlNlDxYRbfykI4zla', 'AssetsLoader');
// game_script/scripts/AssetsLoader.js

"use strict";

exports.BundleLoader = void 0;

var s = function () {
  function t() {}

  t.prototype.loadBundleSync = function (t, e, i) {
    return __awaiter(this, void 0, Promise, function () {
      return __generator(this, function () {
        return [2, new Promise(function (o, n) {
          var s = cc.assetManager.getBundle(t);

          if (s) {
            if (i) {
              i(null, s);
            }

            return o(s);
          }

          cc.assetManager.loadBundle(t, {
            onFileProgress: function onFileProgress(t) {
              var i = t.progress;

              if (i && e) {
                e(i / 100);
              }
            }
          }, function (t, e) {
            return t ? (i && i(t, null), n(t)) : (i && i(null, e), o(e));
          });
        })["catch"](function (t) {
          console.error(t);
        })];
      });
    });
  };

  t.prototype.loadRes = function (t, e, i, o, n) {
    var s = cc.assetManager.getBundle(t);

    if (!s) {
      console.error("bundle未加载或不存在 ==> " + t);
    }

    s.load(e, i, function (t, e) {
      if (o) {
        o(t, e);
      }
    }, function (t, e) {
      t ? (console.warn("不存在资源 ==> ", t), n && n(t, null)) : n && n(null, e);
    });
  };

  t.prototype.loadResSync = function (t, e, i, s, r) {
    return __awaiter(this, void 0, Promise, function () {
      return __generator(this, function () {
        return [2, new Promise(function (o, n) {
          var a = cc.assetManager.getBundle(t);

          if (!a) {
            n("检测bundle是否加载：" + t);
          }

          a.load(e, i, function (t, e) {
            if (s) {
              s(t, e);
            }
          }, function (t, e) {
            t ? n("资源未找到： " + t) : o(e);

            if (r) {
              r(t, e);
            }
          });
        })["catch"](function (t) {
          console.warn(t);
        })];
      });
    });
  };

  t.prototype.preLoadRes = function (t, e, i, o, n) {
    var s = cc.assetManager.getBundle(t);

    if (!s) {
      console.warn("检测bundle是否加载： " + t);
    }

    s.preload(e, i, function (t, e) {
      if (o) {
        o(t, e);
      }
    }, function (t, e) {
      t ? (console.warn("资源未找到：" + t), n && n(t, null)) : n && n(null, e);
    });
  };

  t.prototype.release = function (t, e) {
    if (void 0 === e) {
      e = !0;
    }

    if ("string" == typeof t) {
      t = cc.assetManager.getBundle(t);
    }

    t ? (e && t.releaseAll(), cc.assetManager.removeBundle(t)) : console.error("bundle未找到");
  };

  t.prototype.getBundle = function (t) {
    return cc.assetManager.getBundle(t);
  };

  t.prototype.getRes = function (t, e, i) {
    var o = this.getBundle(t);
    return o ? o.get(e, i || cc.Asset) || (console.warn("资源未找到, " + t + "," + e), null) : (console.error("bundle未加载, " + t), null);
  };

  t.prototype.getResArray = function (t, e, i) {
    var o = this.getBundle(t);

    if (!o) {
      console.error("bundle未加载, " + t);
      return null;
    }

    var n = new Array();

    for (var s = 0; s < e.length; s++) {
      var r = o.get(e[s], i || cc.Asset);
      r ? n.push(r) : console.error("资源未找到, " + t + "," + e[s]);
    }

    return n;
  };

  t.prototype.isBundleLoaded = function (t) {
    return !!this.getBundle(t);
  };

  t.prototype.isResLoaded = function (t, e, i) {
    var o = this.getBundle(t);
    return !!o && !!o.get(e, i || cc.Asset);
  };

  t.instance = new t();
  return t;
}();

exports["default"] = s;

exports.BundleLoader = function (t, e, i) {
  this._bundleName = t;
  this._onProgCallBack = e;
  this._cmpCallBack = i;
  s.instance.loadBundleSync(t, e, i);
};

cc.sys.localStorage.getItem("LastAssetsVersion") !== cc.assetManager.downloader.remoteServerAddress ? cc.assetManager.cacheManager && cc.assetManager.cacheManager.clearCache ? (cc.assetManager.cacheManager.clearCache(), cc.sys.localStorage.setItem("LastAssetsVersion", cc.assetManager.downloader.remoteServerAddress), console.warn("old assets is removed")) : console.warn("cur cc.assetManager.cacheManager is null") : console.warn("old assets have no change");

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEFzc2V0c0xvYWRlci5qcyJdLCJuYW1lcyI6WyJleHBvcnRzIiwiQnVuZGxlTG9hZGVyIiwicyIsInQiLCJwcm90b3R5cGUiLCJsb2FkQnVuZGxlU3luYyIsImUiLCJpIiwiX19hd2FpdGVyIiwiUHJvbWlzZSIsIl9fZ2VuZXJhdG9yIiwibyIsIm4iLCJjYyIsImFzc2V0TWFuYWdlciIsImdldEJ1bmRsZSIsImxvYWRCdW5kbGUiLCJvbkZpbGVQcm9ncmVzcyIsInByb2dyZXNzIiwiY29uc29sZSIsImVycm9yIiwibG9hZFJlcyIsImxvYWQiLCJ3YXJuIiwibG9hZFJlc1N5bmMiLCJyIiwiYSIsInByZUxvYWRSZXMiLCJwcmVsb2FkIiwicmVsZWFzZSIsInJlbGVhc2VBbGwiLCJyZW1vdmVCdW5kbGUiLCJnZXRSZXMiLCJnZXQiLCJBc3NldCIsImdldFJlc0FycmF5IiwiQXJyYXkiLCJsZW5ndGgiLCJwdXNoIiwiaXNCdW5kbGVMb2FkZWQiLCJpc1Jlc0xvYWRlZCIsImluc3RhbmNlIiwiX2J1bmRsZU5hbWUiLCJfb25Qcm9nQ2FsbEJhY2siLCJfY21wQ2FsbEJhY2siLCJzeXMiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZG93bmxvYWRlciIsInJlbW90ZVNlcnZlckFkZHJlc3MiLCJjYWNoZU1hbmFnZXIiLCJjbGVhckNhY2hlIiwic2V0SXRlbSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQUEsT0FBTyxDQUFDQyxZQUFSLEdBQXVCLEtBQUssQ0FBNUI7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFJLFlBQVk7RUFDakIsU0FBU0MsQ0FBVCxHQUFhLENBQUU7O0VBQ2ZBLENBQUMsQ0FBQ0MsU0FBRixDQUFZQyxjQUFaLEdBQTZCLFVBQVVGLENBQVYsRUFBYUcsQ0FBYixFQUFnQkMsQ0FBaEIsRUFBbUI7SUFDNUMsT0FBT0MsU0FBUyxDQUFDLElBQUQsRUFBTyxLQUFLLENBQVosRUFBZUMs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QUUsQ0FBQ0MsWUFBSCxDQUFnQm9DLFlBQWhCLElBQWdDckMsRUFBRSxDQUFDQyxZQUFILENBQWdCb0MsWUFBaEIsQ0FBNkJDLFVBQTdELElBQ0t0QyxFQUFFLENBQUNDLFlBQUgsQ0FBZ0JvQyxZQUFoQixDQUE2QkMsVUFBN0IsSUFDRHRDLEVBQUUsQ0FBQ2dDLEdBQUgsQ0FBT0MsWUFBUCxDQUFvQk0sT0FBcEIsQ0FBNEIsbUJBQTVCLEVBQWlEdkMsRUFBRSxDQUFDQyxZQUFILENBQWdCa0MsVUFBaEIsQ0FBMkJDLG1CQUE1RSxDQURDLEVBRUQ5QixPQUFPLENBQUNJLElBQVIsQ0FBYSx1QkFBYixDQUhKLElBSUlKLE9BQU8sQ0FBQ0ksSUFBUixDQUFhLDBDQUFiLENBTFYsR0FNTUosT0FBTyxDQUFDSSxJQUFSLENBQWEsMkJBQWIsQ0FOTiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cy5CdW5kbGVMb2FkZXIgPSB2b2lkIDA7XHJcbnZhciBzID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIHQoKSB7fVxyXG4gICAgdC5wcm90b3R5cGUubG9hZEJ1bmRsZVN5bmMgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCBQcm9taXNlLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICAgICAgICAgIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IFByb21pc2UoZnVuY3Rpb24gKG8sIG4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMgPSBjYy5hc3NldE1hbmFnZXIuZ2V0QnVuZGxlKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpKG51bGwsIHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG8ocyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2MuYXNzZXRNYW5hZ2VyLmxvYWRCdW5kbGUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uRmlsZVByb2dyZXNzOiBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IHQucHJvZ3Jlc3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpICYmIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUoaSAvIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdCA/IChpICYmIGkodCwgbnVsbCksIG4odCkpIDogKGkgJiYgaShudWxsLCBlKSwgbyhlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcih0KTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUubG9hZFJlcyA9IGZ1bmN0aW9uICh0LCBlLCBpLCBvLCBuKSB7XHJcbiAgICAgICAgdmFyIHMgPSBjYy5hc3NldE1hbmFnZXIuZ2V0QnVuZGxlKHQpO1xyXG4gICAgICAgIGlmICghcykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiYnVuZGxl5pyq5Yqg6L295oiW5LiN5a2Y5ZyoID09PiBcIiArIHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzLmxvYWQoXHJcbiAgICAgICAgICAgIGUsXHJcbiAgICAgICAgICAgIGksXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIG8odCwgZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0ID8gKGNvbnNvbGUud2FybihcIuS4jeWtmOWcqOi1hOa6kCA9PT4gXCIsIHQpLCBuICYmIG4odCwgbnVsbCkpIDogbiAmJiBuKG51bGwsIGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5sb2FkUmVzU3luYyA9IGZ1bmN0aW9uICh0LCBlLCBpLCBzLCByKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIFByb21pc2UsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgICAgICAgICAgMixcclxuICAgICAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAobywgbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGNjLmFzc2V0TWFuYWdlci5nZXRCdW5kbGUodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbihcIuajgOa1i2J1bmRsZeaYr+WQpuWKoOi9ve+8mlwiICsgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYS5sb2FkKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHModCwgZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA/IG4oXCLotYTmupDmnKrmib7liLDvvJogXCIgKyB0KSA6IG8oZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcih0LCBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5wcmVMb2FkUmVzID0gZnVuY3Rpb24gKHQsIGUsIGksIG8sIG4pIHtcclxuICAgICAgICB2YXIgcyA9IGNjLmFzc2V0TWFuYWdlci5nZXRCdW5kbGUodCk7XHJcbiAgICAgICAgaWYgKCFzKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuajgOa1i2J1bmRsZeaYr+WQpuWKoOi9ve+8miBcIiArIHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzLnByZWxvYWQoXHJcbiAgICAgICAgICAgIGUsXHJcbiAgICAgICAgICAgIGksXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICAgICAgICAgIG8odCwgZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICB0ID8gKGNvbnNvbGUud2FybihcIui1hOa6kOacquaJvuWIsO+8mlwiICsgdCksIG4gJiYgbih0LCBudWxsKSkgOiBuICYmIG4obnVsbCwgZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIHQucHJvdG90eXBlLnJlbGVhc2UgPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIGlmICh2b2lkIDAgPT09IGUpIHtcclxuICAgICAgICAgICAgZSA9ICEwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkge1xyXG4gICAgICAgICAgICB0ID0gY2MuYXNzZXRNYW5hZ2VyLmdldEJ1bmRsZSh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdCA/IChlICYmIHQucmVsZWFzZUFsbCgpLCBjYy5hc3NldE1hbmFnZXIucmVtb3ZlQnVuZGxlKHQpKSA6IGNvbnNvbGUuZXJyb3IoXCJidW5kbGXmnKrmib7liLBcIik7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUuZ2V0QnVuZGxlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICByZXR1cm4gY2MuYXNzZXRNYW5hZ2VyLmdldEJ1bmRsZSh0KTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5nZXRSZXMgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBvID0gdGhpcy5nZXRCdW5kbGUodCk7XHJcbiAgICAgICAgcmV0dXJuIG9cclxuICAgICAgICAgICAgPyBvLmdldChlLCBpIHx8IGNjLkFzc2V0KSB8fCAoY29uc29sZS53YXJuKFwi6LWE5rqQ5pyq5om+5YiwLCBcIiArIHQgKyBcIixcIiArIGUpLCBudWxsKVxyXG4gICAgICAgICAgICA6IChjb25zb2xlLmVycm9yKFwiYnVuZGxl5pyq5Yqg6L29LCBcIiArIHQpLCBudWxsKTtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5nZXRSZXNBcnJheSA9IGZ1bmN0aW9uICh0LCBlLCBpKSB7XHJcbiAgICAgICAgdmFyIG8gPSB0aGlzLmdldEJ1bmRsZSh0KTtcclxuICAgICAgICBpZiAoIW8pIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImJ1bmRsZeacquWKoOi9vSwgXCIgKyB0KTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuID0gbmV3IEFycmF5KCk7XHJcbiAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBlLmxlbmd0aDsgcysrKSB7XHJcbiAgICAgICAgICAgIHZhciByID0gby5nZXQoZVtzXSwgaSB8fCBjYy5Bc3NldCk7XHJcbiAgICAgICAgICAgIHIgPyBuLnB1c2gocikgOiBjb25zb2xlLmVycm9yKFwi6LWE5rqQ5pyq5om+5YiwLCBcIiArIHQgKyBcIixcIiArIGVbc10pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbjtcclxuICAgIH07XHJcbiAgICB0LnByb3RvdHlwZS5pc0J1bmRsZUxvYWRlZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgcmV0dXJuICEhdGhpcy5nZXRCdW5kbGUodCk7XHJcbiAgICB9O1xyXG4gICAgdC5wcm90b3R5cGUuaXNSZXNMb2FkZWQgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBvID0gdGhpcy5nZXRCdW5kbGUodCk7XHJcbiAgICAgICAgcmV0dXJuICEhbyAmJiAhIW8uZ2V0KGUsIGkgfHwgY2MuQXNzZXQpO1xyXG4gICAgfTtcclxuICAgIHQuaW5zdGFuY2UgPSBuZXcgdCgpO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn0pKCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHM7XHJcbmV4cG9ydHMuQnVuZGxlTG9hZGVyID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgIHRoaXMuX2J1bmRsZU5hbWUgPSB0O1xyXG4gICAgdGhpcy5fb25Qcm9nQ2FsbEJhY2sgPSBlO1xyXG4gICAgdGhpcy5fY21wQ2FsbEJhY2sgPSBpO1xyXG4gICAgcy5pbnN0YW5jZS5sb2FkQnVuZGxlU3luYyh0LCBlLCBpKTtcclxufTtcclxuY2Muc3lzLmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiTGFzdEFzc2V0c1ZlcnNpb25cIikgIT09IGNjLmFzc2V0TWFuYWdlci5kb3dubG9hZGVyLnJlbW90ZVNlcnZlckFkZHJlc3NcclxuICAgID8gY2MuYXNzZXRNYW5hZ2VyLmNhY2hlTWFuYWdlciAmJiBjYy5hc3NldE1hbmFnZXIuY2FjaGVNYW5hZ2VyLmNsZWFyQ2FjaGVcclxuICAgICAgICA/IChjYy5hc3NldE1hbmFnZXIuY2FjaGVNYW5hZ2VyLmNsZWFyQ2FjaGUoKSxcclxuICAgICAgICAgIGNjLnN5cy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIkxhc3RBc3NldHNWZXJzaW9uXCIsIGNjLmFzc2V0TWFuYWdlci5kb3dubG9hZGVyLnJlbW90ZVNlcnZlckFkZHJlc3MpLFxyXG4gICAgICAgICAgY29uc29sZS53YXJuKFwib2xkIGFzc2V0cyBpcyByZW1vdmVkXCIpKVxyXG4gICAgICAgIDogY29uc29sZS53YXJuKFwiY3VyIGNjLmFzc2V0TWFuYWdlci5jYWNoZU1hbmFnZXIgaXMgbnVsbFwiKVxyXG4gICAgOiBjb25zb2xlLndhcm4oXCJvbGQgYXNzZXRzIGhhdmUgbm8gY2hhbmdlXCIpO1xyXG4iXX0=