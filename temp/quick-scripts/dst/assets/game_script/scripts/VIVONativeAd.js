
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/VIVONativeAd.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b4471OD7LNPRKtCgf0d+ma1', 'VIVONativeAd');
// game_script/scripts/VIVONativeAd.js

"use strict";

var o;
exports.VIVONativeAd = void 0;

var $baseAdNode = require("./BaseAdNode");

var r = window.qg;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.adViewName = null;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (r && r.createNativeAd) {
        var t = {
          adUnitId: this.adUnitId
        };
        this.adIns = r.createNativeAd(t);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }

        this.adIns.load();
      } else {
        console.warn("组件不支持NativeAd");
      }
    } else {
      console.error("vivoNative ID为空");
    }
  };

  e.prototype.showNativeAd = function (t, e, i, o) {
    var n = this;
    this.showCallback = e;
    this.errorCallback = o;
    this.closeCallback = i;

    if (this.isCanShow) {
      return this.hideing || !this.isLoaded ? (console.warn(this.adUnitId, ":正在隐藏或加载中，稍等"), void (this.isAutoShow = !0)) : !this.adIns || this.adData ? this.reCreateAd(!0) : void (this.isLoaded && this.adData && (this.isConsume = !0, this.createNativeAd(t, function () {
        if (n.adIns && n.adData) {
          n.adIns.reportAdClick({
            adId: n.adData.adId.toString()
          });
        }

        if (n.showCallback) {
          n.showCallback();
        }

        n.destroyAd();
        n.reCreateAd(!1);
      }, function () {
        if (n.closeCallback) {
          n.closeCallback();
        }

        n.reCreateAd(!1);
      }), this.setAdData(this.adData.icon, this.adData.title, this.adData.desc), this.adIns.reportAdShow({
        adId: this.adData.adId.toString()
      })));
    }

    console.warn(this.adUnitId, ":当前广告禁止显示");
  };

  e.prototype.forbiddenNativeAd = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideNativeAd(!1);
    }
  };

  e.prototype.hideNativeAd = function (t) {
    t && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : this.destroyAd();
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);
    this.adData = null;

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showNativeAd(this.adViewName, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function (e) {
    t.prototype.onAdLoad.call(this, e);
    this.isConsume = !1;
    this.isLoaded = !0;

    if (e && e.adList && e.adList.length > 0) {
      var i = e.adList.pop();
      this.adData = i;
      this.autoShow();
    }
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);
    console.error("onAdError", this.adUnitId, e);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdClose = function (e) {
    t.prototype.onAdClose.call(this, e);
    this.destroyNativeAdNode();
  };

  return e;
}($baseAdNode["default"]);

exports.VIVONativeAd = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFZJVk9OYXRpdmVBZC5qcyJdLCJuYW1lcyI6WyJvIiwiZXhwb3J0cyIsIlZJVk9OYXRpdmVBZCIsIiRiYXNlQWROb2RlIiwicmVxdWlyZSIsInIiLCJ3aW5kb3ciLCJxZyIsImEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYWRWaWV3TmFtZSIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsImxvYWRBZCIsImFkVW5pdElkIiwiY3JlYXRlTmF0aXZlQWQiLCJhZElucyIsIm9uTG9hZCIsIm9uRXJyb3IiLCJsb2FkIiwiY29uc29sZSIsIndhcm4iLCJlcnJvciIsInNob3dOYXRpdmVBZCIsImkiLCJuIiwic2hvd0NhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsImNsb3NlQ2FsbGJhY2siLCJpc0NhblNob3ciLCJoaWRlaW5nIiwiaXNMb2FkZWQiLCJpc0F1dG9TaG93IiwiYWREYXRhIiwicmVDcmVhdGVBZCIsImlzQ29uc3VtZSIsInJlcG9ydEFkQ2xpY2siLCJhZElkIiwidG9TdHJpbmciLCJkZXN0cm95QWQiLCJzZXRBZERhdGEiLCJpY29uIiwidGl0bGUiLCJkZXNjIiwicmVwb3J0QWRTaG93IiwiZm9yYmlkZGVuTmF0aXZlQWQiLCJoaWRlTmF0aXZlQWQiLCJjYWxsIiwib2ZmTG9hZCIsIm9mZkVycm9yIiwiZGVzdHJveSIsImF1dG9TaG93Iiwib25BZExvYWQiLCJhZExpc3QiLCJsZW5ndGgiLCJwb3AiLCJvbkFkRXJyb3IiLCJvbkFkQ2xvc2UiLCJkZXN0cm95TmF0aXZlQWROb2RlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7QUFDQUMsT0FBTyxDQUFDQyxZQUFSLEdBQXVCLEtBQUssQ0FBNUI7O0FBQ0EsSUFBSUMsV0FBVyxHQUFHQyxPQUFPLENBQUMsY0FBRCxDQUF6Qjs7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1BQU0sQ0FBQ0MsRUFBZjs7QUFD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QUFDTSxTQUFGLENBQVk0QyxTQUFaLENBQXNCVCxJQUF0QixDQUEyQixJQUEzQixFQUFpQ3hDLENBQWpDO0lBQ0FhLE9BQU8sQ0FBQ0UsS0FBUixDQUFjLFdBQWQsRUFBMkIsS0FBS1IsUUFBaEMsRUFBMENQLENBQTFDOztJQUNBLElBQUksS0FBS29CLGFBQVQsRUFBd0I7TUFDcEIsS0FBS0EsYUFBTDtJQUNIOztJQUNELEtBQUtZLFNBQUw7RUFDSCxDQVBEOztFQVFBaEMsQ0FBQyxDQUFDSyxTQUFGLENBQVk2QyxTQUFaLEdBQXdCLFVBQVVsRCxDQUFWLEVBQWE7SUFDakNELENBQUMsQ0FBQ00sU0FBRixDQUFZNkMsU0FBWixDQUFzQlYsSUFBdEIsQ0FBMkIsSUFBM0IsRUFBaUN4QyxDQUFqQztJQUNBLEtBQUttRCxtQkFBTDtFQUNILENBSEQ7O0VBSUEsT0FBT25ELENBQVA7QUFDSCxDQTdITyxDQTZITFAsV0FBVyxXQTdITixDQUFSOztBQThIQUYsT0FBTyxDQUFDQyxZQUFSLEdBQXVCTSxDQUF2QiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbmV4cG9ydHMuVklWT05hdGl2ZUFkID0gdm9pZCAwO1xyXG52YXIgJGJhc2VBZE5vZGUgPSByZXF1aXJlKFwiLi9CYXNlQWROb2RlXCIpO1xyXG52YXIgciA9IHdpbmRvdy5xZztcclxudmFyIGEgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5hZFZpZXdOYW1lID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmxvYWRBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLmNyZWF0ZU5hdGl2ZUFkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBhZFVuaXRJZDogdGhpcy5hZFVuaXRJZFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMgPSByLmNyZWF0ZU5hdGl2ZUFkKHQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25Mb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25FcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5sb2FkKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLnu4Tku7bkuI3mlK/mjIFOYXRpdmVBZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJ2aXZvTmF0aXZlIElE5Li656m6XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zaG93TmF0aXZlQWQgPSBmdW5jdGlvbiAodCwgZSwgaSwgbykge1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gbztcclxuICAgICAgICB0aGlzLmNsb3NlQ2FsbGJhY2sgPSBpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2FuU2hvdykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oaWRlaW5nIHx8ICF0aGlzLmlzTG9hZGVkXHJcbiAgICAgICAgICAgICAgICA/IChjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65q2j5Zyo6ZqQ6JeP5oiW5Yqg6L295Lit77yM56iN562JXCIpLCB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCkpXHJcbiAgICAgICAgICAgICAgICA6ICF0aGlzLmFkSW5zIHx8IHRoaXMuYWREYXRhXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMucmVDcmVhdGVBZCghMClcclxuICAgICAgICAgICAgICAgIDogdm9pZCAoXHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGVkICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkRGF0YSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgKCh0aGlzLmlzQ29uc3VtZSA9ICEwKSxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlTmF0aXZlQWQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmFkSW5zICYmIG4uYWREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmFkSW5zLnJlcG9ydEFkQ2xpY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkSWQ6IG4uYWREYXRhLmFkSWQudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uc2hvd0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNob3dDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uZGVzdHJveUFkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ucmVDcmVhdGVBZCghMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmNsb3NlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uY2xvc2VDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ucmVDcmVhdGVBZCghMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QWREYXRhKHRoaXMuYWREYXRhLmljb24sIHRoaXMuYWREYXRhLnRpdGxlLCB0aGlzLmFkRGF0YS5kZXNjKSxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMucmVwb3J0QWRTaG93KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBhZElkOiB0aGlzLmFkRGF0YS5hZElkLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgICAgICAgICAgIH0pKVxyXG4gICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65b2T5YmN5bm/5ZGK56aB5q2i5pi+56S6XCIpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmZvcmJpZGRlbk5hdGl2ZUFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmlzQ2FuU2hvdyA9ICF0O1xyXG4gICAgICAgIGlmICh0ICYmIHRoaXMuaXNDb25zdW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZU5hdGl2ZUFkKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuaGlkZU5hdGl2ZUFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0ICYmIHRoaXMuaXNDb25zdW1lID8gKHRoaXMuZGVzdHJveUFkKCksIHRoaXMucmVDcmVhdGVBZCghMSkpIDogdGhpcy5kZXN0cm95QWQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5kZXN0cm95QWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUuZGVzdHJveUFkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgdGhpcy5hZERhdGEgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmRXJyb3IodGhpcy5vbkVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5kZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFkSW5zID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYXV0b1Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvU2hvdykge1xyXG4gICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaG93TmF0aXZlQWQodGhpcy5hZFZpZXdOYW1lLCB0aGlzLnNob3dDYWxsYmFjaywgdGhpcy5lcnJvckNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZExvYWQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRMb2FkLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgdGhpcy5pc0NvbnN1bWUgPSAhMTtcclxuICAgICAgICB0aGlzLmlzTG9hZGVkID0gITA7XHJcbiAgICAgICAgaWYgKGUgJiYgZS5hZExpc3QgJiYgZS5hZExpc3QubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGUuYWRMaXN0LnBvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLmFkRGF0YSA9IGk7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b1Nob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZEVycm9yID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkRXJyb3IuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwib25BZEVycm9yXCIsIHRoaXMuYWRVbml0SWQsIGUpO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZENsb3NlID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkQ2xvc2UuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lOYXRpdmVBZE5vZGUoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZTtcclxufSkoJGJhc2VBZE5vZGUuZGVmYXVsdCk7XHJcbmV4cG9ydHMuVklWT05hdGl2ZUFkID0gYTtcclxuIl19