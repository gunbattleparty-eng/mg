
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Egg1.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '89ce7CVIz9BD6UprC6GRFmr', 'Egg1');
// game_script/scripts/Egg1.js

"use strict";

var o;

var $assetsMap = require("./AssetsMap");

var $popupManager = require("./PopupManager");

var $globalParam = require("./GlobalParam");

var $userDataContext = require("./UserDataContext");

var u = cc._decorator;
var d = u.ccclass;
var p = u.property;

var f = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.prop = null;
    e.box = null;
    e.count = 0;
    e.dir = -1;
    e.initPos = null;
    e.isKey = !1;
    e.isTouchProp = !1;
    e.dis = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.start = function () {
    this.initPos = this.prop.position.clone();
    this.prop.on(cc.Node.EventType.TOUCH_START, this.touchProp, this);
    this.prop.on(cc.Node.EventType.TOUCH_MOVE, this.moveProp, this);
    this.prop.on(cc.Node.EventType.TOUCH_END, this.endProp, this);
    this.prop.on(cc.Node.EventType.TOUCH_CANCEL, this.endProp, this);
    this.box.on(cc.Node.EventType.TOUCH_START, this.touchBox, this);
  };

  e.prototype.touchProp = function () {
    this.isTouchProp = !0;
  };

  e.prototype.moveProp = function (t) {
    this.count >= 3 ? this.isTouchProp && (this.prop.position = this.prop.position.add(cc.v3(t.getDelta()))) : (this.dis += t.getDeltaX(), -1 === this.dir ? this.dis >= 30 && (this.dis = 0, this.count++, this.dir = 1, this.renderProp()) : this.dis <= -30 && (this.dis = 0, this.count++, this.dir = -1, this.renderProp()), this.count >= 3 && (t.stopPropagationImmediate(), this.isTouchProp = !1, this.renderProp()));
  };

  e.prototype.endProp = function () {
    this.isTouchProp = !1;

    if (!(this.count < 3)) {
      if (this.prop.position.sub(this.box.position).mag() < 100) {
        this.prop.active = !1;
        var t = this.box.getComponent(dragonBones.ArmatureDisplay);
        this.prop.active = !1;
        t.playAnimation("qiao_2", 1);
        t.once(dragonBones.EventObject.COMPLETE, function () {
          t.playAnimation("qiao_3", 1);
        }, this);
      } else {
        this.prop.position = this.initPos.clone();
      }
    }
  };

  e.prototype.touchBox = function () {
    var t = this;

    if (!(this.prop.active || this.isKey || $globalParam["default"].isGamePuase)) {
      $globalParam["default"].isGamePuase = !0;
      $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.EggKeyView, {
        type: 1
      }, {
        closeCallback: function closeCallback() {
          $globalParam["default"].isGamePuase = !1;

          if ($userDataContext["default"].Ins.getEgg(1) >= 1) {
            t.box.getComponent(dragonBones.ArmatureDisplay).playAnimation("qiao_4", 0);
            t.isKey = !0;
          }
        }
      });
    }
  };

  e.prototype.renderProp = function () {
    for (var t = 0; t < this.prop.children.length; t++) {
      this.prop.children[t].active = t === this.count;
    }
  };

  __decorate([p(cc.Node)], e.prototype, "prop", void 0);

  __decorate([p(cc.Node)], e.prototype, "box", void 0);

  return __decorate([d], e);
}(cc.Component);

exports["default"] = f;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEVnZzEuanMiXSwibmFtZXMiOlsibyIsIiRhc3NldHNNYXAiLCJyZXF1aXJlIiwiJHBvcHVwTWFuYWdlciIsIiRnbG9iYWxQYXJhbSIsIiR1c2VyRGF0YUNvbnRleHQiLCJ1IiwiY2MiLCJfZGVjb3JhdG9yIiwiZCIsImNjY2xhc3MiLCJwIiwicHJvcGVydHkiLCJmIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInByb3AiLCJib3giLCJjb3VudCIsImRpciIsImluaXRQb3MiLCJpc0tleSIsImlzVG91Y2hQcm9wIiwiZGlzIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwic3RhcnQiLCJwb3NpdGlvbiIsImNsb25lIiwib24iLCJOb2RlIiwiRXZlbnRUeXBlIiwiVE9VQ0hfU1RBUlQiLCJ0b3VjaFByb3AiLCJUT1VDSF9NT1ZFIiwibW92ZVByb3AiLCJUT1VDSF9FTkQiLCJlbmRQcm9wIiwiVE9VQ0hfQ0FOQ0VMIiwidG91Y2hCb3giLCJhZGQiLCJ2MyIsImdldERlbHRhIiwiZ2V0RGVsdGFYIiwicmVuZGVyUHJvcCIsInN0b3BQcm9wYWdhdGlvbkltbWVkaWF0ZSIsInN1YiIsIm1hZyIsImFjdGl2ZSIsImdldENvbXBvbmVudCIsImRyYWdvbkJvbmVzIiwiQXJtYXR1cmVEaXNwbGF5IiwicGxheUFuaW1hdGlvbiIsIm9uY2UiLCJFdmVudE9iamVjdCIsIkNPTVBMRVRFIiwiaXNHYW1lUHVhc2UiLCJQb3B1cE1hbmFnZXIiLCJpbnN0YW5jZSIsIm9wZW4iLCJBc3NldHNNYXAiLCJQb3BVcEJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkVnZ0tleVZpZXciLCJ0eXBlIiwiY2xvc2VDYWxsYmFjayIsIklucyIsImdldEVnZyIsImNoaWxkcmVuIiwibGVuZ3RoIiwiX19kZWNvcmF0ZSIsIkNvbXBvbmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEs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QUFDLENBQVg7VUFDSDtRQUNKO01BUEwsQ0FMSjtJQWVIO0VBQ0osQ0FwQkQ7O0VBcUJBUixDQUFDLENBQUNZLFNBQUYsQ0FBWW1CLFVBQVosR0FBeUIsWUFBWTtJQUNqQyxLQUFLLElBQUloQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHLEtBQUtJLElBQUwsQ0FBVXFELFFBQVYsQ0FBbUJDLE1BQXZDLEVBQStDMUQsQ0FBQyxFQUFoRCxFQUFvRDtNQUNoRCxLQUFLSSxJQUFMLENBQVVxRCxRQUFWLENBQW1CekQsQ0FBbkIsRUFBc0JvQyxNQUF0QixHQUErQnBDLENBQUMsS0FBSyxLQUFLTSxLQUExQztJQUNIO0VBQ0osQ0FKRDs7RUFLQXFELFVBQVUsQ0FBQyxDQUFDOUQsQ0FBQyxDQUFDSixFQUFFLENBQUN5QixJQUFKLENBQUYsQ0FBRCxFQUFlakIsQ0FBQyxDQUFDWSxTQUFqQixFQUE0QixNQUE1QixFQUFvQyxLQUFLLENBQXpDLENBQVY7O0VBQ0E4QyxVQUFVLENBQUMsQ0FBQzlELENBQUMsQ0FBQ0osRUFBRSxDQUFDeUIsSUFBSixDQUFGLENBQUQsRUFBZWpCLENBQUMsQ0FBQ1ksU0FBakIsRUFBNEIsS0FBNUIsRUFBbUMsS0FBSyxDQUF4QyxDQUFWOztFQUNBLE9BQU84QyxVQUFVLENBQUMsQ0FBQ2hFLENBQUQsQ0FBRCxFQUFNTSxDQUFOLENBQWpCO0FBQ0gsQ0FuRk8sQ0FtRkxSLEVBQUUsQ0FBQ21FLFNBbkZFLENBQVI7O0FBb0ZBQyxPQUFPLFdBQVAsR0FBa0I5RCxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHBvcHVwTWFuYWdlciA9IHJlcXVpcmUoXCIuL1BvcHVwTWFuYWdlclwiKTtcclxudmFyICRnbG9iYWxQYXJhbSA9IHJlcXVpcmUoXCIuL0dsb2JhbFBhcmFtXCIpO1xyXG52YXIgJHVzZXJEYXRhQ29udGV4dCA9IHJlcXVpcmUoXCIuL1VzZXJEYXRhQ29udGV4dFwiKTtcclxudmFyIHUgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgZCA9IHUuY2NjbGFzcztcclxudmFyIHAgPSB1LnByb3BlcnR5O1xyXG52YXIgZiA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLnByb3AgPSBudWxsO1xyXG4gICAgICAgIGUuYm94ID0gbnVsbDtcclxuICAgICAgICBlLmNvdW50ID0gMDtcclxuICAgICAgICBlLmRpciA9IC0xO1xyXG4gICAgICAgIGUuaW5pdFBvcyA9IG51bGw7XHJcbiAgICAgICAgZS5pc0tleSA9ICExO1xyXG4gICAgICAgIGUuaXNUb3VjaFByb3AgPSAhMTtcclxuICAgICAgICBlLmRpcyA9IDA7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmluaXRQb3MgPSB0aGlzLnByb3AucG9zaXRpb24uY2xvbmUoKTtcclxuICAgICAgICB0aGlzLnByb3Aub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQsIHRoaXMudG91Y2hQcm9wLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnByb3Aub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSwgdGhpcy5tb3ZlUHJvcCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5wcm9wLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgdGhpcy5lbmRQcm9wLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnByb3Aub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMLCB0aGlzLmVuZFByb3AsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYm94Lm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX1NUQVJULCB0aGlzLnRvdWNoQm94LCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS50b3VjaFByb3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5pc1RvdWNoUHJvcCA9ICEwO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm1vdmVQcm9wID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmNvdW50ID49IDNcclxuICAgICAgICAgICAgPyB0aGlzLmlzVG91Y2hQcm9wICYmICh0aGlzLnByb3AucG9zaXRpb24gPSB0aGlzLnByb3AucG9zaXRpb24uYWRkKGNjLnYzKHQuZ2V0RGVsdGEoKSkpKVxyXG4gICAgICAgICAgICA6ICgodGhpcy5kaXMgKz0gdC5nZXREZWx0YVgoKSksXHJcbiAgICAgICAgICAgICAgLTEgPT09IHRoaXMuZGlyXHJcbiAgICAgICAgICAgICAgICAgID8gdGhpcy5kaXMgPj0gMzAgJiYgKCh0aGlzLmRpcyA9IDApLCB0aGlzLmNvdW50KyssICh0aGlzLmRpciA9IDEpLCB0aGlzLnJlbmRlclByb3AoKSlcclxuICAgICAgICAgICAgICAgICAgOiB0aGlzLmRpcyA8PSAtMzAgJiYgKCh0aGlzLmRpcyA9IDApLCB0aGlzLmNvdW50KyssICh0aGlzLmRpciA9IC0xKSwgdGhpcy5yZW5kZXJQcm9wKCkpLFxyXG4gICAgICAgICAgICAgIHRoaXMuY291bnQgPj0gMyAmJiAodC5zdG9wUHJvcGFnYXRpb25JbW1lZGlhdGUoKSwgKHRoaXMuaXNUb3VjaFByb3AgPSAhMSksIHRoaXMucmVuZGVyUHJvcCgpKSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZW5kUHJvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmlzVG91Y2hQcm9wID0gITE7XHJcbiAgICAgICAgaWYgKCEodGhpcy5jb3VudCA8IDMpKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnByb3AucG9zaXRpb24uc3ViKHRoaXMuYm94LnBvc2l0aW9uKS5tYWcoKSA8IDEwMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLmJveC5nZXRDb21wb25lbnQoZHJhZ29uQm9uZXMuQXJtYXR1cmVEaXNwbGF5KTtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJvcC5hY3RpdmUgPSAhMTtcclxuICAgICAgICAgICAgICAgIHQucGxheUFuaW1hdGlvbihcInFpYW9fMlwiLCAxKTtcclxuICAgICAgICAgICAgICAgIHQub25jZShcclxuICAgICAgICAgICAgICAgICAgICBkcmFnb25Cb25lcy5FdmVudE9iamVjdC5DT01QTEVURSxcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQucGxheUFuaW1hdGlvbihcInFpYW9fM1wiLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3AucG9zaXRpb24gPSB0aGlzLmluaXRQb3MuY2xvbmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS50b3VjaEJveCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCEodGhpcy5wcm9wLmFjdGl2ZSB8fCB0aGlzLmlzS2V5IHx8ICRnbG9iYWxQYXJhbS5kZWZhdWx0LmlzR2FtZVB1YXNlKSkge1xyXG4gICAgICAgICAgICAkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZSA9ICEwO1xyXG4gICAgICAgICAgICAkcG9wdXBNYW5hZ2VyLlBvcHVwTWFuYWdlci5pbnN0YW5jZS5vcGVuKFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuUG9wVXBCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5FZ2dLZXlWaWV3LFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IDFcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VDYWxsYmFjazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5nZXRFZ2coMSkgPj0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5ib3guZ2V0Q29tcG9uZW50KGRyYWdvbkJvbmVzLkFybWF0dXJlRGlzcGxheSkucGxheUFuaW1hdGlvbihcInFpYW9fNFwiLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuaXNLZXkgPSAhMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVuZGVyUHJvcCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IHRoaXMucHJvcC5jaGlsZHJlbi5sZW5ndGg7IHQrKykge1xyXG4gICAgICAgICAgICB0aGlzLnByb3AuY2hpbGRyZW5bdF0uYWN0aXZlID0gdCA9PT0gdGhpcy5jb3VudDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbcChjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcInByb3BcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW3AoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJib3hcIiwgdm9pZCAwKTtcclxuICAgIHJldHVybiBfX2RlY29yYXRlKFtkXSwgZSk7XHJcbn0pKGNjLkNvbXBvbmVudCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGY7XHJcbiJdfQ==