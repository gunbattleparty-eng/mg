
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/UpgradeView.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '5bb38G07AZDgpzOv2XPBwKF', 'UpgradeView');
// game_script/scripts/UpgradeView.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $popupView = require("./PopupView");

var $remoteAudio = require("./RemoteAudio");

var $configContext = require("./ConfigContext");

var $userDataContext = require("./UserDataContext");

var f = cc._decorator;
var h = f.ccclass;
var m = f.property;

var y = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.anim = null;
    e.infoLayer = null;
    e.closeAll = null;
    e.isClose = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.onResetView = function () {
    var t;
    var e = this;
    $remoteAudio["default"].instance.playEffectMusic("levelup");
    var i = null === (t = this.uiParam.param) || void 0 === t ? void 0 : t.count;

    if (!i) {
      i = 1;
    }

    this.infoLayer.children[0].getComponent(cc.Label).string = "等级" + ($userDataContext["default"].Ins.gradeInfo.grade - 1);
    this.infoLayer.children[1].getComponent(cc.Label).string = "等级" + $userDataContext["default"].Ins.gradeInfo.grade;
    this.infoLayer.children[2].getComponent(cc.Label).string = "奖励：" + 100 * i;
    var o = -1;
    var n = $configContext["default"].instance.basicSkillConfigs;

    for (var s = 0; s < n.length; s++) {
      if (n[s].unclok_level === $userDataContext["default"].Ins.gradeInfo.grade) {
        o = n[s].skillmaster_id;
        break;
      }
    }

    if (-1 !== o) {
      this.infoLayer.children[3].active = !0;
      this.infoLayer.children[6].active = !0;
      var c = this.infoLayer.children[6].getComponent(cc.Sprite);
      $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public_Res, ["/skills/" + $configContext["default"].instance.skillConfigsMap.get(o).icon], cc.SpriteFrame, null, function (t, i) {
        var o = i[0];

        if (o && cc.isValid(c)) {
          c.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);
        }
      });
    } else {
      this.infoLayer.children[3].active = !1;
      this.infoLayer.children[6].active = !1;
    }

    this.anim.playAnimation("kai", 1);
    this.anim.once(dragonBones.EventObject.COMPLETE, function () {
      e.anim.playAnimation("stand", 0);
      e.infoLayer.active = !0;
      e.infoLayer.opacity = 0;
      cc.tween(e.infoLayer).to(0.3, {
        opacity: 255
      }).call(function () {
        e.isClose = !0;
      }).start();
    }, this);
  };

  e.prototype.addEvent = function () {
    this.closeAll.on(cc.Node.EventType.TOUCH_END, this.clickClose, this);
  };

  e.prototype.removeEvent = function () {
    this.closeAll.off(cc.Node.EventType.TOUCH_END, this.clickClose, this);
  };

  e.prototype.clickClose = function () {
    if (this.isClose) {
      t.prototype.onClickClose.call(this);
    }
  };

  __decorate([m(dragonBones.ArmatureDisplay)], e.prototype, "anim", void 0);

  __decorate([m(cc.Node)], e.prototype, "infoLayer", void 0);

  __decorate([m(cc.Node)], e.prototype, "closeAll", void 0);

  return __decorate([h], e);
}($popupView.PopupView);

exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFVwZ3JhZGVWaWV3LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRwb3B1cFZpZXciLCIkcmVtb3RlQXVkaW8iLCIkY29uZmlnQ29udGV4dCIsIiR1c2VyRGF0YUNvbnRleHQiLCJmIiwiY2MiLCJfZGVjb3JhdG9yIiwiaCIsImNjY2xhc3MiLCJtIiwicHJvcGVydHkiLCJ5IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsImFuaW0iLCJpbmZvTGF5ZXIiLCJjbG9zZUFsbCIsImlzQ2xvc2UiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJvblJlc2V0VmlldyIsImluc3RhbmNlIiwicGxheUVmZmVjdE11c2ljIiwiaSIsInVpUGFyYW0iLCJwYXJhbSIsImNvdW50IiwiY2hpbGRyZW4iLCJnZXRDb21wb25lbnQiLCJMYWJlbCIsInN0cmluZyIsIklucyIsImdyYWRlSW5mbyIsImdyYWRlIiwibiIsImJhc2ljU2tpbGxDb25maWdzIiwicyIsImxlbmd0aCIsInVuY2xva19sZXZlbCIsInNraWxsbWFzdGVyX2lkIiwiYWN0aXZlIiwiYyIsIlNwcml0ZSIsImxvYWRSZXMiLCJCdW5kbGVOYW1lcyIsIlB1YmxpY19SZXMiLCJza2lsbENvbmZpZ3NNYXAiLCJnZXQiLCJpY29uIiwiU3ByaXRlRnJhbWUiLCJpc1ZhbGlkIiwic3ByaXRlRnJhbWUiLCJSZXNVdGlsIiwiYXNzaWduV2l0aCIsIm5vZGUiLCJwbGF5QW5pbWF0aW9uIiwib25jZSIsImRyYWdvbkJvbmVzIiwiRXZlbnRPYmplY3QiLCJDT01QTEVURSIsIm9wYWNpdHkiLCJ0d2VlbiIsInRvIiwiY2FsbCIsInN0YXJ0IiwiYWRkRXZlbnQiLCJvbiIsIk5vZGUiLCJFdmVudFR5cGUiLCJUT1VDSF9FTkQiLCJjbGlja0Nsb3NlIiwicmVtb3ZlRXZlbnQiLCJvZmYiLCJvbkNs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RkQ7O0VBR0EzRCxDQUFDLENBQUNRLFNBQUYsQ0FBWW9ELFdBQVosR0FBMEIsWUFBWTtJQUNsQyxLQUFLdkQsUUFBTCxDQUFjd0QsR0FBZCxDQUFrQnJFLEVBQUUsQ0FBQ2dFLElBQUgsQ0FBUUMsU0FBUixDQUFrQkMsU0FBcEMsRUFBK0MsS0FBS0MsVUFBcEQsRUFBZ0UsSUFBaEU7RUFDSCxDQUZEOztFQUdBM0QsQ0FBQyxDQUFDUSxTQUFGLENBQVltRCxVQUFaLEdBQXlCLFlBQVk7SUFDakMsSUFBSSxLQUFLckQsT0FBVCxFQUFrQjtNQUNkUCxDQUFDLENBQUNTLFNBQUYsQ0FBWXNELFlBQVosQ0FBeUJWLElBQXpCLENBQThCLElBQTlCO0lBQ0g7RUFDSixDQUpEOztFQUtBVyxVQUFVLENBQUMsQ0FBQ25FLENBQUMsQ0FBQ2tELFdBQVcsQ0FBQ2tCLGVBQWIsQ0FBRixDQUFELEVBQW1DaEUsQ0FBQyxDQUFDUSxTQUFyQyxFQUFnRCxNQUFoRCxFQUF3RCxLQUFLLENBQTdELENBQVY7O0VBQ0F1RCxVQUFVLENBQUMsQ0FBQ25FLENBQUMsQ0FBQ0osRUFBRSxDQUFDZ0UsSUFBSixDQUFGLENBQUQsRUFBZXhELENBQUMsQ0FBQ1EsU0FBakIsRUFBNEIsV0FBNUIsRUFBeUMsS0FBSyxDQUE5QyxDQUFWOztFQUNBdUQsVUFBVSxDQUFDLENBQUNuRSxDQUFDLENBQUNKLEVBQUUsQ0FBQ2dFLElBQUosQ0FBRixDQUFELEVBQWV4RCxDQUFDLENBQUNRLFNBQWpCLEVBQTRCLFVBQTVCLEVBQXdDLEtBQUssQ0FBN0MsQ0FBVjs7RUFDQSxPQUFPdUQsVUFBVSxDQUFDLENBQUNyRSxDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBckZPLENBcUZMYixVQUFVLENBQUM4RSxTQXJGTixDQUFSOztBQXNGQUMsT0FBTyxXQUFQLEdBQWtCcEUsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkcG9wdXBWaWV3ID0gcmVxdWlyZShcIi4vUG9wdXBWaWV3XCIpO1xyXG52YXIgJHJlbW90ZUF1ZGlvID0gcmVxdWlyZShcIi4vUmVtb3RlQXVkaW9cIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkdXNlckRhdGFDb250ZXh0ID0gcmVxdWlyZShcIi4vVXNlckRhdGFDb250ZXh0XCIpO1xyXG52YXIgZiA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciBoID0gZi5jY2NsYXNzO1xyXG52YXIgbSA9IGYucHJvcGVydHk7XHJcbnZhciB5ID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuYW5pbSA9IG51bGw7XHJcbiAgICAgICAgZS5pbmZvTGF5ZXIgPSBudWxsO1xyXG4gICAgICAgIGUuY2xvc2VBbGwgPSBudWxsO1xyXG4gICAgICAgIGUuaXNDbG9zZSA9ICExO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUub25SZXNldFZpZXcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQ7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgICRyZW1vdGVBdWRpby5kZWZhdWx0Lmluc3RhbmNlLnBsYXlFZmZlY3RNdXNpYyhcImxldmVsdXBcIik7XHJcbiAgICAgICAgdmFyIGkgPSBudWxsID09PSAodCA9IHRoaXMudWlQYXJhbS5wYXJhbSkgfHwgdm9pZCAwID09PSB0ID8gdm9pZCAwIDogdC5jb3VudDtcclxuICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgaSA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5mb0xheWVyLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID1cclxuICAgICAgICAgICAgXCLnrYnnuqdcIiArICgkdXNlckRhdGFDb250ZXh0LmRlZmF1bHQuSW5zLmdyYWRlSW5mby5ncmFkZSAtIDEpO1xyXG4gICAgICAgIHRoaXMuaW5mb0xheWVyLmNoaWxkcmVuWzFdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID1cclxuICAgICAgICAgICAgXCLnrYnnuqdcIiArICR1c2VyRGF0YUNvbnRleHQuZGVmYXVsdC5JbnMuZ3JhZGVJbmZvLmdyYWRlO1xyXG4gICAgICAgIHRoaXMuaW5mb0xheWVyLmNoaWxkcmVuWzJdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gXCLlpZblirHvvJpcIiArIDEwMCAqIGk7XHJcbiAgICAgICAgdmFyIG8gPSAtMTtcclxuICAgICAgICB2YXIgbiA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ3M7XHJcbiAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBuLmxlbmd0aDsgcysrKSB7XHJcbiAgICAgICAgICAgIGlmIChuW3NdLnVuY2xva19sZXZlbCA9PT0gJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5ncmFkZUluZm8uZ3JhZGUpIHtcclxuICAgICAgICAgICAgICAgIG8gPSBuW3NdLnNraWxsbWFzdGVyX2lkO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKC0xICE9PSBvKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5mb0xheWVyLmNoaWxkcmVuWzNdLmFjdGl2ZSA9ICEwO1xyXG4gICAgICAgICAgICB0aGlzLmluZm9MYXllci5jaGlsZHJlbls2XS5hY3RpdmUgPSAhMDtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmluZm9MYXllci5jaGlsZHJlbls2XS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAgICAgJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmxvYWRSZXMoXHJcbiAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLlB1YmxpY19SZXMsXHJcbiAgICAgICAgICAgICAgICBbXCIvc2tpbGxzL1wiICsgJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5za2lsbENvbmZpZ3NNYXAuZ2V0KG8pLmljb25dLFxyXG4gICAgICAgICAgICAgICAgY2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IGlbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG8gJiYgY2MuaXNWYWxpZChjKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKG8sIGUubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5mb0xheWVyLmNoaWxkcmVuWzNdLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLmluZm9MYXllci5jaGlsZHJlbls2XS5hY3RpdmUgPSAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hbmltLnBsYXlBbmltYXRpb24oXCJrYWlcIiwgMSk7XHJcbiAgICAgICAgdGhpcy5hbmltLm9uY2UoXHJcbiAgICAgICAgICAgIGRyYWdvbkJvbmVzLkV2ZW50T2JqZWN0LkNPTVBMRVRFLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBlLmFuaW0ucGxheUFuaW1hdGlvbihcInN0YW5kXCIsIDApO1xyXG4gICAgICAgICAgICAgICAgZS5pbmZvTGF5ZXIuYWN0aXZlID0gITA7XHJcbiAgICAgICAgICAgICAgICBlLmluZm9MYXllci5vcGFjaXR5ID0gMDtcclxuICAgICAgICAgICAgICAgIGNjLnR3ZWVuKGUuaW5mb0xheWVyKVxyXG4gICAgICAgICAgICAgICAgICAgIC50bygwLjMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMjU1XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2FsbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuaXNDbG9zZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN0YXJ0KCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRoaXNcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmFkZEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VBbGwub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLmNsaWNrQ2xvc2UsIHRoaXMpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbW92ZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2VBbGwub2ZmKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgdGhpcy5jbGlja0Nsb3NlLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jbGlja0Nsb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2xvc2UpIHtcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUub25DbGlja0Nsb3NlLmNhbGwodGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIF9fZGVjb3JhdGUoW20oZHJhZ29uQm9uZXMuQXJtYXR1cmVEaXNwbGF5KV0sIGUucHJvdG90eXBlLCBcImFuaW1cIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW20oY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJpbmZvTGF5ZXJcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW20oY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJjbG9zZUFsbFwiLCB2b2lkIDApO1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2hdLCBlKTtcclxufSkoJHBvcHVwVmlldy5Qb3B1cFZpZXcpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSB5O1xyXG4iXX0=