
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_17.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '38d03e7iQZHhLGzznmPgq63', 'Bullet_17');
// game_script/scripts/Bullet_17.js

"use strict";

var o;

var $util = require("./Util");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseBullet = require("./BaseBullet");

var $bullet_17_1 = require("./Bullet_17_1");

var u = cc._decorator;
var d = u.ccclass;
var p = u.property;
var f = (cc.size(0, 0), cc.Vec3.ZERO);

var h = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.sourceNode = null;
    e.lineNode = null;
    e.lineBody = null;
    e.linePool = new cc.NodePool();
    e.lineBodyPool = new cc.NodePool();
    e.currLineNodes = [];
    e.currLineBodyNodes = [];
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, null, i);
    this.clearStatus();
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
  };

  e.prototype.render = function (t, e) {
    if (t.length > this.currLineNodes.length) {
      var i = t.length - this.currLineNodes.length;

      for (var o = 0; o < i; o++) {
        var n = this.getLine();
        n.active = !0;
        this.currLineNodes.push(n);
        n.parent = this.node;
        (s = this.getLineBody()).active = !0;
        this.currLineBodyNodes.push(s);
        s.getComponent($bullet_17_1["default"]).insert(this.node);
      }
    } else {
      if (t.length < this.currLineNodes.length) {
        i = this.currLineNodes.length - t.length;

        for (o = 0; o < i; o++) {
          var s;
          var a = this.currLineNodes.pop();
          a.width = 0;
          this.linePool.put(a);
          (s = this.currLineBodyNodes.pop()).getComponent($bullet_17_1["default"]).remove(!1);
          s.parent = null;
          this.lineBodyPool.put(s);
        }
      }
    }

    var l = t[0].sub(this.node.position);

    for (o = 0; o < t.length; o++) {
      f.x = 0;
      f.y = 0;
      var u = this.currLineBodyNodes[o].getComponent($bullet_17_1["default"]);
      var d = e && e.length > o ? e[o].id : -1;

      if (0 === o) {
        var p = $util["default"].dirConverAngle(l);
        this.currLineNodes[o].angle = p;
        this.currLineNodes[o].width = l.mag();
        this.sourceNode.angle = p;
        this.currLineNodes[o].setPosition(0, 0);
      } else {
        this.currLineNodes[o].position = l.add(this.currLineNodes[o - 1].position);
        l = t[o].sub(t[o - 1]);
        this.currLineNodes[o].angle = $util["default"].dirConverAngle(l);
        this.currLineNodes[o].width = l.mag();
      }

      this.currLineNodes[o].height = this.lineNode.height * this.skillParam.guideLaserWidth;
      this.currLineNodes[o].children[0].setPosition(this.currLineNodes[o].width, 0);
      f.x = this.currLineNodes[o].x;
      f.y = this.currLineNodes[o].y;
      u.setPosition(f);
      u.refreshBullet17(d, this.currLineNodes[o].angle, this.currLineNodes[o].width);
    }
  };

  e.prototype.getLineBody = function () {
    return this.lineBodyPool.size() > 0 ? this.lineBodyPool.get() : cc.instantiate(this.lineBody);
  };

  e.prototype.getLine = function () {
    return this.linePool.size() > 0 ? this.linePool.get() : cc.instantiate(this.lineNode);
  };

  e.prototype.clear = function () {
    var t = this;
    this.currLineNodes.forEach(function (e) {
      e.width = 0;
      t.linePool.put(e);
    });
    this.currLineBodyNodes.forEach(function (e) {
      e.getComponent($bullet_17_1["default"]).remove(!1);
      e.parent = null;
      t.lineBodyPool.put(e);
    });
    this.currLineNodes.length = 0;
    this.currLineBodyNodes.length = 0;
  };

  e.prototype.onDestroy = function () {
    this.linePool.clear();
    this.lineBodyPool.clear();
  };

  e.prototype.removeSelf = function (e) {
    if (void 0 === e) {
      e = !0;
    }

    this.clear();
    t.prototype.removeSelf.call(this, e);
  };

  e.prototype.updateFrame = function () {};

  __decorate([p(cc.Node)], e.prototype, "sourceNode", void 0);

  __decorate([p(cc.Node)], e.prototype, "lineNode", void 0);

  __decorate([p(cc.Node)], e.prototype, "lineBody", void 0);

  return __decorate([d], e);
}($baseBullet["default"]);

exports["default"] = h;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8xNy5qcyJdLCJuYW1lcyI6WyJvIiwiJHV0aWwiLCJyZXF1aXJlIiwiJGdhbWVTa2lsbEluZm8iLCIkYmFzZUJ1bGxldCIsIiRidWxsZXRfMTdfMSIsInUiLCJjYyIsIl9kZWNvcmF0b3IiLCJkIiwiY2NjbGFzcyIsInAiLCJwcm9wZXJ0eSIsImYiLCJzaXplIiwiVmVjMyIsIlpFUk8iLCJoIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInNvdXJjZU5vZGUiLCJsaW5lTm9kZSIsImxpbmVCb2R5IiwibGluZVBvb2wiLCJOb2RlUG9vbCIsImxpbmVCb2R5UG9vbCIsImN1cnJMaW5lTm9kZXMiLCJjdXJyTGluZUJvZHlOb2RlcyIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsImluaXRCdXR0bGUiLCJpIiwiY2FsbCIsImNsZWFyU3RhdHVzIiwiYXRrIiwic2tpbGxQYXJhbSIsInNraWxsQXRrIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsInJlbmRlciIsImxlbmd0aCIsIm4iLCJnZXRMaW5lIiwiYWN0aXZlIiwicHVzaCIsInBhcmVudCIsIm5vZGUiLCJzIiwiZ2V0TGluZUJvZHkiLCJnZXRDb21wb25lbnQiLCJpbnNlcnQiLCJhIiwicG9wIiwid2lkdGgiLCJwdXQiLCJyZW1vdmUiLCJsIiwic3ViIiwicG9zaXRpb24iLCJ4IiwieSIsImlkIiwiZGlyQ29udmVyQW5nbGUiLCJhbmdsZSIsIm1hZyIsInNldFBvc2l0aW9uIiwiYWRkIiwiaGVpZ2h0IiwiZ3VpZGVMYXNlcldpZHRoIiwiY2hpbGRyZW4iLCJyZWZyZXNoQnVsbGV0MTciLCJnZXQiLCJpbnN0YW50aWF0ZSIsImNsZWFyIiwiZm9yRWFjaCIsIm9uRGVzdHJveSIsInJlbW92ZVNlbGYiLCJ1cGRhdGVGcmFtZSIsIl9fZGVjb3JhdGUiLCJOb2RlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJ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QUFGLENBQVlnRCxXQUFaLEdBQTBCLFlBQVksQ0FBRSxDQUF4Qzs7RUFDQUMsVUFBVSxDQUFDLENBQUNyRSxDQUFDLENBQUNKLEVBQUUsQ0FBQzBFLElBQUosQ0FBRixDQUFELEVBQWU5RCxDQUFDLENBQUNZLFNBQWpCLEVBQTRCLFlBQTVCLEVBQTBDLEtBQUssQ0FBL0MsQ0FBVjs7RUFDQWlELFVBQVUsQ0FBQyxDQUFDckUsQ0FBQyxDQUFDSixFQUFFLENBQUMwRSxJQUFKLENBQUYsQ0FBRCxFQUFlOUQsQ0FBQyxDQUFDWSxTQUFqQixFQUE0QixVQUE1QixFQUF3QyxLQUFLLENBQTdDLENBQVY7O0VBQ0FpRCxVQUFVLENBQUMsQ0FBQ3JFLENBQUMsQ0FBQ0osRUFBRSxDQUFDMEUsSUFBSixDQUFGLENBQUQsRUFBZTlELENBQUMsQ0FBQ1ksU0FBakIsRUFBNEIsVUFBNUIsRUFBd0MsS0FBSyxDQUE3QyxDQUFWOztFQUNBLE9BQU9pRCxVQUFVLENBQUMsQ0FBQ3ZFLENBQUQsQ0FBRCxFQUFNVSxDQUFOLENBQWpCO0FBQ0gsQ0ExR08sQ0EwR0xmLFdBQVcsV0ExR04sQ0FBUjs7QUEyR0E4RSxPQUFPLFdBQVAsR0FBa0JqRSxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkdXRpbCA9IHJlcXVpcmUoXCIuL1V0aWxcIik7XHJcbnZhciAkZ2FtZVNraWxsSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVTa2lsbEluZm9cIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciAkYnVsbGV0XzE3XzEgPSByZXF1aXJlKFwiLi9CdWxsZXRfMTdfMVwiKTtcclxudmFyIHUgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgZCA9IHUuY2NjbGFzcztcclxudmFyIHAgPSB1LnByb3BlcnR5O1xyXG52YXIgZiA9IChjYy5zaXplKDAsIDApLCBjYy5WZWMzLlpFUk8pO1xyXG52YXIgaCA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLnNvdXJjZU5vZGUgPSBudWxsO1xyXG4gICAgICAgIGUubGluZU5vZGUgPSBudWxsO1xyXG4gICAgICAgIGUubGluZUJvZHkgPSBudWxsO1xyXG4gICAgICAgIGUubGluZVBvb2wgPSBuZXcgY2MuTm9kZVBvb2woKTtcclxuICAgICAgICBlLmxpbmVCb2R5UG9vbCA9IG5ldyBjYy5Ob2RlUG9vbCgpO1xyXG4gICAgICAgIGUuY3VyckxpbmVOb2RlcyA9IFtdO1xyXG4gICAgICAgIGUuY3VyckxpbmVCb2R5Tm9kZXMgPSBbXTtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSwgaSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmluaXRCdXR0bGUuY2FsbCh0aGlzLCBudWxsLCBpKTtcclxuICAgICAgICB0aGlzLmNsZWFyU3RhdHVzKCk7XHJcbiAgICAgICAgdGhpcy5hdGsgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgaWYgKHQubGVuZ3RoID4gdGhpcy5jdXJyTGluZU5vZGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHQubGVuZ3RoIC0gdGhpcy5jdXJyTGluZU5vZGVzLmxlbmd0aDtcclxuICAgICAgICAgICAgZm9yICh2YXIgbyA9IDA7IG8gPCBpOyBvKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcy5nZXRMaW5lKCk7XHJcbiAgICAgICAgICAgICAgICBuLmFjdGl2ZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyTGluZU5vZGVzLnB1c2gobik7XHJcbiAgICAgICAgICAgICAgICBuLnBhcmVudCA9IHRoaXMubm9kZTtcclxuICAgICAgICAgICAgICAgIChzID0gdGhpcy5nZXRMaW5lQm9keSgpKS5hY3RpdmUgPSAhMDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VyckxpbmVCb2R5Tm9kZXMucHVzaChzKTtcclxuICAgICAgICAgICAgICAgIHMuZ2V0Q29tcG9uZW50KCRidWxsZXRfMTdfMS5kZWZhdWx0KS5pbnNlcnQodGhpcy5ub2RlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0Lmxlbmd0aCA8IHRoaXMuY3VyckxpbmVOb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGkgPSB0aGlzLmN1cnJMaW5lTm9kZXMubGVuZ3RoIC0gdC5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBmb3IgKG8gPSAwOyBvIDwgaTsgbysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHM7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLmN1cnJMaW5lTm9kZXMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYS53aWR0aCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saW5lUG9vbC5wdXQoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgKHMgPSB0aGlzLmN1cnJMaW5lQm9keU5vZGVzLnBvcCgpKS5nZXRDb21wb25lbnQoJGJ1bGxldF8xN18xLmRlZmF1bHQpLnJlbW92ZSghMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcy5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGluZUJvZHlQb29sLnB1dChzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbCA9IHRbMF0uc3ViKHRoaXMubm9kZS5wb3NpdGlvbik7XHJcbiAgICAgICAgZm9yIChvID0gMDsgbyA8IHQubGVuZ3RoOyBvKyspIHtcclxuICAgICAgICAgICAgZi54ID0gMDtcclxuICAgICAgICAgICAgZi55ID0gMDtcclxuICAgICAgICAgICAgdmFyIHUgPSB0aGlzLmN1cnJMaW5lQm9keU5vZGVzW29dLmdldENvbXBvbmVudCgkYnVsbGV0XzE3XzEuZGVmYXVsdCk7XHJcbiAgICAgICAgICAgIHZhciBkID0gZSAmJiBlLmxlbmd0aCA+IG8gPyBlW29dLmlkIDogLTE7XHJcbiAgICAgICAgICAgIGlmICgwID09PSBvKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9ICR1dGlsLmRlZmF1bHQuZGlyQ29udmVyQW5nbGUobCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJMaW5lTm9kZXNbb10uYW5nbGUgPSBwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyTGluZU5vZGVzW29dLndpZHRoID0gbC5tYWcoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlTm9kZS5hbmdsZSA9IHA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJMaW5lTm9kZXNbb10uc2V0UG9zaXRpb24oMCwgMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJMaW5lTm9kZXNbb10ucG9zaXRpb24gPSBsLmFkZCh0aGlzLmN1cnJMaW5lTm9kZXNbbyAtIDFdLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGwgPSB0W29dLnN1Yih0W28gLSAxXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJMaW5lTm9kZXNbb10uYW5nbGUgPSAkdXRpbC5kZWZhdWx0LmRpckNvbnZlckFuZ2xlKGwpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyTGluZU5vZGVzW29dLndpZHRoID0gbC5tYWcoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJMaW5lTm9kZXNbb10uaGVpZ2h0ID0gdGhpcy5saW5lTm9kZS5oZWlnaHQgKiB0aGlzLnNraWxsUGFyYW0uZ3VpZGVMYXNlcldpZHRoO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJMaW5lTm9kZXNbb10uY2hpbGRyZW5bMF0uc2V0UG9zaXRpb24odGhpcy5jdXJyTGluZU5vZGVzW29dLndpZHRoLCAwKTtcclxuICAgICAgICAgICAgZi54ID0gdGhpcy5jdXJyTGluZU5vZGVzW29dLng7XHJcbiAgICAgICAgICAgIGYueSA9IHRoaXMuY3VyckxpbmVOb2Rlc1tvXS55O1xyXG4gICAgICAgICAgICB1LnNldFBvc2l0aW9uKGYpO1xyXG4gICAgICAgICAgICB1LnJlZnJlc2hCdWxsZXQxNyhkLCB0aGlzLmN1cnJMaW5lTm9kZXNbb10uYW5nbGUsIHRoaXMuY3VyckxpbmVOb2Rlc1tvXS53aWR0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmdldExpbmVCb2R5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxpbmVCb2R5UG9vbC5zaXplKCkgPiAwID8gdGhpcy5saW5lQm9keVBvb2wuZ2V0KCkgOiBjYy5pbnN0YW50aWF0ZSh0aGlzLmxpbmVCb2R5KTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5nZXRMaW5lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxpbmVQb29sLnNpemUoKSA+IDAgPyB0aGlzLmxpbmVQb29sLmdldCgpIDogY2MuaW5zdGFudGlhdGUodGhpcy5saW5lTm9kZSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuY3VyckxpbmVOb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGUud2lkdGggPSAwO1xyXG4gICAgICAgICAgICB0LmxpbmVQb29sLnB1dChlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmN1cnJMaW5lQm9keU5vZGVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZS5nZXRDb21wb25lbnQoJGJ1bGxldF8xN18xLmRlZmF1bHQpLnJlbW92ZSghMSk7XHJcbiAgICAgICAgICAgIGUucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgdC5saW5lQm9keVBvb2wucHV0KGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY3VyckxpbmVOb2Rlcy5sZW5ndGggPSAwO1xyXG4gICAgICAgIHRoaXMuY3VyckxpbmVCb2R5Tm9kZXMubGVuZ3RoID0gMDtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5saW5lUG9vbC5jbGVhcigpO1xyXG4gICAgICAgIHRoaXMubGluZUJvZHlQb29sLmNsZWFyKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVtb3ZlU2VsZiA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gZSkge1xyXG4gICAgICAgICAgICBlID0gITA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICAgICB0LnByb3RvdHlwZS5yZW1vdmVTZWxmLmNhbGwodGhpcywgZSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUudXBkYXRlRnJhbWUgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgIF9fZGVjb3JhdGUoW3AoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJzb3VyY2VOb2RlXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtwKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwibGluZU5vZGVcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW3AoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJsaW5lQm9keVwiLCB2b2lkIDApO1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2RdLCBlKTtcclxufSkoJGJhc2VCdWxsZXQuZGVmYXVsdCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGg7XHJcbiJdfQ==