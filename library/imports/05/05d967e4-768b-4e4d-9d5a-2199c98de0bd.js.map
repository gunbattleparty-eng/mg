{"version":3,"sources":["assets\\game_script\\scripts\\StorageUtil.js"],"names":["exports","StorageUtil","$globalParam","require","$localName","$crypto_ts","l","t","init","e","i","getItem","setItem","__values","Object","entries","c","next","done","u","__read","value","d","p","cc","sys","localStorage","Filters","includes","AES","encrypt","keyWord","toString","error","call","o","n","decrypt","enc","Utf8","String","Number","parseInt","Boolean","Map","jsonToMap","JSON","parse","console","mapToJson","stringify","removeItem","forEach","push","length","set","ONLINE_RECORD","MEDIAS","MEDIAS_VOL","PACK_INFO"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.StorageUtil = void 0;\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $localName = require(\"./LocalName\");\r\nvar $crypto_ts = require(\"./crypto-ts\");\r\nvar l = (function () {\r\n    function t() {}\r\n    t.init = function () {\r\n        var e;\r\n        var i;\r\n        if (!t.getItem(\"isEnc\", !1, !1)) {\r\n            t.setItem(\"isEnc\", !0, !1);\r\n            try {\r\n                var l = __values(Object.entries($localName.default));\r\n                for (var c = l.next(); !c.done; c = l.next()) {\r\n                    var u = __read(c.value, 2);\r\n                    var d = (u[0], u[1]);\r\n                    var p = cc.sys.localStorage.getItem(d);\r\n                    if (p) {\r\n                        if (!t.Filters.includes(d)) {\r\n                            p = $crypto_ts.AES.encrypt(p, $globalParam.default.keyWord).toString();\r\n                        }\r\n                        cc.sys.localStorage.setItem(d, p);\r\n                    }\r\n                }\r\n            } catch (t) {\r\n                e = {\r\n                    error: t\r\n                };\r\n            } finally {\r\n                try {\r\n                    if (c && !c.done && (i = l.return)) {\r\n                        i.call(l);\r\n                    }\r\n                } finally {\r\n                    if (e) {\r\n                        throw e.error;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    t.getItem = function (e, i, o) {\r\n        if (void 0 === o) {\r\n            o = !0;\r\n        }\r\n        var n = cc.sys.localStorage.getItem(e);\r\n        if (!(n = n || \"\")) {\r\n            return i;\r\n        }\r\n        if (o && !t.Filters.includes(e)) {\r\n            n = $crypto_ts.AES.decrypt(n, $globalParam.default.keyWord).toString($crypto_ts.enc.Utf8);\r\n        }\r\n        if (i instanceof String) {\r\n            return n;\r\n        }\r\n        if (i instanceof Number) {\r\n            return parseInt(n);\r\n        }\r\n        if (i instanceof Boolean) {\r\n            return \"true\" === n;\r\n        }\r\n        if (i instanceof Map) {\r\n            return t.jsonToMap(n);\r\n        }\r\n        try {\r\n            return JSON.parse(n);\r\n        } catch (t) {\r\n            console.error(e, t);\r\n            return i;\r\n        }\r\n    };\r\n    t.setItem = function (e, i, o) {\r\n        if (void 0 === o) {\r\n            o = !0;\r\n        }\r\n        var n = \"\";\r\n        n = i instanceof Map ? t.mapToJson(i) : JSON.stringify(i);\r\n        if (o && !t.Filters.includes(e)) {\r\n            n = $crypto_ts.AES.encrypt(n, $globalParam.default.keyWord).toString();\r\n        }\r\n        cc.sys.localStorage.setItem(e, n);\r\n    };\r\n    t.removeItem = function (t) {\r\n        cc.sys.localStorage.removeItem(t);\r\n    };\r\n    t.mapToJson = function (t) {\r\n        var e = [];\r\n        t.forEach(function (t, i) {\r\n            e.push([i, t]);\r\n        });\r\n        return JSON.stringify(e);\r\n    };\r\n    t.jsonToMap = function (t) {\r\n        var e = JSON.parse(t);\r\n        var i = new Map();\r\n        for (var o = 0; o < e.length; o++) {\r\n            i.set(e[o][0], e[o][1]);\r\n        }\r\n        return i;\r\n    };\r\n    t.Filters = [\r\n        $localName.default.ONLINE_RECORD,\r\n        $localName.default.MEDIAS,\r\n        $localName.default.MEDIAS_VOL,\r\n        $localName.default.PACK_INFO\r\n    ];\r\n    return t;\r\n})();\r\nexports.StorageUtil = l;\r\n"]}