
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/ShopDiamondListItem.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b8ff1bDJkhCFq+tsfzCaWIQ', 'ShopDiamondListItem');
// game_script/scripts/ShopDiamondListItem.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $popupManager = require("./PopupManager");

var $platform = require("./Platform");

var $remoteAudio = require("./RemoteAudio");

var $util = require("./Util");

var $aD = require("./AD");

var $adService = require("./AdService");

var $localEventName = require("./LocalEventName");

var $shopContext = require("./ShopContext");

var $userDataContext = require("./UserDataContext");

var $startView = require("./StartView");

var v = cc._decorator;
var b = v.ccclass;
var w = v.property;

var A = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.icon = null;
    e.firstLable = null;
    e.countLable = null;
    e.btnBuy = null;
    e.proccessLable = null;
    e.limitLable = null;
    e.config = null;
    e.buyType = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.start = function () {
    this.btnBuy.on("click", this.clickBuy, this);
  };

  e.prototype.init = function (t) {
    var e = this;
    this.buyType = 0;
    this.config = t;
    var i = this.config.id;

    if (0 === this.config.is_video) {
      i = 1;
    }

    $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Start, ["/textures/shop/diamond_" + i], cc.SpriteFrame, null, function (t, i) {
      var o = i[0];

      if (o && cc.isValid(e.icon)) {
        e.icon.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);
      }
    });
    this.render();
    this.renderLimit();
  };

  e.prototype.render = function () {
    this.firstLable.string = "首次礼包额外获得*" + this.config.reward_num;
    this.countLable.string = "x" + this.config.reward_num;
    var t = $shopContext["default"].Ins.getDiamondRecordById(this.config.id);
    this.firstLable.node.active = t.isFrist;
    this.proccessLable.string = "购买(" + t.video_count + "/" + this.config.vido_num + ")";
    this.proccessLable.node.parent.children[0].active = !0;
    this.btnBuy.children[1].active = !1;
    this.buyType = 0;
    0 !== this.config.is_video || $shopContext["default"].Ins.isDiamondBuyDay(this.config.id) ? 0 === this.config.is_video && (this.proccessLable.string = "购买") : (this.buyType = 1, this.proccessLable.node.parent.children[0].active = !1, this.proccessLable.string = "免费", this.btnBuy.children[1].active = !0);
  };

  e.prototype.clickBuy = function () {
    var t = this;
    $remoteAudio["default"].instance.playEffectMusic("Click");
    0 === this.buyType ? $adService["default"].Ins.showRewardedVideo(function () {
      if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {
        $aD["default"].toutiao.report("Diamond_Shop");
      }

      t.buy(!0);
      t.renderLimit();
    }) : (this.buy(!1), $eventManager["default"].send($localEventName["default"].RENDER_DOT, $startView.MenuType.Shop), this.renderLimit());
  };

  e.prototype.buy = function (t) {
    var e = $shopContext["default"].Ins.addDiamondRecord(this.config.id, this.config.vido_num);

    if (t && $platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {
      $aD["default"].toutiao.report("Diamond_Shop_" + this.config.id, {
        count: e.count
      });
    }

    if (e.isReward) {
      var i = e.isFirst ? 2 * this.config.reward_num : this.config.reward_num;
      $userDataContext["default"].Ins.opearDiamond(i);
      this.render();
      var o = [];
      o.push({
        type: 6,
        num: i
      });
      $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.RewardView, {
        infos: o
      });
    } else {
      this.render();
    }
  };

  e.prototype.renderLimit = function () {
    var t = $shopContext["default"].Ins.getDiamondRecordById(this.config.id).dayBuyCount;
    this.limitLable.string = "每日限购(" + t + "/" + this.config.buy_num + ")";
    $util["default"].updateMaterialState(this.btnBuy, t >= this.config.buy_num);
    this.btnBuy.getComponent(cc.Button).interactable = t < this.config.buy_num;
  };

  __decorate([w(cc.Sprite)], e.prototype, "icon", void 0);

  __decorate([w(cc.Label)], e.prototype, "firstLable", void 0);

  __decorate([w(cc.Label)], e.prototype, "countLable", void 0);

  __decorate([w(cc.Node)], e.prototype, "btnBuy", void 0);

  __decorate([w(cc.Label)], e.prototype, "proccessLable", void 0);

  __decorate([w(cc.Label)], e.prototype, "limitLable", void 0);

  return __decorate([b], e);
}(cc.Component);

exports["default"] = A;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFNob3BEaWFtb25kTGlzdEl0ZW0uanMiXSwibmFtZXMiOlsibyIsIiRhc3NldHNMb2FkZXIiLCJyZXF1aXJlIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGV2ZW50TWFuYWdlciIsIiRwb3B1cE1hbmFnZXIiLCIkcGxhdGZvcm0iLCIkcmVtb3RlQXVkaW8iLCIkdXRpbCIsIiRhRCIsIiRhZFNlcnZpY2UiLCIkbG9jYWxFdmVudE5hbWUiLCIkc2hvcENvbnRleHQiLCIkdXNlckRhdGFDb250ZXh0IiwiJHN0YXJ0VmlldyIsInYiLCJjYyIsIl9kZWNvcmF0b3IiLCJiIiwiY2NjbGFzcyIsInciLCJwcm9wZXJ0eSIsIkEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiaWNvbiIsImZpcnN0TGFibGUiLCJjb3VudExhYmxlIiwiYnRuQnV5IiwicHJvY2Nlc3NMYWJsZSIsImxpbWl0TGFibGUiLCJjb25maWciLCJidXlUeXBlIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwic3RhcnQiLCJvbiIsImNsaWNrQnV5IiwiaW5pdCIsImkiLCJpZCIsImlzX3ZpZGVvIiwiaW5zdGFuY2UiLCJsb2FkUmVzIiwiQnVuZGxlTmFtZXMiLCJTdGFydCIsIlNwcml0ZUZyYW1lIiwiaXNWYWxpZCIsInNwcml0ZUZyYW1lIiwiUmVzVXRpbCIsImFzc2lnbldpdGgiLCJub2RlIiwicmVuZGVyIiwicmVuZGVyTGltaXQiLCJzdHJpbmciLCJyZXdhcmRfbnVtIiwiSW5zIiwiZ2V0RGlhbW9uZFJlY29yZEJ5SWQiLCJhY3RpdmUiLCJpc0ZyaXN0IiwidmlkZW9fY291bnQiLCJ2aWRvX251bSIsInBhcmVudCIsImNoaWxkcmVuIiwiaXNEaWFtb25kQnV5RGF5IiwicGxheUVmZmVjdE11c2ljIiwic2hvd1Jld2FyZGVkVmlkZW8iLCJQbGF0Zm9ybSIsImN1cnJQbGF0Rm9ybSIsIlBsYXRmb3JtRW51bSIsIlRPVV9USUFPIiwidG91dGlhbyIsInJlcG9ydCIsImJ1eSIsInNlbmQiLCJSRU5ERVJfRE9UIiwiTWVudVR5cGUiLCJTaG9wIiwiYWRkRGlhbW9uZFJlY29yZCIsImNvdW50IiwiaXNSZXdhcmQiLCJpc0ZpcnN0Iiwib3BlYXJEaWFtb25kIiwicHVzaCIsInR5cGUiLCJudW0iLCJQb3B1cE1hbmFnZXIiLCJvcGVuIiwiQXNzZXRzTWFwIiwiUG9wVXBCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJSZXdhcmRWaWV3IiwiaW5mb3MiLCJkYXlCdXlDb3VudCIsImJ1eV9udW0iLCJ1cGRhdGVNYXRlcmlhbFN0YXRlIiwiZ2V0Q29tcG9uZW50IiwiQnV0dG9uIiwiaW50ZXJhY3RhYmxlIiwiX19kZWNvcmF0ZSIsIlNwcml0ZSIsIkxhYmVsIiwiTm9kZSIsIkNvbXBvbmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJQyxVQUFVLEdBQUdELE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlFLFFBQVEsR0FBR0YsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUcsYUFBYSxHQUFHSCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUksYUFBYSxHQUFHSixPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUssU0FBUyxHQUFHTCxPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFDQSxJQUFJTSxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlPLEtBQUssR0FBR1AsT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSVEsR0FBRyxHQUFHUixPQUFPLENBQUMsTUFBRCxDQUFqQjs7QUFDQSxJQUFJUyxVQUFVLEdBQUdULE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlVLGVBQWUsR0FBR1YsT0FBTyxD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Z0JoRixDQUFDLENBQUNZLFNBQWxCLEVBQTZCLFlBQTdCLEVBQTJDLEtBQUssQ0FBaEQsQ0FBVjs7RUFDQSxPQUFPa0UsVUFBVSxDQUFDLENBQUNwRixDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBM0dPLENBMkdMUixFQUFFLENBQUMwRixTQTNHRSxDQUFSOztBQTRHQUMsT0FBTyxXQUFQLEdBQWtCckYsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkZXZlbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vRXZlbnRNYW5hZ2VyXCIpO1xyXG52YXIgJHBvcHVwTWFuYWdlciA9IHJlcXVpcmUoXCIuL1BvcHVwTWFuYWdlclwiKTtcclxudmFyICRwbGF0Zm9ybSA9IHJlcXVpcmUoXCIuL1BsYXRmb3JtXCIpO1xyXG52YXIgJHJlbW90ZUF1ZGlvID0gcmVxdWlyZShcIi4vUmVtb3RlQXVkaW9cIik7XHJcbnZhciAkdXRpbCA9IHJlcXVpcmUoXCIuL1V0aWxcIik7XHJcbnZhciAkYUQgPSByZXF1aXJlKFwiLi9BRFwiKTtcclxudmFyICRhZFNlcnZpY2UgPSByZXF1aXJlKFwiLi9BZFNlcnZpY2VcIik7XHJcbnZhciAkbG9jYWxFdmVudE5hbWUgPSByZXF1aXJlKFwiLi9Mb2NhbEV2ZW50TmFtZVwiKTtcclxudmFyICRzaG9wQ29udGV4dCA9IHJlcXVpcmUoXCIuL1Nob3BDb250ZXh0XCIpO1xyXG52YXIgJHVzZXJEYXRhQ29udGV4dCA9IHJlcXVpcmUoXCIuL1VzZXJEYXRhQ29udGV4dFwiKTtcclxudmFyICRzdGFydFZpZXcgPSByZXF1aXJlKFwiLi9TdGFydFZpZXdcIik7XHJcbnZhciB2ID0gY2MuX2RlY29yYXRvcjtcclxudmFyIGIgPSB2LmNjY2xhc3M7XHJcbnZhciB3ID0gdi5wcm9wZXJ0eTtcclxudmFyIEEgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5pY29uID0gbnVsbDtcclxuICAgICAgICBlLmZpcnN0TGFibGUgPSBudWxsO1xyXG4gICAgICAgIGUuY291bnRMYWJsZSA9IG51bGw7XHJcbiAgICAgICAgZS5idG5CdXkgPSBudWxsO1xyXG4gICAgICAgIGUucHJvY2Nlc3NMYWJsZSA9IG51bGw7XHJcbiAgICAgICAgZS5saW1pdExhYmxlID0gbnVsbDtcclxuICAgICAgICBlLmNvbmZpZyA9IG51bGw7XHJcbiAgICAgICAgZS5idXlUeXBlID0gMDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYnRuQnV5Lm9uKFwiY2xpY2tcIiwgdGhpcy5jbGlja0J1eSwgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuYnV5VHlwZSA9IDA7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSB0O1xyXG4gICAgICAgIHZhciBpID0gdGhpcy5jb25maWcuaWQ7XHJcbiAgICAgICAgaWYgKDAgPT09IHRoaXMuY29uZmlnLmlzX3ZpZGVvKSB7XHJcbiAgICAgICAgICAgIGkgPSAxO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UubG9hZFJlcyhcclxuICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5TdGFydCxcclxuICAgICAgICAgICAgW1wiL3RleHR1cmVzL3Nob3AvZGlhbW9uZF9cIiArIGldLFxyXG4gICAgICAgICAgICBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKHQsIGkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gaVswXTtcclxuICAgICAgICAgICAgICAgIGlmIChvICYmIGNjLmlzVmFsaWQoZS5pY29uKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuaWNvbi5zcHJpdGVGcmFtZSA9ICRyZXNVdGlsLlJlc1V0aWwuYXNzaWduV2l0aChvLCBlLm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuICAgICAgICB0aGlzLnJlbmRlcigpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyTGltaXQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5maXJzdExhYmxlLnN0cmluZyA9IFwi6aaW5qyh56S85YyF6aKd5aSW6I635b6XKlwiICsgdGhpcy5jb25maWcucmV3YXJkX251bTtcclxuICAgICAgICB0aGlzLmNvdW50TGFibGUuc3RyaW5nID0gXCJ4XCIgKyB0aGlzLmNvbmZpZy5yZXdhcmRfbnVtO1xyXG4gICAgICAgIHZhciB0ID0gJHNob3BDb250ZXh0LmRlZmF1bHQuSW5zLmdldERpYW1vbmRSZWNvcmRCeUlkKHRoaXMuY29uZmlnLmlkKTtcclxuICAgICAgICB0aGlzLmZpcnN0TGFibGUubm9kZS5hY3RpdmUgPSB0LmlzRnJpc3Q7XHJcbiAgICAgICAgdGhpcy5wcm9jY2Vzc0xhYmxlLnN0cmluZyA9IFwi6LSt5LmwKFwiICsgdC52aWRlb19jb3VudCArIFwiL1wiICsgdGhpcy5jb25maWcudmlkb19udW0gKyBcIilcIjtcclxuICAgICAgICB0aGlzLnByb2NjZXNzTGFibGUubm9kZS5wYXJlbnQuY2hpbGRyZW5bMF0uYWN0aXZlID0gITA7XHJcbiAgICAgICAgdGhpcy5idG5CdXkuY2hpbGRyZW5bMV0uYWN0aXZlID0gITE7XHJcbiAgICAgICAgdGhpcy5idXlUeXBlID0gMDtcclxuICAgICAgICAwICE9PSB0aGlzLmNvbmZpZy5pc192aWRlbyB8fCAkc2hvcENvbnRleHQuZGVmYXVsdC5JbnMuaXNEaWFtb25kQnV5RGF5KHRoaXMuY29uZmlnLmlkKVxyXG4gICAgICAgICAgICA/IDAgPT09IHRoaXMuY29uZmlnLmlzX3ZpZGVvICYmICh0aGlzLnByb2NjZXNzTGFibGUuc3RyaW5nID0gXCLotK3kubBcIilcclxuICAgICAgICAgICAgOiAoKHRoaXMuYnV5VHlwZSA9IDEpLFxyXG4gICAgICAgICAgICAgICh0aGlzLnByb2NjZXNzTGFibGUubm9kZS5wYXJlbnQuY2hpbGRyZW5bMF0uYWN0aXZlID0gITEpLFxyXG4gICAgICAgICAgICAgICh0aGlzLnByb2NjZXNzTGFibGUuc3RyaW5nID0gXCLlhY3otLlcIiksXHJcbiAgICAgICAgICAgICAgKHRoaXMuYnRuQnV5LmNoaWxkcmVuWzFdLmFjdGl2ZSA9ICEwKSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY2xpY2tCdXkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgICRyZW1vdGVBdWRpby5kZWZhdWx0Lmluc3RhbmNlLnBsYXlFZmZlY3RNdXNpYyhcIkNsaWNrXCIpO1xyXG4gICAgICAgIDAgPT09IHRoaXMuYnV5VHlwZVxyXG4gICAgICAgICAgICA/ICRhZFNlcnZpY2UuZGVmYXVsdC5JbnMuc2hvd1Jld2FyZGVkVmlkZW8oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICBpZiAoJHBsYXRmb3JtLlBsYXRmb3JtLmN1cnJQbGF0Rm9ybSA9PT0gJHBsYXRmb3JtLlBsYXRmb3JtRW51bS5UT1VfVElBTykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgJGFELmRlZmF1bHQudG91dGlhby5yZXBvcnQoXCJEaWFtb25kX1Nob3BcIik7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgdC5idXkoITApO1xyXG4gICAgICAgICAgICAgICAgICB0LnJlbmRlckxpbWl0KCk7XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgOiAodGhpcy5idXkoITEpLFxyXG4gICAgICAgICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9ET1QsICRzdGFydFZpZXcuTWVudVR5cGUuU2hvcCksXHJcbiAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMaW1pdCgpKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5idXkgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHZhciBlID0gJHNob3BDb250ZXh0LmRlZmF1bHQuSW5zLmFkZERpYW1vbmRSZWNvcmQodGhpcy5jb25maWcuaWQsIHRoaXMuY29uZmlnLnZpZG9fbnVtKTtcclxuICAgICAgICBpZiAodCAmJiAkcGxhdGZvcm0uUGxhdGZvcm0uY3VyclBsYXRGb3JtID09PSAkcGxhdGZvcm0uUGxhdGZvcm1FbnVtLlRPVV9USUFPKSB7XHJcbiAgICAgICAgICAgICRhRC5kZWZhdWx0LnRvdXRpYW8ucmVwb3J0KFwiRGlhbW9uZF9TaG9wX1wiICsgdGhpcy5jb25maWcuaWQsIHtcclxuICAgICAgICAgICAgICAgIGNvdW50OiBlLmNvdW50XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZS5pc1Jld2FyZCkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IGUuaXNGaXJzdCA/IDIgKiB0aGlzLmNvbmZpZy5yZXdhcmRfbnVtIDogdGhpcy5jb25maWcucmV3YXJkX251bTtcclxuICAgICAgICAgICAgJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5vcGVhckRpYW1vbmQoaSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgICAgIHZhciBvID0gW107XHJcbiAgICAgICAgICAgIG8ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiA2LFxyXG4gICAgICAgICAgICAgICAgbnVtOiBpXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkcG9wdXBNYW5hZ2VyLlBvcHVwTWFuYWdlci5pbnN0YW5jZS5vcGVuKCRhc3NldHNNYXAuQXNzZXRzTWFwLlBvcFVwQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuUmV3YXJkVmlldywge1xyXG4gICAgICAgICAgICAgICAgaW5mb3M6IG9cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVuZGVyTGltaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSAkc2hvcENvbnRleHQuZGVmYXVsdC5JbnMuZ2V0RGlhbW9uZFJlY29yZEJ5SWQodGhpcy5jb25maWcuaWQpLmRheUJ1eUNvdW50O1xyXG4gICAgICAgIHRoaXMubGltaXRMYWJsZS5zdHJpbmcgPSBcIuavj+aXpemZkOi0rShcIiArIHQgKyBcIi9cIiArIHRoaXMuY29uZmlnLmJ1eV9udW0gKyBcIilcIjtcclxuICAgICAgICAkdXRpbC5kZWZhdWx0LnVwZGF0ZU1hdGVyaWFsU3RhdGUodGhpcy5idG5CdXksIHQgPj0gdGhpcy5jb25maWcuYnV5X251bSk7XHJcbiAgICAgICAgdGhpcy5idG5CdXkuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gdCA8IHRoaXMuY29uZmlnLmJ1eV9udW07XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbdyhjYy5TcHJpdGUpXSwgZS5wcm90b3R5cGUsIFwiaWNvblwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbdyhjYy5MYWJlbCldLCBlLnByb3RvdHlwZSwgXCJmaXJzdExhYmxlXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFt3KGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImNvdW50TGFibGVcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW3coY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJidG5CdXlcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW3coY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwicHJvY2Nlc3NMYWJsZVwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbdyhjYy5MYWJlbCldLCBlLnByb3RvdHlwZSwgXCJsaW1pdExhYmxlXCIsIHZvaWQgMCk7XHJcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbYl0sIGUpO1xyXG59KShjYy5Db21wb25lbnQpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBBO1xyXG4iXX0=