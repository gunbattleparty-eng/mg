{"version":3,"sources":["assets\\game_script\\scripts\\TaskContext.js"],"names":["$eventManager","require","$storageUtil","$util","$startView","$configContext","$localEventName","$localName","u","t","taskRecord","taskTime","StorageUtil","getItem","TAKS_RECORD","TASK_TIME","startDayTimestamp","length","Object","defineProperty","get","instance","enumerable","configurable","prototype","getTaskRecord","isGain","num","setTaskRecord","e","setItem","send","RENDER_DOT","MenuType","Battle","hasRedDot","taskConfigs","i","id","target_num","gainTask","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var $eventManager = require(\"./EventManager\");\r\nvar $storageUtil = require(\"./StorageUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $startView = require(\"./StartView\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $localName = require(\"./LocalName\");\r\nvar u = (function () {\r\n    function t() {\r\n        this.taskRecord = [];\r\n        this.taskTime = 0;\r\n        this.taskRecord = $storageUtil.StorageUtil.getItem($localName.default.TAKS_RECORD, this.taskRecord);\r\n        this.taskTime = $storageUtil.StorageUtil.getItem($localName.default.TASK_TIME, this.taskTime);\r\n        var t = $util.default.startDayTimestamp();\r\n        if (this.taskTime < t) {\r\n            this.taskRecord.length = 0;\r\n            this.taskTime = t;\r\n        }\r\n    }\r\n    Object.defineProperty(t, \"Ins\", {\r\n        get: function () {\r\n            if (!t.instance) {\r\n                t.instance = new t();\r\n            }\r\n            return t.instance;\r\n        },\r\n        enumerable: !1,\r\n        configurable: !0\r\n    });\r\n    t.prototype.getTaskRecord = function (t) {\r\n        return this.taskRecord[t - 1]\r\n            ? this.taskRecord[t - 1]\r\n            : {\r\n                  isGain: !1,\r\n                  num: 0\r\n              };\r\n    };\r\n    t.prototype.setTaskRecord = function (t, e) {\r\n        if (void 0 === e) {\r\n            e = 1;\r\n        }\r\n        if (0 !== e) {\r\n            if (!this.taskRecord[t - 1]) {\r\n                this.taskRecord[t - 1] = {\r\n                    isGain: !1,\r\n                    num: 0\r\n                };\r\n            }\r\n            this.taskRecord[t - 1].num += e;\r\n            $storageUtil.StorageUtil.setItem($localName.default.TAKS_RECORD, this.taskRecord);\r\n            $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.Battle);\r\n        }\r\n    };\r\n    t.prototype.hasRedDot = function () {\r\n        for (var t = 0; t < $configContext.default.instance.taskConfigs.length; t++) {\r\n            var e = $configContext.default.instance.taskConfigs[t];\r\n            var i = this.getTaskRecord(e.id);\r\n            if (!i.isGain && i.num >= e.target_num) {\r\n                return !0;\r\n            }\r\n        }\r\n        return !1;\r\n    };\r\n    t.prototype.gainTask = function (t) {\r\n        this.taskRecord[t - 1].isGain = !0;\r\n        $storageUtil.StorageUtil.setItem($localName.default.TASK_TIME, this.taskTime);\r\n    };\r\n    return t;\r\n})();\r\nexports.default = u;\r\n"]}