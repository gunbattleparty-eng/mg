{"version":3,"sources":["assets\\game_script\\scripts\\Gun_10.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$seedUtil","$configContext","$globalParam","$localEventName","$baseBullet","$gameContext","$gameGemInfo","$gameSkillInfo","$baseGun","_","cc","Vec3","ZERO","t","e","i","call","skillId","skillParam","ins","skillInfo","getSkillById","__extends","prototype","updateF","isAttacking","isGamePuase","timeLeft","skillCD","Skill4Param","FINAL","send","RENDER_SKILL_CD_INFO","starGun","oilCount","GameGemInfo","hasGem","GemType","AddSkill","probability","get1","getRandomEnemys","pointNode","skillAtkRange","length","n","schedulesOnce","sendButtle","getPosition","clone","s","getButtlePool","BulletType","oil","instance","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","Bullet_24","ResUtil","instantiate","buttleLayer","parent","getComponent","skillSpecialitys","basicSkillConfigMap","get","skill_tpye","targetPos","targetEnemy","convertToNodeSpaceAR","convertToWorldSpaceAR","setPosition","l","sub","normalize","initButtle","insert","exports"],"mappings":";;;;;;AAAA,IAAIA,CAAJ;;AACA,IAAIC,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIG,aAAa,GAAGH,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAII,SAAS,GAAGJ,OAAO,CAAC,YAAD,CAAvB;;AACA,IAAIK,cAAc,GAAGL,OAAO,CAAC,iBAAD,CAA5B;;AACA,IAAIM,YAAY,GAAGN,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIO,eAAe,GAAGP,OAAO,CAAC,kBAAD,CAA7B;;AACA,IAAIQ,WAAW,GAAGR,OAAO,CAAC,cAAD,CAAzB;;AACA,IAAIS,YAAY,GAAGT,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIU,YAAY,GAAGV,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIW,cAAc,GAAGX,OAAO,CAAC,iBAAD,CAA5B;;AACA,IAAIY,QAAQ,GAAGZ,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIa,CAAC,IACAC,EAAE,CAACC,IAAH,CAAQC,IAAR,EACA,UAAUC,CAAV,EAAa;EACV,SAASC,CAAT,CAAWA,CAAX,EAAc;IACV,IAAIC,CAAC,GAAGF,CAAC,CAACG,IAAF,CAAO,IAAP,EAAaF,CAAb,KAAmB,IAA3B;IACAC,CAAC,CAACE,OAAF,GAAY,GAAZ;IACAF,CAAC,CAACG,UAAF,GAAeb,YAAY,WAAZ,CAAqBc,GAArB,CAAyBC,SAAzB,CAAmCC,YAAnC,CAAgDN,CAAC,CAACE,OAAlD,CAAf;IACA,OAAOF,CAAP;EACH;;EACDO,SAAS,CAACR,CAAD,EAAID,CAAJ,CAAT;;EACAC,CAAC,CAACS,SAAF,CAAYC,OAAZ,GAAsB,UAAUV,CAAV,EAAa;IAC/BD,CAAC,CAACU,SAAF,CAAYC,OAAZ,CAAoBR,IAApB,CAAyB,IAAzB,EAA+BF,CAA/B;;IACA,IAAI,EAAE,KAAKW,WAAL,IAAoBvB,YAAY,WAAZ,CAAqBwB,WAA3C,CAAJ,EAA6D;MACzD,KAAKC,QAAL,IAAiBb,CAAjB;MACA,KAAKa,QAAL,IAAiB,CAAjB,IACQ,KAAKF,WAAL,GAAmB,CAAC,CAArB,EACA,KAAKE,QAAL,GAAgB,KAAKT,UAAL,CAAgBU,OAAhB,CAAwBrB,cAAc,CAACsB,WAAf,CAA2BC,KAAnD,CADhB,EAED/B,aAAa,WAAb,CAAsBgC,IAAtB,CAA2B5B,eAAe,WAAf,CAAwB6B,oBAAnD,EAAyE,KAAKf,OAA9E,EAAuF,CAAvF,EAA0F,CAAC,CAA3F,CAFC,EAGD,KAAKgB,OAAL,OAAoB,KAAKR,WAAL,GAAmB,CAAC,CAArB,EAA0B,KAAKE,QAAL,GAAgB,CAA7D,CAJN,IAKM5B,aAAa,WAAb,CAAsBgC,IAAtB,CACI5B,eAAe,WAAf,CAAwB6B,oBAD5B,EAEI,KAAKf,OAFT,EAGI,KAAKU,QAAL,GAAgB,KAAKT,UAAL,CAAgBU,OAAhB,CAAwBrB,cAAc,CAACsB,WAAf,CAA2BC,KAAnD,CAHpB,EAII,CAAC,CAJL,CALN;IAWH;EACJ,CAhBD;;EAiBAhB,CAAC,CAACS,SAAF,CAAYU,OAAZ,GAAsB,YAAY;IAC9B,IAAIpB,CAAC,GAAG,IAAR;IACA,IAAIC,CAAC,GAAG,KAAKI,UAAL,CAAgBgB,QAAxB;;IACA,IACI5B,YAAY,CAAC6B,WAAb,CAAyBhB,GAAzB,CAA6BiB,MAA7B,CAAoC9B,YAAY,CAAC+B,OAAb,CAAqBC,QAAzD,KACAtC,SAAS,WAAT,CAAkBuC,WAAlB,CAA8B,MAAMjC,YAAY,CAAC6B,WAAb,CAAyBhB,GAAzB,CAA6BqB,IAA7B,CAAkClC,YAAY,CAAC+B,OAAb,CAAqBC,QAAvD,CAApC,CAFJ,EAGE;MACExB,CAAC,IAAI,CAAL;IACH;;IACD,IAAIC,CAAC,GAAGV,YAAY,WAAZ,CAAqBc,GAArB,CAAyBsB,eAAzB,CACJ,KAAKC,SADD,EAEJ5B,CAFI,EAGJ,KAAKI,UAAL,CAAgByB,aAAhB,CAA8BpC,cAAc,CAACsB,WAAf,CAA2BC,KAAzD,CAHI,CAAR;;IAKA,IAAIf,CAAC,CAAC6B,MAAF,IAAY,CAAhB,EAAmB;MACf,OAAO,CAAC,CAAR;IACH;;IACD,IAAIlD,CAAC,GAAG,SAAJA,CAAI,CAAUoB,CAAV,EAAa;MACjB+B,CAAC,CAACC,aAAF,CAAgB,YAAY;QACxBjC,CAAC,CAACkC,UAAF,CAAahC,CAAC,CAACD,CAAD,CAAD,CAAKkC,WAAL,GAAmBC,KAAnB,EAAb,EAAyClC,CAAC,CAACD,CAAD,CAA1C;MACH,CAFD,EAEG,MAAMA,CAFT;IAGH,CAJD;;IAKA,IAAI+B,CAAC,GAAG,IAAR;;IACA,KAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnC,CAAC,CAAC6B,MAAtB,EAA8BM,CAAC,EAA/B,EAAmC;MAC/BxD,CAAC,CAACwD,CAAD,CAAD;IACH;;IACD,KAAKzB,WAAL,GAAmB,CAAC,CAApB;IACA,OAAO,CAAC,CAAR;EACH,CA5BD;;EA6BAX,CAAC,CAACS,SAAF,CAAYwB,UAAZ,GAAyB,UAAUlC,CAAV,EAAaC,CAAb,EAAgB;IACrC,IAAIC,CAAC,GAAGV,YAAY,WAAZ,CAAqBc,GAArB,CAAyBgC,aAAzB,CAAuC/C,WAAW,CAACgD,UAAZ,CAAuBC,GAA9D,CAAR;;IACA,IAAI,CAACtC,CAAL,EAAQ;MACJ,IAAIrB,CAAC,GAAGC,aAAa,WAAb,CAAsB2D,QAAtB,CAA+BC,MAA/B,CACJ1D,UAAU,CAAC2D,WAAX,CAAuBC,IADnB,EAEJ5D,UAAU,CAAC6D,SAAX,CAAqBC,WAArB,CAAiCC,OAAjC,CAAyCC,UAAzC,CAAoDC,SAFhD,CAAR;MAIA,CAAC/C,CAAC,GAAGjB,QAAQ,CAACiE,OAAT,CAAiBC,WAAjB,CAA6BtE,CAA7B,EAAgCW,YAAY,WAAZ,CAAqBc,GAArB,CAAyB8C,WAAzB,CAAqCC,MAArE,EAA6EC,YAA7E,CACD/D,WAAW,WADV,CAAL,EAEGgE,gBAFH,GAEsBnE,cAAc,WAAd,CAAuBqD,QAAvB,CAAgCe,mBAAhC,CAAoDC,GAApD,CAAwD,KAAKrD,OAA7D,EAAsEsD,UAF5F;IAGH;;IACDxD,CAAC,CAACyD,SAAF,GAAc3D,CAAd;IACAE,CAAC,CAAC0D,WAAF,GAAgB3D,CAAhB;IACA,IAAI+B,CAAC,GAAGxC,YAAY,WAAZ,CAAqBc,GAArB,CAAyB8C,WAAzB,CAAqCS,oBAArC,CACJ,KAAKhC,SAAL,CAAeiC,qBAAf,CAAqCjE,EAAE,CAACC,IAAH,CAAQC,IAA7C,CADI,CAAR;IAGAG,CAAC,CAAC6D,WAAF,CAAc/B,CAAd;IACA,IAAIgC,CAAC,GAAGhE,CAAC,CAACiE,GAAF,CAAMjC,CAAN,EAASkC,SAAT,EAAR;IACAhE,CAAC,CAACiE,UAAF,CAAaH,CAAb,EAAgB,KAAK5D,OAArB;IACAF,CAAC,CAACkE,MAAF,CAAS5E,YAAY,WAAZ,CAAqBc,GAArB,CAAyB8C,WAAlC;EACH,CApBD;;EAqBA,OAAOnD,CAAP;AACH,CA5ED,CA4EGN,QAAQ,WA5EX,CAFC,CAAL;;AA+EA0E,OAAO,WAAP,GAAkBzE,CAAlB","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $baseGun = require(\"./BaseGun\");\r\nvar _ =\r\n    (cc.Vec3.ZERO,\r\n    (function (t) {\r\n        function e(e) {\r\n            var i = t.call(this, e) || this;\r\n            i.skillId = 227;\r\n            i.skillParam = $gameContext.default.ins.skillInfo.getSkillById(i.skillId);\r\n            return i;\r\n        }\r\n        __extends(e, t);\r\n        e.prototype.updateF = function (e) {\r\n            t.prototype.updateF.call(this, e);\r\n            if (!(this.isAttacking || $globalParam.default.isGamePuase)) {\r\n                this.timeLeft -= e;\r\n                this.timeLeft <= 0\r\n                    ? ((this.isAttacking = !0),\r\n                      (this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL]),\r\n                      $eventManager.default.send($localEventName.default.RENDER_SKILL_CD_INFO, this.skillId, 0, -1),\r\n                      this.starGun() || ((this.isAttacking = !1), (this.timeLeft = 0)))\r\n                    : $eventManager.default.send(\r\n                          $localEventName.default.RENDER_SKILL_CD_INFO,\r\n                          this.skillId,\r\n                          this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL],\r\n                          -1\r\n                      );\r\n            }\r\n        };\r\n        e.prototype.starGun = function () {\r\n            var t = this;\r\n            var e = this.skillParam.oilCount;\r\n            if (\r\n                $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) &&\r\n                $seedUtil.default.probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))\r\n            ) {\r\n                e += 1;\r\n            }\r\n            var i = $gameContext.default.ins.getRandomEnemys(\r\n                this.pointNode,\r\n                e,\r\n                this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]\r\n            );\r\n            if (i.length <= 0) {\r\n                return !1;\r\n            }\r\n            var o = function (e) {\r\n                n.schedulesOnce(function () {\r\n                    t.sendButtle(i[e].getPosition().clone(), i[e]);\r\n                }, 0.1 * e);\r\n            };\r\n            var n = this;\r\n            for (var s = 0; s < i.length; s++) {\r\n                o(s);\r\n            }\r\n            this.isAttacking = !1;\r\n            return !0;\r\n        };\r\n        e.prototype.sendButtle = function (t, e) {\r\n            var i = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.oil);\r\n            if (!i) {\r\n                var o = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_24\r\n                );\r\n                (i = $resUtil.ResUtil.instantiate(o, $gameContext.default.ins.buttleLayer.parent).getComponent(\r\n                    $baseBullet.default\r\n                )).skillSpecialitys = $configContext.default.instance.basicSkillConfigMap.get(this.skillId).skill_tpye;\r\n            }\r\n            i.targetPos = t;\r\n            i.targetEnemy = e;\r\n            var n = $gameContext.default.ins.buttleLayer.convertToNodeSpaceAR(\r\n                this.pointNode.convertToWorldSpaceAR(cc.Vec3.ZERO)\r\n            );\r\n            i.setPosition(n);\r\n            var l = t.sub(n).normalize();\r\n            i.initButtle(l, this.skillId);\r\n            i.insert($gameContext.default.ins.buttleLayer);\r\n        };\r\n        return e;\r\n    })($baseGun.default));\r\nexports.default = _;\r\n"]}