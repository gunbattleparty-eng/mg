
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_5.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '55fc3+niS5CdJc7Of0b3kTm', 'Gun_5');
// game_script/scripts/Gun_5.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $remoteAudio = require("./RemoteAudio");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $roleContext = require("./RoleContext");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameGemInfo = require("./GameGemInfo");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseGun = require("./BaseGun");

var v = cc.Vec3.ZERO;

var b = function (t) {
  function e(e) {
    var i = t.call(this, e) || this;
    i.nextXs = [];
    i.sendBulletLeftTime = 0;
    i.skinAtkLeftCd = 0;
    i.skinAtkCurrCount = 0;
    i.skillId = 81;
    i.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(i.skillId);
    return i;
  }

  __extends(e, t);

  e.prototype.updateF = function (e) {
    t.prototype.updateF.call(this, e);

    if (!$globalParam["default"].isGamePuase) {
      if (5 === $roleContext["default"].ins.currSkinInfo.skin && this.skinAtkCurrCount >= $gameContext["default"].ins.skillInfo.skinAtkTargetCount) {
        this.skinAtkLeftCd -= e;

        if (this.skinAtkLeftCd <= 0) {
          this.sendSkinBullet();
        }
      }

      this.sendBulletLeftTime -= e;

      if (this.sendBulletLeftTime <= 0) {
        this.sendBulletLeftTime = this.skillParam.carComboTime;
        this.createButtle();
      }

      this.timeLeft -= e;
      this.timeLeft <= 0 ? (this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0, -1), this.starGun() || (this.timeLeft = 0)) : $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1);
    }
  };

  e.prototype.starGun = function () {
    var t = this.skillParam.carComboCount;

    if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) && $seedUtil["default"].probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))) {
      t *= 2;
    }

    var e = $gameContext["default"].ins.getNearbyN2(null, t);

    if (e.length <= 0 || e[0].getPosition().sub(this.pointNode.position).magSqr() > this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL] * this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]) {
      return !1;
    }

    for (var i = 0; i < e.length; i++) {
      this.nextXs.push(e[i].getPosition().x);
    }

    return !0;
  };

  e.prototype.sendSkinBullet = function () {
    var t = $gameContext["default"].ins.getRangeRankEnemy(this.pointNode, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);

    if (!t) {
      this.skinAtkLeftCd = 2;
      return !1;
    }

    $eventManager["default"].send($localEventName["default"].SEND_SKILL_ANIM);
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.s_bullet_5);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.SBullet_5);
      e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.robotFlyLayer.parent).getComponent($baseBullet["default"]);
    }

    v.x = 0;
    v.y = -cc.winSize.height / 2 - 30;
    e.setPosition(v.clone());
    e.targetEnemy = t;
    v.x = 0;
    v.y = 1;
    e.initButtle(v, this.skillId);
    e.insert($gameContext["default"].ins.robotFlyLayer);
    this.skinAtkCurrCount = 0;
    this.skinAtkLeftCd = $gameContext["default"].ins.skillInfo.skinAtkCd;
  };

  e.prototype.createButtle = function () {
    if (!(this.nextXs.length <= 0)) {
      $remoteAudio["default"].instance.playEffectMusic("firecar");
      var t = this.nextXs.shift();
      var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.car);

      if (!e) {
        var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_13);
        (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
      }

      e.isGem = !1;
      e.setPosition(cc.v3(t, -350));
      v.x = 0;
      v.y = 1;
      e.initButtle(v, this.skillId);
      e.insert($gameContext["default"].ins.lowBulletLayer);
      this.skinAtkCurrCount++;
    }
  };

  return e;
}($baseGun["default"]);

exports["default"] = b;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl81LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRldmVudE1hbmFnZXIiLCIkcmVtb3RlQXVkaW8iLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRnbG9iYWxQYXJhbSIsIiRsb2NhbEV2ZW50TmFtZSIsIiRyb2xlQ29udGV4dCIsIiRiYXNlQnVsbGV0IiwiJGdhbWVDb250ZXh0IiwiJGdhbWVHZW1JbmZvIiwiJGdhbWVTa2lsbEluZm8iLCIkYmFzZUd1biIsInYiLCJjYyIsIlZlYzMiLCJaRVJPIiwiYiIsInQiLCJlIiwiaSIsImNhbGwiLCJuZXh0WHMiLCJzZW5kQnVsbGV0TGVmdFRpbWUiLCJza2luQXRrTGVmdENkIiwic2tpbkF0a0N1cnJDb3VudCIsInNraWxsSWQiLCJza2lsbFBhcmFtIiwiaW5zIiwic2tpbGxJbmZvIiwiZ2V0U2tpbGxCeUlkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwidXBkYXRlRiIsImlzR2FtZVB1YXNlIiwiY3VyclNraW5JbmZvIiwic2tpbiIsInNraW5BdGtUYXJnZXRDb3VudCIsInNlbmRTa2luQnVsbGV0IiwiY2FyQ29tYm9UaW1lIiwiY3JlYXRlQnV0dGxlIiwidGltZUxlZnQiLCJza2lsbENEIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsInNlbmQiLCJSRU5ERVJfU0tJTExfQ0RfSU5GTyIsInN0YXJHdW4iLCJjYXJDb21ib0NvdW50IiwiR2FtZUdlbUluZm8iLCJoYXNHZW0iLCJHZW1UeXBlIiwiQWRkU2tpbGwiLCJwcm9iYWJpbGl0eSIsImdldDEiLCJnZXROZWFyYnlOMiIsImxlbmd0aCIsImdldFBvc2l0aW9uIiwic3ViIiwicG9pbnROb2RlIiwicG9zaXRpb24iLCJtYWdTcXIiLCJza2lsbEF0a1JhbmdlIiwicHVzaCIsIngiLCJnZXRSYW5nZVJhbmtFbmVteSIsIlNFTkRfU0tJTExfQU5JTSIsImdldEJ1dHRsZVBvb2wiLCJCdWxsZXRUeXBlIiwic19idWxsZXRfNSIsImluc3RhbmNlIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIlNCdWxsZXRfNSIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsInJvYm90Rmx5TGF5ZXIiLCJwYXJlbnQiLCJnZXRDb21wb25lbnQiLCJ5Iiwid2luU2l6ZSIsImhlaWdodCIsInNldFBvc2l0aW9uIiwiY2xvbmUiLCJ0YXJnZXRFbmVteSIsImluaXRCdXR0bGUiLCJpbnNlcnQiLCJza2luQXRrQ2QiLCJwbGF5RWZmZWN0TXVzaWMiLCJzaGlmdCIsImNhciIsIkJ1bGxldF8xMyIsImJ1dHRsZUxheWVyIiwic2tpbGxTcGVjaWFsaXR5cyIsImJhc2ljU2tpbGxDb25maWdNYXAiLCJnZXQiLCJza2lsbF90cHllIiwiaXNHZW0iLCJ2MyIsImxvd0J1bGxldExheWVyIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlDLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUUsUUFBUSxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJRyxhQUFhLEdBQUdILE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJSSxZQUFZLEdBQUdKLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlLLFNBQVMsR0FBR0wsT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSU0sY0FBYyxHQUFHTixPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSU8sWUFBWSxHQUFHUCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJUSxlQUFlLEdBQUdS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QXZISCxDQUFSOztBQXdIQTZGLE9BQU8sV0FBUCxHQUFrQnhGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRyZW1vdGVBdWRpbyA9IHJlcXVpcmUoXCIuL1JlbW90ZUF1ZGlvXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkZ2xvYmFsUGFyYW0gPSByZXF1aXJlKFwiLi9HbG9iYWxQYXJhbVwiKTtcclxudmFyICRsb2NhbEV2ZW50TmFtZSA9IHJlcXVpcmUoXCIuL0xvY2FsRXZlbnROYW1lXCIpO1xyXG52YXIgJHJvbGVDb250ZXh0ID0gcmVxdWlyZShcIi4vUm9sZUNvbnRleHRcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lR2VtSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVHZW1JbmZvXCIpO1xyXG52YXIgJGdhbWVTa2lsbEluZm8gPSByZXF1aXJlKFwiLi9HYW1lU2tpbGxJbmZvXCIpO1xyXG52YXIgJGJhc2VHdW4gPSByZXF1aXJlKFwiLi9CYXNlR3VuXCIpO1xyXG52YXIgdiA9IGNjLlZlYzMuWkVSTztcclxudmFyIGIgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoZSkge1xyXG4gICAgICAgIHZhciBpID0gdC5jYWxsKHRoaXMsIGUpIHx8IHRoaXM7XHJcbiAgICAgICAgaS5uZXh0WHMgPSBbXTtcclxuICAgICAgICBpLnNlbmRCdWxsZXRMZWZ0VGltZSA9IDA7XHJcbiAgICAgICAgaS5za2luQXRrTGVmdENkID0gMDtcclxuICAgICAgICBpLnNraW5BdGtDdXJyQ291bnQgPSAwO1xyXG4gICAgICAgIGkuc2tpbGxJZCA9IDgxO1xyXG4gICAgICAgIGkuc2tpbGxQYXJhbSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uZ2V0U2tpbGxCeUlkKGkuc2tpbGxJZCk7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS51cGRhdGVGLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKCEkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZSkge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICA1ID09PSAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuY3VyclNraW5JbmZvLnNraW4gJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuc2tpbkF0a0N1cnJDb3VudCA+PSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnNraW5BdGtUYXJnZXRDb3VudFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2tpbkF0a0xlZnRDZCAtPSBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbkF0a0xlZnRDZCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZW5kU2tpbkJ1bGxldCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2VuZEJ1bGxldExlZnRUaW1lIC09IGU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbmRCdWxsZXRMZWZ0VGltZSA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbmRCdWxsZXRMZWZ0VGltZSA9IHRoaXMuc2tpbGxQYXJhbS5jYXJDb21ib1RpbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRsZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgLT0gZTtcclxuICAgICAgICAgICAgdGhpcy50aW1lTGVmdCA8PSAwXHJcbiAgICAgICAgICAgICAgICA/ICgodGhpcy50aW1lTGVmdCA9IHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSksXHJcbiAgICAgICAgICAgICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLCB0aGlzLnNraWxsSWQsIDAsIC0xKSxcclxuICAgICAgICAgICAgICAgICAgdGhpcy5zdGFyR3VuKCkgfHwgKHRoaXMudGltZUxlZnQgPSAwKSlcclxuICAgICAgICAgICAgICAgIDogJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfU0tJTExfQ0RfSU5GTyxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZUxlZnQgLyB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAtMVxyXG4gICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zdGFyR3VuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcy5za2lsbFBhcmFtLmNhckNvbWJvQ291bnQ7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uaW5zLmhhc0dlbSgkZ2FtZUdlbUluZm8uR2VtVHlwZS5BZGRTa2lsbCkgJiZcclxuICAgICAgICAgICAgJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkoMTAwICogJGdhbWVHZW1JbmZvLkdhbWVHZW1JbmZvLmlucy5nZXQxKCRnYW1lR2VtSW5mby5HZW1UeXBlLkFkZFNraWxsKSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgdCAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXROZWFyYnlOMihudWxsLCB0KTtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIGUubGVuZ3RoIDw9IDAgfHxcclxuICAgICAgICAgICAgZVswXS5nZXRQb3NpdGlvbigpLnN1Yih0aGlzLnBvaW50Tm9kZS5wb3NpdGlvbikubWFnU3FyKCkgPlxyXG4gICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrUmFuZ2VbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdICpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtSYW5nZVskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF1cclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgcmV0dXJuICExO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5uZXh0WHMucHVzaChlW2ldLmdldFBvc2l0aW9uKCkueCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAhMDtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zZW5kU2tpbkJ1bGxldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSYW5nZVJhbmtFbmVteShcclxuICAgICAgICAgICAgdGhpcy5wb2ludE5vZGUsXHJcbiAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbS5za2lsbEF0a1JhbmdlWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2tpbkF0a0xlZnRDZCA9IDI7XHJcbiAgICAgICAgICAgIHJldHVybiAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuU0VORF9TS0lMTF9BTklNKTtcclxuICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuc19idWxsZXRfNSk7XHJcbiAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5TQnVsbGV0XzVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnJvYm90Rmx5TGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAkYmFzZUJ1bGxldC5kZWZhdWx0XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHYueCA9IDA7XHJcbiAgICAgICAgdi55ID0gLWNjLndpblNpemUuaGVpZ2h0IC8gMiAtIDMwO1xyXG4gICAgICAgIGUuc2V0UG9zaXRpb24odi5jbG9uZSgpKTtcclxuICAgICAgICBlLnRhcmdldEVuZW15ID0gdDtcclxuICAgICAgICB2LnggPSAwO1xyXG4gICAgICAgIHYueSA9IDE7XHJcbiAgICAgICAgZS5pbml0QnV0dGxlKHYsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgZS5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnJvYm90Rmx5TGF5ZXIpO1xyXG4gICAgICAgIHRoaXMuc2tpbkF0a0N1cnJDb3VudCA9IDA7XHJcbiAgICAgICAgdGhpcy5za2luQXRrTGVmdENkID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luQXRrQ2Q7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY3JlYXRlQnV0dGxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghKHRoaXMubmV4dFhzLmxlbmd0aCA8PSAwKSkge1xyXG4gICAgICAgICAgICAkcmVtb3RlQXVkaW8uZGVmYXVsdC5pbnN0YW5jZS5wbGF5RWZmZWN0TXVzaWMoXCJmaXJlY2FyXCIpO1xyXG4gICAgICAgICAgICB2YXIgdCA9IHRoaXMubmV4dFhzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIHZhciBlID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5jYXIpO1xyXG4gICAgICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8xM1xyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIChlID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShpLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKSkuc2tpbGxTcGVjaWFsaXR5cyA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQodGhpcy5za2lsbElkKS5za2lsbF90cHllO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGUuaXNHZW0gPSAhMTtcclxuICAgICAgICAgICAgZS5zZXRQb3NpdGlvbihjYy52Myh0LCAtMzUwKSk7XHJcbiAgICAgICAgICAgIHYueCA9IDA7XHJcbiAgICAgICAgICAgIHYueSA9IDE7XHJcbiAgICAgICAgICAgIGUuaW5pdEJ1dHRsZSh2LCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICBlLmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIpO1xyXG4gICAgICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQrKztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlR3VuLmRlZmF1bHQpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBiO1xyXG4iXX0=