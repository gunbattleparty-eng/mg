{"version":3,"sources":["assets\\game_script\\scripts\\Bullet_4.js"],"names":["o","$object","require","$assetsLoader","$assetsMap","$resUtil","$seedUtil","$configContext","$gameContext","$gameSkillInfo","$enemyStatus","$baseBullet","y","cc","_decorator","g","ccclass","_","property","t","e","apply","arguments","buttleType","BulletType","thermobaric_bullet","id","anim","currButtlePenetrateLayer","__extends","prototype","initButtle","i","call","atk","skillParam","skillAtk","Skill4Param","FINAL","speed","thermobaricSpeed","velocity","set","multiplyScalar","node","children","getComponent","Animation","setAnimation","isAllPenetrateBoom","play","onTrigger","isUse","Trigger","enter","object","sufferAtk","skillId","skillSpecialitys","thermobaricBoomRange","createButtleBoom","thermobaricSplitCount","createSplitButtle","config","thermobaricPenetrateLayer","removeSelf","thermobaricStunParam","length","n","probability","s","type","EnemyDebuffType","STUN","timeLeft","value","sufferDebuff","ins","getNearbyN2","getButtlePool","thermobaric_split","instance","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","Bullet_7","ResUtil","instantiate","basicSkillConfigMap","get","skill_tpye","setPosition","position","clone","targetEnemy","sub","normalize","insert","buttleLayer","thermobaric_boom","Bullet_5","lowBulletLayer","parent","v3","x","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $enemyStatus = require(\"./EnemyStatus\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar y = cc._decorator;\r\nvar g = y.ccclass;\r\nvar _ =\r\n    (y.property,\r\n    (function (t) {\r\n        function e() {\r\n            var e = (null !== t && t.apply(this, arguments)) || this;\r\n            e.buttleType = $baseBullet.BulletType.thermobaric_bullet;\r\n            e.id = 23;\r\n            e.anim = null;\r\n            e.currButtlePenetrateLayer = 0;\r\n            return e;\r\n        }\r\n        __extends(e, t);\r\n        e.prototype.initButtle = function (e, i) {\r\n            t.prototype.initButtle.call(this, e, i);\r\n            this.currButtlePenetrateLayer = 0;\r\n            this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];\r\n            this.speed = this.skillParam.thermobaricSpeed[$gameSkillInfo.Skill4Param.FINAL];\r\n            this.velocity.set(e).multiplyScalar(this.speed);\r\n            if (!this.anim) {\r\n                this.anim = this.node.children[0].getComponent(cc.Animation);\r\n            }\r\n            this.setAnimation();\r\n        };\r\n        e.prototype.setAnimation = function (t) {\r\n            if (void 0 === t) {\r\n                t = \"bullet_4\";\r\n            }\r\n            if (this.skillParam.isAllPenetrateBoom) {\r\n                t = \"bullet_4_2\";\r\n            }\r\n            this.anim.play(t);\r\n        };\r\n        e.prototype.onTrigger = function (t, e) {\r\n            if (!this.isUse && e == $object.Trigger.enter) {\r\n                var i = t.object;\r\n                i.sufferAtk({\r\n                    id: this.skillId,\r\n                    skillSpecialitys: this.skillSpecialitys,\r\n                    atk: this.atk\r\n                });\r\n                if (0 === this.currButtlePenetrateLayer) {\r\n                    if (this.skillParam.thermobaricBoomRange > 0) {\r\n                        this.createButtleBoom(i);\r\n                    }\r\n                    if (this.skillParam.thermobaricSplitCount > 0) {\r\n                        this.createSplitButtle(i);\r\n                    }\r\n                }\r\n                if (!(29 !== i.config.id && 30 !== i.config.id && 36 !== i.config.id)) {\r\n                    this.currButtlePenetrateLayer = this.skillParam.thermobaricPenetrateLayer;\r\n                }\r\n                this.currButtlePenetrateLayer++;\r\n                if (this.skillParam.thermobaricPenetrateLayer <= this.currButtlePenetrateLayer) {\r\n                    this.isUse = !0;\r\n                    return this.removeSelf();\r\n                }\r\n                if (0 === this.currButtlePenetrateLayer) {\r\n                    for (var o = 0; o < this.skillParam.thermobaricStunParam.length; o++) {\r\n                        var n = this.skillParam.thermobaricStunParam;\r\n                        if ($seedUtil.default.probability(100 * n[o][0])) {\r\n                            var s = {\r\n                                type: $enemyStatus.EnemyDebuffType.STUN,\r\n                                timeLeft: n[o][1],\r\n                                value: 0\r\n                            };\r\n                            i.sufferDebuff(s);\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (\r\n                        this.skillParam.isAllPenetrateBoom &&\r\n                        this.currButtlePenetrateLayer > 1 &&\r\n                        this.skillParam.thermobaricBoomRange > 0\r\n                    ) {\r\n                        this.createButtleBoom(i);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        e.prototype.createSplitButtle = function (t) {\r\n            var e = $gameContext.default.ins.getNearbyN2(t.node, this.skillParam.thermobaricSplitCount);\r\n            for (var i = 0; i < e.length; i++) {\r\n                var o = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.thermobaric_split);\r\n                if (!o) {\r\n                    var n = $assetsLoader.default.instance.getRes(\r\n                        $assetsMap.BundleNames.Game,\r\n                        $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_7\r\n                    );\r\n                    (o = $resUtil.ResUtil.instantiate(n).getComponent($baseBullet.default)).skillSpecialitys =\r\n                        $configContext.default.instance.basicSkillConfigMap.get(23).skill_tpye;\r\n                }\r\n                o.setPosition(this.node.position.clone());\r\n                o.targetEnemy = t;\r\n                o.initButtle(e[i].node.position.sub(this.node.position).normalize(), this.skillId);\r\n                o.insert($gameContext.default.ins.buttleLayer);\r\n            }\r\n        };\r\n        e.prototype.createButtleBoom = function (t) {\r\n            var e = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.thermobaric_boom);\r\n            if (!e) {\r\n                var i = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_5\r\n                );\r\n                e = $resUtil.ResUtil.instantiate(i, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                    $baseBullet.default\r\n                );\r\n            }\r\n            e.setPosition(cc.v3(t.node.position.x, this.node.position.y));\r\n            e.initButtle(null, this.skillId);\r\n            e.insert($gameContext.default.ins.lowBulletLayer);\r\n            e.setAnimation(null);\r\n        };\r\n        return __decorate([g], e);\r\n    })($baseBullet.default));\r\nexports.default = _;\r\n"]}