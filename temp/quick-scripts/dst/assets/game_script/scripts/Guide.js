
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Guide.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '79cc1B9cgFCTK134at6d6i7', 'Guide');
// game_script/scripts/Guide.js

"use strict";

var o;

var $hollowOut = require("./HollowOut");

var $touchBlocker = require("./TouchBlocker");

var u = cc._decorator;
var d = u.ccclass;
var p = u.property;

var f = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.hollowOut = null;
    e.touchBlocker = null;
    e.arrowTargetParent = null;
    e.arrowTarget = null;
    return e;
  }

  var i;

  __extends(e, t);

  i = e;

  e.prototype.onLoad = function () {
    i.currentStep = 1;
  };

  e.prototype.start = function () {
    this.reset();
    i.self = this;
  };

  e.prototype.remove = function () {
    this.hollowOut.node.destroy();
  };

  e.prototype.reset = function () {
    console.log("======================");
    this.hollowOut.node.active = !1;
    this.hollowOut.setNodeSize();
    this.touchBlocker.passAll();
  };

  e.prototype.startGuideMask = function (t, e) {
    var i = this;

    if (void 0 === e) {
      e = -1;
    }

    this.scheduleOnce(function () {
      i.hollowOut.node.active = !0;
      i.touchBlocker.blockAll();
      var o = t;
      var n = o.width + 10;
      var s = o.height + 10;
      i.touchBlocker.target = t;
      var l = i.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.Vec3.ZERO).clone());
      i.hollowOut.node.children.forEach(function (t, i) {
        t.active = i === e;
      });
      new Promise(function () {
        return __awaiter(i, void 0, void 0, function () {
          return __generator(this, function (t) {
            switch (t.label) {
              case 0:
                return [4, this.hollowOut.rectTo(0.3, cc.v2(l), n, s, 5, 5)];

              case 1:
                t.sent();
                return [2];
            }
          });
        });
      });
      i.touchBlocker.setTarget(o);
    }, 0.1);
  };

  e.prototype.startGuideTest = function (t, e) {
    var i = this;
    this.scheduleOnce(function () {
      i.hollowOut.node.active = !0;
      i.touchBlocker.blockAll();
      var o = t;
      var n = o.width + 10;
      var s = o.height + 10;
      i.touchBlocker.target = t;
      var l = i.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.Vec3.ZERO).clone());
      i.hollowOut.node.children.forEach(function (t) {
        t.active = !1;
      });
      var c = i.hollowOut.node.children[2];
      c.active = !0;
      c.position = l.add(cc.v3(0, o.height));
      c.getComponent(cc.Label).string = e;
      new Promise(function () {
        return __awaiter(i, void 0, void 0, function () {
          return __generator(this, function (t) {
            switch (t.label) {
              case 0:
                return [4, this.hollowOut.rectTo(0.3, cc.v2(l), n, s, 5, 5)];

              case 1:
                t.sent();
                return [2];
            }
          });
        });
      });
      i.touchBlocker.setTarget(o);
    }, 0.1);
  };

  e.prototype.stopGuide = function () {
    this.hollowOut.node.children.forEach(function (t) {
      t.active = !1;
    });

    if (cc.isValid(this.arrowTarget)) {
      this.arrowTarget.position = this.arrowTargetParent.convertToNodeSpaceAR(this.arrowTarget.convertToWorldSpaceAR(cc.Vec3.ZERO).clone());
      this.arrowTarget.parent = this.arrowTargetParent;
      this.arrowTarget = null;
      this.arrowTargetParent = null;
    }

    this.hollowOut.setNodeSize();
    this.hollowOut.node.active = !1;
    this.touchBlocker.target = null;
    this.touchBlocker.passAll();
  };

  e.setGuideStep = function (t) {
    if (!(t < i.currentStep)) {
      i.currentStep = t;
    }
  };

  e.isEnd = function () {
    return this.currentStep >= 12;
  };

  e.currentStep = 1;
  e.self = null;

  __decorate([p($hollowOut["default"])], e.prototype, "hollowOut", void 0);

  __decorate([p($touchBlocker["default"])], e.prototype, "touchBlocker", void 0);

  return i = __decorate([d], e);
}(cc.Component);

exports["default"] = f;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1aWRlLmpzIl0sIm5hbWVzIjpbIm8iLCIkaG9sbG93T3V0IiwicmVxdWlyZSIsIiR0b3VjaEJsb2NrZXIiLCJ1IiwiY2MiLCJfZGVjb3JhdG9yIiwiZCIsImNjY2xhc3MiLCJwIiwicHJvcGVydHkiLCJmIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsImhvbGxvd091dCIsInRvdWNoQmxvY2tlciIsImFycm93VGFyZ2V0UGFyZW50IiwiYXJyb3dUYXJnZXQiLCJpIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwiY3VycmVudFN0ZXAiLCJzdGFydCIsInJlc2V0Iiwic2VsZiIsInJlbW92ZSIsIm5vZGUiLCJkZXN0cm95IiwiY29uc29sZSIsImxvZyIsImFjdGl2ZSIsInNldE5vZGVTaXplIiwicGFzc0FsbCIsInN0YXJ0R3VpZGVNYXNrIiwic2NoZWR1bGVPbmNlIiwiYmxvY2tBbGwiLCJuIiwid2lkdGgiLCJzIiwiaGVpZ2h0IiwidGFyZ2V0IiwibCIsImNvbnZlcnRUb05vZGVTcGFjZUFSIiwiY29udmVydFRvV29ybGRTcGFjZUFSIiwiVmVjMyIsIlpFUk8iLCJjbG9uZSIsImNoaWxkcmVuIiwiZm9yRWFjaCIsIlByb21pc2UiLCJfX2F3YWl0ZXIiLCJfX2dlbmVyYXRvciIsImxhYmVsIiwicmVjdFRvIiwidjIiLCJzZW50Iiwic2V0VGFyZ2V0Iiwic3RhcnRHdWlkZVRlc3QiLCJjIiwicG9zaXRpb24iLCJhZGQiLCJ2MyIsImdldENvbXBvbmVudCIsIkxhYmVsIiwic3RyaW5nIiwic3RvcEd1aWRlIiwiaXNWYWxpZCIsInBhcmVudCIsInNldEd1aWRlU3RlcCIsImlzRW5kIiwiX19kZWNvcmF0ZSIsIkNvbXBvbmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxVQUFVLEdBQUdDLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlDLGFBQWEsR0FBR0QsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlFLENBQUMsR0FBR0MsRUFBRSxDQUFDQyxVQUFYO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHSCxDQUFDLENBQUNJLE9BQVY7QUFDQSxJQUFJQyxDQUFDLEdBQUdMLENBQUMsQ0FBQ00sUUFBVjs7QUFDQSxJQUFJQyxDQUFDLEdBQUksVUFBVUMsQ0FBVixFQUFhO0VBQ2xCLFNBQVNDLENBQVQsR0FBYTtJQUNULElBQUlBLENBQUMsR0FBSSxTQUFTRCxDQUFULElBQWNBLENBQUMsQ0FBQ0UsS0FBRixDQUFRLElBQVIsRUFBY0MsU0FBZCxDQUFmLElBQTRDLElBQXBEO0lBQ0FGLENBQUMsQ0FBQ0csU0FBRixHQUFjLElBQWQ7SUFDQUgsQ0FBQyxDQUFDSSxZQUFGLEdBQWlCLElBQWpCO0lBQ0FKLENBQUMsQ0FBQ0ssaUJBQUYsR0FBc0IsSUFBdEI7SUFDQUwsQ0FBQyxDQUFDTSxXQUFGLEdBQWdCLElBQWhCO0lBQ0EsT0FBT04sQ0FBUDtFQUNIOztFQUNELElBQUlPLENBQUo7O0VBQ0FDLFNBQVMsQ0FBQ1IsQ0FBRCxFQUFJRCxDQUFKLENBQVQ7O0VBQ0FRLENBQUMsR0FBR1AsQ0FBSjs7RUFDQUEsQ0FBQyxDQUFDUyxTQUFGLENBQVlDLE1BQVosR0FBcUIsWUFBWTtJQUM3QkgsQ0FBQyxDQUFDSSxXQUFGLEdBQWdCLENBQWhCO0VBQ0gsQ0FGRDs7RUFHQVgsQ0FBQyxDQUFDUyxTQUFGLENBQVlHLEtBQVosR0FBb0IsWUFBWTtJQUM1QixLQUFLQyxLQUFMO0lBQ0FOLENBQUMsQ0FBQ08sSUFBRixHQUFTLElBQVQ7RUFDSCxDQUhEOztFQUlBZCxDQUFDLENBQUNTLFNBQUYsQ0FBWU0sTUFBWixHQUFxQixZQUFZO0lBQzdCLEtBQUtaLFNBQUwsQ0FBZWEsSUFBZixDQUFvQkMsT0FBcEI7RUFDSCxDQUZEOztFQUdBakIsQ0FBQyxDQUFDUyxTQUFGLENBQVlJLEtBQVosR0FBb0IsWUFBWTtJQUM1QkssT0FBTyxDQUFDQyxHQUFSLENBQVksd0JBQVo7SUFDQSxLQUFLaEIsU0FBTCxDQUFlYSxJQUFmLENBQW9CSSxNQUFwQixHQUE2QixDQUFDLENBQTlCO0lBQ0EsS0FBS2pCLFNBQUwsQ0FBZWtCLFdBQWY7SUFDQSxLQUFLakIsWUFBTCxDQUFrQmtCLE9BQWxCO0VBQ0gsQ0FMRDs7RUFNQXRCLENBQUMsQ0FBQ1MsU0FBRixDQUFZYyxjQUFaLEdBQTZCLFVBQVV4QixDQUFWLEVBQWFDLENBQWIsRUFBZ0I7SUFDekMsSUFBSU8sQ0FBQyxHQUFHLElBQVI7O0lBQ0EsSUFBSSxLQUFLLENBQUwsS0FBV1AsQ0FBZixFQUFrQjtNQUNkQSxDQUFDLEdBQUcsQ0FBQyxDQUFMO0lBQ0g7O0lBQ0QsS0FBS3dCLFlBQUwsQ0FBa0IsWUFBWTtNQUMxQmpCLENBQUMsQ0FBQ0osU0FBRixDQUFZYSxJQUFaLENBQWlCSSxNQUFqQixHQUEwQixDQUFDLENBQTNCO01BQ0FiLENBQUMsQ0FBQ0gsWUFBRixDQUFlcUIsUUFBZjtNQUNBLElBQUl0QyxDQUFDLEdBQUdZLENBQVI7TUFDQSxJQUFJMkIsQ0FBQyxHQUFHdkMsQ0FBQyxDQUFDd0MsS0FBRixHQUFVLEVBQWxCO01BQ0EsSUFBSUMsQ0FBQyxHQUFHekMsQ0FBQyxDQUFDMEMsTUFBRixHQUFXLEVBQW5CO01BQ0F0QixDQUFDLENBQUNILFlBQUYsQ0FBZTBCLE1BQWYsR0FBd0IvQixDQUF4QjtNQUNBLElBQUlnQyxDQUFDLEdBQUd4QixDQUFDLENBQUNTLElBQUYsQ0FBT2dCLG9CQUFQLENBQTRCakMsQ0FBQyxDQUFDa0MscUJBQUYsQ0FBd0J6QyxFQUFFLENBQUMwQyxJQUFILENBQVFDLElBQWhDLEVBQXNDQyxLQUF0QyxFQUE1QixDQUFSO01BQ0E3QixDQUFDLENBQUNKLFNBQUYsQ0FBWWEsSUFBWixDQUFpQnFCLFFBQWpCLENBQTBCQyxPQUExQixDQUFrQyxVQUFVdkMsQ0FBVixFQUFhUSxDQUFiLEVBQWdCO1FBQzlDUixDQUFDLENBQUNxQixNQUFGLEdBQVdiLENBQUMsS0FBS1AsQ0FBakI7TUFDSCxDQUZEO01BR0EsSUFBSXVDLE9BQUosQ0FBWSxZQUFZO1FBQ3BCLE9BQU9DLFNBQVMsQ0FBQ2pDLENBQUQsRUFBSSxLQUFLLENBQVQsRUFBWSxLQUFLLENBQWpCLEVBQW9CLFlBQVk7VUFDNUMsT0FBT2tDLFdBQVcsQ0FBQyxJQUFELEVBQU8sVUFBVTFDLENBQVYsRUFBYTtZQUNsQyxRQUFRQSxDQUFDLENBQUMyQyxLQUFWO2NBQ0ksS0FBSyxDQUFMO2dCQUNJLE9BQU8sQ0FBQyxDQUFELEVBQUksS0FBS3ZDLFNBQUwsQ0FBZXdDLE1BQWYsQ0FBc0IsR0FBdEIsRUFBMkJuRCxFQUFFLENBQUNvRCxFQUFILENBQU1iLENBQU4sQ0FBM0IsRUFBcUNMLENBQXJDLEVBQXdDRSxDQUF4QyxFQUEyQyxDQUEzQyxFQUE4QyxDQUE5QyxDQUFKLENBQVA7O2NBQ0osS0FBSyxDQUFMO2dCQUNJN0IsQ0FBQyxDQUFDOEMsSUFBRjtnQkFDQSxPQUFPLENBQUMsQ0FBRCxDQUFQO1lBTFI7VUFPSCxDQVJpQixDQUFsQjtRQVNILENBVmUsQ0FBaEI7TUFXSCxDQVpEO01BYUF0QyxDQUFDLENBQUNILFlBQUYsQ0FBZTBDLFNBQWYsQ0FBeUIzRCxDQUF6QjtJQUNILENBekJELEVBeUJHLEdBekJIO0VBMEJILENBL0JEOztFQWdDQWEsQ0FBQyxDQUFDUyxTQUFGLENBQVlzQyxjQUFaLEdBQTZCLFVBQVVoRCxDQUFWLEVBQWFDLENBQWIsRUFBZ0I7SUFDekMsSUFBSU8sQ0FBQyxHQUFHLElBQVI7SUFDQSxLQUFLaUIsWUFBTCxDQUFrQixZQUFZO01BQzFCakIsQ0FBQyxDQUFDSixTQUFGLENBQVlhLElBQVosQ0FBaUJJLE1BQWpCLEdBQTBCLENBQUMsQ0FBM0I7TUFDQWIsQ0FBQyxDQUFDSCxZQUFGLENBQWVxQixRQUFmO01BQ0EsSUFBSXRDLENBQUMsR0FBR1ksQ0FBUjtNQUNBLElBQUkyQixDQUFDLEdBQUd2QyxDQUFDLENBQUN3QyxLQUFGLEdBQVUsRUFBbEI7TUFDQSxJQUFJQyxDQUFDLEdBQUd6QyxDQUFDLENBQUMwQyxNQUFGLEdBQVcsRUFBbkI7TUFDQXRCLENBQUMsQ0FBQ0gsWUFBRixDQUFlMEIsTUFBZixHQUF3Qi9CLENBQXhCO01BQ0EsSUFBSWdDLENBQUMsR0FBR3hCLENBQUMsQ0FBQ1MsSUFBRixDQUFPZ0Isb0JBQVAsQ0FBNEJqQyxDQUFDLENBQUNrQyxxQkFBRixDQUF3QnpDLEVBQUUsQ0FBQzBDLElBQUgsQ0FBUUMsSUFBaEMsRUFBc0NDLEtBQXRDLEVBQTVCLENBQVI7TUFDQTdCLENBQUMsQ0FBQ0osU0FBRixDQUFZYSxJQUFaLENBQWlCcUIsUUFBakIsQ0FBMEJDLE9BQTFCLENBQWtDLFVBQVV2QyxDQUFWLEVBQWE7UUFDM0NBLENBQUMsQ0FBQ3FCLE1BQUYsR0FBVyxDQUFDLENBQVo7TUFDSCxDQUZEO01BR0EsSUFBSTRCLENBQUMsR0FBR3pDLENBQUMsQ0FBQ0osU0FBRixDQUFZYSxJQUFaLENBQWlCcUIsUUFBakIsQ0FBMEIsQ0FBMUIsQ0FBUjtNQUNBVyxDQUFDLENBQUM1QixNQUFGLEdBQVcsQ0FBQyxDQUFaO01BQ0E0QixDQUFDLENBQUNDLFFBQUYsR0FBYWxCLENBQUMsQ0FBQ21CLEdBQUYsQ0FBTTFELEVBQUUsQ0FBQzJELEVBQUgsQ0FBTSxDQUFOLEVBQVNoRSxDQUFDLENBQUMwQyxNQUFYLENBQU4sQ0FBYjtNQUNBbUIsQ0FBQyxDQUFDSSxZQUFGLENBQWU1RCxFQUFFLENBQUM2RCxLQUFsQixFQUF5QkMsTUFBekIsR0FBa0N0RCxDQUFsQztNQUNBLElBQUl1QyxPQUFKLENBQVksWUFBWTtRQUNwQixPQUFPQyxTQUFTLENBQUNqQyxDQUFELEVBQUksS0FBSyxDQUFULEVBQVksS0FBSyxDQUFqQixFQUFvQixZQUFZO1VBQzVDLE9BQU9rQyxXQUFXLENBQUMsSUFBRCxFQUFPLFVBQVUxQyxDQUFWLEVBQWE7WUFDbEMsUUFBUUEsQ0FBQyxDQUFDMkMsS0FBVjtjQUNJLEtBQUssQ0FBTDtnQkFDSSxPQUFPLENBQUMsQ0FBRCxFQUFJLEtBQUt2QyxTQUFMLENBQWV3QyxNQUFmLENBQXNCLEdBQXRCLEVBQTJCbkQsRUFBRSxDQUFDb0QsRUFBSCxDQUFNYixDQUFOLENBQTNCLEVBQXFDTCxDQUFyQyxFQUF3Q0UsQ0FBeEMsRUFBMkMsQ0FBM0MsRUFBOEMsQ0FBOUMsQ0FBSixDQUFQOztjQUNKLEtBQUssQ0FBTDtnQkFDSTdCLENBQUMsQ0FBQzhDLElBQUY7Z0JBQ0EsT0FBTyxDQUFDLENBQUQsQ0FBUDtZQUxSO1VBT0gsQ0FSaUIsQ0FBbEI7UUFTSCxDQVZlLENBQWhCO01BV0gsQ0FaRDtNQWFBdEMsQ0FBQyxDQUFDSCxZQUFGLENBQWUwQyxTQUFmLENBQXlCM0QsQ0FBekI7SUFDSCxDQTdCRCxFQTZCRyxHQTdCSDtFQThCSCxDQWhDRDs7RUFpQ0FhLENBQUMsQ0FBQ1MsU0FBRixDQUFZOEMsU0FBWixHQUF3QixZQUFZO0lBQ2hDLEtBQUtwRCxTQUFMLENBQWVhLElBQWYsQ0FBb0JxQixRQUFwQixDQUE2QkMsT0FBN0IsQ0FBcUMsVUFBVXZDLENBQVYsRUFBYTtNQUM5Q0EsQ0FBQyxDQUFDcUIsTUFBRixHQUFXLENBQUMsQ0FBWjtJQUNILENBRkQ7O0lBR0EsSUFBSTVCLEVBQUUsQ0FBQ2dFLE9BQUgsQ0FBVyxLQUFLbEQsV0FBaEIsQ0FBSixFQUFrQztNQUM5QixLQUFLQSxXQUFMLENBQWlCMkMsUUFBakIsR0FBNEIsS0FBSzVDLGlCQUFMLENBQXVCMkIsb0JBQXZCLENBQ3hCLEtBQUsxQixXQUFMLENBQWlCMkIscUJBQWpCLENBQXVDekMsRUFBRSxDQUFDMEMsSUFBSCxDQUFRQyxJQUEvQyxFQUFxREMsS0FBckQsRUFEd0IsQ0FBNUI7TUFHQSxLQUFLOUIsV0FBTCxDQUFpQm1ELE1BQWpCLEdBQTBCLEtBQUtwRCxpQkFBL0I7TUFDQSxLQUFLQyxXQUFMLEdBQW1CLElBQW5CO01BQ0EsS0FBS0QsaUJBQUwsR0FBeUIsSUFBekI7SUFDSDs7SUFDRCxLQUFLRixTQUFMLENBQWVrQixXQUFmO0lBQ0EsS0FBS2xCLFNBQUwsQ0FBZWEsSUFBZixDQUFvQkksTUFBcEIsR0FBNkIsQ0FBQyxDQUE5QjtJQUNBLEtBQUtoQixZQUFMLENBQWtCMEIsTUFBbEIsR0FBMkIsSUFBM0I7SUFDQSxLQUFLMUIsWUFBTCxDQUFrQmtCLE9BQWxCO0VBQ0gsQ0FoQkQ7O0VBaUJBdEIsQ0FBQyxDQUFDMEQsWUFBRixHQUFpQixVQUFVM0QsQ0FBVixFQUFhO0lBQzFCLElBQUksRUFBRUEsQ0FBQyxHQUFHUSxDQUFDLENBQUNJLFdBQVIsQ0FBSixFQUEwQjtNQUN0QkosQ0FBQyxDQUFDSSxXQUFGLEdBQWdCWixDQUFoQjtJQUNIO0VBQ0osQ0FKRDs7RUFLQUMsQ0FBQyxDQUFDMkQsS0FBRixHQUFVLFlBQVk7SUFDbEIsT0FBTyxLQUFLaEQsV0FBTCxJQUFvQixFQUEzQjtFQUNILENBRkQ7O0VBR0FYLENBQUMsQ0FBQ1csV0FBRixHQUFnQixDQUFoQjtFQUNBWCxDQUFDLENBQUNjLElBQUYsR0FBUyxJQUFUOztFQUNBOEMsVUFBVSxDQUFDLENBQUNoRSxDQUFDLENBQUNSLFVBQVUsV0FBWCxDQUFGLENBQUQsRUFBMEJZLENBQUMsQ0FBQ1MsU0FBNUIsRUFBdUMsV0FBdkMsRUFBb0QsS0FBSyxDQUF6RCxDQUFWOztFQUNBbUQsVUFBVSxDQUFDLENBQUNoRSxDQUFDLENBQUNOLGFBQWEsV0FBZCxDQUFGLENBQUQsRUFBNkJVLENBQUMsQ0FBQ1MsU0FBL0IsRUFBMEMsY0FBMUMsRUFBMEQsS0FBSyxDQUEvRCxDQUFWOztFQUNBLE9BQVFGLENBQUMsR0FBR3FELFVBQVUsQ0FBQyxDQUFDbEUsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBdEI7QUFDSCxDQTNITyxDQTJITFIsRUFBRSxDQUFDcUUsU0EzSEUsQ0FBUjs7QUE0SEFDLE9BQU8sV0FBUCxHQUFrQmhFLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRob2xsb3dPdXQgPSByZXF1aXJlKFwiLi9Ib2xsb3dPdXRcIik7XHJcbnZhciAkdG91Y2hCbG9ja2VyID0gcmVxdWlyZShcIi4vVG91Y2hCbG9ja2VyXCIpO1xyXG52YXIgdSA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciBkID0gdS5jY2NsYXNzO1xyXG52YXIgcCA9IHUucHJvcGVydHk7XHJcbnZhciBmID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuaG9sbG93T3V0ID0gbnVsbDtcclxuICAgICAgICBlLnRvdWNoQmxvY2tlciA9IG51bGw7XHJcbiAgICAgICAgZS5hcnJvd1RhcmdldFBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgZS5hcnJvd1RhcmdldCA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICB2YXIgaTtcclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGkgPSBlO1xyXG4gICAgZS5wcm90b3R5cGUub25Mb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGkuY3VycmVudFN0ZXAgPSAxO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgICBpLnNlbGYgPSB0aGlzO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmhvbGxvd091dC5ub2RlLmRlc3Ryb3koKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIj09PT09PT09PT09PT09PT09PT09PT1cIik7XHJcbiAgICAgICAgdGhpcy5ob2xsb3dPdXQubm9kZS5hY3RpdmUgPSAhMTtcclxuICAgICAgICB0aGlzLmhvbGxvd091dC5zZXROb2RlU2l6ZSgpO1xyXG4gICAgICAgIHRoaXMudG91Y2hCbG9ja2VyLnBhc3NBbGwoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zdGFydEd1aWRlTWFzayA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdmFyIGkgPSB0aGlzO1xyXG4gICAgICAgIGlmICh2b2lkIDAgPT09IGUpIHtcclxuICAgICAgICAgICAgZSA9IC0xO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNjaGVkdWxlT25jZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGkuaG9sbG93T3V0Lm5vZGUuYWN0aXZlID0gITA7XHJcbiAgICAgICAgICAgIGkudG91Y2hCbG9ja2VyLmJsb2NrQWxsKCk7XHJcbiAgICAgICAgICAgIHZhciBvID0gdDtcclxuICAgICAgICAgICAgdmFyIG4gPSBvLndpZHRoICsgMTA7XHJcbiAgICAgICAgICAgIHZhciBzID0gby5oZWlnaHQgKyAxMDtcclxuICAgICAgICAgICAgaS50b3VjaEJsb2NrZXIudGFyZ2V0ID0gdDtcclxuICAgICAgICAgICAgdmFyIGwgPSBpLm5vZGUuY29udmVydFRvTm9kZVNwYWNlQVIodC5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIoY2MuVmVjMy5aRVJPKS5jbG9uZSgpKTtcclxuICAgICAgICAgICAgaS5ob2xsb3dPdXQubm9kZS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uICh0LCBpKSB7XHJcbiAgICAgICAgICAgICAgICB0LmFjdGl2ZSA9IGkgPT09IGU7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX19hd2FpdGVyKGksIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodC5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgdGhpcy5ob2xsb3dPdXQucmVjdFRvKDAuMywgY2MudjIobCksIG4sIHMsIDUsIDUpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGkudG91Y2hCbG9ja2VyLnNldFRhcmdldChvKTtcclxuICAgICAgICB9LCAwLjEpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJ0R3VpZGVUZXN0ID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB2YXIgaSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpLmhvbGxvd091dC5ub2RlLmFjdGl2ZSA9ICEwO1xyXG4gICAgICAgICAgICBpLnRvdWNoQmxvY2tlci5ibG9ja0FsbCgpO1xyXG4gICAgICAgICAgICB2YXIgbyA9IHQ7XHJcbiAgICAgICAgICAgIHZhciBuID0gby53aWR0aCArIDEwO1xyXG4gICAgICAgICAgICB2YXIgcyA9IG8uaGVpZ2h0ICsgMTA7XHJcbiAgICAgICAgICAgIGkudG91Y2hCbG9ja2VyLnRhcmdldCA9IHQ7XHJcbiAgICAgICAgICAgIHZhciBsID0gaS5ub2RlLmNvbnZlcnRUb05vZGVTcGFjZUFSKHQuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLlZlYzMuWkVSTykuY2xvbmUoKSk7XHJcbiAgICAgICAgICAgIGkuaG9sbG93T3V0Lm5vZGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICAgICAgdC5hY3RpdmUgPSAhMTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBjID0gaS5ob2xsb3dPdXQubm9kZS5jaGlsZHJlblsyXTtcclxuICAgICAgICAgICAgYy5hY3RpdmUgPSAhMDtcclxuICAgICAgICAgICAgYy5wb3NpdGlvbiA9IGwuYWRkKGNjLnYzKDAsIG8uaGVpZ2h0KSk7XHJcbiAgICAgICAgICAgIGMuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBlO1xyXG4gICAgICAgICAgICBuZXcgUHJvbWlzZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gX19hd2FpdGVyKGksIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodC5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCwgdGhpcy5ob2xsb3dPdXQucmVjdFRvKDAuMywgY2MudjIobCksIG4sIHMsIDUsIDUpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGkudG91Y2hCbG9ja2VyLnNldFRhcmdldChvKTtcclxuICAgICAgICB9LCAwLjEpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0b3BHdWlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmhvbGxvd091dC5ub2RlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgdC5hY3RpdmUgPSAhMTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAoY2MuaXNWYWxpZCh0aGlzLmFycm93VGFyZ2V0KSkge1xyXG4gICAgICAgICAgICB0aGlzLmFycm93VGFyZ2V0LnBvc2l0aW9uID0gdGhpcy5hcnJvd1RhcmdldFBhcmVudC5jb252ZXJ0VG9Ob2RlU3BhY2VBUihcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyb3dUYXJnZXQuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLlZlYzMuWkVSTykuY2xvbmUoKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0aGlzLmFycm93VGFyZ2V0LnBhcmVudCA9IHRoaXMuYXJyb3dUYXJnZXRQYXJlbnQ7XHJcbiAgICAgICAgICAgIHRoaXMuYXJyb3dUYXJnZXQgPSBudWxsO1xyXG4gICAgICAgICAgICB0aGlzLmFycm93VGFyZ2V0UGFyZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ob2xsb3dPdXQuc2V0Tm9kZVNpemUoKTtcclxuICAgICAgICB0aGlzLmhvbGxvd091dC5ub2RlLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgIHRoaXMudG91Y2hCbG9ja2VyLnRhcmdldCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50b3VjaEJsb2NrZXIucGFzc0FsbCgpO1xyXG4gICAgfTtcclxuICAgIGUuc2V0R3VpZGVTdGVwID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBpZiAoISh0IDwgaS5jdXJyZW50U3RlcCkpIHtcclxuICAgICAgICAgICAgaS5jdXJyZW50U3RlcCA9IHQ7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUuaXNFbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFN0ZXAgPj0gMTI7XHJcbiAgICB9O1xyXG4gICAgZS5jdXJyZW50U3RlcCA9IDE7XHJcbiAgICBlLnNlbGYgPSBudWxsO1xyXG4gICAgX19kZWNvcmF0ZShbcCgkaG9sbG93T3V0LmRlZmF1bHQpXSwgZS5wcm90b3R5cGUsIFwiaG9sbG93T3V0XCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtwKCR0b3VjaEJsb2NrZXIuZGVmYXVsdCldLCBlLnByb3RvdHlwZSwgXCJ0b3VjaEJsb2NrZXJcIiwgdm9pZCAwKTtcclxuICAgIHJldHVybiAoaSA9IF9fZGVjb3JhdGUoW2RdLCBlKSk7XHJcbn0pKGNjLkNvbXBvbmVudCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGY7XHJcbiJdfQ==