
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/EquipmentItem.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '56dd7boZflL1b6hbmFBnqWs', 'EquipmentItem');
// game_script/scripts/EquipmentItem.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $popupManager = require("./PopupManager");

var $remoteAudio = require("./RemoteAudio");

var $configContext = require("./ConfigContext");

var $equipmentContext = require("./EquipmentContext");

var $localEventName = require("./LocalEventName");

var $gameGemInfo = require("./GameGemInfo");

var $startView = require("./StartView");

var g = cc._decorator;
var _ = g.ccclass;
var k = g.property;

var v = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.equipmentGem = null;
    e.equipmentIcon = null;
    e.equipmentLevel = null;
    e.equipmentDot = null;
    e.equipmentAnims = null;
    return e;
  }

  __extends(e, t);

  e.prototype.start = function () {
    this.render();
    $eventManager["default"].on($localEventName["default"].RENDER_GEM, this.render, this);
    $eventManager["default"].on($localEventName["default"].RENDER_DOT, this.renderDot, this);
    $eventManager["default"].on($localEventName["default"].EQUIP_UPGRADE, this.upgradeAnim, this);

    for (var t = 0; t < 6; t++) {
      this.equipmentGem.children[t].on(cc.Node.EventType.TOUCH_END, this.touchItem, this);
    }
  };

  e.prototype.onDestroy = function () {
    $eventManager["default"].off($localEventName["default"].RENDER_GEM, this.render, this);
    $eventManager["default"].off($localEventName["default"].RENDER_DOT, this.renderDot, this);
    $eventManager["default"].off($localEventName["default"].EQUIP_UPGRADE, this.upgradeAnim, this);

    for (var t = 0; t < 6; t++) {
      if (cc.isValid(this.equipmentGem)) {
        this.equipmentGem.children[t].off(cc.Node.EventType.TOUCH_END, this.touchItem, this);
      }
    }
  };

  e.prototype.upgradeAnim = function (t) {
    var e = function e(_e) {
      var o = i.equipmentAnims.children[t[_e] - 1];
      var n = o.getComponent(dragonBones.ArmatureDisplay);
      o.active = !0;
      n.playAnimation("stand", 1);
      n.once(dragonBones.EventObject.COMPLETE, function () {
        o.active = !1;
      }, i);
    };

    var i = this;

    for (var o = 0; o < t.length; o++) {
      e(o);
    }
  };

  e.prototype.touchItem = function (t) {
    $remoteAudio["default"].instance.playEffectMusic("Click");
    var e = this.equipmentGem.children.indexOf(t.target);
    $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.EquipmentInfoView, {
      part: e + 1
    });
  };

  e.prototype.renderDot = function (t) {
    if (t === $startView.MenuType.Role) {
      for (var e = 0; e < 6; e++) {
        this.equipmentDot.children[e].active = $equipmentContext["default"].Ins.checkPartEquipUpgrade(e + 1);
      }
    }
  };

  e.prototype.render = function () {
    var t = this;

    var e = function e(_e2) {
      var o = $equipmentContext["default"].Ins.getGrade(_e2);

      var n = i.equipmentIcon.children[_e2 - 1].getComponent(cc.Sprite);

      $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public, ["/textures/gem/e_" + _e2 + "_" + o, "/textures/gem/k" + o], cc.SpriteFrame, null, function (e, i) {
        if (i[0] && cc.isValid(n)) {
          n.spriteFrame = $resUtil.ResUtil.assignWith(i[1], t.node);
          n.node.children[0].getComponent(cc.Sprite).spriteFrame = $resUtil.ResUtil.assignWith(i[0], t.node);
        }
      });
      var s = $equipmentContext["default"].Ins.equipmentMap.get(_e2);
      i.equipmentLevel.children[_e2 - 1].getComponent(cc.Label).string = "等级:" + s;

      for (var c = $equipmentContext["default"].Ins.getGemList(_e2), u = function u(t) {
        var o = i.equipmentGem.children[_e2 - 1].children[0].children[t];

        if (c[t] && 0 !== c[t]) {
          o.active = !0;
          var n = $configContext["default"].instance.gemConfigs.find(function (e) {
            return e.id === c[t];
          });
          o.color = $gameGemInfo.GameGemInfo.gemColor[n.Grade - 1];
        } else {
          o.active = !1;
        }
      }, d = 0; d < 5; d++) {
        u(d);
      }
    };

    var i = this;

    for (var o = 1; o <= 6; o++) {
      e(o);
    }
  };

  __decorate([k(cc.Node)], e.prototype, "equipmentGem", void 0);

  __decorate([k(cc.Node)], e.prototype, "equipmentIcon", void 0);

  __decorate([k(cc.Node)], e.prototype, "equipmentLevel", void 0);

  __decorate([k(cc.Node)], e.prototype, "equipmentDot", void 0);

  __decorate([k(cc.Node)], e.prototype, "equipmentAnims", void 0);

  return __decorate([_], e);
}(cc.Component);

exports["default"] = v;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEVxdWlwbWVudEl0ZW0uanMiXSwibmFtZXMiOlsibyIsIiRhc3NldHNMb2FkZXIiLCJyZXF1aXJlIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGV2ZW50TWFuYWdlciIsIiRwb3B1cE1hbmFnZXIiLCIkcmVtb3RlQXVkaW8iLCIkY29uZmlnQ29udGV4dCIsIiRlcXVpcG1lbnRDb250ZXh0IiwiJGxvY2FsRXZlbnROYW1lIiwiJGdhbWVHZW1JbmZvIiwiJHN0YXJ0VmlldyIsImciLCJjYyIsIl9kZWNvcmF0b3IiLCJfIiwiY2NjbGFzcyIsImsiLCJwcm9wZXJ0eSIsInYiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiZXF1aXBtZW50R2VtIiwiZXF1aXBtZW50SWNvbiIsImVxdWlwbWVudExldmVsIiwiZXF1aXBtZW50RG90IiwiZXF1aXBtZW50QW5pbXMiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJzdGFydCIsInJlbmRlciIsIm9uIiwiUkVOREVSX0dFTSIsIlJFTkRFUl9ET1QiLCJyZW5kZXJEb3QiLCJFUVVJUF9VUEdSQURFIiwidXBncmFkZUFuaW0iLCJjaGlsZHJlbiIsIk5vZGUiLCJFdmVudFR5cGUiLCJUT1VDSF9FTkQiLCJ0b3VjaEl0ZW0iLCJvbkRlc3Ryb3kiLCJvZmYiLCJpc1ZhbGlkIiwiaSIsIm4iLCJnZXRDb21wb25lbnQiLCJkcmFnb25Cb25lcyIsIkFybWF0dXJlRGlzcGxheSIsImFjdGl2ZSIsInBsYXlBbmltYXRpb24iLCJvbmNlIiwiRXZlbnRPYmplY3QiLCJDT01QTEVURSIsImxlbmd0aCIsImluc3RhbmNlIiwicGxheUVmZmVjdE11c2ljIiwiaW5kZXhPZiIsInRhcmdldCIsIlBvcHVwTWFuYWdlciIsIm9wZW4iLCJBc3NldHNNYXAiLCJQb3BVcEJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkVxdWlwbWVudEluZm9WaWV3IiwicGFydCIsIk1lbnVUeXBlIiwiUm9sZSIsIklucyIsImNoZWNrUGFydEVxdWlwVXBncmFkZSIsImdldEdyYWRlIiwiU3ByaXRlIiwibG9hZFJlcyIsIkJ1bmRsZU5hbWVzIiwiUHVibGljIiwiU3ByaXRlRnJhbWUiLCJzcHJpdGVGcmFtZSIsIlJlc1V0aWwiLCJhc3NpZ25XaXRoIiwibm9kZSIsInMiLCJlcXVpcG1lbnRNYXAiLCJnZXQiLCJMYWJlbCIsInN0cmluZyIsImMiLCJnZXRHZW1MaXN0IiwidSIsImdlbUNvbmZpZ3MiLCJmaW5kIiwiaWQiLCJjb2xvciIsIkdhbWVHZW1JbmZvIiwiZ2VtQ29sb3IiLCJHcmFkZSIsImQiLCJfX2RlY29yYXRlIiwiQ29tcG9uZW50IiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlDLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUUsUUFBUSxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJRyxhQUFhLEdBQUdILE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJSSxhQUFhLEdBQUdKLE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJSyxZQUFZLEdBQUdMLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlNLGNBQWMsR0FBR04sT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlPLGlCQUFpQixHQUFHUCxPQUFPLENBQUMsb0JBQUQsQ0FBL0I7O0FBQ0EsSUFBSVEsZUFBZSxHQUFHUixPQUFPLENBQUMsa0JBQUQsQ0FBN0I7O0FBQ0EsSUFBSVMsWUFBWSxHQUFHVCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJVSxVQUFVLEdBQUdWLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlXLENBQUMsR0FBR0MsRUFBRSxDQUFDQyxVQUFYO0FB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QUFlbkIsQ0FBQyxDQUFDUyxTQUFqQixFQUE0QixlQUE1QixFQUE2QyxLQUFLLENBQWxELENBQVY7O0VBQ0FzRSxVQUFVLENBQUMsQ0FBQ25GLENBQUMsQ0FBQ0osRUFBRSxDQUFDMkIsSUFBSixDQUFGLENBQUQsRUFBZW5CLENBQUMsQ0FBQ1MsU0FBakIsRUFBNEIsZ0JBQTVCLEVBQThDLEtBQUssQ0FBbkQsQ0FBVjs7RUFDQXNFLFVBQVUsQ0FBQyxDQUFDbkYsQ0FBQyxDQUFDSixFQUFFLENBQUMyQixJQUFKLENBQUYsQ0FBRCxFQUFlbkIsQ0FBQyxDQUFDUyxTQUFqQixFQUE0QixjQUE1QixFQUE0QyxLQUFLLENBQWpELENBQVY7O0VBQ0FzRSxVQUFVLENBQUMsQ0FBQ25GLENBQUMsQ0FBQ0osRUFBRSxDQUFDMkIsSUFBSixDQUFGLENBQUQsRUFBZW5CLENBQUMsQ0FBQ1MsU0FBakIsRUFBNEIsZ0JBQTVCLEVBQThDLEtBQUssQ0FBbkQsQ0FBVjs7RUFDQSxPQUFPc0UsVUFBVSxDQUFDLENBQUNyRixDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBdkhPLENBdUhMUixFQUFFLENBQUN3RixTQXZIRSxDQUFSOztBQXdIQUMsT0FBTyxXQUFQLEdBQWtCbkYsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkZXZlbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vRXZlbnRNYW5hZ2VyXCIpO1xyXG52YXIgJHBvcHVwTWFuYWdlciA9IHJlcXVpcmUoXCIuL1BvcHVwTWFuYWdlclwiKTtcclxudmFyICRyZW1vdGVBdWRpbyA9IHJlcXVpcmUoXCIuL1JlbW90ZUF1ZGlvXCIpO1xyXG52YXIgJGNvbmZpZ0NvbnRleHQgPSByZXF1aXJlKFwiLi9Db25maWdDb250ZXh0XCIpO1xyXG52YXIgJGVxdWlwbWVudENvbnRleHQgPSByZXF1aXJlKFwiLi9FcXVpcG1lbnRDb250ZXh0XCIpO1xyXG52YXIgJGxvY2FsRXZlbnROYW1lID0gcmVxdWlyZShcIi4vTG9jYWxFdmVudE5hbWVcIik7XHJcbnZhciAkZ2FtZUdlbUluZm8gPSByZXF1aXJlKFwiLi9HYW1lR2VtSW5mb1wiKTtcclxudmFyICRzdGFydFZpZXcgPSByZXF1aXJlKFwiLi9TdGFydFZpZXdcIik7XHJcbnZhciBnID0gY2MuX2RlY29yYXRvcjtcclxudmFyIF8gPSBnLmNjY2xhc3M7XHJcbnZhciBrID0gZy5wcm9wZXJ0eTtcclxudmFyIHYgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5lcXVpcG1lbnRHZW0gPSBudWxsO1xyXG4gICAgICAgIGUuZXF1aXBtZW50SWNvbiA9IG51bGw7XHJcbiAgICAgICAgZS5lcXVpcG1lbnRMZXZlbCA9IG51bGw7XHJcbiAgICAgICAgZS5lcXVpcG1lbnREb3QgPSBudWxsO1xyXG4gICAgICAgIGUuZXF1aXBtZW50QW5pbXMgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQub24oJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuUkVOREVSX0dFTSwgdGhpcy5yZW5kZXIsIHRoaXMpO1xyXG4gICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5vbigkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfRE9ULCB0aGlzLnJlbmRlckRvdCwgdGhpcyk7XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0Lm9uKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LkVRVUlQX1VQR1JBREUsIHRoaXMudXBncmFkZUFuaW0sIHRoaXMpO1xyXG4gICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgNjsgdCsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXF1aXBtZW50R2VtLmNoaWxkcmVuW3RdLm9uKGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX0VORCwgdGhpcy50b3VjaEl0ZW0sIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0Lm9mZigkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfR0VNLCB0aGlzLnJlbmRlciwgdGhpcyk7XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0Lm9mZigkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfRE9ULCB0aGlzLnJlbmRlckRvdCwgdGhpcyk7XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0Lm9mZigkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5FUVVJUF9VUEdSQURFLCB0aGlzLnVwZ3JhZGVBbmltLCB0aGlzKTtcclxuICAgICAgICBmb3IgKHZhciB0ID0gMDsgdCA8IDY7IHQrKykge1xyXG4gICAgICAgICAgICBpZiAoY2MuaXNWYWxpZCh0aGlzLmVxdWlwbWVudEdlbSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXF1aXBtZW50R2VtLmNoaWxkcmVuW3RdLm9mZihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQsIHRoaXMudG91Y2hJdGVtLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS51cGdyYWRlQW5pbSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB2YXIgbyA9IGkuZXF1aXBtZW50QW5pbXMuY2hpbGRyZW5bdFtlXSAtIDFdO1xyXG4gICAgICAgICAgICB2YXIgbiA9IG8uZ2V0Q29tcG9uZW50KGRyYWdvbkJvbmVzLkFybWF0dXJlRGlzcGxheSk7XHJcbiAgICAgICAgICAgIG8uYWN0aXZlID0gITA7XHJcbiAgICAgICAgICAgIG4ucGxheUFuaW1hdGlvbihcInN0YW5kXCIsIDEpO1xyXG4gICAgICAgICAgICBuLm9uY2UoXHJcbiAgICAgICAgICAgICAgICBkcmFnb25Cb25lcy5FdmVudE9iamVjdC5DT01QTEVURSxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBvLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGlcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBpID0gdGhpcztcclxuICAgICAgICBmb3IgKHZhciBvID0gMDsgbyA8IHQubGVuZ3RoOyBvKyspIHtcclxuICAgICAgICAgICAgZShvKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUudG91Y2hJdGVtID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAkcmVtb3RlQXVkaW8uZGVmYXVsdC5pbnN0YW5jZS5wbGF5RWZmZWN0TXVzaWMoXCJDbGlja1wiKTtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuZXF1aXBtZW50R2VtLmNoaWxkcmVuLmluZGV4T2YodC50YXJnZXQpO1xyXG4gICAgICAgICRwb3B1cE1hbmFnZXIuUG9wdXBNYW5hZ2VyLmluc3RhbmNlLm9wZW4oXHJcbiAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLlBvcFVwQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuRXF1aXBtZW50SW5mb1ZpZXcsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBhcnQ6IGUgKyAxXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbmRlckRvdCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgaWYgKHQgPT09ICRzdGFydFZpZXcuTWVudVR5cGUuUm9sZSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IDY7IGUrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lcXVpcG1lbnREb3QuY2hpbGRyZW5bZV0uYWN0aXZlID0gJGVxdWlwbWVudENvbnRleHQuZGVmYXVsdC5JbnMuY2hlY2tQYXJ0RXF1aXBVcGdyYWRlKGUgKyAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgIHZhciBlID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgdmFyIG8gPSAkZXF1aXBtZW50Q29udGV4dC5kZWZhdWx0Lklucy5nZXRHcmFkZShlKTtcclxuICAgICAgICAgICAgdmFyIG4gPSBpLmVxdWlwbWVudEljb24uY2hpbGRyZW5bZSAtIDFdLmdldENvbXBvbmVudChjYy5TcHJpdGUpO1xyXG4gICAgICAgICAgICAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UubG9hZFJlcyhcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuUHVibGljLFxyXG4gICAgICAgICAgICAgICAgW1wiL3RleHR1cmVzL2dlbS9lX1wiICsgZSArIFwiX1wiICsgbywgXCIvdGV4dHVyZXMvZ2VtL2tcIiArIG9dLFxyXG4gICAgICAgICAgICAgICAgY2MuU3ByaXRlRnJhbWUsXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGUsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaVswXSAmJiBjYy5pc1ZhbGlkKG4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4uc3ByaXRlRnJhbWUgPSAkcmVzVXRpbC5SZXNVdGlsLmFzc2lnbldpdGgoaVsxXSwgdC5ub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbi5ub2RlLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaVswXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubm9kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdmFyIHMgPSAkZXF1aXBtZW50Q29udGV4dC5kZWZhdWx0Lklucy5lcXVpcG1lbnRNYXAuZ2V0KGUpO1xyXG4gICAgICAgICAgICBpLmVxdWlwbWVudExldmVsLmNoaWxkcmVuW2UgLSAxXS5nZXRDb21wb25lbnQoY2MuTGFiZWwpLnN0cmluZyA9IFwi562J57qnOlwiICsgcztcclxuICAgICAgICAgICAgZm9yIChcclxuICAgICAgICAgICAgICAgIHZhciBjID0gJGVxdWlwbWVudENvbnRleHQuZGVmYXVsdC5JbnMuZ2V0R2VtTGlzdChlKSxcclxuICAgICAgICAgICAgICAgICAgICB1ID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBpLmVxdWlwbWVudEdlbS5jaGlsZHJlbltlIC0gMV0uY2hpbGRyZW5bMF0uY2hpbGRyZW5bdF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjW3RdICYmIDAgIT09IGNbdF0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uYWN0aXZlID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuZ2VtQ29uZmlncy5maW5kKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuaWQgPT09IGNbdF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uY29sb3IgPSAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uZ2VtQ29sb3Jbbi5HcmFkZSAtIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5hY3RpdmUgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZCA9IDA7XHJcbiAgICAgICAgICAgICAgICBkIDwgNTtcclxuICAgICAgICAgICAgICAgIGQrK1xyXG4gICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICB1KGQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGkgPSB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIG8gPSAxOyBvIDw9IDY7IG8rKykge1xyXG4gICAgICAgICAgICBlKG8pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwiZXF1aXBtZW50R2VtXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwiZXF1aXBtZW50SWNvblwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImVxdWlwbWVudExldmVsXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwiZXF1aXBtZW50RG90XCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwiZXF1aXBtZW50QW5pbXNcIiwgdm9pZCAwKTtcclxuICAgIHJldHVybiBfX2RlY29yYXRlKFtfXSwgZSk7XHJcbn0pKGNjLkNvbXBvbmVudCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHY7XHJcbiJdfQ==