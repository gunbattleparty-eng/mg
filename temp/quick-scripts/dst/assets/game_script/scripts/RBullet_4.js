
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/RBullet_4.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '3ae6bG9SzhDp5o4L0EruSl7', 'RBullet_4');
// game_script/scripts/RBullet_4.js

"use strict";

var o;

var $object = require("./Object");

var $countDownUtil = require("./CountDownUtil");

var $util = require("./Util");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var f = cc._decorator;
var h = f.ccclass;
var m = (f.property, new cc.Vec3());

var y = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.r_bullet_4;
    e.timeLeft = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e) {
    this.speed = $gameContext["default"].ins.skillInfo.robotParam[3];
    t.prototype.initButtle.call(this, e, null);
    this.atk = Math.ceil($gameContext["default"].ins.skillInfo.robotParam[0] * this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL]);
    this.timeLeft = $gameContext["default"].ins.skillInfo.robotParam[5];
    this.isUse = !1;

    if (e) {
      this.velocity.set(e).multiplyScalar(this.speed);
    }
  };

  e.prototype.updateFrame = function (t) {
    if (!(this.timeLeft <= 0)) {
      this.timeLeft -= t;

      if (this.timeLeft <= 0) {
        this.timeLeft = 0;
        return this.removeSelf();
      }

      this.move(t);
    }
  };

  e.prototype.move = function (t) {
    var e = this.getPosition();
    var i = this.velocity;
    var o = !1;
    m.x = e.x + i.x * t;
    m.y = e.y + i.y * t;
    m.z = e.z + i.z * t;

    if (m.x < -310 || m.x > 310) {
      m.x = e.x;
      this.velocity.x = -this.velocity.x;
      var n = $util["default"].dirConverAngle(this.velocity);
      this.setAngle(n);
      o = !0;
    }

    if (m.y < -300 || m.y > cc.winSize.height / 2 - 50) {
      m.y = e.y;
      this.velocity.y = -this.velocity.y;
      n = $util["default"].dirConverAngle(this.velocity);
      this.setAngle(n);
      o = !0;
    }

    if (o) {
      var s = $gameContext["default"].ins.getRandomEnemy();

      if (s) {
        this.velocity = s.getPosition().sub(this.getPosition()).normalize();
        this.velocity.multiplyScalar(this.speed);
        n = $util["default"].dirConverAngle(this.velocity);
        this.setAngle(n);
      }
    }

    this.setPosition(m);
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse) {
      var i = t.object;

      if (e == $object.Trigger.enter) {
        i.sufferAtk({
          skillSpecialitys: [],
          atk: this.atk
        });
        var o = {
          id: -1,
          type: $enemyStatus.EnemyDebuffType.FREEZE,
          timeLeft: $gameContext["default"].ins.skillInfo.robotParam[4],
          value: -1
        };
        i.sufferDebuff(o);
      } else {
        if (e === $object.Trigger.stay) {
          if ($countDownUtil.CountDownUtil.time - i.getLastAtkTime(5) <= $gameContext["default"].ins.skillInfo.robotParam[6] / $gameContext["default"].ins.gameRatio) {
            return;
          }

          i.setLastAtkTime(5, $countDownUtil.CountDownUtil.time);
          i.sufferAtk({
            skillSpecialitys: [],
            atk: this.atk
          });
        }
      }
    }
  };

  e.prototype.lerpAngleRes = function (t) {
    var e = 180 * cc.v2(0, 1).signAngle(cc.v2(t)) / Math.PI;
    e = e < 0 ? 360 + e : e;
    var i = this.node.angle < 0 ? 360 + this.node.angle : this.node.angle;
    i %= 360;

    if (Math.abs(i - e) <= 10) {
      return e;
    }

    var o = i - e;
    o = o < 0 ? 360 + o : o;
    var n = e - i;
    n = n < 0 ? 360 + n : n;
    var s = cc.misc.lerp(0, Math.abs(e - i), 0.1);
    o < n ? i -= s : i += s;
    return i;
  };

  return __decorate([h], e);
}($baseBullet["default"]);

exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFJCdWxsZXRfNC5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkY291bnREb3duVXRpbCIsIiR1dGlsIiwiJGdhbWVDb250ZXh0IiwiJGdhbWVTa2lsbEluZm8iLCIkZW5lbXlTdGF0dXMiLCIkYmFzZUJ1bGxldCIsImYiLCJjYyIsIl9kZWNvcmF0b3IiLCJoIiwiY2NjbGFzcyIsIm0iLCJwcm9wZXJ0eSIsIlZlYzMiLCJ5IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsImJ1dHRsZVR5cGUiLCJCdWxsZXRUeXBlIiwicl9idWxsZXRfNCIsInRpbWVMZWZ0IiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEJ1dHRsZSIsInNwZWVkIiwiaW5zIiwic2tpbGxJbmZvIiwicm9ib3RQYXJhbSIsImNhbGwiLCJhdGsiLCJNYXRoIiwiY2VpbCIsInNraWxsUGFyYW0iLCJza2lsbEF0ayIsIlNraWxsNFBhcmFtIiwiRklOQUwiLCJpc1VzZSIsInZlbG9jaXR5Iiwic2V0IiwibXVsdGlwbHlTY2FsYXIiLCJ1cGRhdGVGcmFtZSIsInJlbW92ZVNlbGYiLCJtb3ZlIiwiZ2V0UG9zaXRpb24iLCJpIiwieCIsInoiLCJuIiwiZGlyQ29udmVyQW5nbGUiLCJzZXRBbmdsZSIsIndpblNpemUiLCJoZWlnaHQiLCJzIiwiZ2V0UmFuZG9tRW5lbXkiLCJzdWIiLCJub3JtYWxpemUiLCJzZXRQb3NpdGlvbiIsIm9uVHJpZ2dlciIsIm9iamVjdCIsIlRyaWdnZXIiLCJlbnRlciIsInN1ZmZlckF0ayIsInNraWxsU3BlY2lhbGl0eXMiLCJpZCIsInR5cGUiLCJFbmVteURlYnVmZlR5cGUiLCJGUkVFWkUiLCJ2YWx1ZSIsInN1ZmZlckRlYnVmZiIsInN0YXkiLCJDb3VudERvd25VdGlsIiwidGltZSIsImdldExhc3RBdGtUaW1lIiwiZ2FtZVJhdGlvIiwic2V0TGFzdEF0a1RpbWUiLCJsZXJwQW5nbGVSZXMiLCJ2MiIsInNpZ25BbmdsZSIsIlBJIiwibm9kZSIsImFuZ2xlIiwiYWJzIiwibWlzYyIsImxlcnAiLCJfX2RlY29yYXRlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0EsSUFBSUMsY0FBYyxHQUFHRCxPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSUUsS0FBSyxHQUFHRixPQUFPLENBQUMsUUFBRCxDQUFuQjs7QUFDQSxJQUFJRyxZQUFZLEdBQUdILE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlJLGNBQWMsR0FBR0osT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlLLFlBQVksR0FBR0wsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSU0sV0FBVyxHQUFHTixPQUFPLENBQUMsY0FBRCxDQUF6Qjs7QUFDQSxJQUFJTyxDQUFDLEdBQUdDLEVBQUUsQ0FBQ0MsVUFBWDtBQUNBLElBQUlDLENBQUMsR0FBR0gsQ0FBQyxDQUFDSSxPQUFWO0FBQ0EsSUFBSUMsQ0FBQyxJQUFJTCxDQUFDLENBQUNNLFFBQUYsRUFBWSxJQUFJTCxFQUFFLENBQUNNLElBQVAsRUFBaEIsQ0FBTDs7QUFDQSxJQUFJQyxDQUFDLEdBQUksVUFBVUMsQ0FBVixFQUFhO0VBQ2xCLFNBQVNDLENBQVQsR0FBYTtJQUNULElBQUlBLENBQUMsR0FBSSxTQUFTRCxDQUFULElBQWNBLENBQUMsQ0FBQ0UsS0FBRixDQUFRLElBQVIsRUFBY0MsU0FBZCxDQUFmLElBQTRDLElBQXBEO0lBQ0FGLENBQUMsQ0FBQ0csVUFBRixHQUFlZCxXQUFXLENBQUNlLFVBQVosQ0FBdUJDLFVBQXRDO0lBQ0FMLENBQUMsQ0FBQ00sUUFBRixHQUFhLENBQWI7SUFDQSxPQUFPTixDQUFQO0VBQ0g7O0VBQ0RPLFNBQVMsQ0FBQ1AsQ0FBRCxFQUFJRCxDQUFKLENBQVQ7O0VB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InNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkb2JqZWN0ID0gcmVxdWlyZShcIi4vT2JqZWN0XCIpO1xyXG52YXIgJGNvdW50RG93blV0aWwgPSByZXF1aXJlKFwiLi9Db3VudERvd25VdGlsXCIpO1xyXG52YXIgJHV0aWwgPSByZXF1aXJlKFwiLi9VdGlsXCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZ2FtZVNraWxsSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVTa2lsbEluZm9cIik7XHJcbnZhciAkZW5lbXlTdGF0dXMgPSByZXF1aXJlKFwiLi9FbmVteVN0YXR1c1wiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyIGYgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgaCA9IGYuY2NjbGFzcztcclxudmFyIG0gPSAoZi5wcm9wZXJ0eSwgbmV3IGNjLlZlYzMoKSk7XHJcbnZhciB5ID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuYnV0dGxlVHlwZSA9ICRiYXNlQnVsbGV0LkJ1bGxldFR5cGUucl9idWxsZXRfNDtcclxuICAgICAgICBlLnRpbWVMZWZ0ID0gMDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHRoaXMuc3BlZWQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnJvYm90UGFyYW1bM107XHJcbiAgICAgICAgdC5wcm90b3R5cGUuaW5pdEJ1dHRsZS5jYWxsKHRoaXMsIGUsIG51bGwpO1xyXG4gICAgICAgIHRoaXMuYXRrID0gTWF0aC5jZWlsKFxyXG4gICAgICAgICAgICAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnJvYm90UGFyYW1bMF0gKlxyXG4gICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy50aW1lTGVmdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8ucm9ib3RQYXJhbVs1XTtcclxuICAgICAgICB0aGlzLmlzVXNlID0gITE7XHJcbiAgICAgICAgaWYgKGUpIHtcclxuICAgICAgICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoZSkubXVsdGlwbHlTY2FsYXIodGhpcy5zcGVlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnVwZGF0ZUZyYW1lID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBpZiAoISh0aGlzLnRpbWVMZWZ0IDw9IDApKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgLT0gdDtcclxuICAgICAgICAgICAgaWYgKHRoaXMudGltZUxlZnQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCA9IDA7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tb3ZlKHQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0UG9zaXRpb24oKTtcclxuICAgICAgICB2YXIgaSA9IHRoaXMudmVsb2NpdHk7XHJcbiAgICAgICAgdmFyIG8gPSAhMTtcclxuICAgICAgICBtLnggPSBlLnggKyBpLnggKiB0O1xyXG4gICAgICAgIG0ueSA9IGUueSArIGkueSAqIHQ7XHJcbiAgICAgICAgbS56ID0gZS56ICsgaS56ICogdDtcclxuICAgICAgICBpZiAobS54IDwgLTMxMCB8fCBtLnggPiAzMTApIHtcclxuICAgICAgICAgICAgbS54ID0gZS54O1xyXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnggPSAtdGhpcy52ZWxvY2l0eS54O1xyXG4gICAgICAgICAgICB2YXIgbiA9ICR1dGlsLmRlZmF1bHQuZGlyQ29udmVyQW5nbGUodGhpcy52ZWxvY2l0eSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QW5nbGUobik7XHJcbiAgICAgICAgICAgIG8gPSAhMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG0ueSA8IC0zMDAgfHwgbS55ID4gY2Mud2luU2l6ZS5oZWlnaHQgLyAyIC0gNTApIHtcclxuICAgICAgICAgICAgbS55ID0gZS55O1xyXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnkgPSAtdGhpcy52ZWxvY2l0eS55O1xyXG4gICAgICAgICAgICBuID0gJHV0aWwuZGVmYXVsdC5kaXJDb252ZXJBbmdsZSh0aGlzLnZlbG9jaXR5KTtcclxuICAgICAgICAgICAgdGhpcy5zZXRBbmdsZShuKTtcclxuICAgICAgICAgICAgbyA9ICEwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobykge1xyXG4gICAgICAgICAgICB2YXIgcyA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSYW5kb21FbmVteSgpO1xyXG4gICAgICAgICAgICBpZiAocykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IHMuZ2V0UG9zaXRpb24oKS5zdWIodGhpcy5nZXRQb3NpdGlvbigpKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudmVsb2NpdHkubXVsdGlwbHlTY2FsYXIodGhpcy5zcGVlZCk7XHJcbiAgICAgICAgICAgICAgICBuID0gJHV0aWwuZGVmYXVsdC5kaXJDb252ZXJBbmdsZSh0aGlzLnZlbG9jaXR5KTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0QW5nbGUobik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbihtKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vblRyaWdnZXIgPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc1VzZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgICAgICBpZiAoZSA9PSAkb2JqZWN0LlRyaWdnZXIuZW50ZXIpIHtcclxuICAgICAgICAgICAgICAgIGkuc3VmZmVyQXRrKHtcclxuICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBhdGs6IHRoaXMuYXRrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHZhciBvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiAtMSxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkZSRUVaRSxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5yb2JvdFBhcmFtWzRdLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAtMVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGkuc3VmZmVyRGVidWZmKG8pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT09ICRvYmplY3QuVHJpZ2dlci5zdGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY291bnREb3duVXRpbC5Db3VudERvd25VdGlsLnRpbWUgLSBpLmdldExhc3RBdGtUaW1lKDUpIDw9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8ucm9ib3RQYXJhbVs2XSAvICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nYW1lUmF0aW9cclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpLnNldExhc3RBdGtUaW1lKDUsICRjb3VudERvd25VdGlsLkNvdW50RG93blV0aWwudGltZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXRrOiB0aGlzLmF0a1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmxlcnBBbmdsZVJlcyA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSAoMTgwICogY2MudjIoMCwgMSkuc2lnbkFuZ2xlKGNjLnYyKHQpKSkgLyBNYXRoLlBJO1xyXG4gICAgICAgIGUgPSBlIDwgMCA/IDM2MCArIGUgOiBlO1xyXG4gICAgICAgIHZhciBpID0gdGhpcy5ub2RlLmFuZ2xlIDwgMCA/IDM2MCArIHRoaXMubm9kZS5hbmdsZSA6IHRoaXMubm9kZS5hbmdsZTtcclxuICAgICAgICBpICU9IDM2MDtcclxuICAgICAgICBpZiAoTWF0aC5hYnMoaSAtIGUpIDw9IDEwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbyA9IGkgLSBlO1xyXG4gICAgICAgIG8gPSBvIDwgMCA/IDM2MCArIG8gOiBvO1xyXG4gICAgICAgIHZhciBuID0gZSAtIGk7XHJcbiAgICAgICAgbiA9IG4gPCAwID8gMzYwICsgbiA6IG47XHJcbiAgICAgICAgdmFyIHMgPSBjYy5taXNjLmxlcnAoMCwgTWF0aC5hYnMoZSAtIGkpLCAwLjEpO1xyXG4gICAgICAgIG8gPCBuID8gKGkgLT0gcykgOiAoaSArPSBzKTtcclxuICAgICAgICByZXR1cm4gaTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbaF0sIGUpO1xyXG59KSgkYmFzZUJ1bGxldC5kZWZhdWx0KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0geTtcclxuIl19