{"version":3,"sources":["assets\\game_script\\scripts\\UpgradeView.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$popupView","$remoteAudio","$configContext","$userDataContext","f","cc","_decorator","h","ccclass","m","property","y","t","e","apply","arguments","anim","infoLayer","closeAll","isClose","__extends","prototype","onResetView","instance","playEffectMusic","i","uiParam","param","count","children","getComponent","Label","string","Ins","gradeInfo","grade","n","basicSkillConfigs","s","length","unclok_level","skillmaster_id","active","c","Sprite","loadRes","BundleNames","Public_Res","skillConfigsMap","get","icon","SpriteFrame","isValid","spriteFrame","ResUtil","assignWith","node","playAnimation","once","dragonBones","EventObject","COMPLETE","opacity","tween","to","call","start","addEvent","on","Node","EventType","TOUCH_END","clickClose","removeEvent","off","onClickClose","__decorate","ArmatureDisplay","PopupView","exports"],"mappings":";;;;;;AAAA,IAAIA,CAAJ;;AACA,IAAIC,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIG,UAAU,GAAGH,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAII,YAAY,GAAGJ,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIK,cAAc,GAAGL,OAAO,CAAC,iBAAD,CAA5B;;AACA,IAAIM,gBAAgB,GAAGN,OAAO,CAAC,mBAAD,CAA9B;;AACA,IAAIO,CAAC,GAAGC,EAAE,CAACC,UAAX;AACA,IAAIC,CAAC,GAAGH,CAAC,CAACI,OAAV;AACA,IAAIC,CAAC,GAAGL,CAAC,CAACM,QAAV;;AACA,IAAIC,CAAC,GAAI,UAAUC,CAAV,EAAa;EAClB,SAASC,CAAT,GAAa;IACT,IAAIA,CAAC,GAAI,SAASD,CAAT,IAAcA,CAAC,CAACE,KAAF,CAAQ,IAAR,EAAcC,SAAd,CAAf,IAA4C,IAApD;IACAF,CAAC,CAACG,IAAF,GAAS,IAAT;IACAH,CAAC,CAACI,SAAF,GAAc,IAAd;IACAJ,CAAC,CAACK,QAAF,GAAa,IAAb;IACAL,CAAC,CAACM,OAAF,GAAY,CAAC,CAAb;IACA,OAAON,CAAP;EACH;;EACDO,SAAS,CAACP,CAAD,EAAID,CAAJ,CAAT;;EACAC,CAAC,CAACQ,SAAF,CAAYC,WAAZ,GAA0B,YAAY;IAClC,IAAIV,CAAJ;IACA,IAAIC,CAAC,GAAG,IAAR;IACAZ,YAAY,WAAZ,CAAqBsB,QAArB,CAA8BC,eAA9B,CAA8C,SAA9C;IACA,IAAIC,CAAC,GAAG,UAAUb,CAAC,GAAG,KAAKc,OAAL,CAAaC,KAA3B,KAAqC,KAAK,CAAL,KAAWf,CAAhD,GAAoD,KAAK,CAAzD,GAA6DA,CAAC,CAACgB,KAAvE;;IACA,IAAI,CAACH,CAAL,EAAQ;MACJA,CAAC,GAAG,CAAJ;IACH;;IACD,KAAKR,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2BC,YAA3B,CAAwCzB,EAAE,CAAC0B,KAA3C,EAAkDC,MAAlD,GACI,QAAQ7B,gBAAgB,WAAhB,CAAyB8B,GAAzB,CAA6BC,SAA7B,CAAuCC,KAAvC,GAA+C,CAAvD,CADJ;IAEA,KAAKlB,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2BC,YAA3B,CAAwCzB,EAAE,CAAC0B,KAA3C,EAAkDC,MAAlD,GACI,OAAO7B,gBAAgB,WAAhB,CAAyB8B,GAAzB,CAA6BC,SAA7B,CAAuCC,KADlD;IAEA,KAAKlB,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2BC,YAA3B,CAAwCzB,EAAE,CAAC0B,KAA3C,EAAkDC,MAAlD,GAA2D,QAAQ,MAAMP,CAAzE;IACA,IAAI9B,CAAC,GAAG,CAAC,CAAT;IACA,IAAIyC,CAAC,GAAGlC,cAAc,WAAd,CAAuBqB,QAAvB,CAAgCc,iBAAxC;;IACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,CAAC,CAACG,MAAtB,EAA8BD,CAAC,EAA/B,EAAmC;MAC/B,IAAIF,CAAC,CAACE,CAAD,CAAD,CAAKE,YAAL,KAAsBrC,gBAAgB,WAAhB,CAAyB8B,GAAzB,CAA6BC,SAA7B,CAAuCC,KAAjE,EAAwE;QACpExC,CAAC,GAAGyC,CAAC,CAACE,CAAD,CAAD,CAAKG,cAAT;QACA;MACH;IACJ;;IACD,IAAI,CAAC,CAAD,KAAO9C,CAAX,EAAc;MACV,KAAKsB,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2Ba,MAA3B,GAAoC,CAAC,CAArC;MACA,KAAKzB,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2Ba,MAA3B,GAAoC,CAAC,CAArC;MACA,IAAIC,CAAC,GAAG,KAAK1B,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2BC,YAA3B,CAAwCzB,EAAE,CAACuC,MAA3C,CAAR;MACAhD,aAAa,WAAb,CAAsB2B,QAAtB,CAA+BsB,OAA/B,CACI/C,UAAU,CAACgD,WAAX,CAAuBC,UAD3B,EAEI,CAAC,aAAa7C,cAAc,WAAd,CAAuBqB,QAAvB,CAAgCyB,eAAhC,CAAgDC,GAAhD,CAAoDtD,CAApD,EAAuDuD,IAArE,CAFJ,EAGI7C,EAAE,CAAC8C,WAHP,EAII,IAJJ,EAKI,UAAUvC,CAAV,EAAaa,CAAb,EAAgB;QACZ,IAAI9B,CAAC,GAAG8B,CAAC,CAAC,CAAD,CAAT;;QACA,IAAI9B,CAAC,IAAIU,EAAE,CAAC+C,OAAH,CAAWT,CAAX,CAAT,EAAwB;UACpBA,CAAC,CAACU,WAAF,GAAgBtD,QAAQ,CAACuD,OAAT,CAAiBC,UAAjB,CAA4B5D,CAA5B,EAA+BkB,CAAC,CAAC2C,IAAjC,CAAhB;QACH;MACJ,CAVL;IAYH,CAhBD,MAgBO;MACH,KAAKvC,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2Ba,MAA3B,GAAoC,CAAC,CAArC;MACA,KAAKzB,SAAL,CAAeY,QAAf,CAAwB,CAAxB,EAA2Ba,MAA3B,GAAoC,CAAC,CAArC;IACH;;IACD,KAAK1B,IAAL,CAAUyC,aAAV,CAAwB,KAAxB,EAA+B,CAA/B;IACA,KAAKzC,IAAL,CAAU0C,IAAV,CACIC,WAAW,CAACC,WAAZ,CAAwBC,QAD5B,EAEI,YAAY;MACRhD,CAAC,CAACG,IAAF,CAAOyC,aAAP,CAAqB,OAArB,EAA8B,CAA9B;MACA5C,CAAC,CAACI,SAAF,CAAYyB,MAAZ,GAAqB,CAAC,CAAtB;MACA7B,CAAC,CAACI,SAAF,CAAY6C,OAAZ,GAAsB,CAAtB;MACAzD,EAAE,CAAC0D,KAAH,CAASlD,CAAC,CAACI,SAAX,EACK+C,EADL,CACQ,GADR,EACa;QACLF,OAAO,EAAE;MADJ,CADb,EAIKG,IAJL,CAIU,YAAY;QACdpD,CAAC,CAACM,OAAF,GAAY,CAAC,CAAb;MACH,CANL,EAOK+C,KAPL;IAQH,CAdL,EAeI,IAfJ;EAiBH,CA3DD;;EA4DArD,CAAC,CAACQ,SAAF,CAAY8C,QAAZ,GAAuB,YAAY;IAC/B,KAAKjD,QAAL,CAAckD,EAAd,CAAiB/D,EAAE,CAACgE,IAAH,CAAQC,SAAR,CAAkBC,SAAnC,EAA8C,KAAKC,UAAnD,EAA+D,IAA/D;EACH,CAFD;;EAGA3D,CAAC,CAACQ,SAAF,CAAYoD,WAAZ,GAA0B,YAAY;IAClC,KAAKvD,QAAL,CAAcwD,GAAd,CAAkBrE,EAAE,CAACgE,IAAH,CAAQC,SAAR,CAAkBC,SAApC,EAA+C,KAAKC,UAApD,EAAgE,IAAhE;EACH,CAFD;;EAGA3D,CAAC,CAACQ,SAAF,CAAYmD,UAAZ,GAAyB,YAAY;IACjC,IAAI,KAAKrD,OAAT,EAAkB;MACdP,CAAC,CAACS,SAAF,CAAYsD,YAAZ,CAAyBV,IAAzB,CAA8B,IAA9B;IACH;EACJ,CAJD;;EAKAW,UAAU,CAAC,CAACnE,CAAC,CAACkD,WAAW,CAACkB,eAAb,CAAF,CAAD,EAAmChE,CAAC,CAACQ,SAArC,EAAgD,MAAhD,EAAwD,KAAK,CAA7D,CAAV;;EACAuD,UAAU,CAAC,CAACnE,CAAC,CAACJ,EAAE,CAACgE,IAAJ,CAAF,CAAD,EAAexD,CAAC,CAACQ,SAAjB,EAA4B,WAA5B,EAAyC,KAAK,CAA9C,CAAV;;EACAuD,UAAU,CAAC,CAACnE,CAAC,CAACJ,EAAE,CAACgE,IAAJ,CAAF,CAAD,EAAexD,CAAC,CAACQ,SAAjB,EAA4B,UAA5B,EAAwC,KAAK,CAA7C,CAAV;;EACA,OAAOuD,UAAU,CAAC,CAACrE,CAAD,CAAD,EAAMM,CAAN,CAAjB;AACH,CArFO,CAqFLb,UAAU,CAAC8E,SArFN,CAAR;;AAsFAC,OAAO,WAAP,GAAkBpE,CAAlB","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $popupView = require(\"./PopupView\");\r\nvar $remoteAudio = require(\"./RemoteAudio\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar f = cc._decorator;\r\nvar h = f.ccclass;\r\nvar m = f.property;\r\nvar y = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.anim = null;\r\n        e.infoLayer = null;\r\n        e.closeAll = null;\r\n        e.isClose = !1;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.onResetView = function () {\r\n        var t;\r\n        var e = this;\r\n        $remoteAudio.default.instance.playEffectMusic(\"levelup\");\r\n        var i = null === (t = this.uiParam.param) || void 0 === t ? void 0 : t.count;\r\n        if (!i) {\r\n            i = 1;\r\n        }\r\n        this.infoLayer.children[0].getComponent(cc.Label).string =\r\n            \"等级\" + ($userDataContext.default.Ins.gradeInfo.grade - 1);\r\n        this.infoLayer.children[1].getComponent(cc.Label).string =\r\n            \"等级\" + $userDataContext.default.Ins.gradeInfo.grade;\r\n        this.infoLayer.children[2].getComponent(cc.Label).string = \"奖励：\" + 100 * i;\r\n        var o = -1;\r\n        var n = $configContext.default.instance.basicSkillConfigs;\r\n        for (var s = 0; s < n.length; s++) {\r\n            if (n[s].unclok_level === $userDataContext.default.Ins.gradeInfo.grade) {\r\n                o = n[s].skillmaster_id;\r\n                break;\r\n            }\r\n        }\r\n        if (-1 !== o) {\r\n            this.infoLayer.children[3].active = !0;\r\n            this.infoLayer.children[6].active = !0;\r\n            var c = this.infoLayer.children[6].getComponent(cc.Sprite);\r\n            $assetsLoader.default.instance.loadRes(\r\n                $assetsMap.BundleNames.Public_Res,\r\n                [\"/skills/\" + $configContext.default.instance.skillConfigsMap.get(o).icon],\r\n                cc.SpriteFrame,\r\n                null,\r\n                function (t, i) {\r\n                    var o = i[0];\r\n                    if (o && cc.isValid(c)) {\r\n                        c.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);\r\n                    }\r\n                }\r\n            );\r\n        } else {\r\n            this.infoLayer.children[3].active = !1;\r\n            this.infoLayer.children[6].active = !1;\r\n        }\r\n        this.anim.playAnimation(\"kai\", 1);\r\n        this.anim.once(\r\n            dragonBones.EventObject.COMPLETE,\r\n            function () {\r\n                e.anim.playAnimation(\"stand\", 0);\r\n                e.infoLayer.active = !0;\r\n                e.infoLayer.opacity = 0;\r\n                cc.tween(e.infoLayer)\r\n                    .to(0.3, {\r\n                        opacity: 255\r\n                    })\r\n                    .call(function () {\r\n                        e.isClose = !0;\r\n                    })\r\n                    .start();\r\n            },\r\n            this\r\n        );\r\n    };\r\n    e.prototype.addEvent = function () {\r\n        this.closeAll.on(cc.Node.EventType.TOUCH_END, this.clickClose, this);\r\n    };\r\n    e.prototype.removeEvent = function () {\r\n        this.closeAll.off(cc.Node.EventType.TOUCH_END, this.clickClose, this);\r\n    };\r\n    e.prototype.clickClose = function () {\r\n        if (this.isClose) {\r\n            t.prototype.onClickClose.call(this);\r\n        }\r\n    };\r\n    __decorate([m(dragonBones.ArmatureDisplay)], e.prototype, \"anim\", void 0);\r\n    __decorate([m(cc.Node)], e.prototype, \"infoLayer\", void 0);\r\n    __decorate([m(cc.Node)], e.prototype, \"closeAll\", void 0);\r\n    return __decorate([h], e);\r\n})($popupView.PopupView);\r\nexports.default = y;\r\n"]}