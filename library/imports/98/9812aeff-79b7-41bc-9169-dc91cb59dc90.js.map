{"version":3,"sources":["assets\\game_script\\scripts\\SkillListItem.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$popupManager","$remoteAudio","$configContext","$localEventName","$skillContext","$startView","y","cc","_decorator","g","ccclass","_","property","k","t","e","apply","arguments","icon","resDot","levelLabel","maskNode","basicSkillId","skillId","__extends","prototype","start","node","on","Node","EventType","TOUCH_END","touchSkill","render","i","instance","skillConfigsMap","get","skillmaster_id","id","loadRes","BundleNames","Public_Res","SpriteFrame","n","isValid","spriteFrame","ResUtil","assignWith","Ins","getSKillLevel","active","getComponentInChildren","Label","string","unclok_level","checkSkillUpgrade","playEffectMusic","PopupManager","open","AssetsMap","PopUpBundles","prefabs","assetsList","SkillInfoView","send","RENDER_DOT","MenuType","Skill","__decorate","Sprite","Component","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $remoteAudio = require(\"./RemoteAudio\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $skillContext = require(\"./SkillContext\");\r\nvar $startView = require(\"./StartView\");\r\nvar y = cc._decorator;\r\nvar g = y.ccclass;\r\nvar _ = y.property;\r\nvar k = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.icon = null;\r\n        e.resDot = null;\r\n        e.levelLabel = null;\r\n        e.maskNode = null;\r\n        e.basicSkillId = 0;\r\n        e.skillId = 0;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.start = function () {\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.touchSkill, this);\r\n    };\r\n    e.prototype.render = function (t, e) {\r\n        var i = this;\r\n        var o = $configContext.default.instance.skillConfigsMap.get(t.skillmaster_id);\r\n        if (t.id !== this.basicSkillId) {\r\n            $assetsLoader.default.instance.loadRes(\r\n                $assetsMap.BundleNames.Public_Res,\r\n                [\"/skills/\" + o.icon],\r\n                cc.SpriteFrame,\r\n                null,\r\n                function (t, o) {\r\n                    var n = o[0];\r\n                    if (n && cc.isValid(i.icon)) {\r\n                        i.icon.spriteFrame = $resUtil.ResUtil.assignWith(n, e);\r\n                    }\r\n                }\r\n            );\r\n        }\r\n        this.basicSkillId = t.id;\r\n        this.skillId = o.id;\r\n        var n = $skillContext.default.Ins.getSKillLevel(this.skillId);\r\n        n <= 0\r\n            ? ((this.levelLabel.node.active = !1),\r\n              (this.maskNode.active = !0),\r\n              (this.maskNode.getComponentInChildren(cc.Label).string = \"达到\" + t.unclok_level + \"级解锁\"))\r\n            : ((this.levelLabel.node.active = !0), (this.maskNode.active = !1), (this.levelLabel.string = \"等级:\" + n));\r\n        this.resDot.active = $skillContext.default.Ins.checkSkillUpgrade(this.skillId);\r\n    };\r\n    e.prototype.touchSkill = function () {\r\n        if (!this.maskNode.active) {\r\n            $remoteAudio.default.instance.playEffectMusic(\"Click\");\r\n            $popupManager.PopupManager.instance.open(\r\n                $assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.SkillInfoView,\r\n                {\r\n                    skillId: this.skillId\r\n                }\r\n            );\r\n            this.resDot.active = $skillContext.default.Ins.checkSkillUpgrade(this.skillId);\r\n            $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.Skill);\r\n        }\r\n    };\r\n    __decorate([_(cc.Sprite)], e.prototype, \"icon\", void 0);\r\n    __decorate([_(cc.Node)], e.prototype, \"resDot\", void 0);\r\n    __decorate([_(cc.Label)], e.prototype, \"levelLabel\", void 0);\r\n    __decorate([_(cc.Node)], e.prototype, \"maskNode\", void 0);\r\n    return __decorate([g], e);\r\n})(cc.Component);\r\nexports.default = k;\r\n"]}