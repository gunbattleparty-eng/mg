
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_1.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1059fl0W5NP1YOfEvz5pQ/0', 'Bullet_1');
// game_script/scripts/Bullet_1.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $roleContext = require("./RoleContext");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var g = cc._decorator;
var _ = g.ccclass;
var k = (g.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.normal_bullet;
    e.anim = null;
    e.currButtlePenetrateLayer = 0;
    e.animName = "bullet_1_1";
    e.isLoadedSkin = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    var o = this;
    t.prototype.initButtle.call(this, e, i);
    this.speed = this.skillParam.bulletSpeed;
    this.velocity.set(e).multiplyScalar(this.speed);

    if (!this.anim) {
      this.anim = this.node.children[0].getComponent(cc.Animation);
    }

    this.setAnimation();
    this.currButtlePenetrateLayer = 0;
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];

    if (!this.isLoadedSkin && 1 !== $roleContext["default"].ins.currSkinInfo.gun) {
      this.isLoadedSkin = !0;
      var n = $configContext["default"].instance.gunSkinConfigs.find(function (t) {
        return t.id === $roleContext["default"].ins.currSkinInfo.gun;
      });
      $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Game, ["/anim/" + n.skin_res], cc.AnimationClip, null, function (t, e) {
        var i = e[0];

        if (sp && cc.isValid(i)) {
          o.animName = "" + n.skin_res;
          $resUtil.ResUtil.assignWith(i, $gameContext["default"].ins.buttleLayer.parent);
          o.anim.addClip(i);
          o.anim.play(o.animName);
        }
      });
    }
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse && e == $object.Trigger.enter) {
      var i = t.object;
      this.skillParam.bulletSuffFreezeAdd <= 0 ? i.sufferAtk({
        id: this.skillId,
        skillSpecialitys: this.skillSpecialitys,
        atk: this.atk
      }) : i.sufferAtk({
        id: this.skillId,
        skillSpecialitys: this.skillSpecialitys,
        atk: this.atk,
        bulletBuff: $baseBullet.BulletBuff.freeze_damage,
        value: this.skillParam.bulletSuffFreezeAdd
      });

      if (0 === this.currButtlePenetrateLayer) {
        if (this.skillParam.isBulletBoom) {
          this.createButtleBoom();
        }

        if (this.skillParam.isOpenbulletSplit) {
          this.createSplitButtle(i);
        }

        if (this.skillParam.isFirebullet) {
          var o = {
            type: $enemyStatus.EnemyDebuffType.BURN,
            timeLeft: this.skillParam.firebulletTime,
            value: this.skillParam.firebulletAtk[$gameSkillInfo.Skill4Param.FINAL]
          };
          i.sufferDebuff(o);
        }

        if (this.skillParam.bulletFreezeProbability > 0 && $seedUtil["default"].probability(this.skillParam.bulletFreezeProbability)) {
          o = {
            type: $enemyStatus.EnemyDebuffType.FREEZE,
            timeLeft: this.skillParam.bulletFreezeTime,
            value: 0
          };
          i.sufferDebuff(o);
        }
      }

      if (!(29 !== i.config.id && 30 !== i.config.id && 36 !== i.config.id)) {
        this.currButtlePenetrateLayer = this.skillParam.bulletPenetrateLayer;
      }

      this.currButtlePenetrateLayer++;

      if (this.skillParam.bulletPenetrateLayer <= this.currButtlePenetrateLayer) {
        this.removeSelf();
      }
    }
  };

  e.prototype.setAnimation = function (t) {
    if (void 0 === t) {
      t = "bullet_1_1";
    }

    this.skillParam.isFirebullet ? t = "bullet_1_2" : this.skillParam.bulletSuffFreezeAdd > 0 ? t = "bullet_1_4" : "bullet_1_1" === t && (t = this.animName);
    this.anim.play(t);
  };

  e.prototype.createButtleBoom = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.boom_bullet);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_2);
      t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    t.setPosition(this.node.position.add(cc.v3(0, 30)));
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.lowBulletLayer);
    t.setAnimation(null);
  };

  e.prototype.createSplitButtle = function (t) {
    var e = $gameContext["default"].ins.getNearbyN2(t.node, 4);

    for (var i = 0; i < e.length; i++) {
      var o = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.split_bullet);

      if (!o) {
        var n = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_3);
        (o = $resUtil.ResUtil.instantiate(n).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(1).skill_tpye;
      }

      o.setPosition(this.node.position.clone());
      o.initButtle(e[i].node.position.sub(this.node.position).normalize(), this.skillId);
      o.targetEnemy = t;
      o.insert($gameContext["default"].ins.buttleLayer);
    }
  };

  return __decorate([_], e);
}($baseBullet["default"]));
exports["default"] = k;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8xLmpzIl0sIm5hbWVzIjpbIm8iLCIkb2JqZWN0IiwicmVxdWlyZSIsIiRhc3NldHNMb2FkZXIiLCIkYXNzZXRzTWFwIiwiJHJlc1V0aWwiLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRyb2xlQ29udGV4dCIsIiRnYW1lQ29udGV4dCIsIiRnYW1lU2tpbGxJbmZvIiwiJGVuZW15U3RhdHVzIiwiJGJhc2VCdWxsZXQiLCJnIiwiY2MiLCJfZGVjb3JhdG9yIiwiXyIsImNjY2xhc3MiLCJrIiwicHJvcGVydHkiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYnV0dGxlVHlwZSIsIkJ1bGxldFR5cGUiLCJub3JtYWxfYnVsbGV0IiwiYW5pbSIsImN1cnJCdXR0bGVQZW5ldHJhdGVMYXllciIsImFuaW1OYW1lIiwiaXNMb2FkZWRTa2luIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEJ1dHRsZSIsImkiLCJjYWxsIiwic3BlZWQiLCJza2lsbFBhcmFtIiwiYnVsbGV0U3BlZWQiLCJ2ZWxvY2l0eSIsInNldCIsIm11bHRpcGx5U2NhbGFyIiwibm9kZSIsImNoaWxkcmVuIiwiZ2V0Q29tcG9uZW50IiwiQW5pbWF0aW9uIiwic2V0QW5pbWF0aW9uIiwiYXRrIiwic2tpbGxBdGsiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwiaW5zIiwiY3VyclNraW5JbmZvIiwiZ3VuIiwibiIsImluc3RhbmNlIiwiZ3VuU2tpbkNvbmZpZ3MiLCJmaW5kIiwiaWQiLCJsb2FkUmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwic2tpbl9yZXMiLCJBbmltYXRpb25DbGlwIiwic3AiLCJpc1ZhbGlkIiwiUmVzVXRpbCIsImFzc2lnbldpdGgiLCJidXR0bGVMYXllciIsInBhcmVudCIsImFkZENsaXAiLCJwbGF5Iiwib25UcmlnZ2VyIiwiaXNVc2UiLCJUcmlnZ2VyIiwiZW50ZXIiLCJvYmplY3QiLCJidWxsZXRTdWZmRnJlZXplQWRkIiwic3VmZmVyQXRrIiwic2tpbGxJZCIsInNraWxsU3BlY2lhbGl0eXMiLCJidWxsZXRCdWZmIiwiQnVsbGV0QnVmZiIsImZyZWV6ZV9kYW1hZ2UiLCJ2YWx1ZSIsImlzQnVsbGV0Qm9vbSIsImNyZWF0ZUJ1dHRsZUJvb20iLCJpc09wZW5idWxsZXRTcGxpdCIsImNyZWF0ZVNwbGl0QnV0dGxlIiwiaXNGaXJlYnVsbGV0IiwidHlwZSIsIkVuZW15RGVidWZmVHlwZSIsIkJVUk4iLCJ0aW1lTGVmdCIsImZpcmVidWxsZXRUaW1lIiwiZmlyZWJ1bGxldEF0ayIsInN1ZmZlckRlYnVmZiIsImJ1bGxldEZyZWV6ZVByb2JhYmlsaXR5IiwicHJvYmFiaWxpdHkiLCJGUkVFWkUiLCJidWxsZXRGcmVlemVUaW1lIiwiY29uZmlnIiwiYnVsbGV0UGVuZXRyYXRlTGF5ZXIiLCJyZW1vdmVTZWxmIiwiZ2V0QnV0dGxlUG9vbCIsImJvb21fYnVsbGV0IiwiZ2V0UmVzIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkJ1bGxldF8yIiwiaW5zdGFudGlhdGUiLCJsb3dCdWxsZXRMYXllciIsInNldFBvc2l0aW9uIiwicG9zaXRpb24iLCJhZGQiLCJ2MyIsImluc2VydCIsImdldE5lYXJieU4yIiwibGVuZ3RoIiwic3BsaXRfYnVsbGV0IiwiQnVsbGV0XzMiLCJiYXNpY1NraWxsQ29uZmlnTWFwIiwiZ2V0Iiwic2tpbGxfdHB5ZSIsImNsb25lIiwic3ViIiwibm9ybWFsaXplIiwidGFyZ2V0RW5lbXkiLCJfX2RlY29yYXRlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHRCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUUsVUFBVSxHQUFHRixPQUFPLENBQUMs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ckIsQ0FBeUJpQixXQUFsQztJQUNIO0VBQ0osQ0FqQkQ7O0VBa0JBLE9BQU84RCxVQUFVLENBQUMsQ0FBQ2xILENBQUQsQ0FBRCxFQUFNSyxDQUFOLENBQWpCO0FBQ0gsQ0E5SUQsQ0E4SUdULFdBQVcsV0E5SWQsQ0FGQyxDQUFMO0FBaUpBdUgsT0FBTyxXQUFQLEdBQWtCakgsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJG9iamVjdCA9IHJlcXVpcmUoXCIuL09iamVjdFwiKTtcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkcm9sZUNvbnRleHQgPSByZXF1aXJlKFwiLi9Sb2xlQ29udGV4dFwiKTtcclxudmFyICRnYW1lQ29udGV4dCA9IHJlcXVpcmUoXCIuL0dhbWVDb250ZXh0XCIpO1xyXG52YXIgJGdhbWVTa2lsbEluZm8gPSByZXF1aXJlKFwiLi9HYW1lU2tpbGxJbmZvXCIpO1xyXG52YXIgJGVuZW15U3RhdHVzID0gcmVxdWlyZShcIi4vRW5lbXlTdGF0dXNcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciBnID0gY2MuX2RlY29yYXRvcjtcclxudmFyIF8gPSBnLmNjY2xhc3M7XHJcbnZhciBrID1cclxuICAgIChnLnByb3BlcnR5LFxyXG4gICAgKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgICAgIGUuYnV0dGxlVHlwZSA9ICRiYXNlQnVsbGV0LkJ1bGxldFR5cGUubm9ybWFsX2J1bGxldDtcclxuICAgICAgICAgICAgZS5hbmltID0gbnVsbDtcclxuICAgICAgICAgICAgZS5jdXJyQnV0dGxlUGVuZXRyYXRlTGF5ZXIgPSAwO1xyXG4gICAgICAgICAgICBlLmFuaW1OYW1lID0gXCJidWxsZXRfMV8xXCI7XHJcbiAgICAgICAgICAgIGUuaXNMb2FkZWRTa2luID0gITE7XHJcbiAgICAgICAgICAgIHJldHVybiBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICAgICAgZS5wcm90b3R5cGUuaW5pdEJ1dHRsZSA9IGZ1bmN0aW9uIChlLCBpKSB7XHJcbiAgICAgICAgICAgIHZhciBvID0gdGhpcztcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUuaW5pdEJ1dHRsZS5jYWxsKHRoaXMsIGUsIGkpO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5za2lsbFBhcmFtLmJ1bGxldFNwZWVkO1xyXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnNldChlKS5tdWx0aXBseVNjYWxhcih0aGlzLnNwZWVkKTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmFuaW0pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYW5pbSA9IHRoaXMubm9kZS5jaGlsZHJlblswXS5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNldEFuaW1hdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJCdXR0bGVQZW5ldHJhdGVMYXllciA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuYXRrID0gdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzTG9hZGVkU2tpbiAmJiAxICE9PSAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuY3VyclNraW5JbmZvLmd1bikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRlZFNraW4gPSAhMDtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5ndW5Ta2luQ29uZmlncy5maW5kKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuaWQgPT09ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UubG9hZFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgW1wiL2FuaW0vXCIgKyBuLnNraW5fcmVzXSxcclxuICAgICAgICAgICAgICAgICAgICBjYy5BbmltYXRpb25DbGlwLFxyXG4gICAgICAgICAgICAgICAgICAgIG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBlWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3AgJiYgY2MuaXNWYWxpZChpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5hbmltTmFtZSA9IFwiXCIgKyBuLnNraW5fcmVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKGksICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllci5wYXJlbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgby5hbmltLmFkZENsaXAoaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmFuaW0ucGxheShvLmFuaW1OYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLm9uVHJpZ2dlciA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1VzZSAmJiBlID09ICRvYmplY3QuVHJpZ2dlci5lbnRlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSB0Lm9iamVjdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbS5idWxsZXRTdWZmRnJlZXplQWRkIDw9IDBcclxuICAgICAgICAgICAgICAgICAgICA/IGkuc3VmZmVyQXRrKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNraWxsU3BlY2lhbGl0eXM6IHRoaXMuc2tpbGxTcGVjaWFsaXR5cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBhdGs6IHRoaXMuYXRrXHJcbiAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIDogaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLnNraWxsSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpbGxTcGVjaWFsaXR5czogdGhpcy5za2lsbFNwZWNpYWxpdHlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGF0azogdGhpcy5hdGssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYnVsbGV0QnVmZjogJGJhc2VCdWxsZXQuQnVsbGV0QnVmZi5mcmVlemVfZGFtYWdlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnNraWxsUGFyYW0uYnVsbGV0U3VmZkZyZWV6ZUFkZFxyXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdGhpcy5jdXJyQnV0dGxlUGVuZXRyYXRlTGF5ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmlzQnVsbGV0Qm9vbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUJ1dHRsZUJvb20oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS5pc09wZW5idWxsZXRTcGxpdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVNwbGl0QnV0dGxlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmlzRmlyZWJ1bGxldCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuQlVSTixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0OiB0aGlzLnNraWxsUGFyYW0uZmlyZWJ1bGxldFRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5za2lsbFBhcmFtLmZpcmVidWxsZXRBdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuc3VmZmVyRGVidWZmKG8pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbS5idWxsZXRGcmVlemVQcm9iYWJpbGl0eSA+IDAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkodGhpcy5za2lsbFBhcmFtLmJ1bGxldEZyZWV6ZVByb2JhYmlsaXR5KVxyXG4gICAgICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5GUkVFWkUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogdGhpcy5za2lsbFBhcmFtLmJ1bGxldEZyZWV6ZVRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZihvKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoISgyOSAhPT0gaS5jb25maWcuaWQgJiYgMzAgIT09IGkuY29uZmlnLmlkICYmIDM2ICE9PSBpLmNvbmZpZy5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJCdXR0bGVQZW5ldHJhdGVMYXllciA9IHRoaXMuc2tpbGxQYXJhbS5idWxsZXRQZW5ldHJhdGVMYXllcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyKys7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmJ1bGxldFBlbmV0cmF0ZUxheWVyIDw9IHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLnNldEFuaW1hdGlvbiA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IHQpIHtcclxuICAgICAgICAgICAgICAgIHQgPSBcImJ1bGxldF8xXzFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uaXNGaXJlYnVsbGV0XHJcbiAgICAgICAgICAgICAgICA/ICh0ID0gXCJidWxsZXRfMV8yXCIpXHJcbiAgICAgICAgICAgICAgICA6IHRoaXMuc2tpbGxQYXJhbS5idWxsZXRTdWZmRnJlZXplQWRkID4gMFxyXG4gICAgICAgICAgICAgICAgPyAodCA9IFwiYnVsbGV0XzFfNFwiKVxyXG4gICAgICAgICAgICAgICAgOiBcImJ1bGxldF8xXzFcIiA9PT0gdCAmJiAodCA9IHRoaXMuYW5pbU5hbWUpO1xyXG4gICAgICAgICAgICB0aGlzLmFuaW0ucGxheSh0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZUJ1dHRsZUJvb20gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5ib29tX2J1bGxldCk7XHJcbiAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzJcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB0ID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShlLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnNldFBvc2l0aW9uKHRoaXMubm9kZS5wb3NpdGlvbi5hZGQoY2MudjMoMCwgMzApKSk7XHJcbiAgICAgICAgICAgIHQuaW5pdEJ1dHRsZShudWxsLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICB0Lmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIpO1xyXG4gICAgICAgICAgICB0LnNldEFuaW1hdGlvbihudWxsKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZVNwbGl0QnV0dGxlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0TmVhcmJ5TjIodC5ub2RlLCA0KTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbyA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuc3BsaXRfYnVsbGV0KTtcclxuICAgICAgICAgICAgICAgIGlmICghbykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzNcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgIChvID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShuKS5nZXRDb21wb25lbnQoJGJhc2VCdWxsZXQuZGVmYXVsdCkpLnNraWxsU3BlY2lhbGl0eXMgPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmJhc2ljU2tpbGxDb25maWdNYXAuZ2V0KDEpLnNraWxsX3RweWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBvLnNldFBvc2l0aW9uKHRoaXMubm9kZS5wb3NpdGlvbi5jbG9uZSgpKTtcclxuICAgICAgICAgICAgICAgIG8uaW5pdEJ1dHRsZShlW2ldLm5vZGUucG9zaXRpb24uc3ViKHRoaXMubm9kZS5wb3NpdGlvbikubm9ybWFsaXplKCksIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgICAgICBvLnRhcmdldEVuZW15ID0gdDtcclxuICAgICAgICAgICAgICAgIG8uaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBfX2RlY29yYXRlKFtfXSwgZSk7XHJcbiAgICB9KSgkYmFzZUJ1bGxldC5kZWZhdWx0KSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGs7XHJcbiJdfQ==