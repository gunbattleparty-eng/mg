{"version":3,"sources":["assets\\game_script\\scripts\\RankView.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$list","$popupView","$util","$rankService","f","cc","_decorator","h","ccclass","m","property","y","t","e","apply","arguments","list","selfLayer","__extends","prototype","onLoad","instance","getRankList","RankTypeEnum","Level","length","numItems","onListRender","i","rankItem","onResetView","renderSelf","refreshAllRankList","updateAll","getRankSelf","rank","n","parseObject","extendParams","children","active","s","getChildByName","c","getComponent","Label","u","toString","string","nameProccess","un","g","l","p","Sprite","loadRes","BundleNames","Public_Res","SpriteFrame","isValid","spriteFrame","ResUtil","assignWith","node","substring","__decorate","Node","PopupView","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $list = require(\"./List\");\r\nvar $popupView = require(\"./PopupView\");\r\nvar $util = require(\"./Util\");\r\nvar $rankService = require(\"./RankService\");\r\nvar f = cc._decorator;\r\nvar h = f.ccclass;\r\nvar m = f.property;\r\nvar y = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.list = null;\r\n        e.selfLayer = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.onLoad = function () {\r\n        var t = $rankService.default.instance.getRankList($rankService.RankTypeEnum.Level);\r\n        if (t.length > 0) {\r\n            this.list.numItems = t.length;\r\n        }\r\n    };\r\n    e.prototype.onListRender = function (t, e) {\r\n        var i = $rankService.default.instance.getRankList($rankService.RankTypeEnum.Level)[e];\r\n        this.rankItem(t, i, e + 1);\r\n    };\r\n    e.prototype.onResetView = function () {\r\n        var t = this;\r\n        this.renderSelf();\r\n        $rankService.default.instance.refreshAllRankList(function () {\r\n            var e = $rankService.default.instance.getRankList($rankService.RankTypeEnum.Level);\r\n            if (e.length > 0) {\r\n                t.list.numItems = e.length;\r\n                t.list.updateAll();\r\n            }\r\n            t.renderSelf();\r\n        });\r\n    };\r\n    e.prototype.renderSelf = function () {\r\n        var t = $rankService.default.instance.getRankSelf($rankService.RankTypeEnum.Level);\r\n        if (t) {\r\n            this.rankItem(this.selfLayer, t, t.rank);\r\n        }\r\n    };\r\n    e.prototype.rankItem = function (t, e, i) {\r\n        var o = this;\r\n        var n = $util.default.parseObject(e.extendParams);\r\n        t.children[0].children[0].active = 2 === i;\r\n        t.children[0].children[1].active = 3 === i;\r\n        t.children[0].children[2].active = i > 3;\r\n        var s = t.getChildByName(\"rank_label\");\r\n        if (s) {\r\n            var c = s.getComponent(cc.Label);\r\n            var u = i <= 100 ? i.toString() : \"-\";\r\n            c.string = u;\r\n        }\r\n        t.getChildByName(\"name_label\").getComponent(cc.Label).string = this.nameProccess(n.un);\r\n        t.getChildByName(\"grade_label\").getComponent(cc.Label).string = n.g;\r\n        t.getChildByName(\"level_label\").getComponent(cc.Label).string = n.l;\r\n        var p = t.getChildByName(\"head_icon\").getComponent(cc.Sprite);\r\n        $assetsLoader.default.instance.loadRes(\r\n            $assetsMap.BundleNames.Public_Res,\r\n            [\"/head_icon/tx\" + n.h],\r\n            cc.SpriteFrame,\r\n            null,\r\n            function (t, e) {\r\n                var i = e[0];\r\n                if (i && cc.isValid(p)) {\r\n                    p.spriteFrame = $resUtil.ResUtil.assignWith(i, o.node);\r\n                }\r\n            }\r\n        );\r\n    };\r\n    e.prototype.nameProccess = function (t) {\r\n        var e = t;\r\n        return t.length <= 8 ? e : t.substring(0, 4) + \"...\" + t.substring(t.length - 3);\r\n    };\r\n    __decorate([m($list.default)], e.prototype, \"list\", void 0);\r\n    __decorate([m(cc.Node)], e.prototype, \"selfLayer\", void 0);\r\n    return __decorate([h], e);\r\n})($popupView.PopupView);\r\nexports.default = y;\r\n"]}