{"version":3,"sources":["assets\\game_script\\scripts\\EquipmentContext.js"],"names":["exports","EquipmentType","o","$assetsMap","require","$eventManager","$popupManager","$storageUtil","$gameGemInfo","$configContext","$localEventName","$localName","$roleContext","$taskContext","$userDataContext","Hat","Clothes","Shoes","Armlet","Trousers","Gloves","m","t","equipmentMap","Map","equipmentAtk","gemMap","order","StorageUtil","getItem","EQUIPMENT_INFO","GEM_LIST_INFO","EQUIPMENT_ORDER","size","set","caculateEquipmentAtk","Object","defineProperty","get","instance","enumerable","configurable","prototype","init","refreshGameGem","getAtk","playerSkinConfigs","find","id","ins","currSkinInfo","skin","add_attribute","getGemList","e","has","length","getAllGemList","i","concat","setGem","n","s","usePackItem","setItem","removeGem","gemConfigs","returnPackItem","hasSameGem","SkillPool","value","r","a","getPartAndIndexGemId","hasGemTypeByPart","filter","includes","map","gemCount","getEquipmentAtk","getEquipemtnAtkByPart","equipmentConfigs","level","add_atk","getGrade","Grade","GameGemInfo","clear","chooseGem","getRobotProps","forEach","setGemProp","getEquipmentUpInfo","type","num","Gradeup_materialspend","coin","level_materialspend","upgradeEquip","Ins","setTaskRecord","upGradeEquipCache","checkEquipUpgrade","checkPartEquipUpgrade","autoUpgrade","checkCoin","checkUpgradeStone","checkEquipBook","opearCoin","opearUpgradeStone","opearEquipBook","l","push","c","send","RENDER_GEM","addExp","PopupManager","open","AssetsMap","PopUpBundles","prefabs","assetsList","UpgradeView","count","changeGemItem","packList","isUse","save"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.EquipmentType = void 0;\r\nvar o;\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $storageUtil = require(\"./StorageUtil\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $localName = require(\"./LocalName\");\r\nvar $roleContext = require(\"./RoleContext\");\r\nvar $taskContext = require(\"./TaskContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\n(o = exports.EquipmentType || (exports.EquipmentType = {}))[(o.Hat = 1)] = \"Hat\";\r\no[(o.Clothes = 2)] = \"Clothes\";\r\no[(o.Shoes = 3)] = \"Shoes\";\r\no[(o.Armlet = 4)] = \"Armlet\";\r\no[(o.Trousers = 5)] = \"Trousers\";\r\no[(o.Gloves = 6)] = \"Gloves\";\r\nvar m = (function () {\r\n    function t() {\r\n        this.equipmentMap = new Map();\r\n        this.equipmentAtk = [];\r\n        this.gemMap = new Map();\r\n        this.order = 0;\r\n        this.equipmentMap = $storageUtil.StorageUtil.getItem($localName.default.EQUIPMENT_INFO, this.equipmentMap);\r\n        this.gemMap = $storageUtil.StorageUtil.getItem($localName.default.GEM_LIST_INFO, this.gemMap);\r\n        this.order = $storageUtil.StorageUtil.getItem($localName.default.EQUIPMENT_ORDER, this.order);\r\n        if (0 === this.equipmentMap.size) {\r\n            for (var t = 1; t < 7; t++) {\r\n                this.equipmentMap.set(t, 1);\r\n            }\r\n        }\r\n        for (t = 1; t < 7; t++) {\r\n            this.caculateEquipmentAtk(t);\r\n        }\r\n    }\r\n    Object.defineProperty(t, \"Ins\", {\r\n        get: function () {\r\n            if (!t.instance) {\r\n                t.instance = new t();\r\n            }\r\n            return t.instance;\r\n        },\r\n        enumerable: !1,\r\n        configurable: !0\r\n    });\r\n    t.prototype.init = function () {\r\n        this.refreshGameGem();\r\n    };\r\n    t.prototype.getAtk = function () {\r\n        return (\r\n            100 +\r\n            $configContext.default.instance.playerSkinConfigs.find(function (t) {\r\n                return t.id === $roleContext.default.ins.currSkinInfo.skin;\r\n            }).add_attribute\r\n        );\r\n    };\r\n    t.prototype.getGemList = function (t, e) {\r\n        if (void 0 === e) {\r\n            e = this.order;\r\n        }\r\n        return this.gemMap.has(e)\r\n            ? !this.gemMap.get(e)[t - 1] || this.gemMap.get(e)[t - 1].length <= 0\r\n                ? []\r\n                : this.gemMap.get(e)[t - 1]\r\n            : [];\r\n    };\r\n    t.prototype.getAllGemList = function (t) {\r\n        if (void 0 === t) {\r\n            t = this.order;\r\n        }\r\n        var e = [];\r\n        for (var i = 1; i <= 6; i++) {\r\n            if (this.gemMap.has(t)) {\r\n                if (!(!this.gemMap.get(t)[i - 1] || this.gemMap.get(t)[i - 1].length <= 0)) {\r\n                    e = e.concat(this.gemMap.get(t)[i - 1]);\r\n                }\r\n            }\r\n        }\r\n        return e;\r\n    };\r\n    t.prototype.setGem = function (t, e, i, o) {\r\n        if (void 0 === i) {\r\n            i = -1;\r\n        }\r\n        if (void 0 === o) {\r\n            o = this.order;\r\n        }\r\n        if (!this.gemMap.has(o)) {\r\n            this.gemMap.set(o, []);\r\n        }\r\n        var n = this.gemMap.get(o);\r\n        if (-1 !== i) {\r\n            n[t - 1][i] = e;\r\n        } else {\r\n            if (n[t - 1]) {\r\n                for (var s = 0; s < 5; s++) {\r\n                    if (!n[t - 1][s] || -1 === n[t - 1][s]) {\r\n                        n[t - 1][s] = e;\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                n[t - 1] = [e];\r\n            }\r\n        }\r\n        $roleContext.default.ins.usePackItem(e, 1);\r\n        $storageUtil.StorageUtil.setItem($localName.default.GEM_LIST_INFO, this.gemMap);\r\n        this.refreshGameGem();\r\n    };\r\n    t.prototype.removeGem = function (t, e, i) {\r\n        if (void 0 === i) {\r\n            i = this.order;\r\n        }\r\n        var o = this.gemMap.get(i)[t - 1][e];\r\n        if (o) {\r\n            var n = $configContext.default.instance.gemConfigs.find(function (t) {\r\n                return t.id === o;\r\n            });\r\n            $roleContext.default.ins.returnPackItem(n, 1);\r\n        }\r\n        this.gemMap.get(i)[t - 1][e] = null;\r\n        $storageUtil.StorageUtil.setItem($localName.default.GEM_LIST_INFO, this.gemMap);\r\n        this.refreshGameGem();\r\n    };\r\n    t.prototype.hasSameGem = function (t, e, i) {\r\n        if (void 0 === i) {\r\n            i = this.order;\r\n        }\r\n        if (!this.gemMap.has(i) || !this.gemMap.get(i)[t - 1] || this.gemMap.get(i)[t - 1].length <= 0) {\r\n            return !1;\r\n        }\r\n        var o = $configContext.default.instance.gemConfigs.find(function (t) {\r\n            return t.id === e;\r\n        }).SkillPool;\r\n        var n = function (e) {\r\n            var n = s.gemMap.get(i)[t - 1][e];\r\n            if (\r\n                n &&\r\n                $configContext.default.instance.gemConfigs.find(function (t) {\r\n                    return t.id === n;\r\n                }).SkillPool === o\r\n            ) {\r\n                return {\r\n                    value: !0\r\n                };\r\n            }\r\n        };\r\n        var s = this;\r\n        for (var r = 0; r < this.gemMap.get(i)[t - 1].length; r++) {\r\n            var a = n(r);\r\n            if (\"object\" == typeof a) {\r\n                return a.value;\r\n            }\r\n        }\r\n        return !1;\r\n    };\r\n    t.prototype.getPartAndIndexGemId = function (t, e, i) {\r\n        if (void 0 === i) {\r\n            i = this.order;\r\n        }\r\n        return !this.gemMap.has(i) ||\r\n            !this.gemMap.get(i)[t - 1] ||\r\n            this.gemMap.get(i)[t - 1].length <= 0 ||\r\n            !this.gemMap.get(i)[t - 1][e]\r\n            ? -1\r\n            : this.gemMap.get(i)[t - 1][e];\r\n    };\r\n    t.prototype.hasGemTypeByPart = function (t, e) {\r\n        var i = this.getGemList(t);\r\n        return $configContext.default.instance.gemConfigs\r\n            .filter(function (t) {\r\n                return i.includes(t.id);\r\n            })\r\n            .map(function (t) {\r\n                return t.SkillPool;\r\n            })\r\n            .includes(e);\r\n    };\r\n    t.prototype.gemCount = function (t, e) {\r\n        if (void 0 === e) {\r\n            e = this.order;\r\n        }\r\n        if (!this.gemMap.has(e) || !this.gemMap.get(e)[t - 1] || this.gemMap.get(e)[t - 1].length <= 0) {\r\n            return 0;\r\n        }\r\n        var i = 0;\r\n        for (var o = 0; o < this.gemMap.get(e)[t - 1].length; o++) {\r\n            if (this.gemMap.get(e)[t - 1][o]) {\r\n                i++;\r\n            }\r\n        }\r\n        return i;\r\n    };\r\n    t.prototype.getEquipmentAtk = function () {\r\n        var t = 0;\r\n        for (var e = 0; e < this.equipmentAtk.length; e++) {\r\n            t += this.equipmentAtk[e];\r\n        }\r\n        return t;\r\n    };\r\n    t.prototype.getEquipemtnAtkByPart = function (t) {\r\n        return this.equipmentAtk[t - 1];\r\n    };\r\n    t.prototype.caculateEquipmentAtk = function (t) {\r\n        var e = $configContext.default.instance.equipmentConfigs.find(function (e) {\r\n            return e.id === t;\r\n        });\r\n        var i = 0;\r\n        var o = 0;\r\n        for (var n = 1; n <= this.equipmentMap.get(t); n++) {\r\n            n > e.level[o] && o < e.level.length - 1 && o++;\r\n            i += e.add_atk[o];\r\n        }\r\n        this.equipmentAtk[t - 1] = i;\r\n        return i;\r\n    };\r\n    t.prototype.getGrade = function (t) {\r\n        var e = $configContext.default.instance.equipmentConfigs.find(function (e) {\r\n            return e.id === t;\r\n        });\r\n        var i = 0;\r\n        for (var o = 0; o < e.level.length; o++) {\r\n            if (this.equipmentMap.get(t) <= e.level[o]) {\r\n                i = o;\r\n                break;\r\n            }\r\n        }\r\n        return e.Grade[i];\r\n    };\r\n    t.prototype.refreshGameGem = function (t) {\r\n        if (void 0 === t) {\r\n            t = !1;\r\n        }\r\n        $gameGemInfo.GameGemInfo.ins.clear();\r\n        var e = this.gemMap.get(this.order);\r\n        if (e && !(e.length <= 0)) {\r\n            for (var i = 0; i < e.length; i++) {\r\n                var o = e[i];\r\n                if (o) {\r\n                    for (var n = 0; n < o.length; n++) {\r\n                        var s = o[n];\r\n                        if (s && s > 0) {\r\n                            $gameGemInfo.GameGemInfo.ins.chooseGem(s);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (t) {\r\n                $roleContext.default.ins.getRobotProps().forEach(function (t, e) {\r\n                    $gameGemInfo.GameGemInfo.ins.setGemProp(e, t);\r\n                });\r\n            }\r\n        }\r\n    };\r\n    t.prototype.getEquipmentUpInfo = function (t) {\r\n        var e = $configContext.default.instance.equipmentConfigs.find(function (e) {\r\n            return e.id === t;\r\n        });\r\n        var i = this.equipmentMap.get(t);\r\n        if (i >= e.level[e.level.length - 1]) {\r\n            return null;\r\n        }\r\n        var o = -1;\r\n        for (var n = 0; n < e.level.length; n++) {\r\n            if (i === e.level[n]) {\r\n                o = n;\r\n                break;\r\n            }\r\n        }\r\n        if (-1 !== o) {\r\n            return {\r\n                type: 0,\r\n                num: e.Gradeup_materialspend[o][0],\r\n                coin: e.Gradeup_materialspend[o][1]\r\n            };\r\n        }\r\n        o = 0;\r\n        for (n = 0; n < e.level.length && !(i < e.level[n]); n++) {\r\n            o = n;\r\n        }\r\n        return -1 !== o\r\n            ? {\r\n                  type: 1,\r\n                  num: e.level_materialspend[o][0] * i,\r\n                  coin: e.level_materialspend[o][1] * i\r\n              }\r\n            : null;\r\n    };\r\n    t.prototype.upgradeEquip = function (t, e) {\r\n        $taskContext.default.Ins.setTaskRecord(6);\r\n        this.equipmentMap.set(t, e);\r\n        this.caculateEquipmentAtk(t);\r\n        $storageUtil.StorageUtil.setItem($localName.default.EQUIPMENT_INFO, this.equipmentMap);\r\n    };\r\n    t.prototype.upGradeEquipCache = function (t, e) {\r\n        this.equipmentMap.set(t, e);\r\n    };\r\n    t.prototype.checkEquipUpgrade = function () {\r\n        for (var t = 0; t < 6; t++) {\r\n            if (this.checkPartEquipUpgrade(t + 1)) {\r\n                return !0;\r\n            }\r\n        }\r\n        return !1;\r\n    };\r\n    t.prototype.autoUpgrade = function () {\r\n        var e = [];\r\n        for (var i = 1; i <= 6; i++) {\r\n            var o = this.getEquipmentUpInfo(i);\r\n            for (\r\n                var a = 0;\r\n                o &&\r\n                $userDataContext.default.Ins.checkCoin(-o.coin) &&\r\n                (0 !== o.type || $userDataContext.default.Ins.checkUpgradeStone(-o.num)) &&\r\n                (1 !== o.type || $userDataContext.default.Ins.checkEquipBook(i, -o.num));\r\n\r\n            ) {\r\n                $userDataContext.default.Ins.opearCoin(-o.coin);\r\n                0 === o.type\r\n                    ? $userDataContext.default.Ins.opearUpgradeStone(-o.num)\r\n                    : 1 === o.type && $userDataContext.default.Ins.opearEquipBook(i, -o.num);\r\n                a++;\r\n                var l = t.Ins.equipmentMap.get(i) + 1;\r\n                t.Ins.upGradeEquipCache(i, l);\r\n                if (!e.includes(i)) {\r\n                    e.push(i);\r\n                }\r\n                o = this.getEquipmentUpInfo(i);\r\n            }\r\n            var c = t.Ins.equipmentMap.get(i);\r\n            t.Ins.upgradeEquip(i, c);\r\n            $eventManager.default.send($localEventName.default.RENDER_GEM);\r\n            if ($userDataContext.default.Ins.addExp(15 * a, a)) {\r\n                $popupManager.PopupManager.instance.open(\r\n                    $assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.UpgradeView,\r\n                    {\r\n                        count: a\r\n                    }\r\n                );\r\n                break;\r\n            }\r\n        }\r\n        return e;\r\n    };\r\n    t.prototype.checkPartEquipUpgrade = function (t) {\r\n        var e = this.getEquipmentUpInfo(t);\r\n        return !!(\r\n            e &&\r\n            $userDataContext.default.Ins.checkCoin(-e.coin) &&\r\n            ((0 === e.type && $userDataContext.default.Ins.checkUpgradeStone(-e.num)) ||\r\n                (1 === e.type && $userDataContext.default.Ins.checkEquipBook(t, -e.num)))\r\n        );\r\n    };\r\n    t.prototype.changeGemItem = function (t) {\r\n        if (t !== this.order) {\r\n            var e = $roleContext.default.ins.packList;\r\n            var i = this.getAllGemList();\r\n            var o = this.getAllGemList(t);\r\n            for (var n = 0; n < e.length; n++) {\r\n                i.includes(e[n].id) && ((e[n].isUse = !1), e[n].num++);\r\n                o.includes(e[n].id) && ((e[n].isUse = !0), e[n].num--);\r\n            }\r\n            $roleContext.default.ins.save();\r\n            this.order = t;\r\n            this.refreshGameGem();\r\n            $storageUtil.StorageUtil.setItem($localName.default.EQUIPMENT_ORDER, t);\r\n        }\r\n    };\r\n    return t;\r\n})();\r\nexports.default = m;\r\n"]}