
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/VIVOCustom.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '63430J8ENJL37KLQKaO0b29', 'VIVOCustom');
// game_script/scripts/VIVOCustom.js

"use strict";

var o;

var $baseAd = require("./BaseAd");

var r = window.qg;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.style = null;
    e.isOpenPreLoad = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    var t;
    var e = r.getSystemInfoSync();
    var i = (e.windowWidth, e.windowHeight);
    t = this.style && !this.style.isBanner ? {
      adUnitId: this.adUnitId,
      style: {
        left: this.style.left || 0,
        top: this.style.top || 0.4 * i
      }
    } : {
      adUnitId: this.adUnitId,
      style: {
        left: this.style.left || 0,
        top: this.style.top || Math.round(i)
      }
    };
    this.isLoaded = !0;
    this.adIns = r.createCustomAd(t);

    if (this.adIns.onLoad) {
      this.adIns.onLoad(this.onLoad);
    }

    if (this.adIns.onClose) {
      this.adIns.onClose(this.onClose);
    }

    if (this.adIns.onHide) {
      this.adIns.onHide(this.onHide);
    }

    if (this.adIns.onError) {
      this.adIns.onError(this.onError);
    }

    this.autoShow();
  };

  e.prototype.showCustomAd = function (e, i, o, n) {
    var s = this;
    this.showCallback = i;
    this.closeCallback = o;
    this.errorCallback = n;

    if (this.isCanShow) {
      this.style = e;

      if (this.adIns) {
        if (this.isLoaded) {
          this.isConsume = !0;

          if (this.adIns.show) {
            var r = this.adIns.show();
            r && r.then ? r.then(function () {
              console.log("customAd show success");

              if (s.showCallback) {
                s.showCallback();
              }

              s.showCallback = null;
            })["catch"](function (i) {
              console.warn("customAd show error:", i);
              console.warn("showCustomAd, customAd显示异常,执行重新创建并显示");
              t.prototype.destroyAd.call(s);
              s.style = e;
              s.reCreateAd(!0);
            }) : (console.warn("showCustomAd, customAd显示异常,执行重新创建并显示"), this.style = e, this.reCreateAd(!0));
          } else {
            console.warn("找不到show");
          }
        } else {
          console.warn("showCustomAd, customAd未加载完毕,执行重新创建并显示");
          this.style = e;
          this.reCreateAd(!0);
        }
      } else {
        console.warn("showCustomAd, customAd对象未创建,执行自动创建并显示");
        this.style = e;
        this.reCreateAd(!0);
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示");
    }
  };

  e.prototype.reCreateAd = function (t) {
    var e = this;
    this.destroyAd(t);
    this.isAutoShow = t;
    setTimeout(function () {
      e.loadAd();
    }, 100);
  };

  e.prototype.forbidderAd = function (t) {
    this.isCanShow = !t;

    if (t) {
      this.hideAd(!0);
    }
  };

  e.prototype.hideAd = function (t) {
    t ? this.destroyAd() : this.showing && this.adIns.hide();
  };

  e.prototype.destroyAd = function (e) {
    if (void 0 === e) {
      e = !1;
    }

    t.prototype.destroyAd.call(this, e);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offClose) {
        this.adIns.offClose(this.onClose);
      }

      if (this.adIns.offHide) {
        this.adIns.offLoad(this.onHide);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showCustomAd(this.style, this.showCallback, this.closeCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function () {
    t.prototype.onAdLoad.call(this);
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);
    this.showing = !1;

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.errorCallback = null;
    this.destroyAd();
  };

  e.prototype.onAdClose = function () {
    t.prototype.onAdClose.call(this);
    this.showing = !1;

    if (this.closeCallback) {
      this.closeCallback();
    }

    this.closeCallback = null;
    this.destroyAd();

    if (this.isOpenPreLoad) {
      this.reCreateAd(!1);
    }
  };

  e.prototype.onAdHide = function () {
    t.prototype.onAdHide.call(this);
    this.showing = !1;
    this.hideing = !1;

    if (this.isOpenPreLoad) {
      this.reCreateAd(!1);
    }
  };

  return e;
}($baseAd.BaseAd);

exports["default"] = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFZJVk9DdXN0b20uanMiXSwibmFtZXMiOlsibyIsIiRiYXNlQWQiLCJyZXF1aXJlIiwiciIsIndpbmRvdyIsInFnIiwiYSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJzdHlsZSIsImlzT3BlblByZUxvYWQiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJsb2FkQWQiLCJnZXRTeXN0ZW1JbmZvU3luYyIsImkiLCJ3aW5kb3dXaWR0aCIsIndpbmRvd0hlaWdodCIsImlzQmFubmVyIiwiYWRVbml0SWQiLCJsZWZ0IiwidG9wIiwiTWF0aCIsInJvdW5kIiwiaXNMb2FkZWQiLCJhZElucyIsImNyZWF0ZUN1c3RvbUFkIiwib25Mb2FkIiwib25DbG9zZSIsIm9uSGlkZSIsIm9uRXJyb3IiLCJhdXRvU2hvdyIsInNob3dDdXN0b21BZCIsIm4iLCJzIiwic2hvd0NhbGxiYWNrIiwiY2xvc2VDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJpc0NhblNob3ciLCJpc0NvbnN1bWUiLCJzaG93IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJ3YXJuIiwiZGVzdHJveUFkIiwiY2FsbCIsInJlQ3JlYXRlQWQiLCJpc0F1dG9TaG93Iiwic2V0VGltZW91dCIsImZvcmJpZGRlckFkIiwiaGlkZUFkIiwic2hvd2luZyIsImhpZGUiLCJvZmZMb2FkIiwib2ZmQ2xvc2UiLCJvZmZIaWRlIiwib2ZmRXJyb3IiLCJkZXN0cm95Iiwib25BZExvYWQiLCJvbkFkRXJyb3IiLCJvbkFkQ2xvc2UiLCJvbkFkSGlkZSIsImhpZGVpbmciLCJCYXNlQWQiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1BQU0sQ0FBQ0MsRUFBZjs7QUFDQSxJQUFJQyxDQUFD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SUFDQSxJQUFJLEtBQUtmLGFBQVQsRUFBd0I7TUFDcEIsS0FBS0EsYUFBTDtJQUNIOztJQUNELEtBQUtBLGFBQUwsR0FBcUIsSUFBckI7SUFDQSxLQUFLUSxTQUFMO0VBQ0gsQ0FSRDs7RUFTQXZDLENBQUMsQ0FBQ00sU0FBRixDQUFZaUQsU0FBWixHQUF3QixZQUFZO0lBQ2hDeEQsQ0FBQyxDQUFDTyxTQUFGLENBQVlpRCxTQUFaLENBQXNCZixJQUF0QixDQUEyQixJQUEzQjtJQUNBLEtBQUtNLE9BQUwsR0FBZSxDQUFDLENBQWhCOztJQUNBLElBQUksS0FBS2hCLGFBQVQsRUFBd0I7TUFDcEIsS0FBS0EsYUFBTDtJQUNIOztJQUNELEtBQUtBLGFBQUwsR0FBcUIsSUFBckI7SUFDQSxLQUFLUyxTQUFMOztJQUNBLElBQUksS0FBS25DLGFBQVQsRUFBd0I7TUFDcEIsS0FBS3FDLFVBQUwsQ0FBZ0IsQ0FBQyxDQUFqQjtJQUNIO0VBQ0osQ0FYRDs7RUFZQXpDLENBQUMsQ0FBQ00sU0FBRixDQUFZa0QsUUFBWixHQUF1QixZQUFZO0lBQy9CekQsQ0FBQyxDQUFDTyxTQUFGLENBQVlrRCxRQUFaLENBQXFCaEIsSUFBckIsQ0FBMEIsSUFBMUI7SUFDQSxLQUFLTSxPQUFMLEdBQWUsQ0FBQyxDQUFoQjtJQUNBLEtBQUtXLE9BQUwsR0FBZSxDQUFDLENBQWhCOztJQUNBLElBQUksS0FBS3JELGFBQVQsRUFBd0I7TUFDcEIsS0FBS3FDLFVBQUwsQ0FBZ0IsQ0FBQyxDQUFqQjtJQUNIO0VBQ0osQ0FQRDs7RUFRQSxPQUFPekMsQ0FBUDtBQUNILENBNUtPLENBNEtMUCxPQUFPLENBQUNpRSxNQTVLSCxDQUFSOztBQTZLQUMsT0FBTyxXQUFQLEdBQWtCN0QsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGJhc2VBZCA9IHJlcXVpcmUoXCIuL0Jhc2VBZFwiKTtcclxudmFyIHIgPSB3aW5kb3cucWc7XHJcbnZhciBhID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuc3R5bGUgPSBudWxsO1xyXG4gICAgICAgIGUuaXNPcGVuUHJlTG9hZCA9ICExO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUubG9hZEFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0O1xyXG4gICAgICAgIHZhciBlID0gci5nZXRTeXN0ZW1JbmZvU3luYygpO1xyXG4gICAgICAgIHZhciBpID0gKGUud2luZG93V2lkdGgsIGUud2luZG93SGVpZ2h0KTtcclxuICAgICAgICB0ID1cclxuICAgICAgICAgICAgdGhpcy5zdHlsZSAmJiAhdGhpcy5zdHlsZS5pc0Jhbm5lclxyXG4gICAgICAgICAgICAgICAgPyB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBhZFVuaXRJZDogdGhpcy5hZFVuaXRJZCxcclxuICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogdGhpcy5zdHlsZS5sZWZ0IHx8IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiB0aGlzLnN0eWxlLnRvcCB8fCAwLjQgKiBpXHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgYWRVbml0SWQ6IHRoaXMuYWRVbml0SWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICBzdHlsZToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMuc3R5bGUubGVmdCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogdGhpcy5zdHlsZS50b3AgfHwgTWF0aC5yb3VuZChpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSAhMDtcclxuICAgICAgICB0aGlzLmFkSW5zID0gci5jcmVhdGVDdXN0b21BZCh0KTtcclxuICAgICAgICBpZiAodGhpcy5hZElucy5vbkxvYWQpIHtcclxuICAgICAgICAgICAgdGhpcy5hZElucy5vbkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hZElucy5vbkNsb3NlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMub25DbG9zZSh0aGlzLm9uQ2xvc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hZElucy5vbkhpZGUpIHtcclxuICAgICAgICAgICAgdGhpcy5hZElucy5vbkhpZGUodGhpcy5vbkhpZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hZElucy5vbkVycm9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMub25FcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF1dG9TaG93KCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2hvd0N1c3RvbUFkID0gZnVuY3Rpb24gKGUsIGksIG8sIG4pIHtcclxuICAgICAgICB2YXIgcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zaG93Q2FsbGJhY2sgPSBpO1xyXG4gICAgICAgIHRoaXMuY2xvc2VDYWxsYmFjayA9IG87XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gbjtcclxuICAgICAgICBpZiAodGhpcy5pc0NhblNob3cpIHtcclxuICAgICAgICAgICAgdGhpcy5zdHlsZSA9IGU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0xvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNDb25zdW1lID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMuc2hvdykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHRoaXMuYWRJbnMuc2hvdygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByICYmIHIudGhlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyByXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjdXN0b21BZCBzaG93IHN1Y2Nlc3NcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMuc2hvd0NhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMuc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMuc2hvd0NhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJjdXN0b21BZCBzaG93IGVycm9yOlwiLCBpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJzaG93Q3VzdG9tQWQsIGN1c3RvbUFk5pi+56S65byC5bi4LOaJp+ihjOmHjeaWsOWIm+W7uuW5tuaYvuekulwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnByb3RvdHlwZS5kZXN0cm95QWQuY2FsbChzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnN0eWxlID0gZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnJlQ3JlYXRlQWQoITApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKGNvbnNvbGUud2FybihcInNob3dDdXN0b21BZCwgY3VzdG9tQWTmmL7npLrlvILluLgs5omn6KGM6YeN5paw5Yib5bu65bm25pi+56S6XCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5zdHlsZSA9IGUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlQ3JlYXRlQWQoITApKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLmib7kuI3liLBzaG93XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwic2hvd0N1c3RvbUFkLCBjdXN0b21BZOacquWKoOi9veWujOavlSzmiafooYzph43mlrDliJvlu7rlubbmmL7npLpcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdHlsZSA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCEwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcInNob3dDdXN0b21BZCwgY3VzdG9tQWTlr7nosaHmnKrliJvlu7os5omn6KGM6Ieq5Yqo5Yib5bu65bm25pi+56S6XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZSA9IGU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlQ3JlYXRlQWQoITApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuW9k+WJjeW5v+WRiuemgeatouaYvuekulwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVDcmVhdGVBZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKHQpO1xyXG4gICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9IHQ7XHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGUubG9hZEFkKCk7XHJcbiAgICAgICAgfSwgMTAwKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5mb3JiaWRkZXJBZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdGhpcy5pc0NhblNob3cgPSAhdDtcclxuICAgICAgICBpZiAodCkge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGVBZCghMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmhpZGVBZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdCA/IHRoaXMuZGVzdHJveUFkKCkgOiB0aGlzLnNob3dpbmcgJiYgdGhpcy5hZElucy5oaWRlKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAodm9pZCAwID09PSBlKSB7XHJcbiAgICAgICAgICAgIGUgPSAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdC5wcm90b3R5cGUuZGVzdHJveUFkLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZMb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZDbG9zZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZDbG9zZSh0aGlzLm9uQ2xvc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkhpZGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uSGlkZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmRXJyb3IodGhpcy5vbkVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5kZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFkSW5zID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYXV0b1Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvU2hvdykge1xyXG4gICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaG93Q3VzdG9tQWQodGhpcy5zdHlsZSwgdGhpcy5zaG93Q2FsbGJhY2ssIHRoaXMuY2xvc2VDYWxsYmFjaywgdGhpcy5lcnJvckNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZExvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZExvYWQuY2FsbCh0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRFcnJvci5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZXJyb3JDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZENsb3NlLmNhbGwodGhpcyk7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gITE7XHJcbiAgICAgICAgaWYgKHRoaXMuY2xvc2VDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lBZCgpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzT3BlblByZUxvYWQpIHtcclxuICAgICAgICAgICAgdGhpcy5yZUNyZWF0ZUFkKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZEhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZEhpZGUuY2FsbCh0aGlzKTtcclxuICAgICAgICB0aGlzLnNob3dpbmcgPSAhMTtcclxuICAgICAgICB0aGlzLmhpZGVpbmcgPSAhMTtcclxuICAgICAgICBpZiAodGhpcy5pc09wZW5QcmVMb2FkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVDcmVhdGVBZCghMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBlO1xyXG59KSgkYmFzZUFkLkJhc2VBZCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGE7XHJcbiJdfQ==