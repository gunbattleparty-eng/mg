{"version":3,"sources":["assets\\game_script\\scripts\\TTNewRecordingBtnView.js"],"names":["o","$uIManager","require","$platform","$aD","$aDConfig","u","cc","_decorator","d","ccclass","p","property","f","t","e","apply","arguments","startRecordNode","recordingNode","shardRecordNode","__extends","prototype","start","node","active","Platform","currPlatForm","PlatformEnum","TOU_TIAO","on","ttStartRecord","ttEndRecord","ttshareRecor","onDestroy","off","toutiao","stopRecorder","console","log","startRecorder","autoStop","i","UIManager","instance","showToast","getRecordVideoPath","share","share_title","ADConfig","tt","share_desc","share_imageUrl","videoPath","success","unschedule","scheduleOnce","__decorate","Node","Component","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $uIManager = require(\"./UIManager\");\r\nvar $platform = require(\"./Platform\");\r\nvar $aD = require(\"./AD\");\r\nvar $aDConfig = require(\"./ADConfig\");\r\nvar u = cc._decorator;\r\nvar d = u.ccclass;\r\nvar p = u.property;\r\nvar f = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.startRecordNode = null;\r\n        e.recordingNode = null;\r\n        e.shardRecordNode = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.start = function () {\r\n        this.node.active = !1;\r\n        if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {\r\n            this.node.active = !0;\r\n            this.startRecordNode.active = !0;\r\n            this.startRecordNode.on(\"click\", this.ttStartRecord, this);\r\n            this.recordingNode.on(\"click\", this.ttEndRecord, this);\r\n            this.shardRecordNode.on(\"click\", this.ttshareRecor, this);\r\n        }\r\n    };\r\n    e.prototype.onDestroy = function () {\r\n        this.startRecordNode.off(\"click\", this.ttStartRecord, this);\r\n        this.recordingNode.off(\"click\", this.ttEndRecord, this);\r\n        this.shardRecordNode.off(\"click\", this.ttshareRecor, this);\r\n        if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {\r\n            $aD.default.toutiao.stopRecorder();\r\n        }\r\n    };\r\n    e.prototype.ttStartRecord = function () {\r\n        console.log(\"=============录屏开始==============\");\r\n        $aD.default.toutiao.startRecorder();\r\n        this.recordingNode.active = !0;\r\n        this.startRecordNode.active = !1;\r\n        this.autoStop();\r\n    };\r\n    e.prototype.ttEndRecord = function () {\r\n        var t = this;\r\n        console.log(\"=============停止录屏==============\");\r\n        this.autoStop();\r\n        this.startRecordNode.active = !1;\r\n        $aD.default.toutiao.stopRecorder(function (e, i) {\r\n            t.recordingNode.active = !1;\r\n            i <= 3e3\r\n                ? ($uIManager.UIManager.instance.showToast(\"录屏失败：录屏时长低于 3 秒\"),\r\n                  (t.startRecordNode.active = !0))\r\n                : (t.shardRecordNode.active = !0);\r\n        });\r\n    };\r\n    e.prototype.ttshareRecor = function () {\r\n        console.log(\"=============点击分享==============\");\r\n        var t = $aD.default.toutiao.getRecordVideoPath();\r\n        if (\"\" === t) {\r\n            $uIManager.UIManager.instance.showToast(\"录屏失败：录屏时长低于 3 秒\");\r\n            this.startRecordNode.active = !0;\r\n            return void (this.shardRecordNode.active = !1);\r\n        }\r\n        $aD.default.toutiao.share({\r\n            share_title: $aDConfig.ADConfig.tt.share_title,\r\n            share_desc: $aDConfig.ADConfig.tt.share_desc,\r\n            share_imageUrl: $aDConfig.ADConfig.tt.share_desc,\r\n            videoPath: t,\r\n            success: function () {}\r\n        });\r\n        this.shardRecordNode.active = !1;\r\n        this.startRecordNode.active = !0;\r\n    };\r\n    e.prototype.autoStop = function () {\r\n        var t = this;\r\n        this.unschedule(this.autoStop);\r\n        this.scheduleOnce(function () {\r\n            $uIManager.UIManager.instance.showToast(\"录屏超过300秒,自动暂停\");\r\n            t.ttEndRecord();\r\n        }, 299);\r\n    };\r\n    __decorate([p(cc.Node)], e.prototype, \"startRecordNode\", void 0);\r\n    __decorate([p(cc.Node)], e.prototype, \"recordingNode\", void 0);\r\n    __decorate([p(cc.Node)], e.prototype, \"shardRecordNode\", void 0);\r\n    return __decorate([d], e);\r\n})(cc.Component);\r\nexports.default = f;\r\n"]}