{"version":3,"sources":["assets\\game_script\\scripts\\RBullet_2_1.js"],"names":["o","$object","require","$util","$gameContext","$baseBullet","u","cc","_decorator","d","ccclass","p","property","t","e","apply","arguments","buttleType","BulletType","r_bullet_2","atkAnim","bulletSpeed","time","targetNode","targetPos","initPos","status","dir","__extends","prototype","initRBullet","i","n","s","r","node","position","clone","getPosition","initButtle","call","getComponentInChildren","Animation","atk","setScale","v3","a","sub","x","mag","tween","to","start","onTrigger","isUse","Trigger","enter","object","sufferAtk","skillSpecialitys","updateFrame","isValid","ins","getRangeRandomEnemyLayerByPos","y","speed","magSqr","velocity","Vec3","ZERO","trigger","active","play","once","EventType","FINISHED","normalize","set","multiplyScalar","removeSelf","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $util = require(\"./Util\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar u = cc._decorator;\r\nvar d = u.ccclass;\r\nvar p =\r\n    (u.property,\r\n    (function (t) {\r\n        function e() {\r\n            var e = (null !== t && t.apply(this, arguments)) || this;\r\n            e.buttleType = $baseBullet.BulletType.r_bullet_2;\r\n            e.atkAnim = null;\r\n            e.bulletSpeed = 800;\r\n            e.time = 0;\r\n            e.targetNode = null;\r\n            e.targetPos = null;\r\n            e.initPos = null;\r\n            e.status = 0;\r\n            e.dir = null;\r\n            return e;\r\n        }\r\n        __extends(e, t);\r\n        e.prototype.initRBullet = function (e, i, o, n, s) {\r\n            var r = this;\r\n            this.initPos = this.node.position.clone();\r\n            this.targetNode = e;\r\n            this.targetPos = this.targetNode.getPosition().clone();\r\n            this.time = s;\r\n            t.prototype.initButtle.call(this, null, null);\r\n            this.bulletSpeed = n;\r\n            this.atkAnim = this.node.getComponentInChildren(cc.Animation);\r\n            this.atk = i;\r\n            this.setScale(cc.v3(o, o));\r\n            this.status = 0;\r\n            var a = this.node.position.sub(cc.v3(this.targetPos.x, -410)).mag() / this.bulletSpeed;\r\n            cc.tween(this.node)\r\n                .to(a, {\r\n                    position: cc.v3(this.targetPos.x, -410)\r\n                })\r\n                .call(function () {\r\n                    r.status = 2;\r\n                })\r\n                .start();\r\n        };\r\n        e.prototype.onTrigger = function (t, e) {\r\n            if (!this.isUse) {\r\n                if (e == $object.Trigger.enter) {\r\n                    t.object.sufferAtk({\r\n                        skillSpecialitys: [],\r\n                        atk: this.atk\r\n                    });\r\n                }\r\n            }\r\n        };\r\n        e.prototype.updateFrame = function (e) {\r\n            var i = this;\r\n            t.prototype.updateFrame.call(this, e);\r\n            if (this.time > 0) {\r\n                this.time -= e;\r\n                if (this.time <= 0 && 2 === this.status) {\r\n                    this.status = 4;\r\n                }\r\n            }\r\n            if (2 === this.status) {\r\n                if (\r\n                    !(\r\n                        (this.targetNode && $util.default.isValid(this.targetNode.node)) ||\r\n                        ((this.targetNode = $gameContext.default.ins.getRangeRandomEnemyLayerByPos(\r\n                            this.targetPos,\r\n                            900\r\n                        )),\r\n                        this.targetNode)\r\n                    )\r\n                ) {\r\n                    return void (this.status = 4);\r\n                }\r\n                this.targetPos.x = this.targetNode.node.x;\r\n                this.targetPos.y = this.targetNode.node.y;\r\n                if (0 === this.speed) {\r\n                    this.speed = this.bulletSpeed;\r\n                }\r\n                this.dir = this.targetPos.sub(this.getPosition());\r\n                this.dir.magSqr() <= 2500\r\n                    ? ((this.velocity = cc.Vec3.ZERO),\r\n                      (this.status = 3),\r\n                      (this.trigger = !0),\r\n                      (this.atkAnim.node.active = !0),\r\n                      this.atkAnim.play(\"rbullet_2\"),\r\n                      this.atkAnim.once(\r\n                          cc.Animation.EventType.FINISHED,\r\n                          function () {\r\n                              i.atkAnim.node.active = !1;\r\n                              i.trigger = !1;\r\n                              i.dir = i.initPos.sub(i.getPosition()).normalize();\r\n                              i.velocity.set(i.dir.normalize()).multiplyScalar(i.speed);\r\n                              i.status = 4;\r\n                          },\r\n                          this\r\n                      ))\r\n                    : this.velocity.set(this.dir.normalize()).multiplyScalar(this.speed);\r\n            }\r\n            if (4 === this.status && this.initPos.sub(this.getPosition()).magSqr() <= 2500) {\r\n                this.status = 5;\r\n                this.removeSelf();\r\n            }\r\n        };\r\n        return __decorate([d], e);\r\n    })($baseBullet.default));\r\nexports.default = p;\r\n"]}