{"version":3,"sources":["assets\\game_script\\scripts\\RGun_2.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$configContext","$globalParam","$baseBullet","$gameContext","$gameSkillInfo","f","t","e","i","call","atk","cd","range","bulletCount","config","instance","robotConfigs","find","id","Petsskin_skill_value","timeLeft","__extends","prototype","updateF","isAttacking","isGamePuase","startGun","ins","getNearbyN2","pointNode","length","node","position","sub","magSqr","skillParam","skillInfo","getSkillById","Math","ceil","skillAtk","Skill4Param","FINAL","createButtle","schedulesOnce","getButtlePool","BulletType","r_bullet_2","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","RBullet_2","ResUtil","instantiate","buttleLayer","parent","getComponent","convertToNodeSpaceAR","convertToWorldSpaceAR","cc","Vec3","ZERO","setPosition","initRBullet","insert","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar f = (function (t) {\r\n    function e(e) {\r\n        var i = t.call(this, e) || this;\r\n        i.atk = 0;\r\n        i.cd = 0;\r\n        i.range = 0;\r\n        i.bulletCount = 2;\r\n        i.config = null;\r\n        i.config = $configContext.default.instance.robotConfigs.find(function (t) {\r\n            return 3 === t.id;\r\n        });\r\n        i.cd = i.config.Petsskin_skill_value[1];\r\n        i.range = i.config.Petsskin_skill_value[2];\r\n        i.timeLeft = 0;\r\n        return i;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.updateF = function (e) {\r\n        t.prototype.updateF.call(this, e);\r\n        if (!(this.isAttacking || $globalParam.default.isGamePuase)) {\r\n            this.timeLeft -= e;\r\n            if (this.timeLeft <= 0) {\r\n                this.startGun();\r\n            }\r\n        }\r\n    };\r\n    e.prototype.startGun = function () {\r\n        var t = this;\r\n        var e = $gameContext.default.ins.getNearbyN2(this.pointNode, this.bulletCount);\r\n        if (e.length <= 0 || e[0].node.position.sub(this.pointNode.position).magSqr() >= this.range * this.range) {\r\n            this.timeLeft = 1;\r\n            return !1;\r\n        }\r\n        if (!this.skillParam) {\r\n            this.skillParam = $gameContext.default.ins.skillInfo.getSkillById(1);\r\n        }\r\n        this.atk = Math.ceil(\r\n            this.config.Petsskin_skill_value[0] * this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL]\r\n        );\r\n        this.isAttacking = !0;\r\n        for (var i = 0; i < this.bulletCount; i++) {\r\n            if (e[i]) {\r\n                this.createButtle(e[i]);\r\n            }\r\n        }\r\n        this.schedulesOnce(function () {\r\n            t.isAttacking = !1;\r\n            t.timeLeft = t.cd;\r\n        }, 0);\r\n    };\r\n    e.prototype.createButtle = function (t) {\r\n        var e = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.r_bullet_2);\r\n        if (!e) {\r\n            var i = $assetsLoader.default.instance.getRes(\r\n                $assetsMap.BundleNames.Game,\r\n                $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.RBullet_2\r\n            );\r\n            e = $resUtil.ResUtil.instantiate(i, $gameContext.default.ins.buttleLayer.parent).getComponent(\r\n                $baseBullet.default\r\n            );\r\n        }\r\n        var o = $gameContext.default.ins.buttleLayer.convertToNodeSpaceAR(\r\n            this.pointNode.convertToWorldSpaceAR(cc.Vec3.ZERO)\r\n        );\r\n        e.setPosition(o);\r\n        e.initRBullet(\r\n            t,\r\n            this.atk,\r\n            this.config.Petsskin_skill_value[4],\r\n            this.config.Petsskin_skill_value[5],\r\n            this.config.Petsskin_skill_value[3]\r\n        );\r\n        e.insert($gameContext.default.ins.buttleLayer);\r\n    };\r\n    return e;\r\n})(require(\"./BaseGun\").default);\r\nexports.default = f;\r\n"]}