{"version":3,"sources":["assets\\game_script\\scripts\\AdSwitch.js"],"names":["exports","AdSwitch","AdTypeCode","o","n","$platform","require","$aDConfig","VIDEO","BANNER","INTERSTITIAL","NATIVE_CUSTOM_ICON","NATIVE_CUSTOM_PATCH","a","t","path","localPath","localInfo","switchParam","currVersion","prototype","initOpen","e","i","Date","getTime","s","loadNetResArray","then","fly","get","baseURL","console","log","error","initAd","city","replace","blacklist","includes","switchStatus","getDetailConfig","checkSwitch","adParam","checkSwitchAll","l","Platform","currPlatForm","PlatformEnum","VIVO","ADConfig","vivo","rewarded_video_id","banner_id","native_ad_ids","switchVersion","saDetailConfigParams","find","saTypeId","length","push","url","Promise","cc","assetManager","loadAny","instance"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.AdSwitch = exports.AdTypeCode = void 0;\r\nvar o;\r\nvar n;\r\nvar $platform = require(\"./Platform\");\r\nvar $aDConfig = require(\"./ADConfig\");\r\n(n = o = exports.AdTypeCode || (exports.AdTypeCode = {}))[(n.VIDEO = 1)] = \"VIDEO\";\r\nn[(n.BANNER = 2)] = \"BANNER\";\r\nn[(n.INTERSTITIAL = 3)] = \"INTERSTITIAL\";\r\nn[(n.NATIVE_CUSTOM_ICON = 19)] = \"NATIVE_CUSTOM_ICON\";\r\nn[(n.NATIVE_CUSTOM_PATCH = 18)] = \"NATIVE_CUSTOM_PATCH\";\r\nvar a = (function () {\r\n    function t() {\r\n        this.path = \"https://cooperation.sjyywy.com/web2/glob_ad_config/local\";\r\n        this.localPath = \"https://backend.pailedi.com/index.php/getClientAddress\";\r\n        this.localInfo = null;\r\n        this.switchParam = null;\r\n        this.currVersion = 0;\r\n    }\r\n    t.prototype.initOpen = function (t, e) {\r\n        var i = this;\r\n        this.currVersion = e;\r\n        var o = \"/ad_\" + t + \".json\";\r\n        var n = new Date().getTime();\r\n        var s = [this.path + o + \"?sign=\" + n];\r\n        this.loadNetResArray(s, null).then(function (t) {\r\n            i.switchParam = t;\r\n            try {\r\n                fly.get(i.localPath, null, {\r\n                    baseURL: \"\"\r\n                }).then(function (t) {\r\n                    i.localInfo = t;\r\n                    console.log(i.localInfo, \"==============\");\r\n                });\r\n            } catch (t) {\r\n                console.error(t);\r\n            }\r\n        });\r\n    };\r\n    t.prototype.initAd = function () {\r\n        if (this.localInfo && this.localInfo.city) {\r\n            this.localInfo.city = this.localInfo.city.replace(\"å¸‚\", \"\");\r\n            if (this.switchParam.blacklist.includes(this.localInfo.city)) {\r\n                this.switchParam.switchStatus = 1;\r\n            }\r\n        }\r\n        var t = this.getDetailConfig(o.VIDEO);\r\n        var e = this.getDetailConfig(o.BANNER);\r\n        var i = this.getDetailConfig(o.INTERSTITIAL);\r\n        var n = this.checkSwitch(t.switchStatus) ? t.adParam : \"\";\r\n        var a = this.checkSwitchAll(e) ? e.adParam : \"\";\r\n        var l = this.checkSwitchAll(e) ? i.adParam : \"\";\r\n        if ($platform.Platform.currPlatForm === $platform.PlatformEnum.VIVO) {\r\n            $aDConfig.ADConfig.vivo.rewarded_video_id = n;\r\n            $aDConfig.ADConfig.vivo.banner_id = a;\r\n            $aDConfig.ADConfig.vivo.native_ad_ids = \"\" === l ? [] : [l];\r\n        }\r\n    };\r\n    t.prototype.checkSwitchAll = function (t) {\r\n        if (this.switchParam.switchVersion < this.currVersion) {\r\n            return !1;\r\n        }\r\n        var e = this.checkSwitch(this.switchParam.switchStatus);\r\n        var i = this.checkSwitch(t.switchStatus);\r\n        return !(!e || !i);\r\n    };\r\n    t.prototype.checkSwitch = function (t) {\r\n        return 0 === t;\r\n    };\r\n    t.prototype.getDetailConfig = function (t) {\r\n        return this.switchParam.saDetailConfigParams.find(function (e) {\r\n            return e.saTypeId === t;\r\n        });\r\n    };\r\n    t.prototype.loadNetResArray = function (t, e) {\r\n        var i = [];\r\n        for (var o = 0; o < t.length; o++) {\r\n            i.push({\r\n                url: t[o]\r\n            });\r\n        }\r\n        return new Promise(function (t, o) {\r\n            cc.assetManager.loadAny(\r\n                i,\r\n                function (t, i) {\r\n                    if (e) {\r\n                        e(t, i);\r\n                    }\r\n                },\r\n                function (e, i) {\r\n                    e ? o(e) : t(i);\r\n                }\r\n            );\r\n        });\r\n    };\r\n    t.instance = new t();\r\n    return t;\r\n})();\r\nexports.AdSwitch = a;\r\n"]}