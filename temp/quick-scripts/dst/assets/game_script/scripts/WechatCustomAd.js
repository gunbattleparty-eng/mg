
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/WechatCustomAd.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e31b9IYejBATIWOsOUxqJWO', 'WechatCustomAd');
// game_script/scripts/WechatCustomAd.js

"use strict";

var o;

var $baseAd = require("./BaseAd");

var r = window.wx;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.isOpenPreLoad = !1;
    e.style = null;
    return e;
  }

  __extends(e, t);

  e.prototype.setOpenPreLoadCustomAd = function (t) {
    this.isOpenPreLoad = !0;
    this.style = t;
  };

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (r && r.createCustomAd) {
        var t = {
          adUnitId: this.adUnitId,
          adIntervals: 0,
          style: {
            left: this.style.left || 0,
            top: this.style.top || 0,
            width: this.style.width || null,
            fixed: !0
          }
        };
        this.adIns = r.createCustomAd(t);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onClose) {
          this.adIns.onClose(this.onClose);
        }

        if (this.adIns.onHide) {
          this.adIns.onHide(this.onHide);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }
      } else {
        console.warn("当前平台不支持创建customAd");
      }
    } else {
      console.error("Customer ID为空");
    }
  };

  e.prototype.showCustomAd = function (t, e, i, o) {
    var n = this;
    this.showCallback = e;
    this.closeCallback = i;
    this.errorCallback = o;
    this.style = t;

    if (this.isCanShow) {
      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        return void this.loadAd();
      }

      if (this.hideing || !this.isLoaded) {
        console.warn(this.adUnitId, ":正在隐藏或加载中，稍等");
        return void (this.isAutoShow = !0);
      }

      this.showing = !1;
      this.isConsume = !0;

      if (this.adIns.show) {
        var s = this.adIns.show();
        s && s.then ? s.then(function () {
          n.showing = !0;

          if (n.showCallback) {
            n.showCallback();
          }

          n.showCallback = null;
        })["catch"](function (t) {
          console.warn(n.adUnitId, ":show错误，重新加载", t);
          n.reCreateAd(!0);
        }) : (console.warn(this.adUnitId, ":show显示失败，重新加载"), this.reCreateAd(!0));
      } else {
        console.error(this.adUnitId, ":未知错误");
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示", this.isCanShow);
    }
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offHide) {
        this.adIns.offLoad(this.onHide);
      }

      if (this.adIns.offClose) {
        this.adIns.offClose(this.onClose);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showCustomAd(this.style, this.showCallback, this.closeCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function (e) {
    t.prototype.onAdLoad.call(this, e);
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (t) {
    console.log("原生模板onAdError", this.adUnitId, t);
    this.showing = !1;

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdClose = function () {
    console.log(":===onAdClose===");
    this.showing = !1;

    if (this.closeCallback) {
      this.closeCallback();
    }
  };

  e.prototype.onAdHide = function () {
    console.log(":===onAdHide===");
    this.showing = !1;
    this.hideing = !1;

    if (this.closeCallback) {
      this.closeCallback();
    }
  };

  return e;
}($baseAd.BaseAd);

exports["default"] = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFdlY2hhdEN1c3RvbUFkLmpzIl0sIm5hbWVzIjpbIm8iLCIkYmFzZUFkIiwicmVxdWlyZSIsInIiLCJ3aW5kb3ciLCJ3eCIsImEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiaXNPcGVuUHJlTG9hZCIsInN0eWxlIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwic2V0T3BlblByZUxvYWRDdXN0b21BZCIsImxvYWRBZCIsImFkVW5pdElkIiwiY3JlYXRlQ3VzdG9tQWQiLCJhZEludGVydmFscyIsImxlZnQiLCJ0b3AiLCJ3aWR0aCIsImZpeGVkIiwiYWRJbnMiLCJvbkxvYWQiLCJvbkNsb3NlIiwib25IaWRlIiwib25FcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJzaG93Q3VzdG9tQWQiLCJpIiwibiIsInNob3dDYWxsYmFjayIsImNsb3NlQ2FsbGJhY2siLCJlcnJvckNhbGxiYWNrIiwiaXNDYW5TaG93IiwiaXNBdXRvU2hvdyIsImhpZGVpbmciLCJpc0xvYWRlZCIsInNob3dpbmciLCJpc0NvbnN1bWUiLCJzaG93IiwicyIsInRoZW4iLCJyZUNyZWF0ZUFkIiwiZGVzdHJveUFkIiwiY2FsbCIsIm9mZkxvYWQiLCJvZmZIaWRlIiwib2ZmQ2xvc2UiLCJvZmZFcnJvciIsImRlc3Ryb3kiLCJhdXRvU2hvdyIsIm9uQWRMb2FkIiwib25BZEVycm9yIiwibG9nIiwib25BZENsb3NlIiwib25BZEhpZGUiLCJCYXNlQWQiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1BQU0sQ0FBQ0MsRUFBZjs7QUFDQSxJQUFJQyxDQUFDLEdBQUksVUFBVUMsQ0FBVixFQUFhO0VBQ2xCLFNBQVNDLENBQVQsR0FBYTtJQUNULElB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QTBCLElBQTFCLEVBQWdDekMsQ0FBaEM7SUFDQSxLQUFLbUMsU0FBTCxHQUFpQixDQUFDLENBQWxCO0lBQ0EsS0FBS0YsUUFBTCxHQUFnQixDQUFDLENBQWpCO0lBQ0EsS0FBS2MsUUFBTDtFQUNILENBTEQ7O0VBTUEvQyxDQUFDLENBQUNNLFNBQUYsQ0FBWTJDLFNBQVosR0FBd0IsVUFBVWxELENBQVYsRUFBYTtJQUNqQ3NCLE9BQU8sQ0FBQzZCLEdBQVIsQ0FBWSxlQUFaLEVBQTZCLEtBQUt6QyxRQUFsQyxFQUE0Q1YsQ0FBNUM7SUFDQSxLQUFLbUMsT0FBTCxHQUFlLENBQUMsQ0FBaEI7O0lBQ0EsSUFBSSxLQUFLTCxhQUFULEVBQXdCO01BQ3BCLEtBQUtBLGFBQUw7SUFDSDs7SUFDRCxLQUFLVyxTQUFMO0VBQ0gsQ0FQRDs7RUFRQXhDLENBQUMsQ0FBQ00sU0FBRixDQUFZNkMsU0FBWixHQUF3QixZQUFZO0lBQ2hDOUIsT0FBTyxDQUFDNkIsR0FBUixDQUFZLGtCQUFaO0lBQ0EsS0FBS2hCLE9BQUwsR0FBZSxDQUFDLENBQWhCOztJQUNBLElBQUksS0FBS04sYUFBVCxFQUF3QjtNQUNwQixLQUFLQSxhQUFMO0lBQ0g7RUFDSixDQU5EOztFQU9BNUIsQ0FBQyxDQUFDTSxTQUFGLENBQVk4QyxRQUFaLEdBQXVCLFlBQVk7SUFDL0IvQixPQUFPLENBQUM2QixHQUFSLENBQVksaUJBQVo7SUFDQSxLQUFLaEIsT0FBTCxHQUFlLENBQUMsQ0FBaEI7SUFDQSxLQUFLRixPQUFMLEdBQWUsQ0FBQyxDQUFoQjs7SUFDQSxJQUFJLEtBQUtKLGFBQVQsRUFBd0I7TUFDcEIsS0FBS0EsYUFBTDtJQUNIO0VBQ0osQ0FQRDs7RUFRQSxPQUFPNUIsQ0FBUDtBQUNILENBL0lPLENBK0lMUCxPQUFPLENBQUM0RCxNQS9JSCxDQUFSOztBQWdKQUMsT0FBTyxXQUFQLEdBQWtCeEQsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGJhc2VBZCA9IHJlcXVpcmUoXCIuL0Jhc2VBZFwiKTtcclxudmFyIHIgPSB3aW5kb3cud3g7XHJcbnZhciBhID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuaXNPcGVuUHJlTG9hZCA9ICExO1xyXG4gICAgICAgIGUuc3R5bGUgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUuc2V0T3BlblByZUxvYWRDdXN0b21BZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdGhpcy5pc09wZW5QcmVMb2FkID0gITA7XHJcbiAgICAgICAgdGhpcy5zdHlsZSA9IHQ7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUubG9hZEFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmFkVW5pdElkKSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmIHIuY3JlYXRlQ3VzdG9tQWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkVW5pdElkOiB0aGlzLmFkVW5pdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIGFkSW50ZXJ2YWxzOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHRoaXMuc3R5bGUubGVmdCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHRoaXMuc3R5bGUudG9wIHx8IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLnN0eWxlLndpZHRoIHx8IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpeGVkOiAhMFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zID0gci5jcmVhdGVDdXN0b21BZCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25Mb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uQ2xvc2UodGhpcy5vbkNsb3NlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uSGlkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25IaWRlKHRoaXMub25IaWRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uRXJyb3IodGhpcy5vbkVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIuW9k+WJjeW5s+WPsOS4jeaUr+aMgeWIm+W7umN1c3RvbUFkXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkN1c3RvbWVyIElE5Li656m6XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zaG93Q3VzdG9tQWQgPSBmdW5jdGlvbiAodCwgZSwgaSwgbykge1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrID0gaTtcclxuICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2sgPSBvO1xyXG4gICAgICAgIHRoaXMuc3R5bGUgPSB0O1xyXG4gICAgICAgIGlmICh0aGlzLmlzQ2FuU2hvdykge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliJvlu7rvvIzmiafooYzliJvlu7pcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMDtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMubG9hZEFkKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuaGlkZWluZyB8fCAhdGhpcy5pc0xvYWRlZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuato+WcqOmakOiXj+aIluWKoOi9veS4re+8jOeojeetiVwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zaG93aW5nID0gITE7XHJcbiAgICAgICAgICAgIHRoaXMuaXNDb25zdW1lID0gITA7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLnNob3cpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzID0gdGhpcy5hZElucy5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBzICYmIHMudGhlblxyXG4gICAgICAgICAgICAgICAgICAgID8gc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5zaG93aW5nID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLnNob3dDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5zaG93Q2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNob3dDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKG4uYWRVbml0SWQsIFwiOnNob3fplJnor6/vvIzph43mlrDliqDovb1cIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4ucmVDcmVhdGVBZCghMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI6c2hvd+aYvuekuuWksei0pe+8jOmHjeaWsOWKoOi9vVwiKSwgdGhpcy5yZUNyZWF0ZUFkKCEwKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMuYWRVbml0SWQsIFwiOuacquefpemUmeivr1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrlvZPliY3lub/lkYrnpoHmraLmmL7npLpcIiwgdGhpcy5pc0NhblNob3cpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5kZXN0cm95QWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUuZGVzdHJveUFkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZMb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZIaWRlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZkxvYWQodGhpcy5vbkhpZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkNsb3NlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZkNsb3NlKHRoaXMub25DbG9zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmRXJyb3IodGhpcy5vbkVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5kZXN0cm95KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFkSW5zID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYXV0b1Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvU2hvdykge1xyXG4gICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaG93Q3VzdG9tQWQodGhpcy5zdHlsZSwgdGhpcy5zaG93Q2FsbGJhY2ssIHRoaXMuY2xvc2VDYWxsYmFjaywgdGhpcy5lcnJvckNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZExvYWQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRMb2FkLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgdGhpcy5pc0NvbnN1bWUgPSAhMTtcclxuICAgICAgICB0aGlzLmlzTG9hZGVkID0gITA7XHJcbiAgICAgICAgdGhpcy5hdXRvU2hvdygpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRFcnJvciA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCLljp/nlJ/mqKHmnb9vbkFkRXJyb3JcIiwgdGhpcy5hZFVuaXRJZCwgdCk7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gITE7XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3JDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkQ2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCI6PT09b25BZENsb3NlPT09XCIpO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmNsb3NlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRIaWRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiOj09PW9uQWRIaWRlPT09XCIpO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9ICExO1xyXG4gICAgICAgIHRoaXMuaGlkZWluZyA9ICExO1xyXG4gICAgICAgIGlmICh0aGlzLmNsb3NlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBlO1xyXG59KSgkYmFzZUFkLkJhc2VBZCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGE7XHJcbiJdfQ==