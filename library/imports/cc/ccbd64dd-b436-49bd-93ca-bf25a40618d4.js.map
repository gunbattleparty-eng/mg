{"version":3,"sources":["assets\\scripts\\core\\ApiClient.js"],"names":["Config","require","Storage","withTimeout","p","ms","Promise","resolve","reject","t","setTimeout","Error","then","v","clearTimeout","e","request","path","method","data","headers","url","API_BASE","replace","token","getToken","opts","Object","assign","body","JSON","stringify","fetch","REQ_TIMEOUT","res","ok","status","text","json","module","exports","get","post","d"],"mappings":";;;;;;+CACA;;;;;;;;AADA,IAAMA,MAAM,GAAIC,OAAO,CAAC,UAAD,CAAvB;;AACA,IAAMC,OAAO,GAAGD,OAAO,CAAC,WAAD,CAAvB;;AAEA,SAASE,WAAT,CAAqBC,CAArB,EAAwBC,EAAxB,EAA2B;EACzB,OAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAkB;IACnC,IAAMC,CAAC,GAAGC,UAAU,CAAC;MAAA,OAAIF,MAAM,CAAC,IAAIG,KAAJ,CAAU,SAAV,CAAD,CAAV;IAAA,CAAD,EAAmCN,EAAnC,CAApB;IACAD,CAAC,CAACQ,IAAF,CAAO,UAAAC,CAAC,EAAE;MAACC,YAAY,CAACL,CAAD,CAAZ;MAAgBF,OAAO,CAACM,CAAD,CAAP;IAAY,CAAvC,EAAwC,UAAAE,CAAC,EAAE;MAACD,YAAY,CAACL,CAAD,CAAZ;MAAgBD,MAAM,CAACO,CAAD,CAAN;IAAW,CAAvE;EACD,CAHM,CAAP;AAID;;SAEcC;;;;;wEAAf,iBAAuBC,IAAvB;IAAA;;IAAA;MAAA;QAAA;UAAA;YAAA,0BAAqE,EAArE,6BAA8BC,MAA9B,EAA8BA,MAA9B,4BAAqC,KAArC,iCAA4CC,IAA5C,EAA4CA,IAA5C,0BAAiD,IAAjD,kCAAuDC,OAAvD,EAAuDA,OAAvD,6BAA+D,EAA/D;YACQC,GADR,GACcrB,MAAM,CAACsB,QAAP,GAAkBL,IAAI,CAACM,OAAL,CAAa,MAAb,EAAqB,EAArB,CADhC;YAEQC,KAFR,GAEgBtB,OAAO,CAACuB,QAAR,EAFhB;YAGQC,IAHR,GAGe;cACXR,MAAM,EAANA,MADW;cAEXE,OAAO,EAAEO,MAAM,CAACC,MAAP;gBACP,gBAAgB,kBADT;gBAEP,UAAU;cAFH,GAGHJ,KAAK,GAAG;gBAAC,iBAAiB,YAAUA;cAA5B,CAAH,GAAwC,EAH1C,GAINJ,OAJM;YAFE,CAHf;YAWE,IAAID,IAAJ,EAAUO,IAAI,CAACG,IAAL,GAAYC,IAAI,CAACC,SAAL,CAAeZ,IAAf,CAAZ;YAXZ;YAAA,OAYoBhB,WAAW,CAAC6B,KAAK,CAACX,GAAD,EAAMK,IAAN,CAAN,EAAmB1B,MAAM,CAACiC,WAA1B,CAZ/B;;UAAA;YAYQC,GAZR;;YAAA,IAaOA,GAAG,CAACC,EAbX;cAAA;cAAA;YAAA;;YAAA,cAayBxB,KAbzB;YAAA,wBAauCuB,GAAG,CAACE,MAb3C;YAAA;YAAA,OAa4DF,GAAG,CAACG,IAAJ,YAAiB;cAAA,OAAK,EAAL;YAAA,CAAjB,CAb5D;;UAAA;YAAA;YAAA;YAAA;;UAAA;YAAA,iCAcSH,GAAG,CAACI,IAAJ,EAdT;;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA;;;;AAiBAC,MAAM,CAACC,OAAP,GAAiB;EACfC,GAAG,EAAG,aAACrC,CAAD;IAAA,OAAKY,OAAO,CAACZ,CAAD,EAAG;MAACc,MAAM,EAAC;IAAR,CAAH,CAAZ;EAAA,CADS;EAEfwB,IAAI,EAAE,cAACtC,CAAD,EAAGuC,CAAH;IAAA,OAAO3B,OAAO,CAACZ,CAAD,EAAG;MAACc,MAAM,EAAC,MAAR;MAAgBC,IAAI,EAACwB;IAArB,CAAH,CAAd;EAAA;AAFS,CAAjB","sourceRoot":"/","sourcesContent":["const Config  = require('./Config');\nconst Storage = require('./Storage');\n\nfunction withTimeout(p, ms){\n  return new Promise((resolve,reject)=>{\n    const t = setTimeout(()=>reject(new Error('timeout')), ms);\n    p.then(v=>{clearTimeout(t);resolve(v);},e=>{clearTimeout(t);reject(e);});\n  });\n}\n\nasync function request(path, {method='GET', data=null, headers={}} = {}){\n  const url = Config.API_BASE + path.replace(/^\\/+/, '');\n  const token = Storage.getToken();\n  const opts = {\n    method,\n    headers: Object.assign({\n      'Content-Type': 'application/json',\n      'Accept': 'application/json',\n      ...(token ? {'Authorization': 'Bearer '+token} : {})\n    }, headers)\n  };\n  if (data) opts.body = JSON.stringify(data);\n  const res = await withTimeout(fetch(url, opts), Config.REQ_TIMEOUT);\n  if (!res.ok) throw new Error(`HTTP ${res.status}: ${await res.text().catch(()=> '')}`);\n  return res.json();\n}\n\nmodule.exports = {\n  get:  (p)=>request(p,{method:'GET'}),\n  post: (p,d)=>request(p,{method:'POST', data:d}),\n};\n"]}