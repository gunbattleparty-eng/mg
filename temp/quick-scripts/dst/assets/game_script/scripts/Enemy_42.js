
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Enemy_42.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '8e0fbM7+XxAcL80cHVqvPr/', 'Enemy_42');
// game_script/scripts/Enemy_42.js

"use strict";

var o;

var $configContext = require("./ConfigContext");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $baseEnemy = require("./BaseEnemy");

var $enemyStatus = require("./EnemyStatus");

var $healthBar = require("./HealthBar");

var p = cc._decorator;
var f = p.ccclass;
var h = p.property;

var m = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.healthBar = null;
    e.flyTime = 0.5;
    e.timeLeft = 0;
    e.scaleRatio = 0.5;
    e.isFly = !1;
    e.immunity = [$enemyStatus.EnemyDebuffType.FREEZE, $enemyStatus.EnemyDebuffType.PARALYSIS, $enemyStatus.EnemyDebuffType.SLOW,, $enemyStatus.EnemyDebuffType.STUN];
    return e;
  }

  __extends(e, t);

  e.prototype.initEnemy = function (e, i, o) {
    if (void 0 === o) {
      o = 0;
    }

    t.prototype.initEnemy.call(this, e, i, o);
    this.statusManager.specialityAtkAdd.set($baseBullet.BulletSpeciality.wind, this.config.value[0]);

    if (this.healthBar) {
      this.healthBar.init(this.statusManager.hp, e.hp_num);
    }

    this.timeLeft = 0;
    this.isFly = !0;
    var n = null;
    42 === e.id ? n = $configContext["default"].instance.getEnemyConfig(38) : 43 === e.id && (n = $configContext["default"].instance.getEnemyConfig(39));
    var s = n.value[1] / this.flyTime;
    this.speed = s;
  };

  e.prototype.addAdsorb = function (e) {
    if (!this.isFly) {
      t.prototype.addAdsorb.call(this, e);
    }
  };

  e.prototype.removeAdsorb = function (e) {
    if (!this.isFly) {
      t.prototype.removeAdsorb.call(this, e);
    }
  };

  e.prototype.sufferDebuff = function (e) {
    if (!(this.isFly || this.immunity.includes(e.type))) {
      t.prototype.sufferDebuff.call(this, e);
    }
  };

  e.prototype.sufferAttack = function (e, i) {
    if (this.statusManager.isDie) {
      return !1;
    }

    var o = t.prototype.sufferAttack.call(this, e, i);

    if (this.healthBar) {
      this.healthBar.render(this.statusManager.hp);
    }

    return o;
  };

  e.prototype.updateFrame = function (e) {
    if (!this.statusManager.isDie) {
      if (this.isFly) {
        this.timeLeft += e;

        if (this.timeLeft >= this.flyTime) {
          this.timeLeft = this.flyTime;
          this.speed = this.statusManager.initSpeed;
          this.isFly = !1;
        }

        this.skin.node.scale = this.easeSine(this.timeLeft, 1, this.scaleRatio, this.flyTime);
      }

      t.prototype.updateFrame.call(this, e);
    }
  };

  e.prototype.speedRatioRight = function () {
    if (this.isFly) {
      if (1 !== this.currRatio && 0 !== this.skin.timeScale) {
        this.skin.timeScale = 1;
      }
    } else {
      if ($gameContext["default"].ins.gameRatio !== this.currRatio) {
        this.currRatio = $gameContext["default"].ins.gameRatio;
        var t = this.speed / this.statusManager.initSpeed * this.currRatio;

        if (0 !== this.skin.timeScale) {
          this.skin.timeScale = t;
        }
      }
    }
  };

  e.prototype.easeSine = function (t, e, i, o) {
    return i * Math.sin(t / o * Math.PI) + e;
  };

  __decorate([h($healthBar["default"])], e.prototype, "healthBar", void 0);

  return __decorate([f], e);
}($baseEnemy["default"]);

exports["default"] = m;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEVuZW15XzQyLmpzIl0sIm5hbWVzIjpbIm8iLCIkY29uZmlnQ29udGV4dCIsInJlcXVpcmUiLCIkYmFzZUJ1bGxldCIsIiRnYW1lQ29udGV4dCIsIiRiYXNlRW5lbXkiLCIkZW5lbXlTdGF0dXMiLCIkaGVhbHRoQmFyIiwicCIsImNjIiwiX2RlY29yYXRvciIsImYiLCJjY2NsYXNzIiwiaCIsInByb3BlcnR5IiwibSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJoZWFsdGhCYXIiLCJmbHlUaW1lIiwidGltZUxlZnQiLCJzY2FsZVJhdGlvIiwiaXNGbHkiLCJpbW11bml0eSIsIkVuZW15RGVidWZmVHlwZSIsIkZSRUVaRSIsIlBBUkFMWVNJUyIsIlNMT1ciLCJTVFVOIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEVuZW15IiwiaSIsImNhbGwiLCJzdGF0dXNNYW5hZ2VyIiwic3BlY2lhbGl0eUF0a0FkZCIsInNldCIsIkJ1bGxldFNwZWNpYWxpdHkiLCJ3aW5kIiwiY29uZmlnIiwidmFsdWUiLCJpbml0IiwiaHAiLCJocF9udW0iLCJuIiwiaWQiLCJpbnN0YW5jZSIsImdldEVuZW15Q29uZmlnIiwicyIsInNwZWVkIiwiYWRkQWRzb3JiIiwicmVtb3ZlQWRzb3JiIiwic3VmZmVyRGVidWZmIiwiaW5jbHVkZXMiLCJ0eXBlIiwic3VmZmVyQXR0YWNrIiwiaXNEaWUiLCJyZW5kZXIiLCJ1cGRhdGVGcmFtZSIsImluaXRTcGVlZCIsInNraW4iLCJub2RlIiwic2NhbGUiLCJlYXNlU2luZSIsInNwZWVkUmF0aW9SaWdodCIsImN1cnJSYXRpbyIsInRpbWVTY2FsZSIsImlucyIsImdhbWVSYXRpbyIsIk1hdGgiLCJzaW4iLCJQSSIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsY0FBYyxHQUFH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QyxTQUF6QixLQUF1QyxLQUFLSCxTQUFoRCxFQUEyRDtRQUN2RCxLQUFLQSxTQUFMLEdBQWlCL0QsWUFBWSxXQUFaLENBQXFCaUUsR0FBckIsQ0FBeUJDLFNBQTFDO1FBQ0EsSUFBSXRELENBQUMsR0FBSSxLQUFLbUMsS0FBTCxHQUFhLEtBQUtmLGFBQUwsQ0FBbUJ5QixTQUFqQyxHQUE4QyxLQUFLTSxTQUEzRDs7UUFDQSxJQUFJLE1BQU0sS0FBS0wsSUFBTCxDQUFVTSxTQUFwQixFQUErQjtVQUMzQixLQUFLTixJQUFMLENBQVVNLFNBQVYsR0FBc0JwRCxDQUF0QjtRQUNIO01BQ0o7SUFDSjtFQUNKLENBZEQ7O0VBZUFDLENBQUMsQ0FBQ2UsU0FBRixDQUFZaUMsUUFBWixHQUF1QixVQUFVakQsQ0FBVixFQUFhQyxDQUFiLEVBQWdCaUIsQ0FBaEIsRUFBbUJsQyxDQUFuQixFQUFzQjtJQUN6QyxPQUFPa0MsQ0FBQyxHQUFHcUMsSUFBSSxDQUFDQyxHQUFMLENBQVV4RCxDQUFDLEdBQUdoQixDQUFMLEdBQVV1RSxJQUFJLENBQUNFLEVBQXhCLENBQUosR0FBa0N4RCxDQUF6QztFQUNILENBRkQ7O0VBR0F5RCxVQUFVLENBQUMsQ0FBQzdELENBQUMsQ0FBQ04sVUFBVSxXQUFYLENBQUYsQ0FBRCxFQUEwQlUsQ0FBQyxDQUFDZSxTQUE1QixFQUF1QyxXQUF2QyxFQUFvRCxLQUFLLENBQXpELENBQVY7O0VBQ0EsT0FBTzBDLFVBQVUsQ0FBQyxDQUFDL0QsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBakI7QUFDSCxDQS9GTyxDQStGTFosVUFBVSxXQS9GTCxDQUFSOztBQWdHQXNFLE9BQU8sV0FBUCxHQUFrQjVELENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRjb25maWdDb250ZXh0ID0gcmVxdWlyZShcIi4vQ29uZmlnQ29udGV4dFwiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyICRnYW1lQ29udGV4dCA9IHJlcXVpcmUoXCIuL0dhbWVDb250ZXh0XCIpO1xyXG52YXIgJGJhc2VFbmVteSA9IHJlcXVpcmUoXCIuL0Jhc2VFbmVteVwiKTtcclxudmFyICRlbmVteVN0YXR1cyA9IHJlcXVpcmUoXCIuL0VuZW15U3RhdHVzXCIpO1xyXG52YXIgJGhlYWx0aEJhciA9IHJlcXVpcmUoXCIuL0hlYWx0aEJhclwiKTtcclxudmFyIHAgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgZiA9IHAuY2NjbGFzcztcclxudmFyIGggPSBwLnByb3BlcnR5O1xyXG52YXIgbSA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLmhlYWx0aEJhciA9IG51bGw7XHJcbiAgICAgICAgZS5mbHlUaW1lID0gMC41O1xyXG4gICAgICAgIGUudGltZUxlZnQgPSAwO1xyXG4gICAgICAgIGUuc2NhbGVSYXRpbyA9IDAuNTtcclxuICAgICAgICBlLmlzRmx5ID0gITE7XHJcbiAgICAgICAgZS5pbW11bml0eSA9IFtcclxuICAgICAgICAgICAgJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5GUkVFWkUsXHJcbiAgICAgICAgICAgICRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuUEFSQUxZU0lTLFxyXG4gICAgICAgICAgICAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLlNMT1csXHJcbiAgICAgICAgICAgICxcclxuICAgICAgICAgICAgJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5TVFVOXHJcbiAgICAgICAgXTtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmluaXRFbmVteSA9IGZ1bmN0aW9uIChlLCBpLCBvKSB7XHJcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gbykge1xyXG4gICAgICAgICAgICBvID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdC5wcm90b3R5cGUuaW5pdEVuZW15LmNhbGwodGhpcywgZSwgaSwgbyk7XHJcbiAgICAgICAgdGhpcy5zdGF0dXNNYW5hZ2VyLnNwZWNpYWxpdHlBdGtBZGQuc2V0KCRiYXNlQnVsbGV0LkJ1bGxldFNwZWNpYWxpdHkud2luZCwgdGhpcy5jb25maWcudmFsdWVbMF0pO1xyXG4gICAgICAgIGlmICh0aGlzLmhlYWx0aEJhcikge1xyXG4gICAgICAgICAgICB0aGlzLmhlYWx0aEJhci5pbml0KHRoaXMuc3RhdHVzTWFuYWdlci5ocCwgZS5ocF9udW0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRpbWVMZWZ0ID0gMDtcclxuICAgICAgICB0aGlzLmlzRmx5ID0gITA7XHJcbiAgICAgICAgdmFyIG4gPSBudWxsO1xyXG4gICAgICAgIDQyID09PSBlLmlkXHJcbiAgICAgICAgICAgID8gKG4gPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmdldEVuZW15Q29uZmlnKDM4KSlcclxuICAgICAgICAgICAgOiA0MyA9PT0gZS5pZCAmJiAobiA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuZ2V0RW5lbXlDb25maWcoMzkpKTtcclxuICAgICAgICB2YXIgcyA9IG4udmFsdWVbMV0gLyB0aGlzLmZseVRpbWU7XHJcbiAgICAgICAgdGhpcy5zcGVlZCA9IHM7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYWRkQWRzb3JiID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNGbHkpIHtcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUuYWRkQWRzb3JiLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbW92ZUFkc29yYiA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzRmx5KSB7XHJcbiAgICAgICAgICAgIHQucHJvdG90eXBlLnJlbW92ZUFkc29yYi5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zdWZmZXJEZWJ1ZmYgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmICghKHRoaXMuaXNGbHkgfHwgdGhpcy5pbW11bml0eS5pbmNsdWRlcyhlLnR5cGUpKSkge1xyXG4gICAgICAgICAgICB0LnByb3RvdHlwZS5zdWZmZXJEZWJ1ZmYuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc3VmZmVyQXR0YWNrID0gZnVuY3Rpb24gKGUsIGkpIHtcclxuICAgICAgICBpZiAodGhpcy5zdGF0dXNNYW5hZ2VyLmlzRGllKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG8gPSB0LnByb3RvdHlwZS5zdWZmZXJBdHRhY2suY2FsbCh0aGlzLCBlLCBpKTtcclxuICAgICAgICBpZiAodGhpcy5oZWFsdGhCYXIpIHtcclxuICAgICAgICAgICAgdGhpcy5oZWFsdGhCYXIucmVuZGVyKHRoaXMuc3RhdHVzTWFuYWdlci5ocCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnVwZGF0ZUZyYW1lID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc3RhdHVzTWFuYWdlci5pc0RpZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0ZseSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCArPSBlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGltZUxlZnQgPj0gdGhpcy5mbHlUaW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCA9IHRoaXMuZmx5VGltZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5zdGF0dXNNYW5hZ2VyLmluaXRTcGVlZDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRmx5ID0gITE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraW4ubm9kZS5zY2FsZSA9IHRoaXMuZWFzZVNpbmUodGhpcy50aW1lTGVmdCwgMSwgdGhpcy5zY2FsZVJhdGlvLCB0aGlzLmZseVRpbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHQucHJvdG90eXBlLnVwZGF0ZUZyYW1lLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNwZWVkUmF0aW9SaWdodCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0ZseSkge1xyXG4gICAgICAgICAgICBpZiAoMSAhPT0gdGhpcy5jdXJyUmF0aW8gJiYgMCAhPT0gdGhpcy5za2luLnRpbWVTY2FsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5za2luLnRpbWVTY2FsZSA9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdhbWVSYXRpbyAhPT0gdGhpcy5jdXJyUmF0aW8pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VyclJhdGlvID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdhbWVSYXRpbztcclxuICAgICAgICAgICAgICAgIHZhciB0ID0gKHRoaXMuc3BlZWQgLyB0aGlzLnN0YXR1c01hbmFnZXIuaW5pdFNwZWVkKSAqIHRoaXMuY3VyclJhdGlvO1xyXG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IHRoaXMuc2tpbi50aW1lU2NhbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNraW4udGltZVNjYWxlID0gdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5lYXNlU2luZSA9IGZ1bmN0aW9uICh0LCBlLCBpLCBvKSB7XHJcbiAgICAgICAgcmV0dXJuIGkgKiBNYXRoLnNpbigodCAvIG8pICogTWF0aC5QSSkgKyBlO1xyXG4gICAgfTtcclxuICAgIF9fZGVjb3JhdGUoW2goJGhlYWx0aEJhci5kZWZhdWx0KV0sIGUucHJvdG90eXBlLCBcImhlYWx0aEJhclwiLCB2b2lkIDApO1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2ZdLCBlKTtcclxufSkoJGJhc2VFbmVteS5kZWZhdWx0KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gbTtcclxuIl19