
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_19.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e58a52sG5BKbb7j15xqNBPt', 'Bullet_19');
// game_script/scripts/Bullet_19.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $countDownUtil = require("./CountDownUtil");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var g = cc._decorator;
var _ = g.ccclass;
var k = (g.property, cc.Vec3.ZERO);

var v = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.ice_boom;
    e.timeLeft = 0;
    e.attackEnemy = new Map();
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.isUse = !1;
    var o = this.skillParam.iceBoomAtkRange;
    this.setScale(cc.v3(o, o));
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
    this.timeLeft = this.skillParam.iceBoomTime[$gameSkillInfo.Skill4Param.FINAL];
  };

  e.prototype.onTrigger = function (t, e) {
    var i = t.object;

    if (e == $object.Trigger.enter) {
      if (this.timeLeft > 0.016) {
        i.sufferDebuff({
          type: $enemyStatus.EnemyDebuffType.SLOW,
          timeLeft: this.timeLeft + this.skillParam.iceBoomSlowTime,
          value: this.skillParam.iceBoomSlowAdd
        });
      }

      if (this.skillParam.iceBoomAdsorb > 0) {
        var o = this.node.position.sub(i.node.position);
        i.addAdsorb(o);
        this.attackEnemy.set(i, o);
      }

      if (this.skillParam.iceBoomFreezeTime > 0) {
        i.sufferDebuff({
          type: $enemyStatus.EnemyDebuffType.FREEZE,
          timeLeft: this.skillParam.iceBoomFreezeTime,
          value: 0
        });
      }
    } else {
      if (e == $object.Trigger.stay) {
        if ($countDownUtil.CountDownUtil.time - i.getLastAtkTime(4) <= this.skillParam.iceBoomAtkInterval / $gameContext["default"].ins.gameRatio) {
          return;
        }

        i.setLastAtkTime(4, $countDownUtil.CountDownUtil.time);
        i.sufferAtk({
          id: this.skillId,
          skillSpecialitys: this.skillSpecialitys,
          atk: this.atk
        });

        if (this.skillParam.iceBoomAdsorb > 0 && this.attackEnemy.has(i)) {
          k.x = this.node.position.x - i.node.position.x;
          k.y = this.node.position.y - i.node.position.y;
          k.magSqr() <= 900 ? (this.attackEnemy.get(i).x = 0, this.attackEnemy.get(i).y = 0) : (k.normalizeSelf().mulSelf(this.skillParam.iceBoomAdsorb), this.attackEnemy.get(i).x = k.x, this.attackEnemy.get(i).y = k.y);
        }
      } else {
        if (e == $object.Trigger.exit && this.skillParam.iceBoomAdsorb > 0 && this.attackEnemy.has(i)) {
          i.removeAdsorb(this.attackEnemy.get(i));
          this.attackEnemy["delete"](i);
        }
      }
    }
  };

  e.prototype.updateFrame = function (t) {
    if (!this.isUse) {
      this.timeLeft -= t;

      if (this.timeLeft <= 0) {
        this.isUse = !0;

        if (this.skillParam.iceBoomBoomAtk[$gameSkillInfo.Skill4Param.FINAL] > 0) {
          this.createBoom();
        }

        if (this.skillParam.iceBoomSplitCount > 0) {
          this.createSplitButtle();
        }

        if (this.attackEnemy.size > 0) {
          this.attackEnemy.forEach(function (t, e) {
            if ($util["default"].isValid(e.node)) {
              e.removeAdsorb(t);
            }
          });
        }

        this.removeSelf();
      }
    }
  };

  e.prototype.createBoom = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.ice_boom_boom);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_20);
      t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    t.setPosition(cc.v3(this.node.position.x, this.node.position.y));
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.lowBulletLayer);
    t.setAnimation(null);
  };

  e.prototype.createSplitButtle = function () {
    var t = $gameContext["default"].ins.getNearbyN2(this.node, this.skillParam.iceBoomSplitCount);

    for (var e = 0; e < t.length; e++) {
      var i = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.ice_boom_split);

      if (!i) {
        var o = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_21);
        (i = $resUtil.ResUtil.instantiate(o).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
      }

      var n = t[e].node.position.sub(this.node.position).normalize();
      i.setPosition(this.node.position.add(n.mul(100)));
      i.initButtle(n, this.skillId);
      i.insert($gameContext["default"].ins.buttleLayer);
    }
  };

  return __decorate([_], e);
}($baseBullet["default"]);

exports["default"] = v;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8xOS5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkYXNzZXRzTG9hZGVyIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGNvdW50RG93blV0aWwiLCIkdXRpbCIsIiRjb25maWdDb250ZXh0IiwiJGdhbWVDb250ZXh0IiwiJGdhbWVTa2lsbEluZm8iLCIkZW5lbXlTdGF0dXMiLCIkYmFzZUJ1bGxldCIsImciLCJjYyIsIl9kZWNvcmF0b3IiLCJfIiwiY2NjbGFzcyIsImsiLCJwcm9wZXJ0eSIsIlZlYzMiLCJaRVJPIiwidiIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJidXR0bGVUeXBlIiwiQnVsbGV0VHlwZSIsImljZV9ib29tIiwidGltZUxlZnQiLCJhdHRhY2tFbmVteSIsIk1hcCIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsImluaXRCdXR0bGUiLCJpIiwiY2FsbCIsImlzVXNlIiwic2tpbGxQYXJhbSIsImljZUJvb21BdGtSYW5nZSIsInNldFNjYWxlIiwidjMiLCJhdGsiLCJza2lsbEF0ayIsIlNraWxsNFBhcmFtIiwiRklOQUwiLCJpY2VCb29tVGltZSIsIm9uVHJpZ2dlciIsIm9iamVjdCIsIlRyaWdnZXIiLCJlbnRlciIsInN1ZmZlckRlYnVmZiIsInR5cGUiLCJFbmVteURlYnVmZlR5cGUiLCJTTE9XIiwiaWNlQm9vbVNsb3dUaW1lIiwidmFsdWUiLCJpY2VCb29tU2xvd0FkZCIsImljZUJvb21BZHNvcmIiLCJub2RlIiwicG9zaXRpb24iLCJzdWIiLCJhZGRBZHNvcmIiLCJzZXQiLCJpY2VCb29tRnJlZXplVGltZSIsIkZSRUVaRSIsInN0YXkiLCJDb3VudERvd25VdGlsIiwidGltZSIsImdldExhc3RBdGtUaW1lIiwiaWNlQm9vbUF0a0ludGVydmFsIiwiaW5zIiwiZ2FtZVJhdGlvIiwic2V0TGFzdEF0a1RpbWUiLCJzdWZmZXJBdGsiLCJpZCIsInNraWxsSWQiLCJza2lsbFNwZWNpYWxpdHlzIiwiaGFzIiwieCIsInkiLCJtYWdTcXIiLCJnZXQiLCJub3JtYWxpemVTZWxmIiwibXVsU2VsZiIsImV4aXQiLCJyZW1vdmVBZHNvcmIiLCJ1cGRhdGVGcmFtZSIsImljZUJvb21Cb29tQXRrIiwiY3JlYXRlQm9vbSIsImljZUJvb21TcGxpdENvdW50IiwiY3JlYXRlU3BsaXRCdXR0bGUiLCJzaXplIiwiZm9yRWFjaCIsImlzVmFsaWQiLCJyZW1vdmVTZWxmIiwiZ2V0QnV0dGxlUG9vbCIsImljZV9ib29tX2Jvb20iLCJpbnN0YW5jZSIsImdldFJlcyIsIkJ1bmRsZU5hbWVzIiwiR2FtZSIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJCdWxsZXRfMjAiLCJSZXNVdGlsIiwiaW5zdGFudGlhdGUiLCJsb3dCdWxsZXRMYXllciIsInBhcmVudCIsImdldENvbXBvbmVudCIsInNldFBvc2l0aW9uIiwiaW5zZXJ0Iiwic2V0QW5pbWF0aW9uIiwiZ2V0TmVhcmJ5TjIiLCJsZW5ndGgiLCJpY2VfYm9vbV9zcGxpdCIsIkJ1bGxldF8yMSIsImJhc2ljU2tpbGxDb25maWdNYXAiLCJza2lsbF90cHllIiwibiIsIm5vcm1hbGl6ZSIsImFkZCIsIm11bCIsImJ1dHRsZUxheWVyIiwiX19kZWNvcmF0ZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXJCOztBQUNBLElBQUlDLGFBQWEsR0FBR0QsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlFLFVBQVUsR0FBR0YsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUcsUUFBUSxHQUFHSCxPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJSSxjQUFjLEdBQUdKLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJ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QUFPQyxVQUFVLENBQUMsQ0FBQy9HLENBQUQsQ0FBRCxFQUFNUSxDQUFOLENBQWpCO0FBQ0gsQ0EvSE8sQ0ErSExaLFdBQVcsV0EvSE4sQ0FBUjs7QUFnSUFvSCxPQUFPLFdBQVAsR0FBa0IxRyxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkb2JqZWN0ID0gcmVxdWlyZShcIi4vT2JqZWN0XCIpO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkY291bnREb3duVXRpbCA9IHJlcXVpcmUoXCIuL0NvdW50RG93blV0aWxcIik7XHJcbnZhciAkdXRpbCA9IHJlcXVpcmUoXCIuL1V0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRlbmVteVN0YXR1cyA9IHJlcXVpcmUoXCIuL0VuZW15U3RhdHVzXCIpO1xyXG52YXIgJGJhc2VCdWxsZXQgPSByZXF1aXJlKFwiLi9CYXNlQnVsbGV0XCIpO1xyXG52YXIgZyA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciBfID0gZy5jY2NsYXNzO1xyXG52YXIgayA9IChnLnByb3BlcnR5LCBjYy5WZWMzLlpFUk8pO1xyXG52YXIgdiA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLmJ1dHRsZVR5cGUgPSAkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLmljZV9ib29tO1xyXG4gICAgICAgIGUudGltZUxlZnQgPSAwO1xyXG4gICAgICAgIGUuYXR0YWNrRW5lbXkgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5pbml0QnV0dGxlID0gZnVuY3Rpb24gKGUsIGkpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5pbml0QnV0dGxlLmNhbGwodGhpcywgZSwgaSk7XHJcbiAgICAgICAgdGhpcy5pc1VzZSA9ICExO1xyXG4gICAgICAgIHZhciBvID0gdGhpcy5za2lsbFBhcmFtLmljZUJvb21BdGtSYW5nZTtcclxuICAgICAgICB0aGlzLnNldFNjYWxlKGNjLnYzKG8sIG8pKTtcclxuICAgICAgICB0aGlzLmF0ayA9IHRoaXMuc2tpbGxQYXJhbS5za2lsbEF0a1skZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgdGhpcy50aW1lTGVmdCA9IHRoaXMuc2tpbGxQYXJhbS5pY2VCb29tVGltZVskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25UcmlnZ2VyID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB2YXIgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5lbnRlcikge1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lTGVmdCA+IDAuMDE2KSB7XHJcbiAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZih7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5TTE9XLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0OiB0aGlzLnRpbWVMZWZ0ICsgdGhpcy5za2lsbFBhcmFtLmljZUJvb21TbG93VGltZSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5za2lsbFBhcmFtLmljZUJvb21TbG93QWRkXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmljZUJvb21BZHNvcmIgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbyA9IHRoaXMubm9kZS5wb3NpdGlvbi5zdWIoaS5ub2RlLnBvc2l0aW9uKTtcclxuICAgICAgICAgICAgICAgIGkuYWRkQWRzb3JiKG8pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdHRhY2tFbmVteS5zZXQoaSwgbyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS5pY2VCb29tRnJlZXplVGltZSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGkuc3VmZmVyRGVidWZmKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkZSRUVaRSxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogdGhpcy5za2lsbFBhcmFtLmljZUJvb21GcmVlemVUaW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5zdGF5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgJGNvdW50RG93blV0aWwuQ291bnREb3duVXRpbC50aW1lIC0gaS5nZXRMYXN0QXRrVGltZSg0KSA8PVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbS5pY2VCb29tQXRrSW50ZXJ2YWwgLyAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2FtZVJhdGlvXHJcbiAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpLnNldExhc3RBdGtUaW1lKDQsICRjb3VudERvd25VdGlsLkNvdW50RG93blV0aWwudGltZSk7XHJcbiAgICAgICAgICAgICAgICBpLnN1ZmZlckF0ayh7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuc2tpbGxJZCxcclxuICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiB0aGlzLnNraWxsU3BlY2lhbGl0eXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYXRrOiB0aGlzLmF0a1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmljZUJvb21BZHNvcmIgPiAwICYmIHRoaXMuYXR0YWNrRW5lbXkuaGFzKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgay54ID0gdGhpcy5ub2RlLnBvc2l0aW9uLnggLSBpLm5vZGUucG9zaXRpb24ueDtcclxuICAgICAgICAgICAgICAgICAgICBrLnkgPSB0aGlzLm5vZGUucG9zaXRpb24ueSAtIGkubm9kZS5wb3NpdGlvbi55O1xyXG4gICAgICAgICAgICAgICAgICAgIGsubWFnU3FyKCkgPD0gOTAwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gKCh0aGlzLmF0dGFja0VuZW15LmdldChpKS54ID0gMCksICh0aGlzLmF0dGFja0VuZW15LmdldChpKS55ID0gMCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogKGsubm9ybWFsaXplU2VsZigpLm11bFNlbGYodGhpcy5za2lsbFBhcmFtLmljZUJvb21BZHNvcmIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLmF0dGFja0VuZW15LmdldChpKS54ID0gay54KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5hdHRhY2tFbmVteS5nZXQoaSkueSA9IGsueSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT0gJG9iamVjdC5UcmlnZ2VyLmV4aXQgJiYgdGhpcy5za2lsbFBhcmFtLmljZUJvb21BZHNvcmIgPiAwICYmIHRoaXMuYXR0YWNrRW5lbXkuaGFzKGkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5yZW1vdmVBZHNvcmIodGhpcy5hdHRhY2tFbmVteS5nZXQoaSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNrRW5lbXkuZGVsZXRlKGkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnVwZGF0ZUZyYW1lID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNVc2UpIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAtPSB0O1xyXG4gICAgICAgICAgICBpZiAodGhpcy50aW1lTGVmdCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzVXNlID0gITA7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmljZUJvb21Cb29tQXRrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUJvb20oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0uaWNlQm9vbVNwbGl0Q291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVTcGxpdEJ1dHRsZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXR0YWNrRW5lbXkuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dGFja0VuZW15LmZvckVhY2goZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR1dGlsLmRlZmF1bHQuaXNWYWxpZChlLm5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnJlbW92ZUFkc29yYih0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY3JlYXRlQm9vbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuaWNlX2Jvb21fYm9vbSk7XHJcbiAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfMjBcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgdCA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoZSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0LnNldFBvc2l0aW9uKGNjLnYzKHRoaXMubm9kZS5wb3NpdGlvbi54LCB0aGlzLm5vZGUucG9zaXRpb24ueSkpO1xyXG4gICAgICAgIHQuaW5pdEJ1dHRsZShudWxsLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgIHQuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgdC5zZXRBbmltYXRpb24obnVsbCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY3JlYXRlU3BsaXRCdXR0bGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0TmVhcmJ5TjIodGhpcy5ub2RlLCB0aGlzLnNraWxsUGFyYW0uaWNlQm9vbVNwbGl0Q291bnQpO1xyXG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdC5sZW5ndGg7IGUrKykge1xyXG4gICAgICAgICAgICB2YXIgaSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuaWNlX2Jvb21fc3BsaXQpO1xyXG4gICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8yMVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIChpID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShvKS5nZXRDb21wb25lbnQoJGJhc2VCdWxsZXQuZGVmYXVsdCkpLnNraWxsU3BlY2lhbGl0eXMgPVxyXG4gICAgICAgICAgICAgICAgICAgICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQodGhpcy5za2lsbElkKS5za2lsbF90cHllO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBuID0gdFtlXS5ub2RlLnBvc2l0aW9uLnN1Yih0aGlzLm5vZGUucG9zaXRpb24pLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICBpLnNldFBvc2l0aW9uKHRoaXMubm9kZS5wb3NpdGlvbi5hZGQobi5tdWwoMTAwKSkpO1xyXG4gICAgICAgICAgICBpLmluaXRCdXR0bGUobiwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgaS5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW19dLCBlKTtcclxufSkoJGJhc2VCdWxsZXQuZGVmYXVsdCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHY7XHJcbiJdfQ==