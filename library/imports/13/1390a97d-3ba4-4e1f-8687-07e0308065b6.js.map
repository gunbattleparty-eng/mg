{"version":3,"sources":["assets\\game_script\\scripts\\Bullet_22.js"],"names":["o","$object","require","$assetsLoader","$assetsMap","$resUtil","$seedUtil","$gameContext","$gameSkillInfo","$enemyStatus","$baseBullet","m","cc","_decorator","y","ccclass","g","property","t","e","apply","arguments","buttleType","BulletType","wind_blade","anim","currButtlePenetrateLayer","animName","isLoadedSkin","__extends","prototype","initButtle","i","call","speed","skillParam","windBladeSpeed","velocity","set","multiplyScalar","setScale","v3","windBladeRange","node","children","getComponent","Animation","setAnimation","atk","skillAtk","Skill4Param","FINAL","windBladeMulti","instance","loadRes","BundleNames","Game","AnimationClip","sp","isValid","ResUtil","assignWith","ins","buttleLayer","parent","addClip","play","onTrigger","isUse","Trigger","enter","object","sufferAtk","id","skillId","skillSpecialitys","windBladeBack","windBladeFreezeBackAdd","hasDebuff","EnemyDebuffType","FREEZE","Math","ceil","n","type","BACK","timeLeft","value","sufferDebuff","s","windBladeFreezeParam","length","a","probability","config","windBladePenetrateLayer","windBladeWaveAtk","createBoom","removeSelf","getButtlePool","wind_blade_boom","getRes","AssetsMap","GameBundles","prefabs","assetsList","Bullet_23","instantiate","lowBulletLayer","setPosition","getPosition","insert","checkBoundary","x","winSize","height","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $enemyStatus = require(\"./EnemyStatus\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar m = cc._decorator;\r\nvar y = m.ccclass;\r\nvar g =\r\n    (m.property,\r\n    (function (t) {\r\n        function e() {\r\n            var e = (null !== t && t.apply(this, arguments)) || this;\r\n            e.buttleType = $baseBullet.BulletType.wind_blade;\r\n            e.anim = null;\r\n            e.currButtlePenetrateLayer = 0;\r\n            e.animName = \"bullet_22\";\r\n            e.isLoadedSkin = !1;\r\n            return e;\r\n        }\r\n        __extends(e, t);\r\n        e.prototype.initButtle = function (e, i) {\r\n            var o = this;\r\n            t.prototype.initButtle.call(this, e, i);\r\n            this.speed = this.skillParam.windBladeSpeed;\r\n            this.velocity.set(e).multiplyScalar(this.speed);\r\n            this.setScale(cc.v3(this.skillParam.windBladeRange, this.skillParam.windBladeRange));\r\n            if (!this.anim) {\r\n                this.anim = this.node.children[0].getComponent(cc.Animation);\r\n            }\r\n            this.setAnimation();\r\n            this.currButtlePenetrateLayer = 0;\r\n            this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];\r\n            if (!this.isLoadedSkin && this.skillParam.windBladeMulti > 0) {\r\n                this.isLoadedSkin = !0;\r\n                $assetsLoader.default.instance.loadRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    [\"/anim/bullet_22_1\"],\r\n                    cc.AnimationClip,\r\n                    null,\r\n                    function (t, e) {\r\n                        var i = e[0];\r\n                        if (sp && cc.isValid(i)) {\r\n                            o.animName = \"bullet_22_1\";\r\n                            $resUtil.ResUtil.assignWith(i, $gameContext.default.ins.buttleLayer.parent);\r\n                            o.anim.addClip(i);\r\n                            o.anim.play(o.animName);\r\n                        }\r\n                    }\r\n                );\r\n            }\r\n        };\r\n        e.prototype.onTrigger = function (t, e) {\r\n            if (!this.isUse && e == $object.Trigger.enter) {\r\n                var i = t.object;\r\n                i.sufferAtk({\r\n                    id: this.skillId,\r\n                    skillSpecialitys: this.skillSpecialitys,\r\n                    atk: this.atk\r\n                });\r\n                if (this.skillParam.windBladeBack[$gameSkillInfo.Skill4Param.FINAL] > 0) {\r\n                    var o = this.skillParam.windBladeBack[$gameSkillInfo.Skill4Param.FINAL];\r\n                    if (\r\n                        this.skillParam.windBladeFreezeBackAdd > 0 &&\r\n                        i.hasDebuff($enemyStatus.EnemyDebuffType.FREEZE)\r\n                    ) {\r\n                        o = Math.ceil(o * (1 + this.skillParam.windBladeFreezeBackAdd));\r\n                    }\r\n                    var n = {\r\n                        id: this.skillId,\r\n                        type: $enemyStatus.EnemyDebuffType.BACK,\r\n                        timeLeft: -1,\r\n                        value: o\r\n                    };\r\n                    i.sufferDebuff(n);\r\n                }\r\n                for (var s = 0; s < this.skillParam.windBladeFreezeParam.length; s++) {\r\n                    var a = this.skillParam.windBladeFreezeParam[s];\r\n                    if ($seedUtil.default.probability(100 * a[1])) {\r\n                        i.sufferDebuff({\r\n                            type: $enemyStatus.EnemyDebuffType.FREEZE,\r\n                            timeLeft: a[0],\r\n                            value: 0\r\n                        });\r\n                    }\r\n                }\r\n                if (!(29 !== i.config.id && 30 !== i.config.id && 36 !== i.config.id)) {\r\n                    this.currButtlePenetrateLayer = this.skillParam.windBladePenetrateLayer;\r\n                }\r\n                this.currButtlePenetrateLayer++;\r\n                if (this.skillParam.windBladePenetrateLayer <= this.currButtlePenetrateLayer) {\r\n                    if (this.skillParam.windBladeWaveAtk[$gameSkillInfo.Skill4Param.FINAL] > 0) {\r\n                        this.createBoom();\r\n                    }\r\n                    this.removeSelf();\r\n                }\r\n            }\r\n        };\r\n        e.prototype.createBoom = function () {\r\n            var t = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.wind_blade_boom);\r\n            if (!t) {\r\n                var e = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_23\r\n                );\r\n                t = $resUtil.ResUtil.instantiate(e, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                    $baseBullet.default\r\n                );\r\n            }\r\n            t.setPosition(this.getPosition());\r\n            t.initButtle(null, this.skillId);\r\n            t.insert($gameContext.default.ins.lowBulletLayer);\r\n            t.setAnimation(null);\r\n        };\r\n        e.prototype.checkBoundary = function () {\r\n            return !(\r\n                this.node.x <= -560 ||\r\n                this.node.x >= 560 ||\r\n                this.node.y >= cc.winSize.height / 2 + 100 ||\r\n                this.node.y <= -cc.winSize.height / 2 - 200\r\n            );\r\n        };\r\n        e.prototype.setAnimation = function (t) {\r\n            if (void 0 === t) {\r\n                t = \"bullet_22\";\r\n            }\r\n            if (this.isLoadedSkin) {\r\n                t = \"bullet_22_1\";\r\n            }\r\n            this.anim.play(t);\r\n        };\r\n        return __decorate([y], e);\r\n    })($baseBullet.default));\r\nexports.default = g;\r\n"]}