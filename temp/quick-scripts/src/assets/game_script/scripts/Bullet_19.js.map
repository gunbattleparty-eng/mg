{"version":3,"sources":["assets\\game_script\\scripts\\Bullet_19.js"],"names":["o","$object","require","$assetsLoader","$assetsMap","$resUtil","$countDownUtil","$util","$configContext","$gameContext","$gameSkillInfo","$enemyStatus","$baseBullet","g","cc","_decorator","_","ccclass","k","property","Vec3","ZERO","v","t","e","apply","arguments","buttleType","BulletType","ice_boom","timeLeft","attackEnemy","Map","__extends","prototype","initButtle","i","call","isUse","skillParam","iceBoomAtkRange","setScale","v3","atk","skillAtk","Skill4Param","FINAL","iceBoomTime","onTrigger","object","Trigger","enter","sufferDebuff","type","EnemyDebuffType","SLOW","iceBoomSlowTime","value","iceBoomSlowAdd","iceBoomAdsorb","node","position","sub","addAdsorb","set","iceBoomFreezeTime","FREEZE","stay","CountDownUtil","time","getLastAtkTime","iceBoomAtkInterval","ins","gameRatio","setLastAtkTime","sufferAtk","id","skillId","skillSpecialitys","has","x","y","magSqr","get","normalizeSelf","mulSelf","exit","removeAdsorb","updateFrame","iceBoomBoomAtk","createBoom","iceBoomSplitCount","createSplitButtle","size","forEach","isValid","removeSelf","getButtlePool","ice_boom_boom","instance","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","Bullet_20","ResUtil","instantiate","lowBulletLayer","parent","getComponent","setPosition","insert","setAnimation","getNearbyN2","length","ice_boom_split","Bullet_21","basicSkillConfigMap","skill_tpye","n","normalize","add","mul","buttleLayer","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $countDownUtil = require(\"./CountDownUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $enemyStatus = require(\"./EnemyStatus\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar g = cc._decorator;\r\nvar _ = g.ccclass;\r\nvar k = (g.property, cc.Vec3.ZERO);\r\nvar v = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.buttleType = $baseBullet.BulletType.ice_boom;\r\n        e.timeLeft = 0;\r\n        e.attackEnemy = new Map();\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.initButtle = function (e, i) {\r\n        t.prototype.initButtle.call(this, e, i);\r\n        this.isUse = !1;\r\n        var o = this.skillParam.iceBoomAtkRange;\r\n        this.setScale(cc.v3(o, o));\r\n        this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];\r\n        this.timeLeft = this.skillParam.iceBoomTime[$gameSkillInfo.Skill4Param.FINAL];\r\n    };\r\n    e.prototype.onTrigger = function (t, e) {\r\n        var i = t.object;\r\n        if (e == $object.Trigger.enter) {\r\n            if (this.timeLeft > 0.016) {\r\n                i.sufferDebuff({\r\n                    type: $enemyStatus.EnemyDebuffType.SLOW,\r\n                    timeLeft: this.timeLeft + this.skillParam.iceBoomSlowTime,\r\n                    value: this.skillParam.iceBoomSlowAdd\r\n                });\r\n            }\r\n            if (this.skillParam.iceBoomAdsorb > 0) {\r\n                var o = this.node.position.sub(i.node.position);\r\n                i.addAdsorb(o);\r\n                this.attackEnemy.set(i, o);\r\n            }\r\n            if (this.skillParam.iceBoomFreezeTime > 0) {\r\n                i.sufferDebuff({\r\n                    type: $enemyStatus.EnemyDebuffType.FREEZE,\r\n                    timeLeft: this.skillParam.iceBoomFreezeTime,\r\n                    value: 0\r\n                });\r\n            }\r\n        } else {\r\n            if (e == $object.Trigger.stay) {\r\n                if (\r\n                    $countDownUtil.CountDownUtil.time - i.getLastAtkTime(4) <=\r\n                    this.skillParam.iceBoomAtkInterval / $gameContext.default.ins.gameRatio\r\n                ) {\r\n                    return;\r\n                }\r\n                i.setLastAtkTime(4, $countDownUtil.CountDownUtil.time);\r\n                i.sufferAtk({\r\n                    id: this.skillId,\r\n                    skillSpecialitys: this.skillSpecialitys,\r\n                    atk: this.atk\r\n                });\r\n                if (this.skillParam.iceBoomAdsorb > 0 && this.attackEnemy.has(i)) {\r\n                    k.x = this.node.position.x - i.node.position.x;\r\n                    k.y = this.node.position.y - i.node.position.y;\r\n                    k.magSqr() <= 900\r\n                        ? ((this.attackEnemy.get(i).x = 0), (this.attackEnemy.get(i).y = 0))\r\n                        : (k.normalizeSelf().mulSelf(this.skillParam.iceBoomAdsorb),\r\n                          (this.attackEnemy.get(i).x = k.x),\r\n                          (this.attackEnemy.get(i).y = k.y));\r\n                }\r\n            } else {\r\n                if (e == $object.Trigger.exit && this.skillParam.iceBoomAdsorb > 0 && this.attackEnemy.has(i)) {\r\n                    i.removeAdsorb(this.attackEnemy.get(i));\r\n                    this.attackEnemy.delete(i);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    e.prototype.updateFrame = function (t) {\r\n        if (!this.isUse) {\r\n            this.timeLeft -= t;\r\n            if (this.timeLeft <= 0) {\r\n                this.isUse = !0;\r\n                if (this.skillParam.iceBoomBoomAtk[$gameSkillInfo.Skill4Param.FINAL] > 0) {\r\n                    this.createBoom();\r\n                }\r\n                if (this.skillParam.iceBoomSplitCount > 0) {\r\n                    this.createSplitButtle();\r\n                }\r\n                if (this.attackEnemy.size > 0) {\r\n                    this.attackEnemy.forEach(function (t, e) {\r\n                        if ($util.default.isValid(e.node)) {\r\n                            e.removeAdsorb(t);\r\n                        }\r\n                    });\r\n                }\r\n                this.removeSelf();\r\n            }\r\n        }\r\n    };\r\n    e.prototype.createBoom = function () {\r\n        var t = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.ice_boom_boom);\r\n        if (!t) {\r\n            var e = $assetsLoader.default.instance.getRes(\r\n                $assetsMap.BundleNames.Game,\r\n                $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_20\r\n            );\r\n            t = $resUtil.ResUtil.instantiate(e, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                $baseBullet.default\r\n            );\r\n        }\r\n        t.setPosition(cc.v3(this.node.position.x, this.node.position.y));\r\n        t.initButtle(null, this.skillId);\r\n        t.insert($gameContext.default.ins.lowBulletLayer);\r\n        t.setAnimation(null);\r\n    };\r\n    e.prototype.createSplitButtle = function () {\r\n        var t = $gameContext.default.ins.getNearbyN2(this.node, this.skillParam.iceBoomSplitCount);\r\n        for (var e = 0; e < t.length; e++) {\r\n            var i = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.ice_boom_split);\r\n            if (!i) {\r\n                var o = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_21\r\n                );\r\n                (i = $resUtil.ResUtil.instantiate(o).getComponent($baseBullet.default)).skillSpecialitys =\r\n                    $configContext.default.instance.basicSkillConfigMap.get(this.skillId).skill_tpye;\r\n            }\r\n            var n = t[e].node.position.sub(this.node.position).normalize();\r\n            i.setPosition(this.node.position.add(n.mul(100)));\r\n            i.initButtle(n, this.skillId);\r\n            i.insert($gameContext.default.ins.buttleLayer);\r\n        }\r\n    };\r\n    return __decorate([_], e);\r\n})($baseBullet.default);\r\nexports.default = v;\r\n"]}