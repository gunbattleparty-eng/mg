
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/GunShopView .js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '13aedwq9KxD1J8DukcKCwvj', 'GunShopView ');
// game_script/scripts/GunShopView .js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $list = require("./List");

var $uIManager = require("./UIManager");

var $uIView = require("./UIView");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $roleContext = require("./RoleContext");

var $startView = require("./StartView");

var $gunShopItem = require("./GunShopItem");

var g = cc._decorator;
var _ = g.ccclass;
var k = g.property;

var v = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.nameLable = null;
    e.gunSkin = null;
    e.atkLabel = null;
    e.shardSp = null;
    e.shardLabel = null;
    e.btnSure = null;
    e.list = null;
    e.btnBack = null;
    e.atkAllLabel = null;
    e.gainLabel = null;
    e.currSkinId = -1;
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {
    var t = 1 === $roleContext["default"].ins.currSkinInfo.gun ? 2 : $roleContext["default"].ins.currSkinInfo.gun;
    this.renderGun(t);
  };

  e.prototype.onResetView = function () {
    this.list.numItems = $configContext["default"].instance.gunSkinConfigs.length - 1;
    this.list.selectedId = 0;
  };

  e.prototype.addEvent = function () {
    this.btnSure.on("click", this.clickSure, this);
    this.btnBack.on("click", this.clickBack, this);
  };

  e.prototype.removeEvent = function () {
    this.btnSure.off("click", this.clickSure, this);
    this.btnBack.off("click", this.clickBack, this);
  };

  e.prototype.renderItem = function (t, e) {
    t.getComponent($gunShopItem["default"]).render($configContext["default"].instance.gunSkinConfigs[e + 1]);
  };

  e.prototype.onListSelected = function (t) {
    if (t) {
      var e = t.getComponent($gunShopItem["default"]).gunSKinId;
      this.renderGun(e);
    }
  };

  e.prototype.renderGun = function (t) {
    var e = this;
    this.currSkinId = t;
    var i = $configContext["default"].instance.gunSkinConfigs.find(function (e) {
      return e.id === t;
    });
    var o = $roleContext["default"].ins.getGunSkinInfo(t);
    this.nameLable.string = i.Gunskin_name;
    this.gunSkin.armatureName = "zanshi" + i.id;
    this.atkLabel.string = (100 * i.Gunskin_add_attribute[0]).toFixed(2) + "%";
    this.atkAllLabel.string = (100 * $roleContext["default"].ins.getGunAllAtkAdd()).toFixed(2) + "%";
    this.shardSp.node.active = !1;
    this.shardLabel.node.active = !1;
    this.gainLabel.node.parent.active = !1;
    o.isHave ? $roleContext["default"].ins.currSkinInfo.gun === t ? (this.btnSure.active = !0, $util["default"].updateMaterialState(this.btnSure, !1), this.btnSure.getComponent(cc.Button).interactable = !0, this.btnSure.getComponentInChildren(cc.Label).string = "卸下") : ($util["default"].updateMaterialState(this.btnSure, !1), this.btnSure.getComponent(cc.Button).interactable = !0, this.btnSure.getComponentInChildren(cc.Label).string = "使用") : (this.gainLabel.node.parent.active = !0, this.gainLabel.string = i.get_describe, this.shardSp.node.active = !0, this.shardLabel.node.active = !0, $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public_Res, ["/gun_shard/sp" + i.id], cc.SpriteFrame, null, function (t, i) {
      var o = i[0];

      if (o && cc.isValid(e.shardSp)) {
        e.shardSp.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);
      }
    }), this.shardLabel.string = o.shard + "/" + i.shard_num, o.shard >= i.shard_num ? ($util["default"].updateMaterialState(this.btnSure, !1), this.btnSure.getComponent(cc.Button).interactable = !0, this.btnSure.getComponentInChildren(cc.Label).string = "激活") : ($util["default"].updateMaterialState(this.btnSure, !0), this.btnSure.getComponent(cc.Button).interactable = !1, this.btnSure.getComponentInChildren(cc.Label).string = "激活"));
  };

  e.prototype.clickSure = function () {
    var t = this;
    var e = $roleContext["default"].ins.getGunSkinInfo(this.currSkinId);
    var i = $configContext["default"].instance.gunSkinConfigs.find(function (e) {
      return e.id === t.currSkinId;
    });

    if (this.currSkinId === $roleContext["default"].ins.currSkinInfo.gun) {
      $roleContext["default"].ins.currSkinInfo.gun = 1;
      $roleContext["default"].ins.setCurrInfo($roleContext["default"].ins.currSkinInfo);
      this.renderGun(2);
      return void this.list.updateAll();
    }

    e.isHave ? $roleContext["default"].ins.currSkinInfo.gun !== this.currSkinId && ($roleContext["default"].ins.currSkinInfo.gun = this.currSkinId, $roleContext["default"].ins.setCurrInfo($roleContext["default"].ins.currSkinInfo), this.renderGun(this.currSkinId), this.list.updateAll()) : e.shard >= i.shard_num && (e.isHave = !0, e.shard -= i.shard_num, $roleContext["default"].ins.setGunSkinInfo(e), this.renderGun(this.currSkinId), this.list.updateAll());
  };

  e.prototype.clickBack = function () {
    $uIManager.UIManager.instance.replaceView($assetsMap.AssetsMap.StartBundles.prefabs.assetsList.StartView, {
      type: $startView.MenuType.Role
    });
  };

  __decorate([k(cc.Label)], e.prototype, "nameLable", void 0);

  __decorate([k(dragonBones.ArmatureDisplay)], e.prototype, "gunSkin", void 0);

  __decorate([k(cc.Label)], e.prototype, "atkLabel", void 0);

  __decorate([k(cc.Sprite)], e.prototype, "shardSp", void 0);

  __decorate([k(cc.Label)], e.prototype, "shardLabel", void 0);

  __decorate([k(cc.Node)], e.prototype, "btnSure", void 0);

  __decorate([k($list["default"])], e.prototype, "list", void 0);

  __decorate([k(cc.Node)], e.prototype, "btnBack", void 0);

  __decorate([k(cc.Label)], e.prototype, "atkAllLabel", void 0);

  __decorate([k(cc.Label)], e.prototype, "gainLabel", void 0);

  return __decorate([_], e);
}($uIView.UIView);

exports["default"] = v;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1blNob3BWaWV3IC5qcyJdLCJuYW1lcyI6WyJvIiwiJGFzc2V0c0xvYWRlciIsInJlcXVpcmUiLCIkYXNzZXRzTWFwIiwiJHJlc1V0aWwiLCIkbGlzdCIsIiR1SU1hbmFnZXIiLCIkdUlWaWV3IiwiJHV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRyb2xlQ29udGV4dCIsIiRzdGFydFZpZXciLCIkZ3VuU2hvcEl0ZW0iLCJnIiwiY2MiLCJfZGVjb3JhdG9yIiwiXyIsImNjY2xhc3MiLCJrIiwicHJvcGVydHkiLCJ2IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsIm5hbWVMYWJsZSIsImd1blNraW4iLCJhdGtMYWJlbCIsInNoYXJkU3AiLCJzaGFyZExhYmVsIiwiYnRuU3VyZSIsImxpc3QiLCJidG5CYWNrIiwiYXRrQWxsTGFiZWwiLCJnYWluTGFiZWwiLCJjdXJyU2tpbklkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwiaW5zIiwiY3VyclNraW5JbmZvIiwiZ3VuIiwicmVuZGVyR3VuIiwib25SZXNldFZpZXciLCJudW1JdGVtcyIsImluc3RhbmNlIiwiZ3VuU2tpbkNvbmZpZ3MiLCJsZW5ndGgiLCJzZWxlY3RlZElkIiwiYWRkRXZlbnQiLCJvbiIsImNsaWNrU3VyZSIsImNsaWNrQmFjayIsInJlbW92ZUV2ZW50Iiwib2ZmIiwicmVuZGVySXRlbSIsImdldENvbXBvbmVudCIsInJlbmRlciIsIm9uTGlzdFNlbGVjdGVkIiwiZ3VuU0tpbklkIiwiaSIsImZpbmQiLCJpZCIsImdldEd1blNraW5JbmZvIiwic3RyaW5nIiwiR3Vuc2tpbl9uYW1lIiwiYXJtYXR1cmVOYW1lIiwiR3Vuc2tpbl9hZGRfYXR0cmlidXRlIiwidG9GaXhlZCIsImdldEd1bkFsbEF0a0FkZCIsIm5vZGUiLCJhY3RpdmUiLCJwYXJlbnQiLCJpc0hhdmUiLCJ1cGRhdGVNYXRlcmlhbFN0YXRlIiwiQnV0dG9uIiwiaW50ZXJhY3RhYmxlIiwiZ2V0Q29tcG9uZW50SW5DaGlsZHJlbiIsIkxhYmVsIiwiZ2V0X2Rlc2NyaWJlIiwibG9hZFJlcyIsIkJ1bmRsZU5hbWVzIiwiUHVibGljX1JlcyIsIlNwcml0ZUZyYW1lIiwiaXNWYWxpZCIsInNwcml0ZUZyYW1lIiwiUmVzVXRpbCIsImFzc2lnbldpdGgiLCJzaGFyZCIsInNoYXJkX251bSIsInNldEN1cnJJbmZvIiwidXBkYXRlQWxsIiwic2V0R3VuU2tpbkluZm8iLCJVSU1hbmFnZXIiLCJyZXBsYWNlVmlldyIsIkFzc2V0c01hcCIsIlN0YXJ0QnVuZGxlcyIsInByZWZhYnMiLCJhc3NldHNMaXN0IiwiU3RhcnRWaWV3IiwidHlwZSIsIk1lbnVUeXBlIiwiUm9sZSIsIl9fZGVjb3JhdGUiLCJkcmFnb25Cb25lcyIsIkFybWF0dXJlRGlzcGxheSIsIlNwcml0ZSIsIk5vZGUiLCJVSVZpZXciLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlHLEtBQUssR0FBR0gsT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSUksVUFBVSxHQUFHSixPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJSyxPQUFPLEdBQUdMLE9BQU8sQ0FBQyxVQUFELENBQXJCOztBQUNBLElBQUlNLEtBQUssR0FBR04sT0FBTyxDQUFDLFFBQUQsQ0FBbkI7O0FBQ0EsSUFBSU8sY0FBYyxHQUFHUCxPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSVEsWUFBWSxHQUFHUixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJUyxVQUFVLEdBQUdULE9BQU8sQ0FBQyxhQUFE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SixFQUFFLENBQUM2RixJQUFKLENBQUYsQ0FBRCxFQUFlckYsQ0FBQyxDQUFDZSxTQUFqQixFQUE0QixTQUE1QixFQUF1QyxLQUFLLENBQTVDLENBQVY7O0VBQ0FrRSxVQUFVLENBQUMsQ0FBQ3JGLENBQUMsQ0FBQ0osRUFBRSxDQUFDZ0UsS0FBSixDQUFGLENBQUQsRUFBZ0J4RCxDQUFDLENBQUNlLFNBQWxCLEVBQTZCLGFBQTdCLEVBQTRDLEtBQUssQ0FBakQsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDckYsQ0FBQyxDQUFDSixFQUFFLENBQUNnRSxLQUFKLENBQUYsQ0FBRCxFQUFnQnhELENBQUMsQ0FBQ2UsU0FBbEIsRUFBNkIsV0FBN0IsRUFBMEMsS0FBSyxDQUEvQyxDQUFWOztFQUNBLE9BQU9rRSxVQUFVLENBQUMsQ0FBQ3ZGLENBQUQsQ0FBRCxFQUFNTSxDQUFOLENBQWpCO0FBQ0gsQ0FuSU8sQ0FtSUxmLE9BQU8sQ0FBQ3FHLE1BbklILENBQVI7O0FBb0lBQyxPQUFPLFdBQVAsR0FBa0J6RixDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkYXNzZXRzTG9hZGVyID0gcmVxdWlyZShcIi4vQXNzZXRzTG9hZGVyXCIpO1xyXG52YXIgJGFzc2V0c01hcCA9IHJlcXVpcmUoXCIuL0Fzc2V0c01hcFwiKTtcclxudmFyICRyZXNVdGlsID0gcmVxdWlyZShcIi4vUmVzVXRpbFwiKTtcclxudmFyICRsaXN0ID0gcmVxdWlyZShcIi4vTGlzdFwiKTtcclxudmFyICR1SU1hbmFnZXIgPSByZXF1aXJlKFwiLi9VSU1hbmFnZXJcIik7XHJcbnZhciAkdUlWaWV3ID0gcmVxdWlyZShcIi4vVUlWaWV3XCIpO1xyXG52YXIgJHV0aWwgPSByZXF1aXJlKFwiLi9VdGlsXCIpO1xyXG52YXIgJGNvbmZpZ0NvbnRleHQgPSByZXF1aXJlKFwiLi9Db25maWdDb250ZXh0XCIpO1xyXG52YXIgJHJvbGVDb250ZXh0ID0gcmVxdWlyZShcIi4vUm9sZUNvbnRleHRcIik7XHJcbnZhciAkc3RhcnRWaWV3ID0gcmVxdWlyZShcIi4vU3RhcnRWaWV3XCIpO1xyXG52YXIgJGd1blNob3BJdGVtID0gcmVxdWlyZShcIi4vR3VuU2hvcEl0ZW1cIik7XHJcbnZhciBnID0gY2MuX2RlY29yYXRvcjtcclxudmFyIF8gPSBnLmNjY2xhc3M7XHJcbnZhciBrID0gZy5wcm9wZXJ0eTtcclxudmFyIHYgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5uYW1lTGFibGUgPSBudWxsO1xyXG4gICAgICAgIGUuZ3VuU2tpbiA9IG51bGw7XHJcbiAgICAgICAgZS5hdGtMYWJlbCA9IG51bGw7XHJcbiAgICAgICAgZS5zaGFyZFNwID0gbnVsbDtcclxuICAgICAgICBlLnNoYXJkTGFiZWwgPSBudWxsO1xyXG4gICAgICAgIGUuYnRuU3VyZSA9IG51bGw7XHJcbiAgICAgICAgZS5saXN0ID0gbnVsbDtcclxuICAgICAgICBlLmJ0bkJhY2sgPSBudWxsO1xyXG4gICAgICAgIGUuYXRrQWxsTGFiZWwgPSBudWxsO1xyXG4gICAgICAgIGUuZ2FpbkxhYmVsID0gbnVsbDtcclxuICAgICAgICBlLmN1cnJTa2luSWQgPSAtMTtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLm9uTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9IDEgPT09ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuID8gMiA6ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuO1xyXG4gICAgICAgIHRoaXMucmVuZGVyR3VuKHQpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uUmVzZXRWaWV3ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMubGlzdC5udW1JdGVtcyA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuZ3VuU2tpbkNvbmZpZ3MubGVuZ3RoIC0gMTtcclxuICAgICAgICB0aGlzLmxpc3Quc2VsZWN0ZWRJZCA9IDA7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYWRkRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5idG5TdXJlLm9uKFwiY2xpY2tcIiwgdGhpcy5jbGlja1N1cmUsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYnRuQmFjay5vbihcImNsaWNrXCIsIHRoaXMuY2xpY2tCYWNrLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0blN1cmUub2ZmKFwiY2xpY2tcIiwgdGhpcy5jbGlja1N1cmUsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYnRuQmFjay5vZmYoXCJjbGlja1wiLCB0aGlzLmNsaWNrQmFjaywgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVuZGVySXRlbSA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdC5nZXRDb21wb25lbnQoJGd1blNob3BJdGVtLmRlZmF1bHQpLnJlbmRlcigkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmd1blNraW5Db25maWdzW2UgKyAxXSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25MaXN0U2VsZWN0ZWQgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gdC5nZXRDb21wb25lbnQoJGd1blNob3BJdGVtLmRlZmF1bHQpLmd1blNLaW5JZDtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJHdW4oZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlbmRlckd1biA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuY3VyclNraW5JZCA9IHQ7XHJcbiAgICAgICAgdmFyIGkgPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmd1blNraW5Db25maWdzLmZpbmQoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGUuaWQgPT09IHQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIG8gPSAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0R3VuU2tpbkluZm8odCk7XHJcbiAgICAgICAgdGhpcy5uYW1lTGFibGUuc3RyaW5nID0gaS5HdW5za2luX25hbWU7XHJcbiAgICAgICAgdGhpcy5ndW5Ta2luLmFybWF0dXJlTmFtZSA9IFwiemFuc2hpXCIgKyBpLmlkO1xyXG4gICAgICAgIHRoaXMuYXRrTGFiZWwuc3RyaW5nID0gKDEwMCAqIGkuR3Vuc2tpbl9hZGRfYXR0cmlidXRlWzBdKS50b0ZpeGVkKDIpICsgXCIlXCI7XHJcbiAgICAgICAgdGhpcy5hdGtBbGxMYWJlbC5zdHJpbmcgPSAoMTAwICogJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEd1bkFsbEF0a0FkZCgpKS50b0ZpeGVkKDIpICsgXCIlXCI7XHJcbiAgICAgICAgdGhpcy5zaGFyZFNwLm5vZGUuYWN0aXZlID0gITE7XHJcbiAgICAgICAgdGhpcy5zaGFyZExhYmVsLm5vZGUuYWN0aXZlID0gITE7XHJcbiAgICAgICAgdGhpcy5nYWluTGFiZWwubm9kZS5wYXJlbnQuYWN0aXZlID0gITE7XHJcbiAgICAgICAgby5pc0hhdmVcclxuICAgICAgICAgICAgPyAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuY3VyclNraW5JbmZvLmd1biA9PT0gdFxyXG4gICAgICAgICAgICAgICAgPyAoKHRoaXMuYnRuU3VyZS5hY3RpdmUgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICR1dGlsLmRlZmF1bHQudXBkYXRlTWF0ZXJpYWxTdGF0ZSh0aGlzLmJ0blN1cmUsICExKSxcclxuICAgICAgICAgICAgICAgICAgKHRoaXMuYnRuU3VyZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICh0aGlzLmJ0blN1cmUuZ2V0Q29tcG9uZW50SW5DaGlsZHJlbihjYy5MYWJlbCkuc3RyaW5nID0gXCLljbjkuItcIikpXHJcbiAgICAgICAgICAgICAgICA6ICgkdXRpbC5kZWZhdWx0LnVwZGF0ZU1hdGVyaWFsU3RhdGUodGhpcy5idG5TdXJlLCAhMSksXHJcbiAgICAgICAgICAgICAgICAgICh0aGlzLmJ0blN1cmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gITApLFxyXG4gICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudEluQ2hpbGRyZW4oY2MuTGFiZWwpLnN0cmluZyA9IFwi5L2/55SoXCIpKVxyXG4gICAgICAgICAgICA6ICgodGhpcy5nYWluTGFiZWwubm9kZS5wYXJlbnQuYWN0aXZlID0gITApLFxyXG4gICAgICAgICAgICAgICh0aGlzLmdhaW5MYWJlbC5zdHJpbmcgPSBpLmdldF9kZXNjcmliZSksXHJcbiAgICAgICAgICAgICAgKHRoaXMuc2hhcmRTcC5ub2RlLmFjdGl2ZSA9ICEwKSxcclxuICAgICAgICAgICAgICAodGhpcy5zaGFyZExhYmVsLm5vZGUuYWN0aXZlID0gITApLFxyXG4gICAgICAgICAgICAgICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5sb2FkUmVzKFxyXG4gICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLlB1YmxpY19SZXMsXHJcbiAgICAgICAgICAgICAgICAgIFtcIi9ndW5fc2hhcmQvc3BcIiArIGkuaWRdLFxyXG4gICAgICAgICAgICAgICAgICBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHQsIGkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHZhciBvID0gaVswXTtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmIChvICYmIGNjLmlzVmFsaWQoZS5zaGFyZFNwKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGUuc2hhcmRTcC5zcHJpdGVGcmFtZSA9ICRyZXNVdGlsLlJlc1V0aWwuYXNzaWduV2l0aChvLCBlLm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgICAodGhpcy5zaGFyZExhYmVsLnN0cmluZyA9IG8uc2hhcmQgKyBcIi9cIiArIGkuc2hhcmRfbnVtKSxcclxuICAgICAgICAgICAgICBvLnNoYXJkID49IGkuc2hhcmRfbnVtXHJcbiAgICAgICAgICAgICAgICAgID8gKCR1dGlsLmRlZmF1bHQudXBkYXRlTWF0ZXJpYWxTdGF0ZSh0aGlzLmJ0blN1cmUsICExKSxcclxuICAgICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9ICEwKSxcclxuICAgICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudEluQ2hpbGRyZW4oY2MuTGFiZWwpLnN0cmluZyA9IFwi5r+A5rS7XCIpKVxyXG4gICAgICAgICAgICAgICAgICA6ICgkdXRpbC5kZWZhdWx0LnVwZGF0ZU1hdGVyaWFsU3RhdGUodGhpcy5idG5TdXJlLCAhMCksXHJcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMuYnRuU3VyZS5nZXRDb21wb25lbnQoY2MuQnV0dG9uKS5pbnRlcmFjdGFibGUgPSAhMSksXHJcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMuYnRuU3VyZS5nZXRDb21wb25lbnRJbkNoaWxkcmVuKGNjLkxhYmVsKS5zdHJpbmcgPSBcIua/gOa0u1wiKSkpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmNsaWNrU3VyZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGUgPSAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0R3VuU2tpbkluZm8odGhpcy5jdXJyU2tpbklkKTtcclxuICAgICAgICB2YXIgaSA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuZ3VuU2tpbkNvbmZpZ3MuZmluZChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZS5pZCA9PT0gdC5jdXJyU2tpbklkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJTa2luSWQgPT09ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuKSB7XHJcbiAgICAgICAgICAgICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuID0gMTtcclxuICAgICAgICAgICAgJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLnNldEN1cnJJbmZvKCRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8pO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckd1bigyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy5saXN0LnVwZGF0ZUFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlLmlzSGF2ZVxyXG4gICAgICAgICAgICA/ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuICE9PSB0aGlzLmN1cnJTa2luSWQgJiZcclxuICAgICAgICAgICAgICAoKCRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uZ3VuID0gdGhpcy5jdXJyU2tpbklkKSxcclxuICAgICAgICAgICAgICAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuc2V0Q3VyckluZm8oJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmN1cnJTa2luSW5mbyksXHJcbiAgICAgICAgICAgICAgdGhpcy5yZW5kZXJHdW4odGhpcy5jdXJyU2tpbklkKSxcclxuICAgICAgICAgICAgICB0aGlzLmxpc3QudXBkYXRlQWxsKCkpXHJcbiAgICAgICAgICAgIDogZS5zaGFyZCA+PSBpLnNoYXJkX251bSAmJlxyXG4gICAgICAgICAgICAgICgoZS5pc0hhdmUgPSAhMCksXHJcbiAgICAgICAgICAgICAgKGUuc2hhcmQgLT0gaS5zaGFyZF9udW0pLFxyXG4gICAgICAgICAgICAgICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5zZXRHdW5Ta2luSW5mbyhlKSxcclxuICAgICAgICAgICAgICB0aGlzLnJlbmRlckd1bih0aGlzLmN1cnJTa2luSWQpLFxyXG4gICAgICAgICAgICAgIHRoaXMubGlzdC51cGRhdGVBbGwoKSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY2xpY2tCYWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICR1SU1hbmFnZXIuVUlNYW5hZ2VyLmluc3RhbmNlLnJlcGxhY2VWaWV3KCRhc3NldHNNYXAuQXNzZXRzTWFwLlN0YXJ0QnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuU3RhcnRWaWV3LCB7XHJcbiAgICAgICAgICAgIHR5cGU6ICRzdGFydFZpZXcuTWVudVR5cGUuUm9sZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwibmFtZUxhYmxlXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGRyYWdvbkJvbmVzLkFybWF0dXJlRGlzcGxheSldLCBlLnByb3RvdHlwZSwgXCJndW5Ta2luXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImF0a0xhYmVsXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLlNwcml0ZSldLCBlLnByb3RvdHlwZSwgXCJzaGFyZFNwXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcInNoYXJkTGFiZWxcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJidG5TdXJlXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKCRsaXN0LmRlZmF1bHQpXSwgZS5wcm90b3R5cGUsIFwibGlzdFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImJ0bkJhY2tcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwiYXRrQWxsTGFiZWxcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwiZ2FpbkxhYmVsXCIsIHZvaWQgMCk7XHJcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbX10sIGUpO1xyXG59KSgkdUlWaWV3LlVJVmlldyk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IHY7XHJcbiJdfQ==