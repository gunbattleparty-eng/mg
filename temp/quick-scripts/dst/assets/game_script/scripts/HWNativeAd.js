
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/HWNativeAd.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '736e0zUb6tEoJvk+pPuaGPH', 'HWNativeAd');
// game_script/scripts/HWNativeAd.js

"use strict";

var o;
exports.HWNativeAd = void 0;

var $baseAdNode = require("./BaseAdNode");

var r = window.qg;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.adViewName = null;
    e.isOpenPreLoad = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    var t = this;

    if (this.adUnitId) {
      if (r && r.createNativeAd) {
        var e = {
          adUnitId: this.adUnitId,
          fail: function fail() {
            t.destroyAd();
          }
        };
        this.adIns = r.createNativeAd(e);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }

        this.adIns.load();
      } else {
        console.warn("组件不支持NativeAd");
      }
    } else {
      console.error("OPPONativeAd ID为空");
    }
  };

  e.prototype.showNativeAd = function (t, e, i, o) {
    var n = this;
    this.showCallback = e;
    this.errorCallback = o;
    this.closeCallback = i;
    this.adViewName = t;

    if (this.isCanShow) {
      return this.adIns && this.adData ? this.isLoaded ? void (this.isLoaded && this.adData && (this.isConsume = !0, this.createNativeAd(t, function () {
        if (n.adIns && n.adData) {
          console.log("======", n.adData.adId.toString());
          n.adIns.reportAdClick({
            adId: n.adData.adId.toString()
          });
        }

        if (n.showCallback) {
          n.showCallback();
        }

        n.destroyAd();
      }, function () {
        n.onAdClose(null);
      }), this.setHwAdData(this.adData.imgUrlList[0], this.adData.title, this.adData.desc, this.adData.source), this.adIns.reportAdShow({
        adId: this.adData.adId.toString()
      }))) : (console.warn(this.adUnitId, ":正在加载中，稍等"), void (this.isAutoShow = !0)) : (console.warn(this.adUnitId, ":无数据执行重建"), this.reCreateAd(!0));
    }

    console.warn(this.adUnitId, ":当前广告禁止显示");
  };

  e.prototype.setHwAdData = function (t, e, i, o) {
    if (cc.isValid(this.adNode)) {
      this.setAdData(t, e, i);
      var n = this.adNode.getChildByName("content");

      if (t) {
        n.getChildByName("ad_source").getComponent(cc.Label).string = o || "";
      }
    }
  };

  e.prototype.forbiddenNativeAd = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideNativeAd(!1);
    }
  };

  e.prototype.hideNativeAd = function (e) {
    e && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : t.prototype.destroyNativeAdNode.call(this);
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);
    this.adData = null;

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showNativeAd(this.adViewName, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function (e) {
    t.prototype.onAdLoad.call(this, e);
    this.isConsume = !1;
    this.isLoaded = !0;

    if (e && e.adList && e.adList.length > 0) {
      var i = e.adList.pop();
      console.log("广告参数:", i);
      this.adData = i;
      this.autoShow();
    }
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);
    console.error("onAdError", this.adUnitId, JSON.stringify(e));

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdClose = function (e) {
    t.prototype.onAdClose.call(this, e);

    if (this.closeCallback) {
      this.closeCallback();
    }

    this.destroyAd();
  };

  return e;
}($baseAdNode["default"]);

exports.HWNativeAd = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEhXTmF0aXZlQWQuanMiXSwibmFtZXMiOlsibyIsImV4cG9ydHMiLCJIV05hdGl2ZUFkIiwiJGJhc2VBZE5vZGUiLCJyZXF1aXJlIiwiciIsIndpbmRvdyIsInFnIiwiYSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJhZFZpZXdOYW1lIiwiaXNPcGVuUHJlTG9hZCIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsImxvYWRBZCIsImFkVW5pdElkIiwiY3JlYXRlTmF0aXZlQWQiLCJmYWlsIiwiZGVzdHJveUFkIiwiYWRJbnMiLCJvbkxvYWQiLCJvbkVycm9yIiwibG9hZCIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJzaG93TmF0aXZlQWQiLCJpIiwibiIsInNob3dDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJjbG9zZUNhbGxiYWNrIiwiaXNDYW5TaG93IiwiYWREYXRhIiwiaXNMb2FkZWQiLCJpc0NvbnN1bWUiLCJsb2ciLCJhZElkIiwidG9TdHJpbmciLCJyZXBvcnRBZENsaWNrIiwib25BZENsb3NlIiwic2V0SHdBZERhdGEiLCJpbWdVcmxMaXN0IiwidGl0bGUiLCJkZXNjIiwic291cmNlIiwicmVwb3J0QWRTaG93IiwiaXNBdXRvU2hvdyIsInJlQ3JlYXRlQWQiLCJjYyIsImlzVmFsaWQiLCJhZE5vZGUiLCJzZXRBZERhdGEiLCJnZXRDaGlsZEJ5TmFtZSIsImdldENvbXBvbmVudCIsIkxhYmVsIiwic3RyaW5nIiwiZm9yYmlkZGVuTmF0aXZlQWQiLCJoaWRlTmF0aXZlQWQiLCJkZXN0cm95TmF0aXZlQWROb2RlIiwiY2FsbCIsIm9mZkxvYWQiLCJvZmZFcnJvciIsImRlc3Ryb3kiLCJhdXRvU2hvdyIsIm9uQWRMb2FkIiwiYWRMaXN0IiwibGVuZ3RoIiwicG9wIiwib25BZEVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKO0FBQ0FDLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQixLQUFLLENBQTFCOztBQUNBLElBQUlDLFdBQVcsR0FBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBekI7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFHQyxNQUFNLENBQUNDLEVBQWY7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFJLFVBQVVDLENBQVYsRUFBYTtFQUNsQixTQUFTQyxDQUFULEdBQWE7SUFDVCxJQUFJQSxDQUFDLEdBQUksU0FBU0QsQ0FBVCxJQUFjQSxDQUFDLENBQUNFLEtBQUYsQ0FBUSxJQUFSLEVBQWNDLFNBQWQsQ0FBZixJQUE0QyxJQUFwRDtJQUNBRixDQUFDLENBQUNHLFVBQUYsR0FBZSxJQUFmO0lBQ0FILENBQUMsQ0FBQ0ksYUFBRixHQUFrQixDQUFDLENBQW5CO0lBQ0EsT0FBT0osQ0FBUDtFQUNIOztFQUNESyxTQUFTLENBQUNMLENBQUQsRUFBSUQsQ0FBSixDQUFUOztFQUNBQyxDQUFDLENBQUNNLFNBQUYsQ0FBWUMsTUFBWixHQUFxQixZQUFZO0lBQzdCLElBQUlSLENBQUMsR0FBRyxJQUFSOztJQUNBLElBQUksS0FBS1MsUUFBVCxFQUFtQjtNQUNmLElBQUliLENBQUMsSUFBSUEsQ0FBQyxDQUFDYyxjQUFYLEVBQTJCO1FBQ3ZCLElBQUlULENBQUMsR0FBRztVQUNKUSxRQUFRLEVBQUUsS0FBS0EsUUFEWDtVQUVKRSxJQUFJLEVBQUUsZ0JBQVk7WUFDZFgsQ0FBQyxDQUFDWSxTQUFGO1VBQ0g7UUFKRyxDQUFSO1FBTUEsS0FBS0MsS0FBTCxHQUFhakIsQ0FBQyxDQUFDYyxjQUFGLENBQWlCVCxDQUFqQixDQUFiOztRQUNBLElBQUksS0FBS1ksS0FBTCxDQUFXQyxNQUFmLEVBQXVCO1VBQ25CLEtBQUtELEtBQUwsQ0FBV0MsTUFBWCxDQUFrQixLQUFLQSxNQUF2QjtRQUNIOztRQUNELElBQUksS0FBS0QsS0FBTCxDQUFXRSxPQUFmLEVBQXdCO1VBQ3BCLEtBQUtGLEtBQUwsQ0FBV0UsT0FBWCxDQUFtQixLQUFLQSxPQUF4QjtRQUNIOztRQUNELEtBQUtGLEtBQUwsQ0FBV0csSUFBWDtNQUNILENBZkQsTUFlTztRQUNIQyxPQUFPLENBQUNDLElBQVIsQ0FBYSxlQUFiO01BQ0g7SUFDSixDQW5CRCxNQW1CTztNQUNIRCxPQUFPLENBQUNFLEtBQVIsQ0FBYyxtQkFBZDtJQUNIO0VBQ0osQ0F4QkQ7O0VBeUJBbEIsQ0FBQyxDQUFDTSxTQUFGLENBQVlhLFlBQVosR0FBMkIsVUFBVXBCLENBQVYsRUFBYUMsQ0FBYixFQUFnQm9CLENBQWhCLEVBQW1COUIsQ0FBbkIsRUFBc0I7SUFDN0MsSUFBSStCLENBQUMsR0FBRyxJQUFSO0lBQ0EsS0FBS0MsWUFBTCxHQUFvQnRCLENBQXBCO0lBQ0EsS0FBS3VCLGFBQUwsR0FBcUJqQyxDQUFyQjtJQUNBLEtBQUtrQyxhQUFMLEdBQXFCSixDQUFyQjtJQUNBLEtBQUtqQixVQUFMLEdBQWtCSixDQUFsQjs7SUFDQSxJQUFJLEtBQUswQixTQUFULEVBQW9CO01BQ2hCLE9BQU8sS0FBS2IsS0FBTCxJQUFjLEtBQUtjLE1BQW5CLEdBQ0QsS0FBS0MsUUFBTCxHQUNJLE1BQ0ksS0FBS0EsUUFBTCxJQUNBLEtBQUtELE1BREwsS0FFRSxLQUFLRSxTQUFMLEdBQWlCLENBQUMsQ0FBbkIsRUFDRCxLQUFLbkIsY0FBTCxDQUNJVixDQURKLEVBRUksWUFBWTtRQUNSLElBQUlzQixDQUFDLENBQUNULEtBQUYsSUFBV1MsQ0FBQyxDQUFDSyxNQUFqQixFQUF5QjtVQUNyQlYsT0FBTyxDQUFDYSxHQUFSLENBQVksUUFBWixFQUFzQlIsQ0FBQyxDQUFDSyxNQUFGLENBQVNJLElBQVQsQ0FBY0MsUUFBZCxFQUF0QjtVQUNBVixDQUFDLENBQUNULEtBQUYsQ0FBUW9CLGFBQVIsQ0FBc0I7WUFDbEJGLElBQUksRUFBRVQsQ0FBQyxDQUFDSyxNQUFGLENBQVNJLElBQVQsQ0FBY0MsUUFBZDtVQURZLENBQXRCO1FBR0g7O1FBQ0QsSUFBSVYsQ0FBQyxDQUFDQyxZQUFOLEVBQW9CO1VBQ2hCRCxDQUFDLENBQUNDLFlBQUY7UUFDSDs7UUFDREQsQ0FBQyxDQUFDVixTQUFGO01BQ0gsQ0FiTCxFQWNJLFlBQVk7UUFDUlUsQ0FBQyxDQUFDWSxTQUFGLENBQVksSUFBWjtNQUNILENBaEJMLENBREMsRUFtQkQsS0FBS0MsV0FBTCxDQUNJLEtBQUtSLE1BQUwsQ0FBWVMsVUFBWixDQUF1QixDQUF2QixDQURKLEVBRUksS0FBS1QsTUFBTCxDQUFZVSxLQUZoQixFQUdJLEtBQUtWLE1BQUwsQ0FBWVcsSUFIaEIsRUFJSSxLQUFLWCxNQUFMLENBQVlZLE1BSmhCLENBbkJDLEVBeUJELEtBQUsxQixLQUFMLENBQVcyQixZQUFYLENBQXdCO1FBQ3BCVCxJQUFJLEVBQUUsS0FBS0osTUFBTCxDQUFZSSxJQUFaLENBQWlCQyxRQUFqQjtNQURjLENBQXhCLENBM0JBLENBREosQ0FESixJQWlDS2YsT0FBTyxDQUFDQyxJQUFSLENBQWEsS0FBS1QsUUFBbEIsRUFBNEIsV0FBNUIsR0FBMEMsTUFBTSxLQUFLZ0MsVUFBTCxHQUFrQixDQUFDLENBQXpCLENBakMvQyxDQURDLElBbUNBeEIsT0FBTyxDQUFDQyxJQUFSLENBQWEsS0FBS1QsUUFBbEIsRUFBNEIsVUFBNUIsR0FBeUMsS0FBS2lDLFVBQUwsQ0FBZ0IsQ0FBQyxDQUFqQixDQW5DekMsQ0FBUDtJQW9DSDs7SUFDRHpCLE9BQU8sQ0FBQ0MsSUFBUixDQUFhLEtBQUtULFFBQWxCLEVBQTRCLFdBQTVCO0VBQ0gsQ0E3Q0Q7O0VBOENBUixDQUFDLENBQUNNLFNBQUYsQ0FBWTRCLFdBQVosR0FBMEIsVUFBVW5DLENBQVYsRUFBYUMsQ0FBYixFQUFnQm9CLENBQWhCLEVBQW1COUIsQ0FBbkIsRUFBc0I7SUFDNUMsSUFBSW9ELEVBQUUsQ0FBQ0MsT0FBSCxDQUFXLEtBQUtDLE1BQWhCLENBQUosRUFBNkI7TUFDekIsS0FBS0MsU0FBTCxDQUFlOUMsQ0FBZixFQUFrQkMsQ0FBbEIsRUFBcUJvQixDQUFyQjtNQUNBLElBQUlDLENBQUMsR0FBRyxLQUFLdUIsTUFBTCxDQUFZRSxjQUFaLENBQTJCLFNBQTNCLENBQVI7O01BQ0EsSUFBSS9DLENBQUosRUFBTztRQUNIc0IsQ0FBQyxDQUFDeUIsY0FBRixDQUFpQixXQUFqQixFQUE4QkMsWUFBOUIsQ0FBMkNMLEVBQUUsQ0FBQ00sS0FBOUMsRUFBcURDLE1BQXJELEdBQThEM0QsQ0FBQyxJQUFJLEVBQW5FO01BQ0g7SUFDSjtFQUNKLENBUkQ7O0VBU0FVLENBQUMsQ0FBQ00sU0FBRixDQUFZNEMsaUJBQVosR0FBZ0MsVUFBVW5ELENBQVYsRUFBYTtJQUN6QyxLQUFLMEIsU0FBTCxHQUFpQixDQUFDMUIsQ0FBbEI7O0lBQ0EsSUFBSUEsQ0FBQyxJQUFJLEtBQUs2QixTQUFkLEVBQXlCO01BQ3JCLEtBQUt1QixZQUFMLENBQWtCLENBQUMsQ0FBbkI7SUFDSDtFQUNKLENBTEQ7O0VBTUFuRCxDQUFDLENBQUNNLFNBQUYsQ0FBWTZDLFlBQVosR0FBMkIsVUFBVW5ELENBQVYsRUFBYTtJQUNwQ0EsQ0FBQyxJQUFJLEtBQUs0QixTQUFWLElBQXVCLEtBQUtqQixTQUFMLElBQWtCLEtBQUs4QixVQUFMLENBQWdCLENBQUMsQ0FBakIsQ0FBekMsSUFBZ0UxQyxDQUFDLENBQUNPLFNBQUYsQ0FBWThDLG1CQUFaLENBQWdDQyxJQUFoQyxDQUFxQyxJQUFyQyxDQUFoRTtFQUNILENBRkQ7O0VBR0FyRCxDQUFDLENBQUNNLFNBQUYsQ0FBWUssU0FBWixHQUF3QixZQUFZO0lBQ2hDWixDQUFDLENBQUNPLFNBQUYsQ0FBWUssU0FBWixDQUFzQjBDLElBQXRCLENBQTJCLElBQTNCO0lBQ0EsS0FBSzNCLE1BQUwsR0FBYyxJQUFkOztJQUNBLElBQUksS0FBS2QsS0FBVCxFQUFnQjtNQUNaLElBQUksS0FBS0EsS0FBTCxDQUFXMEMsT0FBZixFQUF3QjtRQUNwQixLQUFLMUMsS0FBTCxDQUFXMEMsT0FBWCxDQUFtQixLQUFLekMsTUFBeEI7TUFDSDs7TUFDRCxJQUFJLEtBQUtELEtBQUwsQ0FBVzJDLFFBQWYsRUFBeUI7UUFDckIsS0FBSzNDLEtBQUwsQ0FBVzJDLFFBQVgsQ0FBb0IsS0FBS3pDLE9BQXpCO01BQ0g7O01BQ0QsSUFBSSxLQUFLRixLQUFMLENBQVc0QyxPQUFmLEVBQXdCO1FBQ3BCLEtBQUs1QyxLQUFMLENBQVc0QyxPQUFYO01BQ0g7O01BQ0QsS0FBSzVDLEtBQUwsR0FBYSxJQUFiO0lBQ0g7RUFDSixDQWZEOztFQWdCQVosQ0FBQyxDQUFDTSxTQUFGLENBQVltRCxRQUFaLEdBQXVCLFlBQVk7SUFDL0IsSUFBSSxLQUFLakIsVUFBVCxFQUFxQjtNQUNqQixLQUFLQSxVQUFMLEdBQWtCLENBQUMsQ0FBbkI7TUFDQSxLQUFLckIsWUFBTCxDQUFrQixLQUFLaEIsVUFBdkIsRUFBbUMsS0FBS21CLFlBQXhDLEVBQXNELEtBQUtDLGFBQTNEO0lBQ0g7RUFDSixDQUxEOztFQU1BdkIsQ0FBQyxDQUFDTSxTQUFGLENBQVlvRCxRQUFaLEdBQXVCLFVBQVUxRCxDQUFWLEVBQWE7SUFDaENELENBQUMsQ0FBQ08sU0FBRixDQUFZb0QsUUFBWixDQUFxQkwsSUFBckIsQ0FBMEIsSUFBMUIsRUFBZ0NyRCxDQUFoQztJQUNBLEtBQUs0QixTQUFMLEdBQWlCLENBQUMsQ0FBbEI7SUFDQSxLQUFLRCxRQUFMLEdBQWdCLENBQUMsQ0FBakI7O0lBQ0EsSUFBSTNCLENBQUMsSUFBSUEsQ0FBQyxDQUFDMkQsTUFBUCxJQUFpQjNELENBQUMsQ0FBQzJELE1BQUYsQ0FBU0MsTUFBVCxHQUFrQixDQUF2QyxFQUEwQztNQUN0QyxJQUFJeEMsQ0FBQyxHQUFHcEIsQ0FBQyxDQUFDMkQsTUFBRixDQUFTRSxHQUFULEVBQVI7TUFDQTdDLE9BQU8sQ0FBQ2EsR0FBUixDQUFZLE9BQVosRUFBcUJULENBQXJCO01BQ0EsS0FBS00sTUFBTCxHQUFjTixDQUFkO01BQ0EsS0FBS3FDLFFBQUw7SUFDSDtFQUNKLENBVkQ7O0VBV0F6RCxDQUFDLENBQUNNLFNBQUYsQ0FBWXdELFNBQVosR0FBd0IsVUFBVTlELENBQVYsRUFBYTtJQUNqQ0QsQ0FBQyxDQUFDTyxTQUFGLENBQVl3RCxTQUFaLENBQXNCVCxJQUF0QixDQUEyQixJQUEzQixFQUFpQ3JELENBQWpDO0lBQ0FnQixPQUFPLENBQUNFLEtBQVIsQ0FBYyxXQUFkLEVBQTJCLEtBQUtWLFFBQWhDLEVBQTBDdUQsSUFBSSxDQUFDQyxTQUFMLENBQWVoRSxDQUFmLENBQTFDOztJQUNBLElBQUksS0FBS3VCLGFBQVQsRUFBd0I7TUFDcEIsS0FBS0EsYUFBTDtJQUNIOztJQUNELEtBQUtaLFNBQUw7RUFDSCxDQVBEOztFQVFBWCxDQUFDLENBQUNNLFNBQUYsQ0FBWTJCLFNBQVosR0FBd0IsVUFBVWpDLENBQVYsRUFBYTtJQUNqQ0QsQ0FBQyxDQUFDTyxTQUFGLENBQVkyQixTQUFaLENBQXNCb0IsSUFBdEIsQ0FBMkIsSUFBM0IsRUFBaUNyRCxDQUFqQzs7SUFDQSxJQUFJLEtBQUt3QixhQUFULEVBQXdCO01BQ3BCLEtBQUtBLGFBQUw7SUFDSDs7SUFDRCxLQUFLYixTQUFMO0VBQ0gsQ0FORDs7RUFPQSxPQUFPWCxDQUFQO0FBQ0gsQ0FsSk8sQ0FrSkxQLFdBQVcsV0FsSk4sQ0FBUjs7QUFtSkFGLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQk0sQ0FBckIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLkhXTmF0aXZlQWQgPSB2b2lkIDA7XHJcbnZhciAkYmFzZUFkTm9kZSA9IHJlcXVpcmUoXCIuL0Jhc2VBZE5vZGVcIik7XHJcbnZhciByID0gd2luZG93LnFnO1xyXG52YXIgYSA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLmFkVmlld05hbWUgPSBudWxsO1xyXG4gICAgICAgIGUuaXNPcGVuUHJlTG9hZCA9ICExO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUubG9hZEFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy5hZFVuaXRJZCkge1xyXG4gICAgICAgICAgICBpZiAociAmJiByLmNyZWF0ZU5hdGl2ZUFkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBhZFVuaXRJZDogdGhpcy5hZFVuaXRJZCxcclxuICAgICAgICAgICAgICAgICAgICBmYWlsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuZGVzdHJveUFkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMgPSByLmNyZWF0ZU5hdGl2ZUFkKGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25Mb2FkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25FcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25FcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5sb2FkKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLnu4Tku7bkuI3mlK/mjIFOYXRpdmVBZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJPUFBPTmF0aXZlQWQgSUTkuLrnqbpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNob3dOYXRpdmVBZCA9IGZ1bmN0aW9uICh0LCBlLCBpLCBvKSB7XHJcbiAgICAgICAgdmFyIG4gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc2hvd0NhbGxiYWNrID0gZTtcclxuICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2sgPSBvO1xyXG4gICAgICAgIHRoaXMuY2xvc2VDYWxsYmFjayA9IGk7XHJcbiAgICAgICAgdGhpcy5hZFZpZXdOYW1lID0gdDtcclxuICAgICAgICBpZiAodGhpcy5pc0NhblNob3cpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRJbnMgJiYgdGhpcy5hZERhdGFcclxuICAgICAgICAgICAgICAgID8gdGhpcy5pc0xvYWRlZFxyXG4gICAgICAgICAgICAgICAgICAgID8gdm9pZCAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRlZCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWREYXRhICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKCh0aGlzLmlzQ29uc3VtZSA9ICEwKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZU5hdGl2ZUFkKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5hZElucyAmJiBuLmFkRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiPT09PT09XCIsIG4uYWREYXRhLmFkSWQudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5hZElucy5yZXBvcnRBZENsaWNrKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRJZDogbi5hZERhdGEuYWRJZC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobi5zaG93Q2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNob3dDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5kZXN0cm95QWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5vbkFkQ2xvc2UobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SHdBZERhdGEoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWREYXRhLmltZ1VybExpc3RbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWREYXRhLnRpdGxlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkRGF0YS5kZXNjLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkRGF0YS5zb3VyY2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMucmVwb3J0QWRTaG93KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRJZDogdGhpcy5hZERhdGEuYWRJZC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgOiAoY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuato+WcqOWKoOi9veS4re+8jOeojeetiVwiKSwgdm9pZCAodGhpcy5pc0F1dG9TaG93ID0gITApKVxyXG4gICAgICAgICAgICAgICAgOiAoY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuaXoOaVsOaNruaJp+ihjOmHjeW7ulwiKSwgdGhpcy5yZUNyZWF0ZUFkKCEwKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrlvZPliY3lub/lkYrnpoHmraLmmL7npLpcIik7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2V0SHdBZERhdGEgPSBmdW5jdGlvbiAodCwgZSwgaSwgbykge1xyXG4gICAgICAgIGlmIChjYy5pc1ZhbGlkKHRoaXMuYWROb2RlKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEFkRGF0YSh0LCBlLCBpKTtcclxuICAgICAgICAgICAgdmFyIG4gPSB0aGlzLmFkTm9kZS5nZXRDaGlsZEJ5TmFtZShcImNvbnRlbnRcIik7XHJcbiAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICBuLmdldENoaWxkQnlOYW1lKFwiYWRfc291cmNlXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gbyB8fCBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmZvcmJpZGRlbk5hdGl2ZUFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmlzQ2FuU2hvdyA9ICF0O1xyXG4gICAgICAgIGlmICh0ICYmIHRoaXMuaXNDb25zdW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZU5hdGl2ZUFkKCExKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuaGlkZU5hdGl2ZUFkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBlICYmIHRoaXMuaXNDb25zdW1lID8gKHRoaXMuZGVzdHJveUFkKCksIHRoaXMucmVDcmVhdGVBZCghMSkpIDogdC5wcm90b3R5cGUuZGVzdHJveU5hdGl2ZUFkTm9kZS5jYWxsKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmRlc3Ryb3lBZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5kZXN0cm95QWQuY2FsbCh0aGlzKTtcclxuICAgICAgICB0aGlzLmFkRGF0YSA9IG51bGw7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRJbnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZMb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZFcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLmRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5hdXRvU2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F1dG9TaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dOYXRpdmVBZCh0aGlzLmFkVmlld05hbWUsIHRoaXMuc2hvd0NhbGxiYWNrLCB0aGlzLmVycm9yQ2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkTG9hZCA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZExvYWQuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSAhMDtcclxuICAgICAgICBpZiAoZSAmJiBlLmFkTGlzdCAmJiBlLmFkTGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gZS5hZExpc3QucG9wKCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5bm/5ZGK5Y+C5pWwOlwiLCBpKTtcclxuICAgICAgICAgICAgdGhpcy5hZERhdGEgPSBpO1xyXG4gICAgICAgICAgICB0aGlzLmF1dG9TaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRFcnJvciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZEVycm9yLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIm9uQWRFcnJvclwiLCB0aGlzLmFkVW5pdElkLCBKU09OLnN0cmluZ2lmeShlKSk7XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3JDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkQ2xvc2UgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRDbG9zZS5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgIGlmICh0aGlzLmNsb3NlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlQWROb2RlLmRlZmF1bHQpO1xyXG5leHBvcnRzLkhXTmF0aXZlQWQgPSBhO1xyXG4iXX0=