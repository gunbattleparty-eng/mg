
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_14.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f2d07Kr61FJ479fAt2lTx5T', 'Bullet_14');
// game_script/scripts/Bullet_14.js

"use strict";

var o;

var $object = require("./Object");

var $remoteAudio = require("./RemoteAudio");

var $countDownUtil = require("./CountDownUtil");

var $globalParam = require("./GlobalParam");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var h = cc._decorator;
var m = h.ccclass;
var y = (h.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.pulse_laser;
    e.leftTime = 0;
    e.attackAtks = new Set();
    e.isSweep = !1;
    e.step = 2;
    e.currStep = 1;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    $remoteAudio["default"].instance.playLoopEffect("laser");
    this.attackAtks.clear();
    this.currStep = 1;
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
    this.step = this.isSweep ? this.skillParam.pulseLaserSweepCount : 1;
    this.leftTime = this.skillParam.pulseLaserTime * this.step;
    this.speed = 135 * this.step / this.leftTime;
    this.setAngle(30);
    var o = this.isSweep ? 1 : this.skillParam.pulseLaserWidthAdd;
    this.setScale(cc.v3(1, o));
  };

  e.prototype.onTrigger = function (t, e) {
    var i = t.object;

    if (e === $object.Trigger.enter) {
      if (this.attackAtks.has(i)) {
        return;
      }

      this.attackAtks.add(i);

      if (this.skillParam.pulseLaserSlowTime > 0) {
        var o = {
          type: $enemyStatus.EnemyDebuffType.SLOW,
          timeLeft: this.skillParam.pulseLaserSlowTime,
          value: this.skillParam.pulseLaserSlowAdd
        };
        i.sufferDebuff(o);
      }

      if (!this.isSweep) {
        if (this.skillParam.pulseLaserBack > 0) {
          var n = {
            type: $enemyStatus.EnemyDebuffType.BACK,
            timeLeft: -1,
            value: this.skillParam.pulseLaserBack
          };
          i.sufferDebuff(n);
        }

        for (var s = 0; s < this.skillParam.pulseLaserEnemyAtkAddParam.length; s++) {
          var a = this.skillParam.pulseLaserEnemyAtkAddParam;
          var c = {
            type: $enemyStatus.EnemyDebuffType.ALL_ATK_ADD,
            timeLeft: a[s][0],
            value: a[s][1]
          };
          i.sufferDebuff(c);
        }
      }
    } else {
      if (e === $object.Trigger.stay) {
        if ($countDownUtil.CountDownUtil.time - i.getLastAtkTime(1) <= this.skillParam.pulseLaserAtkInterval[$gameSkillInfo.Skill4Param.FINAL] / $gameContext["default"].ins.gameRatio) {
          return;
        }

        i.setLastAtkTime(1, $countDownUtil.CountDownUtil.time);
        this.skillParam.pulseLaserEnemySplit ? i.sufferAtk({
          id: this.skillId,
          skillSpecialitys: this.skillSpecialitys,
          atk: this.atk,
          bulletBuff: $baseBullet.BulletBuff.not_split
        }) : i.sufferAtk({
          id: this.skillId,
          skillSpecialitys: this.skillSpecialitys,
          atk: this.atk
        });
      }
    }
  };

  e.prototype.updateFrame = function (t) {
    if (!$globalParam["default"].isGamePuase) {
      this.leftTime -= t;
      this.isSweep ? this.currStep <= this.step && (1 === this.currStep ? (this.setAngle(this.getAngle() + this.speed * t), this.getAngle() >= 165 && (1 === this.step ? this.removeSelf() : this.currStep = 2)) : 2 === this.currStep && (this.setAngle(this.getAngle() - this.speed * t), this.getAngle() <= 30 && this.removeSelf())) : this.leftTime <= 0 && ($remoteAudio["default"].instance.stopLoopEffect("laser"), this.removeSelf());
    }
  };

  return __decorate([m], e);
}($baseBullet["default"]));
exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8xNC5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkcmVtb3RlQXVkaW8iLCIkY291bnREb3duVXRpbCIsIiRnbG9iYWxQYXJhbSIsIiRnYW1lQ29udGV4dCIsIiRnYW1lU2tpbGxJbmZvIiwiJGVuZW15U3RhdHVzIiwiJGJhc2VCdWxsZXQiLCJoIiwiY2MiLCJfZGVjb3JhdG9yIiwibSIsImNjY2xhc3MiLCJ5IiwicHJvcGVydHkiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYnV0dGxlVHlwZSIsIkJ1bGxldFR5cGUiLCJwdWxzZV9sYXNlciIsImxlZnRUaW1lIiwiYXR0YWNrQXRrcyIsIlNldCIsImlzU3dlZXAiLCJzdGVwIiwiY3VyclN0ZXAiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0QnV0dGxlIiwiaSIsImNhbGwiLCJpbnN0YW5jZSIsInBsYXlMb29wRWZmZWN0IiwiY2xlYXIiLCJhdGsiLCJza2lsbFBhcmFtIiwic2tpbGxBdGsiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwicHVsc2VMYXNlclN3ZWVwQ291bnQiLCJwdWxzZUxhc2VyVGltZSIsInNwZWVkIiwic2V0QW5nbGUiLCJwdWxzZUxhc2VyV2lkdGhBZGQiLCJzZXRTY2FsZSIsInYzIiwib25UcmlnZ2VyIiwib2JqZWN0IiwiVHJpZ2dlciIsImVudGVyIiwiaGFzIiwiYWRkIiwicHVsc2VMYXNlclNsb3dUaW1lIiwidHlwZSIsIkVuZW15RGVidWZmVHlwZSIsIlNMT1ciLCJ0aW1lTGVmdCIsInZhbHVlIiwicHVsc2VMYXNlclNsb3dBZGQiLCJzdWZmZXJEZWJ1ZmYiLCJwdWxzZUxhc2VyQmFjayIsIm4iLCJCQUNLIiwicyIsInB1bHNlTGFzZXJFbmVteUF0a0FkZFBhcmFtIiwibGVuZ3RoIiwiYSIsImMiLCJBTExfQVRLX0FERCIsInN0YXkiLCJDb3VudERvd25VdGlsIiwidGltZSIsImdldExhc3RBdGtUaW1lIiwicHVsc2VMYXNlckF0a0ludGVydmFsIiwiaW5zIiwiZ2FtZVJhdGlvIiwic2V0TGFzdEF0a1RpbWUiLCJwdWxzZUxhc2VyRW5lbXlTcGxpdCIsInN1ZmZlckF0ayIsImlkIiwic2tpbGxJZCIsInNraWxsU3BlY2lhbGl0eXMiLCJidWxsZXRCdWZmIiwiQnVsbGV0QnVmZiIsIm5vdF9zcGxpdCIsInVwZGF0ZUZyYW1lIiwiaXNHYW1lUHVhc2UiLCJnZXRBbmdsZSIsInJlbW92ZVNlbGYiLCJzdG9wTG9vcEVmZmVjdCIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxZQUFZLEdBQUdELE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlFLGNBQWMsR0FBR0YsT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlHLFlBQVksR0FBR0gsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSUksWUFBWSxHQUFHSixPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJSyxjQUFjLEdBQUdMLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJTSxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlPLFdBQVcsR0FBR1AsT0FBTyxDQUFDLGNBQUQsQ0FBekI7O0FBQ0EsSUFBSVEsQ0FBQyxHQUFHQyxFQUFFLENBQUNDLFVBQVg7QUFDQSxJQUFJQyxDQUFDLEdBQUdILENBQUMsQ0FBQ0ksT0FBVjtBQUNBLElBQUlDLENBQUMsSUFDQUwsQ0FBQyxDQUFDTSxRQUFGLEVBQ0EsVUFBVUMsQ0FBVixFQUFhO0VBQ1YsU0FBU0MsQ0FBVCxHQUFhO0lBQ1QsSUFBSUEsQ0FBQyxHQUFJLFNBQVNELENBQVQsSUFBY0EsQ0FBQyxDQUFDRSxLQUFGLENBQVEsSUFBUixFQUFj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QUFLRCxVQUFMLEVBQTlFLENBUk47SUFTSDtFQUNKLENBYkQ7O0VBY0EsT0FBT0UsVUFBVSxDQUFDLENBQUNqRixDQUFELENBQUQsRUFBTUssQ0FBTixDQUFqQjtBQUNILENBbkdELENBbUdHVCxXQUFXLFdBbkdkLENBRkMsQ0FBTDtBQXNHQXNGLE9BQU8sV0FBUCxHQUFrQmhGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRvYmplY3QgPSByZXF1aXJlKFwiLi9PYmplY3RcIik7XHJcbnZhciAkcmVtb3RlQXVkaW8gPSByZXF1aXJlKFwiLi9SZW1vdGVBdWRpb1wiKTtcclxudmFyICRjb3VudERvd25VdGlsID0gcmVxdWlyZShcIi4vQ291bnREb3duVXRpbFwiKTtcclxudmFyICRnbG9iYWxQYXJhbSA9IHJlcXVpcmUoXCIuL0dsb2JhbFBhcmFtXCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZ2FtZVNraWxsSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVTa2lsbEluZm9cIik7XHJcbnZhciAkZW5lbXlTdGF0dXMgPSByZXF1aXJlKFwiLi9FbmVteVN0YXR1c1wiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyIGggPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgbSA9IGguY2NjbGFzcztcclxudmFyIHkgPVxyXG4gICAgKGgucHJvcGVydHksXHJcbiAgICAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICAgICAgZS5idXR0bGVUeXBlID0gJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5wdWxzZV9sYXNlcjtcclxuICAgICAgICAgICAgZS5sZWZ0VGltZSA9IDA7XHJcbiAgICAgICAgICAgIGUuYXR0YWNrQXRrcyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAgICAgZS5pc1N3ZWVwID0gITE7XHJcbiAgICAgICAgICAgIGUuc3RlcCA9IDI7XHJcbiAgICAgICAgICAgIGUuY3VyclN0ZXAgPSAxO1xyXG4gICAgICAgICAgICByZXR1cm4gZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSwgaSkge1xyXG4gICAgICAgICAgICB0LnByb3RvdHlwZS5pbml0QnV0dGxlLmNhbGwodGhpcywgZSwgaSk7XHJcbiAgICAgICAgICAgICRyZW1vdGVBdWRpby5kZWZhdWx0Lmluc3RhbmNlLnBsYXlMb29wRWZmZWN0KFwibGFzZXJcIik7XHJcbiAgICAgICAgICAgIHRoaXMuYXR0YWNrQXRrcy5jbGVhcigpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJTdGVwID0gMTtcclxuICAgICAgICAgICAgdGhpcy5hdGsgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgICAgICB0aGlzLnN0ZXAgPSB0aGlzLmlzU3dlZXAgPyB0aGlzLnNraWxsUGFyYW0ucHVsc2VMYXNlclN3ZWVwQ291bnQgOiAxO1xyXG4gICAgICAgICAgICB0aGlzLmxlZnRUaW1lID0gdGhpcy5za2lsbFBhcmFtLnB1bHNlTGFzZXJUaW1lICogdGhpcy5zdGVwO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gKDEzNSAqIHRoaXMuc3RlcCkgLyB0aGlzLmxlZnRUaW1lO1xyXG4gICAgICAgICAgICB0aGlzLnNldEFuZ2xlKDMwKTtcclxuICAgICAgICAgICAgdmFyIG8gPSB0aGlzLmlzU3dlZXAgPyAxIDogdGhpcy5za2lsbFBhcmFtLnB1bHNlTGFzZXJXaWR0aEFkZDtcclxuICAgICAgICAgICAgdGhpcy5zZXRTY2FsZShjYy52MygxLCBvKSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5vblRyaWdnZXIgPSBmdW5jdGlvbiAodCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgICAgICBpZiAoZSA9PT0gJG9iamVjdC5UcmlnZ2VyLmVudGVyKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdHRhY2tBdGtzLmhhcyhpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNrQXRrcy5hZGQoaSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLnB1bHNlTGFzZXJTbG93VGltZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5TTE9XLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogdGhpcy5za2lsbFBhcmFtLnB1bHNlTGFzZXJTbG93VGltZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2tpbGxQYXJhbS5wdWxzZUxhc2VyU2xvd0FkZFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zdWZmZXJEZWJ1ZmYobyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNTd2VlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0ucHVsc2VMYXNlckJhY2sgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5CQUNLLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZUxlZnQ6IC0xLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2tpbGxQYXJhbS5wdWxzZUxhc2VyQmFja1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZihuKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCB0aGlzLnNraWxsUGFyYW0ucHVsc2VMYXNlckVuZW15QXRrQWRkUGFyYW0ubGVuZ3RoOyBzKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLnNraWxsUGFyYW0ucHVsc2VMYXNlckVuZW15QXRrQWRkUGFyYW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5BTExfQVRLX0FERCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0OiBhW3NdWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGFbc11bMV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaS5zdWZmZXJEZWJ1ZmYoYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT09ICRvYmplY3QuVHJpZ2dlci5zdGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY291bnREb3duVXRpbC5Db3VudERvd25VdGlsLnRpbWUgLSBpLmdldExhc3RBdGtUaW1lKDEpIDw9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbS5wdWxzZUxhc2VyQXRrSW50ZXJ2YWxbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdIC9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nYW1lUmF0aW9cclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpLnNldExhc3RBdGtUaW1lKDEsICRjb3VudERvd25VdGlsLkNvdW50RG93blV0aWwudGltZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnB1bHNlTGFzZXJFbmVteVNwbGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lsbFNwZWNpYWxpdHlzOiB0aGlzLnNraWxsU3BlY2lhbGl0eXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0azogdGhpcy5hdGssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1bGxldEJ1ZmY6ICRiYXNlQnVsbGV0LkJ1bGxldEJ1ZmYubm90X3NwbGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBpLnN1ZmZlckF0ayh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLnNraWxsSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraWxsU3BlY2lhbGl0eXM6IHRoaXMuc2tpbGxTcGVjaWFsaXR5cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRrOiB0aGlzLmF0a1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS51cGRhdGVGcmFtZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIGlmICghJGdsb2JhbFBhcmFtLmRlZmF1bHQuaXNHYW1lUHVhc2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubGVmdFRpbWUgLT0gdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNTd2VlcFxyXG4gICAgICAgICAgICAgICAgICAgID8gdGhpcy5jdXJyU3RlcCA8PSB0aGlzLnN0ZXAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICgxID09PSB0aGlzLmN1cnJTdGVwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPyAodGhpcy5zZXRBbmdsZSh0aGlzLmdldEFuZ2xlKCkgKyB0aGlzLnNwZWVkICogdCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEFuZ2xlKCkgPj0gMTY1ICYmICgxID09PSB0aGlzLnN0ZXAgPyB0aGlzLnJlbW92ZVNlbGYoKSA6ICh0aGlzLmN1cnJTdGVwID0gMikpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDogMiA9PT0gdGhpcy5jdXJyU3RlcCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMuc2V0QW5nbGUodGhpcy5nZXRBbmdsZSgpIC0gdGhpcy5zcGVlZCAqIHQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRBbmdsZSgpIDw9IDMwICYmIHRoaXMucmVtb3ZlU2VsZigpKSlcclxuICAgICAgICAgICAgICAgICAgICA6IHRoaXMubGVmdFRpbWUgPD0gMCAmJiAoJHJlbW90ZUF1ZGlvLmRlZmF1bHQuaW5zdGFuY2Uuc3RvcExvb3BFZmZlY3QoXCJsYXNlclwiKSwgdGhpcy5yZW1vdmVTZWxmKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gX19kZWNvcmF0ZShbbV0sIGUpO1xyXG4gICAgfSkoJGJhc2VCdWxsZXQuZGVmYXVsdCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSB5O1xyXG4iXX0=