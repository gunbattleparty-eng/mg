{"version":3,"sources":["assets\\game_script\\scripts\\Door.js"],"names":["o","$object","require","$assetsLoader","$assetsMap","$resUtil","$eventManager","$componentProxy","$gamePool","$localEventName","$baseBullet","$gameContext","$gameGemInfo","g","cc","_decorator","_","ccclass","k","property","v","Vec3","b","t","e","apply","arguments","hpProBar","hpLabel","sendBulletLeftTime","doorSkin","initHp","defHp","unitHp","duration","_time","atkCount","leftWall1Hp","leftWall2Hp","isFristBlood","invulnerabilityTime","bloodLine","addBloodLeftTime","addBlood","hurt","nextXs","__extends","prototype","start","instance","get","PoolKey","HURT","loadRes","BundleNames","Game","Prefab","i","sp","isValid","ResUtil","instantiate","node","on","ATK_DOOR","atkDoor","ADD_HP_DOOR","addHp","ins","doorInitHp","string","toString","GameGemInfo","hasGem","GemType","WallAdd","get2","SecWallBlood","get1","getComponent","dragonBones","ArmatureDisplay","Ins","pushObj","refreshRenderGem","onDestroy","call","off","removeObj","doorLeftHp","totalLength","progress","v3","atkAnim","WallDefAndEnemyAddHurt","n","s","Math","ceil","r","animationName","playAnimation","opacity","send","GAME_FAIL","WallBloodDef","checkGem","WallBloodAtk1","startGun","WallBloodAtk2","updateFrame","createButtle","skillInfo","hideCreateSkill","min","enemyLayer","children","length","push","position","x","shift","getButtlePool","BulletType","car","getRes","AssetsMap","GameBundles","prefabs","assetsList","Bullet_13","lowBulletLayer","parent","skillSpecialitys","isGem","setPosition","y","initButtle","insert","Label","fontSize","atkSize","color","atkColor","atkLayer","clone","add","Tween","stopAllByTarget","tween","to","gameRatio","__decorate","ProgressBar","cObject","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $componentProxy = require(\"./ComponentProxy\");\r\nvar $gamePool = require(\"./GamePool\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar g = cc._decorator;\r\nvar _ = g.ccclass;\r\nvar k = g.property;\r\nvar v = new cc.Vec3();\r\nvar b = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.hpProBar = null;\r\n        e.hpLabel = null;\r\n        e.sendBulletLeftTime = 0;\r\n        e.doorSkin = null;\r\n        e.initHp = 3e3;\r\n        e.defHp = 0;\r\n        e.unitHp = 0;\r\n        e.duration = 0.3;\r\n        e._time = 0;\r\n        e.atkCount = 0;\r\n        e.leftWall1Hp = 0;\r\n        e.leftWall2Hp = 0;\r\n        e.isFristBlood = !1;\r\n        e.invulnerabilityTime = -1;\r\n        e.bloodLine = 0;\r\n        e.addBloodLeftTime = 0;\r\n        e.addBlood = 0;\r\n        e.hurt = null;\r\n        e.nextXs = [];\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.start = function () {\r\n        var t = this;\r\n        this.hurt = $gamePool.default.instance.get($gamePool.PoolKey.HURT);\r\n        if (!this.hurt) {\r\n            $assetsLoader.default.instance.loadRes(\r\n                $assetsMap.BundleNames.Game,\r\n                [\"/prefabs/debuff/Hurt\"],\r\n                cc.Prefab,\r\n                null,\r\n                function (e, i) {\r\n                    var o = i[0];\r\n                    if (sp && cc.isValid(o)) {\r\n                        t.hurt = $resUtil.ResUtil.instantiate(o, t.node);\r\n                    }\r\n                }\r\n            );\r\n        }\r\n        $eventManager.default.on($localEventName.default.ATK_DOOR, this.atkDoor, this);\r\n        $eventManager.default.on($localEventName.default.ADD_HP_DOOR, this.addHp, this);\r\n        this.initHp = $gameContext.default.ins.doorInitHp;\r\n        this.hpLabel.string = this.initHp.toString();\r\n        if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallAdd)) {\r\n            var e = $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallAdd);\r\n            this.defHp += e[1];\r\n        }\r\n        if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.SecWallBlood)) {\r\n            this.addBlood = $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.SecWallBlood);\r\n            this.addBloodLeftTime = 10;\r\n        }\r\n        this.unitHp = this.initHp / 4;\r\n        this.doorSkin = this.node.getComponent(dragonBones.ArmatureDisplay);\r\n        $componentProxy.default.Ins.pushObj(this);\r\n        this.refreshRenderGem();\r\n    };\r\n    e.prototype.onDestroy = function () {\r\n        t.prototype.onDestroy.call(this);\r\n        $eventManager.default.off($localEventName.default.ATK_DOOR, this.atkDoor, this);\r\n        $eventManager.default.off($localEventName.default.ADD_HP_DOOR, this.addHp, this);\r\n        $componentProxy.default.Ins.removeObj(this);\r\n    };\r\n    e.prototype.addHp = function (t) {\r\n        if (!($gameContext.default.ins.doorLeftHp <= 0 || $gameContext.default.ins.doorLeftHp >= this.initHp)) {\r\n            $gameContext.default.ins.doorLeftHp += t;\r\n            if ($gameContext.default.ins.doorLeftHp > this.initHp) {\r\n                $gameContext.default.ins.doorLeftHp = this.initHp;\r\n            }\r\n            var e = -this.hpProBar.totalLength / 2 + this.hpProBar.totalLength * this.hpProBar.progress;\r\n            var i = cc.v3(e, -460);\r\n            this.hpProBar.progress = $gameContext.default.ins.doorLeftHp / this.initHp;\r\n            this.atkAnim(i, \"+\" + t, 2, 1);\r\n            this.hpLabel.string = $gameContext.default.ins.doorLeftHp.toString();\r\n        }\r\n    };\r\n    e.prototype.atkDoor = function (t) {\r\n        this.atkCount++;\r\n        if (\r\n            ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallDefAndEnemyAddHurt) &&\r\n                this.atkCount < $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallDefAndEnemyAddHurt)[0]) ||\r\n            (this.isFristBlood && this.invulnerabilityTime > 0)\r\n        ) {\r\n            var e = -this.hpProBar.totalLength / 2 + this.hpProBar.totalLength * this.hpProBar.progress;\r\n            var i = cc.v3(e, -460);\r\n            this.atkAnim(i, \"免伤\", 1, 1);\r\n            return this.atkCount;\r\n        }\r\n        var o = -this.hpProBar.totalLength / 2 + this.hpProBar.totalLength * this.hpProBar.progress;\r\n        var n = cc.v3(o, -460);\r\n        if ((t -= this.defHp) <= 0) {\r\n            this.atkAnim(n, \"格挡\", 1, 1);\r\n            return this.atkCount;\r\n        }\r\n        if ($gameContext.default.ins.doorLeftHp <= 0) {\r\n            return 0;\r\n        }\r\n        $gameContext.default.ins.doorLeftHp -= t;\r\n        if ($gameContext.default.ins.doorLeftHp < 0) {\r\n            $gameContext.default.ins.doorLeftHp = 0;\r\n        }\r\n        this.hpLabel.string = $gameContext.default.ins.doorLeftHp.toString();\r\n        this.hpProBar.progress = $gameContext.default.ins.doorLeftHp / this.initHp;\r\n        this.atkAnim(n, \"-\" + t, 1, 1);\r\n        var s = Math.ceil($gameContext.default.ins.doorLeftHp / this.unitHp);\r\n        var r = \"hp\" + (5 - (s = 0 === s ? 1 : s));\r\n        if (this.doorSkin.animationName !== r) {\r\n            this.doorSkin.playAnimation(r, 0);\r\n        }\r\n        if (this._time <= 0) {\r\n            this._time = 0.3;\r\n        }\r\n        if ($gameContext.default.ins.doorLeftHp <= 0) {\r\n            this._time = 0;\r\n            this.doorSkin.node.opacity = 1;\r\n            $eventManager.default.send($localEventName.default.GAME_FAIL);\r\n        }\r\n        if (\r\n            this.bloodLine < $gameContext.default.ins.doorLeftHp &&\r\n            !this.isFristBlood &&\r\n            $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallBloodDef)\r\n        ) {\r\n            this.isFristBlood = !0;\r\n        }\r\n        this.checkGem(t);\r\n        return this.atkCount;\r\n    };\r\n    e.prototype.checkGem = function (t) {\r\n        this.leftWall1Hp -= t;\r\n        this.leftWall2Hp -= t;\r\n        if (this.leftWall1Hp <= 0 && $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallBloodAtk1)) {\r\n            this.leftWall1Hp = this.initHp * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.WallBloodAtk1);\r\n            this.startGun(1);\r\n        }\r\n        if (this.leftWall2Hp <= 0 && $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallBloodAtk2)) {\r\n            this.leftWall2Hp = this.initHp * $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallBloodAtk2)[0];\r\n            this.startGun($gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallBloodAtk2)[1]);\r\n        }\r\n    };\r\n    e.prototype.refreshRenderGem = function () {\r\n        if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallBloodAtk1)) {\r\n            this.leftWall1Hp = this.initHp * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.WallBloodAtk1);\r\n        }\r\n        if (this.leftWall2Hp <= 0 && $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallBloodAtk2)) {\r\n            this.leftWall2Hp = this.initHp * $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallBloodAtk2)[0];\r\n        }\r\n        if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallBloodDef)) {\r\n            this.bloodLine = $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallBloodDef)[0] * this.initHp;\r\n            this.invulnerabilityTime = $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallBloodDef)[1];\r\n        }\r\n    };\r\n    e.prototype.updateFrame = function (t) {\r\n        if (this._time > 0) {\r\n            this._time -= t;\r\n            if (this._time <= 0) {\r\n                this._time = 0;\r\n            }\r\n            this._time = this._time < 0 ? 0 : this._time;\r\n            var e = Math.ceil((255 * this._time) / this.duration);\r\n            if (e < 1) {\r\n                e = 1;\r\n            }\r\n            this.doorSkin.node.opacity = e;\r\n        }\r\n        this.sendBulletLeftTime -= t;\r\n        if (this.sendBulletLeftTime <= 0) {\r\n            this.sendBulletLeftTime = 1;\r\n            this.createButtle();\r\n        }\r\n        if (-1 !== this.invulnerabilityTime && this.isFristBlood) {\r\n            this.invulnerabilityTime -= t;\r\n            if (this.invulnerabilityTime < 0) {\r\n                this.invulnerabilityTime = -1;\r\n            }\r\n        }\r\n        if (this.addBlood > 0) {\r\n            this.addBloodLeftTime -= t;\r\n            if (this.addBloodLeftTime <= 0) {\r\n                this.addBloodLeftTime = 10;\r\n                this.addHp(this.addBlood);\r\n            }\r\n        }\r\n    };\r\n    e.prototype.startGun = function (t) {\r\n        $gameContext.default.ins.skillInfo.hideCreateSkill(81);\r\n        var e = Math.min(t, $gameContext.default.ins.enemyLayer.children.length);\r\n        var i = !1;\r\n        for (var o = 0; o < e; o++) {\r\n            var n =\r\n                $gameContext.default.ins.enemyLayer.children[\r\n                    $gameContext.default.ins.enemyLayer.children.length - o - 1\r\n                ];\r\n            this.nextXs.push(n.position.x);\r\n            i = !0;\r\n        }\r\n        return i;\r\n    };\r\n    e.prototype.createButtle = function () {\r\n        if (!(this.nextXs.length <= 0)) {\r\n            var t = this.nextXs.shift();\r\n            var e = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.car);\r\n            if (!e) {\r\n                var i = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_13\r\n                );\r\n                (e = $resUtil.ResUtil.instantiate(i, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                    $baseBullet.default\r\n                )).skillSpecialitys = [];\r\n            }\r\n            e.isGem = !0;\r\n            e.setPosition(cc.v3(t, -350));\r\n            v.x = 0;\r\n            v.y = 1;\r\n            e.initButtle(v, 81);\r\n            e.insert($gameContext.default.ins.lowBulletLayer);\r\n        }\r\n    };\r\n    e.prototype.atkAnim = function (t, e, i, o) {\r\n        var n = this;\r\n        if (void 0 === i) {\r\n            i = 0;\r\n        }\r\n        if (void 0 === o) {\r\n            o = 0;\r\n        }\r\n        var s = this.hurt.getComponent(cc.Label);\r\n        s.fontSize = $gameContext.default.ins.atkSize[o];\r\n        s.string = e;\r\n        this.hurt.color = $gameContext.default.ins.atkColor[i];\r\n        this.hurt.parent = $gameContext.default.ins.atkLayer;\r\n        this.hurt.position = t.clone();\r\n        var r = t.add(cc.v3(0, 50));\r\n        cc.Tween.stopAllByTarget(this.hurt);\r\n        this.hurt.opacity = 255;\r\n        cc.tween(this.hurt)\r\n            .to(0.5 / $gameContext.default.ins.gameRatio, {\r\n                position: r\r\n            })\r\n            .call(function () {\r\n                n.hurt.opacity = 0;\r\n            })\r\n            .start();\r\n    };\r\n    __decorate([k(cc.ProgressBar)], e.prototype, \"hpProBar\", void 0);\r\n    __decorate([k(cc.Label)], e.prototype, \"hpLabel\", void 0);\r\n    return __decorate([_], e);\r\n})($object.cObject);\r\nexports.default = b;\r\n"]}