{"version":3,"sources":["assets\\game_script\\scripts\\Bullet_24.js"],"names":["o","$object","require","$assetsLoader","$assetsMap","$resUtil","$configContext","$gameContext","$enemyStatus","$baseBullet","h","cc","_decorator","m","ccclass","y","property","t","e","apply","arguments","buttleType","BulletType","oil","enemys","Set","targetPos","targetEnemy","flyTime","timeLeft","__extends","prototype","initButtle","i","call","speed","skillParam","oilSpeed","velocity","set","multiplyScalar","setAngle","sub","getPosition","mag","onTrigger","isUse","Trigger","enter","object","add","exit","updateFrame","node","children","scale","easeSine","attack","removeSelf","forEach","sufferDebuff","type","EnemyDebuffType","BACK","value","oilBack","oilExtraSend","has","config","monster_type","createSelf","createBoom","createBurnArea","ins","getRandomEnemy","getButtlePool","instance","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","Bullet_24","ResUtil","instantiate","buttleLayer","parent","getComponent","skillSpecialitys","basicSkillConfigMap","get","skillId","skill_tpye","clone","setPosition","normalize","insert","oil_boom","Bullet_25","lowBulletLayer","setAnimation","oil_burn_area","Bullet_26","floorLayer","Math","sin","PI","__decorate","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $enemyStatus = require(\"./EnemyStatus\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar h = cc._decorator;\r\nvar m = h.ccclass;\r\nvar y =\r\n    (h.property,\r\n    (function (t) {\r\n        function e() {\r\n            var e = (null !== t && t.apply(this, arguments)) || this;\r\n            e.buttleType = $baseBullet.BulletType.oil;\r\n            e.enemys = new Set();\r\n            e.targetPos = null;\r\n            e.targetEnemy = null;\r\n            e.flyTime = 0;\r\n            e.timeLeft = 0;\r\n            return e;\r\n        }\r\n        __extends(e, t);\r\n        e.prototype.initButtle = function (e, i) {\r\n            t.prototype.initButtle.call(this, e, i);\r\n            this.speed = this.skillParam.oilSpeed;\r\n            this.velocity.set(e).multiplyScalar(this.speed);\r\n            this.setAngle(0);\r\n            this.timeLeft = 0;\r\n            this.flyTime = this.targetPos.sub(this.getPosition()).mag() / this.speed;\r\n        };\r\n        e.prototype.onTrigger = function (t, e) {\r\n            if (!this.isUse) {\r\n                if (e == $object.Trigger.enter) {\r\n                    var i = t.object;\r\n                    this.enemys.add(i);\r\n                } else {\r\n                    if (e == $object.Trigger.exit) {\r\n                        i = t.object;\r\n                        this.enemys.delete(i);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        e.prototype.updateFrame = function (e) {\r\n            if (!this.isUse) {\r\n                t.prototype.updateFrame.call(this, e);\r\n                this.timeLeft += e;\r\n                if (this.timeLeft >= this.flyTime) {\r\n                    this.timeLeft = this.flyTime;\r\n                    this.isUse = !0;\r\n                }\r\n                this.node.children[0].scale = this.easeSine(this.timeLeft, 1, 0.5, this.flyTime);\r\n                if (this.isUse) {\r\n                    this.attack();\r\n                    this.removeSelf();\r\n                }\r\n            }\r\n        };\r\n        e.prototype.attack = function () {\r\n            var t = this;\r\n            this.enemys.forEach(function (e) {\r\n                e.sufferDebuff({\r\n                    type: $enemyStatus.EnemyDebuffType.BACK,\r\n                    timeLeft: -1,\r\n                    value: t.skillParam.oilBack\r\n                });\r\n                if (\r\n                    t.skillParam.oilExtraSend &&\r\n                    t.targetEnemy &&\r\n                    t.targetEnemy === e &&\r\n                    t.enemys.has(e) &&\r\n                    2 !== t.targetEnemy.config.monster_type\r\n                ) {\r\n                    t.createSelf();\r\n                }\r\n            });\r\n            this.createBoom();\r\n            this.createBurnArea();\r\n        };\r\n        e.prototype.createSelf = function () {\r\n            var t = $gameContext.default.ins.getRandomEnemy();\r\n            if (t) {\r\n                var e = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.oil);\r\n                if (!e) {\r\n                    var i = $assetsLoader.default.instance.getRes(\r\n                        $assetsMap.BundleNames.Game,\r\n                        $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_24\r\n                    );\r\n                    (e = $resUtil.ResUtil.instantiate(i, $gameContext.default.ins.buttleLayer.parent).getComponent(\r\n                        $baseBullet.default\r\n                    )).skillSpecialitys = $configContext.default.instance.basicSkillConfigMap.get(\r\n                        this.skillId\r\n                    ).skill_tpye;\r\n                }\r\n                e.targetPos = t.getPosition().clone();\r\n                e.targetEnemy = null;\r\n                e.setPosition(this.getPosition());\r\n                var o = t.getPosition().sub(this.getPosition()).normalize();\r\n                e.initButtle(o, this.skillId);\r\n                e.insert($gameContext.default.ins.buttleLayer);\r\n            }\r\n        };\r\n        e.prototype.createBoom = function () {\r\n            var t = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.oil_boom);\r\n            if (!t) {\r\n                var e = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_25\r\n                );\r\n                (t = $resUtil.ResUtil.instantiate(e, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                    $baseBullet.default\r\n                )).skillSpecialitys = this.skillSpecialitys;\r\n            }\r\n            t.setPosition(this.getPosition());\r\n            t.initButtle(null, this.skillId);\r\n            t.insert($gameContext.default.ins.lowBulletLayer);\r\n            t.setAnimation(null);\r\n        };\r\n        e.prototype.createBurnArea = function () {\r\n            var t = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.oil_burn_area);\r\n            if (!t) {\r\n                var e = $assetsLoader.default.instance.getRes(\r\n                    $assetsMap.BundleNames.Game,\r\n                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_26\r\n                );\r\n                (t = $resUtil.ResUtil.instantiate(e, $gameContext.default.ins.floorLayer.parent).getComponent(\r\n                    $baseBullet.default\r\n                )).skillSpecialitys = this.skillSpecialitys;\r\n            }\r\n            t.setPosition(this.getPosition());\r\n            t.initButtle(null, this.skillId);\r\n            t.insert($gameContext.default.ins.floorLayer);\r\n        };\r\n        e.prototype.easeSine = function (t, e, i, o) {\r\n            return i * Math.sin((t / o) * Math.PI) + e;\r\n        };\r\n        return __decorate([m], e);\r\n    })($baseBullet.default));\r\nexports.default = y;\r\n"]}