
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/RankView.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'f21088CkE5J25uRSblpGHLz', 'RankView');
// game_script/scripts/RankView.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $list = require("./List");

var $popupView = require("./PopupView");

var $util = require("./Util");

var $rankService = require("./RankService");

var f = cc._decorator;
var h = f.ccclass;
var m = f.property;

var y = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.list = null;
    e.selfLayer = null;
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {
    var t = $rankService["default"].instance.getRankList($rankService.RankTypeEnum.Level);

    if (t.length > 0) {
      this.list.numItems = t.length;
    }
  };

  e.prototype.onListRender = function (t, e) {
    var i = $rankService["default"].instance.getRankList($rankService.RankTypeEnum.Level)[e];
    this.rankItem(t, i, e + 1);
  };

  e.prototype.onResetView = function () {
    var t = this;
    this.renderSelf();
    $rankService["default"].instance.refreshAllRankList(function () {
      var e = $rankService["default"].instance.getRankList($rankService.RankTypeEnum.Level);

      if (e.length > 0) {
        t.list.numItems = e.length;
        t.list.updateAll();
      }

      t.renderSelf();
    });
  };

  e.prototype.renderSelf = function () {
    var t = $rankService["default"].instance.getRankSelf($rankService.RankTypeEnum.Level);

    if (t) {
      this.rankItem(this.selfLayer, t, t.rank);
    }
  };

  e.prototype.rankItem = function (t, e, i) {
    var o = this;
    var n = $util["default"].parseObject(e.extendParams);
    t.children[0].children[0].active = 2 === i;
    t.children[0].children[1].active = 3 === i;
    t.children[0].children[2].active = i > 3;
    var s = t.getChildByName("rank_label");

    if (s) {
      var c = s.getComponent(cc.Label);
      var u = i <= 100 ? i.toString() : "-";
      c.string = u;
    }

    t.getChildByName("name_label").getComponent(cc.Label).string = this.nameProccess(n.un);
    t.getChildByName("grade_label").getComponent(cc.Label).string = n.g;
    t.getChildByName("level_label").getComponent(cc.Label).string = n.l;
    var p = t.getChildByName("head_icon").getComponent(cc.Sprite);
    $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public_Res, ["/head_icon/tx" + n.h], cc.SpriteFrame, null, function (t, e) {
      var i = e[0];

      if (i && cc.isValid(p)) {
        p.spriteFrame = $resUtil.ResUtil.assignWith(i, o.node);
      }
    });
  };

  e.prototype.nameProccess = function (t) {
    var e = t;
    return t.length <= 8 ? e : t.substring(0, 4) + "..." + t.substring(t.length - 3);
  };

  __decorate([m($list["default"])], e.prototype, "list", void 0);

  __decorate([m(cc.Node)], e.prototype, "selfLayer", void 0);

  return __decorate([h], e);
}($popupView.PopupView);

exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFJhbmtWaWV3LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRsaXN0IiwiJHBvcHVwVmlldyIsIiR1dGlsIiwiJHJhbmtTZXJ2aWNlIiwiZiIsImNjIiwiX2RlY29yYXRvciIsImgiLCJjY2NsYXNzIiwibSIsInByb3BlcnR5IiwieSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJsaXN0Iiwic2VsZkxheWVyIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwiaW5zdGFuY2UiLCJnZXRSYW5rTGlzdCIsIlJhbmtUeXBlRW51bSIsIkxldmVsIiwibGVuZ3RoIiwibnVtSXRlbXMiLCJvbkxpc3RSZW5kZXIiLCJpIiwicmFua0l0ZW0iLCJvblJlc2V0VmlldyIsInJlbmRlclNlbGYiLCJyZWZyZXNoQWxsUmFua0xpc3QiLCJ1cGRhdGVBbGwiLCJnZXRSYW5rU2VsZiIsInJhbmsiLCJuIiwicGFyc2VPYmplY3QiLCJleHRlbmRQYXJhbXMiLCJjaGlsZHJlbiIsImFjdGl2ZSIsInMiLCJnZXRDaGlsZEJ5TmFtZSIsImMiLCJnZXRDb21wb25lbnQiLCJMYWJlbCIsInUiLCJ0b1N0cmluZyIsInN0cmluZyIsIm5hbWVQcm9jY2VzcyIsInVuIiwiZyIsImwiLCJwIiwiU3ByaXRlIiwibG9hZFJlcyIsIkJ1bmRsZU5hbWVzIiwiUHVibGljX1JlcyIsIlNwcml0ZUZyYW1lIiwiaXNWYWxpZCIsInNwcml0ZUZyYW1lIiwiUmVzVXRpbCIsImFzc2lnbldpdGgiLCJub2RlIiwic3Vic3RyaW5nIiwiX19kZWNvcmF0ZSIsIk5vZGUiLCJQb3B1cFZpZXciLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQs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Q0FBWixHQUFnQlosQ0FBaEIsR0FBb0JELENBQUMsQ0FBQ29ELFNBQUYsQ0FBWSxDQUFaLEVBQWUsQ0FBZixJQUFvQixLQUFwQixHQUE0QnBELENBQUMsQ0FBQ29ELFNBQUYsQ0FBWXBELENBQUMsQ0FBQ2EsTUFBRixHQUFXLENBQXZCLENBQXZEO0VBQ0gsQ0FIRDs7RUFJQXdDLFVBQVUsQ0FBQyxDQUFDeEQsQ0FBQyxDQUFDVCxLQUFLLFdBQU4sQ0FBRixDQUFELEVBQXFCYSxDQUFDLENBQUNNLFNBQXZCLEVBQWtDLE1BQWxDLEVBQTBDLEtBQUssQ0FBL0MsQ0FBVjs7RUFDQThDLFVBQVUsQ0FBQyxDQUFDeEQsQ0FBQyxDQUFDSixFQUFFLENBQUM2RCxJQUFKLENBQUYsQ0FBRCxFQUFlckQsQ0FBQyxDQUFDTSxTQUFqQixFQUE0QixXQUE1QixFQUF5QyxLQUFLLENBQTlDLENBQVY7O0VBQ0EsT0FBTzhDLFVBQVUsQ0FBQyxDQUFDMUQsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBakI7QUFDSCxDQXhFTyxDQXdFTFosVUFBVSxDQUFDa0UsU0F4RU4sQ0FBUjs7QUF5RUFDLE9BQU8sV0FBUCxHQUFrQnpELENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGxpc3QgPSByZXF1aXJlKFwiLi9MaXN0XCIpO1xyXG52YXIgJHBvcHVwVmlldyA9IHJlcXVpcmUoXCIuL1BvcHVwVmlld1wiKTtcclxudmFyICR1dGlsID0gcmVxdWlyZShcIi4vVXRpbFwiKTtcclxudmFyICRyYW5rU2VydmljZSA9IHJlcXVpcmUoXCIuL1JhbmtTZXJ2aWNlXCIpO1xyXG52YXIgZiA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciBoID0gZi5jY2NsYXNzO1xyXG52YXIgbSA9IGYucHJvcGVydHk7XHJcbnZhciB5ID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUubGlzdCA9IG51bGw7XHJcbiAgICAgICAgZS5zZWxmTGF5ZXIgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUub25Mb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gJHJhbmtTZXJ2aWNlLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmFua0xpc3QoJHJhbmtTZXJ2aWNlLlJhbmtUeXBlRW51bS5MZXZlbCk7XHJcbiAgICAgICAgaWYgKHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmxpc3QubnVtSXRlbXMgPSB0Lmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25MaXN0UmVuZGVyID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB2YXIgaSA9ICRyYW5rU2VydmljZS5kZWZhdWx0Lmluc3RhbmNlLmdldFJhbmtMaXN0KCRyYW5rU2VydmljZS5SYW5rVHlwZUVudW0uTGV2ZWwpW2VdO1xyXG4gICAgICAgIHRoaXMucmFua0l0ZW0odCwgaSwgZSArIDEpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uUmVzZXRWaWV3ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICB0aGlzLnJlbmRlclNlbGYoKTtcclxuICAgICAgICAkcmFua1NlcnZpY2UuZGVmYXVsdC5pbnN0YW5jZS5yZWZyZXNoQWxsUmFua0xpc3QoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9ICRyYW5rU2VydmljZS5kZWZhdWx0Lmluc3RhbmNlLmdldFJhbmtMaXN0KCRyYW5rU2VydmljZS5SYW5rVHlwZUVudW0uTGV2ZWwpO1xyXG4gICAgICAgICAgICBpZiAoZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0Lmxpc3QubnVtSXRlbXMgPSBlLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIHQubGlzdC51cGRhdGVBbGwoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnJlbmRlclNlbGYoKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW5kZXJTZWxmID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gJHJhbmtTZXJ2aWNlLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmFua1NlbGYoJHJhbmtTZXJ2aWNlLlJhbmtUeXBlRW51bS5MZXZlbCk7XHJcbiAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgdGhpcy5yYW5rSXRlbSh0aGlzLnNlbGZMYXllciwgdCwgdC5yYW5rKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmFua0l0ZW0gPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBvID0gdGhpcztcclxuICAgICAgICB2YXIgbiA9ICR1dGlsLmRlZmF1bHQucGFyc2VPYmplY3QoZS5leHRlbmRQYXJhbXMpO1xyXG4gICAgICAgIHQuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0uYWN0aXZlID0gMiA9PT0gaTtcclxuICAgICAgICB0LmNoaWxkcmVuWzBdLmNoaWxkcmVuWzFdLmFjdGl2ZSA9IDMgPT09IGk7XHJcbiAgICAgICAgdC5jaGlsZHJlblswXS5jaGlsZHJlblsyXS5hY3RpdmUgPSBpID4gMztcclxuICAgICAgICB2YXIgcyA9IHQuZ2V0Q2hpbGRCeU5hbWUoXCJyYW5rX2xhYmVsXCIpO1xyXG4gICAgICAgIGlmIChzKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gcy5nZXRDb21wb25lbnQoY2MuTGFiZWwpO1xyXG4gICAgICAgICAgICB2YXIgdSA9IGkgPD0gMTAwID8gaS50b1N0cmluZygpIDogXCItXCI7XHJcbiAgICAgICAgICAgIGMuc3RyaW5nID0gdTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdC5nZXRDaGlsZEJ5TmFtZShcIm5hbWVfbGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSB0aGlzLm5hbWVQcm9jY2VzcyhuLnVuKTtcclxuICAgICAgICB0LmdldENoaWxkQnlOYW1lKFwiZ3JhZGVfbGFiZWxcIikuZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBuLmc7XHJcbiAgICAgICAgdC5nZXRDaGlsZEJ5TmFtZShcImxldmVsX2xhYmVsXCIpLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gbi5sO1xyXG4gICAgICAgIHZhciBwID0gdC5nZXRDaGlsZEJ5TmFtZShcImhlYWRfaWNvblwiKS5nZXRDb21wb25lbnQoY2MuU3ByaXRlKTtcclxuICAgICAgICAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UubG9hZFJlcyhcclxuICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5QdWJsaWNfUmVzLFxyXG4gICAgICAgICAgICBbXCIvaGVhZF9pY29uL3R4XCIgKyBuLmhdLFxyXG4gICAgICAgICAgICBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpID0gZVswXTtcclxuICAgICAgICAgICAgICAgIGlmIChpICYmIGNjLmlzVmFsaWQocCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKGksIG8ubm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm5hbWVQcm9jY2VzcyA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB0O1xyXG4gICAgICAgIHJldHVybiB0Lmxlbmd0aCA8PSA4ID8gZSA6IHQuc3Vic3RyaW5nKDAsIDQpICsgXCIuLi5cIiArIHQuc3Vic3RyaW5nKHQubGVuZ3RoIC0gMyk7XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbbSgkbGlzdC5kZWZhdWx0KV0sIGUucHJvdG90eXBlLCBcImxpc3RcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW20oY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJzZWxmTGF5ZXJcIiwgdm9pZCAwKTtcclxuICAgIHJldHVybiBfX2RlY29yYXRlKFtoXSwgZSk7XHJcbn0pKCRwb3B1cFZpZXcuUG9wdXBWaWV3KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0geTtcclxuIl19