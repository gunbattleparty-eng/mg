
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_29.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e2e98RrwxNCObVrpeoMy5FU', 'Bullet_29');
// game_script/scripts/Bullet_29.js

"use strict";

var o;

var $object = require("./Object");

var $shape = require("./Shape");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $countDownUtil = require("./CountDownUtil");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var _ = cc._decorator;
var k = _.ccclass;
var v = (_.property, cc.Vec3.ZERO);

var b = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.drat;
    e._type = $shape.ShapeType.Sphere;
    e.currentSpeedStatus = 1;
    e.attackEnemys = new Set();
    e.timeLeft = 0;
    e.delayTime = 0;
    e.rebound = 0;
    e.r = 70;
    e.anim = null;
    e.animName = "bullet_29";
    e.isLoadedSkin = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.attackEnemys.clear();
    this.currentSpeedStatus = 1;
    this.rebound = 0;
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];
    var o = this.skillParam.size;
    this.timeLeft = this.skillParam.time[$gameSkillInfo.Skill4Param.FINAL];
    this.delayTime = this.skillParam.delayRecover;
    this.setScale(cc.v3(o, o));
    this.r = 70 * o;
    this.changeSpeed(0);

    if (!this.anim) {
      this.anim = this.node.children[0].getComponent(cc.Animation);
    }

    this.setAnimation(null);
    this.loadSkin();
  };

  e.prototype.loadSkin = function () {
    var t = this;

    if (!this.isLoadedSkin && this.skillParam.burnTime > 0) {
      this.isLoadedSkin = !0;
      $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Game, ["/anim/bullet_29_1"], cc.AnimationClip, null, function (e, i) {
        var o = i[0];

        if (sp && cc.isValid(o)) {
          t.animName = "bullet_29_1";
          $resUtil.ResUtil.assignWith(o, $gameContext["default"].ins.buttleLayer.parent);
          t.anim.addClip(o);
          t.anim.play(t.animName);
        }
      });
    }
  };

  e.prototype.setAnimation = function () {
    this.anim.play(this.animName);
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse) {
      if (e == $object.Trigger.enter) {
        var i = t.object;
        this.attackEnemys.add(i);

        if (this.skillParam.stunTime > 0) {
          i.sufferDebuff({
            type: $enemyStatus.EnemyDebuffType.STUN,
            timeLeft: this.skillParam.stunTime,
            value: 0
          });
        }

        if (this.skillParam.burnTime > 0) {
          i.sufferDebuff({
            type: $enemyStatus.EnemyDebuffType.BURN,
            timeLeft: this.skillParam.burnTime,
            value: this.skillParam.burnAtk[$gameSkillInfo.Skill4Param.FINAL]
          });
        }

        if (this.skillParam.enemySlowTime > 0) {
          i.sufferDebuff({
            type: $enemyStatus.EnemyDebuffType.SLOW,
            timeLeft: this.skillParam.enemySlowTime,
            value: this.skillParam.enemySlowAdd
          });
        }
      } else {
        if (e == $object.Trigger.stay) {
          i = t.object;

          if ($countDownUtil.CountDownUtil.time - i.getLastAtkTime(8) <= this.skillParam.interval / $gameContext["default"].ins.gameRatio) {
            return;
          }

          i.setLastAtkTime(8, $countDownUtil.CountDownUtil.time);
          i.sufferAtk({
            id: this.skillId,
            skillSpecialitys: this.skillSpecialitys,
            atk: this.atk
          });
        } else {
          if (e == $object.Trigger.exit) {
            i = t.object;
            this.attackEnemys["delete"](i);
          }
        }
      }
    }
  };

  e.prototype.updateFrame = function (t) {
    if (!this.isUse) {
      this.timeLeft -= t;

      if (0 === this.currentSpeedStatus) {
        if (this.attackEnemys.size > 0) {
          this.delayTime = this.skillParam.delayRecover;
          this.changeSpeed(1);
        }
      } else {
        if (1 === this.currentSpeedStatus) {
          if (this.attackEnemys.size <= 0) {
            this.delayTime -= t;

            if (this.delayTime <= 0) {
              this.delayTime = this.skillParam.delayRecover;
              this.changeSpeed(0);
            }
          }
        } else {
          if (2 === this.currentSpeedStatus) {
            return void (this.timeLeft <= 0 && (this.attackEnemys.clear(), this.isUse = !0, this.removeSelf()));
          }
        }
      }

      if (this.timeLeft <= 0) {
        this.currentSpeedStatus = 2;
        this.timeLeft = this.skillParam.stayTime;
        this.sendRelease();
      }

      this.move(t);
    }
  };

  e.prototype.changeSpeed = function (t) {
    if (this.currentSpeedStatus !== t) {
      this.currentSpeedStatus = t;
      0 === this.currentSpeedStatus ? this.speed = this.skillParam.getNormalSpeed(this.rebound) : this.speed = this.skillParam.getSlowSpeed();
      this.velocity.normalizeSelf().multiplyScalar(this.speed);
    }
  };

  e.prototype.move = function (t) {
    var e = this.getPosition();
    var i = this.velocity;
    v.x = e.x + i.x * t;
    v.y = e.y + i.y * t;
    v.z = e.z + i.z * t;
    v.x < -360 + this.r ? (v.x = -360 + this.r + 1, this.velocity.x = -this.velocity.x, this.rebound++) : v.x > 360 - this.r && (v.x = 360 - this.r - 1, this.velocity.x = -this.velocity.x, this.rebound++);
    v.y < -450 + this.r ? (v.y = -450 + this.r + 1, this.velocity.y = -this.velocity.y, this.rebound++) : v.y > cc.winSize.height / 2 - this.r && (v.y = cc.winSize.height / 2 - this.r - 1, this.velocity.y = -this.velocity.y, this.rebound++);
    this.setPosition(v);
  };

  e.prototype.sendRelease = function () {
    if (!(this.skillParam.releaseCount <= 0)) {
      for (var t = 0; t < 2; t++) {
        var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.drat_release);

        if (!e) {
          var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_30);
          (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
        }

        var o = cc.Vec3.ZERO;
        o.x = 0 === t ? $seedUtil["default"].randomFloat(-1, 0) : $seedUtil["default"].randomFloat(0, 1);
        o.y = $seedUtil["default"].randomFloat(-1, 1);
        o.normalizeSelf();
        e.setPosition(this.getPosition());
        e.initButtle(o, this.skillId);
        e.insert($gameContext["default"].ins.lowBulletLayer);
      }
    }
  };

  return __decorate([k], e);
}($baseBullet["default"]);

exports["default"] = b;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8yOS5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkc2hhcGUiLCIkYXNzZXRzTG9hZGVyIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGNvdW50RG93blV0aWwiLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRnYW1lQ29udGV4dCIsIiRnYW1lU2tpbGxJbmZvIiwiJGVuZW15U3RhdHVzIiwiJGJhc2VCdWxsZXQiLCJfIiwiY2MiLCJfZGVjb3JhdG9yIiwiayIsImNjY2xhc3MiLCJ2IiwicHJvcGVydHkiLCJWZWMzIiwiWkVSTyIsImIiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYnV0dGxlVHlwZSIsIkJ1bGxldFR5cGUiLCJkcmF0IiwiX3R5cGUiLCJTaGFwZVR5cGUiLCJTcGhlcmUiLCJjdXJyZW50U3BlZWRTdGF0dXMiLCJhdHRhY2tFbmVteXMiLCJTZXQiLCJ0aW1lTGVmdCIsImRlbGF5VGltZSIsInJlYm91bmQiLCJyIiwiYW5pbSIsImFuaW1OYW1lIiwiaXNMb2FkZWRTa2luIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEJ1dHRsZSIsImkiLCJjYWxsIiwiY2xlYXIiLCJhdGsiLCJza2lsbFBhcmFtIiwic2tpbGxBdGsiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwic2l6ZSIsInRpbWUiLCJkZWxheVJlY292ZXIiLCJzZXRTY2FsZSIsInYzIiwiY2hhbmdlU3BlZWQiLCJub2RlIiwiY2hpbGRyZW4iLCJnZXRDb21wb25lbnQiLCJBbmltYXRpb24iLCJzZXRBbmltYXRpb24iLCJsb2FkU2tpbiIsImJ1cm5UaW1lIiwiaW5zdGFuY2UiLCJsb2FkUmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQW5pbWF0aW9uQ2xpcCIsInNwIiwiaXNWYWxpZCIsIlJlc1V0aWwiLCJhc3NpZ25XaXRoIiwiaW5zIiwiYnV0dGxlTGF5ZXIiLCJwYXJlbnQiLCJhZGRDbGlwIiwicGxheSIsIm9uVHJpZ2dlciIsImlzVXNlIiwiVHJpZ2dlciIsImVudGVyIiwib2JqZWN0IiwiYWRkIiwic3R1blRpbWUiLCJzdWZmZXJEZWJ1ZmYiLCJ0eXBlIiwiRW5lbXlEZWJ1ZmZUeXBlIiwiU1RVTiIsInZhbHVlIiwiQlVSTiIsImJ1cm5BdGsiLCJlbmVteVNsb3dUaW1lIiwiU0xPVyIsImVuZW15U2xvd0FkZCIsInN0YXkiLCJDb3VudERvd25VdGlsIiwiZ2V0TGFzdEF0a1RpbWUiLCJpbnRlcnZhbCIsImdhbWVSYXRpbyIsInNldExhc3RBdGtUaW1lIiwic3VmZmVyQXRrIiwiaWQiLCJza2lsbElkIiwic2tpbGxTcGVjaWFsaXR5cyIsImV4aXQiLCJ1cGRhdGVGcmFtZSIsInJlbW92ZVNlbGYiLCJzdGF5VGltZSIsInNlbmRSZWxlYXNlIiwibW92ZSIsInNwZWVkIiwiZ2V0Tm9ybWFsU3BlZWQiLCJnZXRTbG93U3BlZWQiLCJ2ZWxvY2l0eSIsIm5vcm1hbGl6ZVNlbGYiLCJtdWx0aXBseVNjYWxhciIsImdldFBvc2l0aW9uIiwieCIsInkiLCJ6Iiwid2luU2l6ZSIsImhlaWdodCIsInNldFBvc2l0aW9uIiwicmVsZWFzZUNvdW50IiwiZ2V0QnV0dGxlUG9vbCIsImRyYXRfcmVsZWFzZSIsImdldFJlcyIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJCdWxsZXRfMzAiLCJpbnN0YW50aWF0ZSIsImxvd0J1bGxldExheWVyIiwiYmFzaWNTa2lsbENvbmZpZ01hcCIsImdldCIsInNraWxsX3RweWUiLCJyYW5kb21GbG9hdCIsImluc2VydCIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxTQUFELENBQXBCOztB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QUFrQyxDQUFsQyxDQUFWLEdBQWlEdEksU0FBUyxXQUFULENBQWtCc0ksV0FBbEIsQ0FBOEIsQ0FBOUIsRUFBaUMsQ0FBakMsQ0FBdkQ7UUFDQTlJLENBQUMsQ0FBQzJILENBQUYsR0FBTW5ILFNBQVMsV0FBVCxDQUFrQnNJLFdBQWxCLENBQThCLENBQUMsQ0FBL0IsRUFBa0MsQ0FBbEMsQ0FBTjtRQUNBOUksQ0FBQyxDQUFDdUgsYUFBRjtRQUNBOUYsQ0FBQyxDQUFDc0csV0FBRixDQUFjLEtBQUtOLFdBQUwsRUFBZDtRQUNBaEcsQ0FBQyxDQUFDcUIsVUFBRixDQUFhOUMsQ0FBYixFQUFnQixLQUFLMkcsT0FBckI7UUFDQWxGLENBQUMsQ0FBQ3NILE1BQUYsQ0FBU3JJLFlBQVksV0FBWixDQUFxQm1FLEdBQXJCLENBQXlCNkQsY0FBbEM7TUFDSDtJQUNKO0VBQ0osQ0F4QkQ7O0VBeUJBLE9BQU9NLFVBQVUsQ0FBQyxDQUFDL0gsQ0FBRCxDQUFELEVBQU1RLENBQU4sQ0FBakI7QUFDSCxDQWhNTyxDQWdNTFosV0FBVyxXQWhNTixDQUFSOztBQWlNQW9JLE9BQU8sV0FBUCxHQUFrQjFILENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRvYmplY3QgPSByZXF1aXJlKFwiLi9PYmplY3RcIik7XHJcbnZhciAkc2hhcGUgPSByZXF1aXJlKFwiLi9TaGFwZVwiKTtcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGNvdW50RG93blV0aWwgPSByZXF1aXJlKFwiLi9Db3VudERvd25VdGlsXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRlbmVteVN0YXR1cyA9IHJlcXVpcmUoXCIuL0VuZW15U3RhdHVzXCIpO1xyXG52YXIgJGJhc2VCdWxsZXQgPSByZXF1aXJlKFwiLi9CYXNlQnVsbGV0XCIpO1xyXG52YXIgXyA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciBrID0gXy5jY2NsYXNzO1xyXG52YXIgdiA9IChfLnByb3BlcnR5LCBjYy5WZWMzLlpFUk8pO1xyXG52YXIgYiA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLmJ1dHRsZVR5cGUgPSAkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLmRyYXQ7XHJcbiAgICAgICAgZS5fdHlwZSA9ICRzaGFwZS5TaGFwZVR5cGUuU3BoZXJlO1xyXG4gICAgICAgIGUuY3VycmVudFNwZWVkU3RhdHVzID0gMTtcclxuICAgICAgICBlLmF0dGFja0VuZW15cyA9IG5ldyBTZXQoKTtcclxuICAgICAgICBlLnRpbWVMZWZ0ID0gMDtcclxuICAgICAgICBlLmRlbGF5VGltZSA9IDA7XHJcbiAgICAgICAgZS5yZWJvdW5kID0gMDtcclxuICAgICAgICBlLnIgPSA3MDtcclxuICAgICAgICBlLmFuaW0gPSBudWxsO1xyXG4gICAgICAgIGUuYW5pbU5hbWUgPSBcImJ1bGxldF8yOVwiO1xyXG4gICAgICAgIGUuaXNMb2FkZWRTa2luID0gITE7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5pbml0QnV0dGxlID0gZnVuY3Rpb24gKGUsIGkpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5pbml0QnV0dGxlLmNhbGwodGhpcywgZSwgaSk7XHJcbiAgICAgICAgdGhpcy5hdHRhY2tFbmVteXMuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRTcGVlZFN0YXR1cyA9IDE7XHJcbiAgICAgICAgdGhpcy5yZWJvdW5kID0gMDtcclxuICAgICAgICB0aGlzLmF0ayA9IHRoaXMuc2tpbGxQYXJhbS5za2lsbEF0a1skZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgdmFyIG8gPSB0aGlzLnNraWxsUGFyYW0uc2l6ZTtcclxuICAgICAgICB0aGlzLnRpbWVMZWZ0ID0gdGhpcy5za2lsbFBhcmFtLnRpbWVbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgIHRoaXMuZGVsYXlUaW1lID0gdGhpcy5za2lsbFBhcmFtLmRlbGF5UmVjb3ZlcjtcclxuICAgICAgICB0aGlzLnNldFNjYWxlKGNjLnYzKG8sIG8pKTtcclxuICAgICAgICB0aGlzLnIgPSA3MCAqIG87XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VTcGVlZCgwKTtcclxuICAgICAgICBpZiAoIXRoaXMuYW5pbSkge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW0gPSB0aGlzLm5vZGUuY2hpbGRyZW5bMF0uZ2V0Q29tcG9uZW50KGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0QW5pbWF0aW9uKG51bGwpO1xyXG4gICAgICAgIHRoaXMubG9hZFNraW4oKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5sb2FkU2tpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9IHRoaXM7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzTG9hZGVkU2tpbiAmJiB0aGlzLnNraWxsUGFyYW0uYnVyblRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNMb2FkZWRTa2luID0gITA7XHJcbiAgICAgICAgICAgICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5sb2FkUmVzKFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgW1wiL2FuaW0vYnVsbGV0XzI5XzFcIl0sXHJcbiAgICAgICAgICAgICAgICBjYy5BbmltYXRpb25DbGlwLFxyXG4gICAgICAgICAgICAgICAgbnVsbCxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChlLCBpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzcCAmJiBjYy5pc1ZhbGlkKG8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuYW5pbU5hbWUgPSBcImJ1bGxldF8yOV8xXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyZXNVdGlsLlJlc1V0aWwuYXNzaWduV2l0aChvLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIucGFyZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5hbmltLmFkZENsaXAobyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHQuYW5pbS5wbGF5KHQuYW5pbU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2V0QW5pbWF0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuYW5pbS5wbGF5KHRoaXMuYW5pbU5hbWUpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uVHJpZ2dlciA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzVXNlKSB7XHJcbiAgICAgICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5lbnRlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSB0Lm9iamVjdDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXR0YWNrRW5lbXlzLmFkZChpKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0uc3R1blRpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zdWZmZXJEZWJ1ZmYoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLlNUVU4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0OiB0aGlzLnNraWxsUGFyYW0uc3R1blRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAwXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmJ1cm5UaW1lID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc3VmZmVyRGVidWZmKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5CVVJOLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogdGhpcy5za2lsbFBhcmFtLmJ1cm5UaW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5za2lsbFBhcmFtLmJ1cm5BdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLmVuZW15U2xvd1RpbWUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zdWZmZXJEZWJ1ZmYoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLlNMT1csXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVMZWZ0OiB0aGlzLnNraWxsUGFyYW0uZW5lbXlTbG93VGltZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuc2tpbGxQYXJhbS5lbmVteVNsb3dBZGRcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5zdGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGNvdW50RG93blV0aWwuQ291bnREb3duVXRpbC50aW1lIC0gaS5nZXRMYXN0QXRrVGltZSg4KSA8PVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uaW50ZXJ2YWwgLyAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2FtZVJhdGlvXHJcbiAgICAgICAgICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaS5zZXRMYXN0QXRrVGltZSg4LCAkY291bnREb3duVXRpbC5Db3VudERvd25VdGlsLnRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGkuc3VmZmVyQXRrKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuc2tpbGxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2tpbGxTcGVjaWFsaXR5czogdGhpcy5za2lsbFNwZWNpYWxpdHlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdGs6IHRoaXMuYXRrXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5leGl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0Lm9iamVjdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRhY2tFbmVteXMuZGVsZXRlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGcmFtZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzVXNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgLT0gdDtcclxuICAgICAgICAgICAgaWYgKDAgPT09IHRoaXMuY3VycmVudFNwZWVkU3RhdHVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdHRhY2tFbmVteXMuc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGF5VGltZSA9IHRoaXMuc2tpbGxQYXJhbS5kZWxheVJlY292ZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VTcGVlZCgxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgxID09PSB0aGlzLmN1cnJlbnRTcGVlZFN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dGFja0VuZW15cy5zaXplIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxheVRpbWUgLT0gdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGVsYXlUaW1lIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsYXlUaW1lID0gdGhpcy5za2lsbFBhcmFtLmRlbGF5UmVjb3ZlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlU3BlZWQoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgyID09PSB0aGlzLmN1cnJlbnRTcGVlZFN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVMZWZ0IDw9IDAgJiYgKHRoaXMuYXR0YWNrRW5lbXlzLmNsZWFyKCksICh0aGlzLmlzVXNlID0gITApLCB0aGlzLnJlbW92ZVNlbGYoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMudGltZUxlZnQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3BlZWRTdGF0dXMgPSAyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCA9IHRoaXMuc2tpbGxQYXJhbS5zdGF5VGltZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VuZFJlbGVhc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLm1vdmUodCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmNoYW5nZVNwZWVkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50U3BlZWRTdGF0dXMgIT09IHQpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3BlZWRTdGF0dXMgPSB0O1xyXG4gICAgICAgICAgICAwID09PSB0aGlzLmN1cnJlbnRTcGVlZFN0YXR1c1xyXG4gICAgICAgICAgICAgICAgPyAodGhpcy5zcGVlZCA9IHRoaXMuc2tpbGxQYXJhbS5nZXROb3JtYWxTcGVlZCh0aGlzLnJlYm91bmQpKVxyXG4gICAgICAgICAgICAgICAgOiAodGhpcy5zcGVlZCA9IHRoaXMuc2tpbGxQYXJhbS5nZXRTbG93U3BlZWQoKSk7XHJcbiAgICAgICAgICAgIHRoaXMudmVsb2NpdHkubm9ybWFsaXplU2VsZigpLm11bHRpcGx5U2NhbGFyKHRoaXMuc3BlZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0UG9zaXRpb24oKTtcclxuICAgICAgICB2YXIgaSA9IHRoaXMudmVsb2NpdHk7XHJcbiAgICAgICAgdi54ID0gZS54ICsgaS54ICogdDtcclxuICAgICAgICB2LnkgPSBlLnkgKyBpLnkgKiB0O1xyXG4gICAgICAgIHYueiA9IGUueiArIGkueiAqIHQ7XHJcbiAgICAgICAgdi54IDwgLTM2MCArIHRoaXMuclxyXG4gICAgICAgICAgICA/ICgodi54ID0gLTM2MCArIHRoaXMuciArIDEpLCAodGhpcy52ZWxvY2l0eS54ID0gLXRoaXMudmVsb2NpdHkueCksIHRoaXMucmVib3VuZCsrKVxyXG4gICAgICAgICAgICA6IHYueCA+IDM2MCAtIHRoaXMuciAmJiAoKHYueCA9IDM2MCAtIHRoaXMuciAtIDEpLCAodGhpcy52ZWxvY2l0eS54ID0gLXRoaXMudmVsb2NpdHkueCksIHRoaXMucmVib3VuZCsrKTtcclxuICAgICAgICB2LnkgPCAtNDUwICsgdGhpcy5yXHJcbiAgICAgICAgICAgID8gKCh2LnkgPSAtNDUwICsgdGhpcy5yICsgMSksICh0aGlzLnZlbG9jaXR5LnkgPSAtdGhpcy52ZWxvY2l0eS55KSwgdGhpcy5yZWJvdW5kKyspXHJcbiAgICAgICAgICAgIDogdi55ID4gY2Mud2luU2l6ZS5oZWlnaHQgLyAyIC0gdGhpcy5yICYmXHJcbiAgICAgICAgICAgICAgKCh2LnkgPSBjYy53aW5TaXplLmhlaWdodCAvIDIgLSB0aGlzLnIgLSAxKSwgKHRoaXMudmVsb2NpdHkueSA9IC10aGlzLnZlbG9jaXR5LnkpLCB0aGlzLnJlYm91bmQrKyk7XHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbih2KTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zZW5kUmVsZWFzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoISh0aGlzLnNraWxsUGFyYW0ucmVsZWFzZUNvdW50IDw9IDApKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgMjsgdCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuZHJhdF9yZWxlYXNlKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzMwXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAoZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYmFzZUJ1bGxldC5kZWZhdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgKSkuc2tpbGxTcGVjaWFsaXR5cyA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxJZFxyXG4gICAgICAgICAgICAgICAgICAgICkuc2tpbGxfdHB5ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBvID0gY2MuVmVjMy5aRVJPO1xyXG4gICAgICAgICAgICAgICAgby54ID0gMCA9PT0gdCA/ICRzZWVkVXRpbC5kZWZhdWx0LnJhbmRvbUZsb2F0KC0xLCAwKSA6ICRzZWVkVXRpbC5kZWZhdWx0LnJhbmRvbUZsb2F0KDAsIDEpO1xyXG4gICAgICAgICAgICAgICAgby55ID0gJHNlZWRVdGlsLmRlZmF1bHQucmFuZG9tRmxvYXQoLTEsIDEpO1xyXG4gICAgICAgICAgICAgICAgby5ub3JtYWxpemVTZWxmKCk7XHJcbiAgICAgICAgICAgICAgICBlLnNldFBvc2l0aW9uKHRoaXMuZ2V0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgICAgICBlLmluaXRCdXR0bGUobywgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgICAgIGUuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2tdLCBlKTtcclxufSkoJGJhc2VCdWxsZXQuZGVmYXVsdCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGI7XHJcbiJdfQ==