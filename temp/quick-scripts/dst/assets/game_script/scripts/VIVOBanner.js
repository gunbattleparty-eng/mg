
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/VIVOBanner.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '214c7fqwNhIzpUZ+xoeBPga', 'VIVOBanner');
// game_script/scripts/VIVOBanner.js

"use strict";

var o;
exports.VIVOBanner = void 0;

var $baseAd = require("./BaseAd");

var r = window.qg;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.style = null;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (r && r.createBannerAd) {
        var t = {
          posId: this.adUnitId
        };
        this.adIns = r.createBannerAd(t);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onClose) {
          this.adIns.onClose(this.onHide);
        }

        if (this.adIns.onSize) {
          this.adIns.onSize(this.onResize);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }
      } else {
        console.warn("当前平台不支持创建banner");
      }
    } else {
      console.error("Banner ID为空");
    }
  };

  e.prototype.showBanner = function (t, e, i) {
    var o = this;
    this.showCallback = e;
    this.errorCallback = i;

    if (this.isCanShow) {
      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        this.loadAd();
      }

      if (this.isConsume) {
        this.reCreateAd(!0);
      } else {
        {
          if (!this.isLoaded) {
            console.warn(this.adUnitId, ":未加载完成，稍等");
            return void (this.isAutoShow = !0);
          }

          if (this.adIns && t) {
            if (t.top && this.adIns.style) {
              this.adIns.style.top = t.top;
            }

            if (t.left && this.adIns.style) {
              this.adIns.style.left = t.left;
            }

            if (t.width && this.adIns.style) {
              this.adIns.style.width = t.width;
            }
          }

          this.isConsume = !1;

          if (this.adIns.show) {
            var n = this.adIns.show();
            n && n.then ? n.then(function () {
              o.isConsume = !0;

              if (o.showCallback) {
                o.showCallback();
              }

              o.showCallback = null;
            })["catch"](function (t) {
              console.warn(o.adUnitId, ":show错误，重新加载", t);
              o.reCreateAd(!0);
            }) : (console.warn(this.adUnitId, ":show显示失败，重新加载"), this.reCreateAd(!0));
          }
        }
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示");
    }
  };

  e.prototype.forbiddenBanner = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideBanner(!1);
    }
  };

  e.prototype.hideBanner = function (t) {
    t && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : this.adIns && this.adIns.hide && this.adIns.hide();
  };

  e.prototype.onAdResize = function (t) {
    console.warn("onBannerResize", t, this.adIns);
    var e = r.getSystemInfoSync();
    var i = e.windowWidth;
    var o = e.windowHeight;
    var n = this.style || {};
    this.style = {
      top: n.top || Math.round(o - t.height + 0.1),
      left: Math.round((i - t.width) / 2 + 0.1)
    };
    this.adIns.style = this.style;
    null != n.top ? this.adIns.style.top = n.top : this.adIns.style.top = Math.round(o - t.height + 0.1);
    null != n.left ? this.adIns.style.left = n.left : this.adIns.style.left = Math.round((i - t.width) / 2 + 0.1);
  };

  e.prototype.reCreateAd = function (t) {
    var e = this;
    this.destroyAd();
    this.isAutoShow = t;
    setTimeout(function () {
      e.loadAd();
    }, 100);
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offClose) {
        this.adIns.offClose(this.onHide);
      }

      if (this.adIns.offSize) {
        this.adIns.offSize(this.onResize);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showBanner(this.style, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function () {
    t.prototype.onAdLoad.call(this);
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdHide = function () {
    t.prototype.onAdHide.call(this);
    this.hideing = !1;
    this.destroyAd();
  };

  return e;
}($baseAd.BaseAd);

exports.VIVOBanner = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFZJVk9CYW5uZXIuanMiXSwibmFtZXMiOlsibyIsImV4cG9ydHMiLCJWSVZPQmFubmVyIiwiJGJhc2VBZCIsInJlcXVpcmUiLCJyIiwid2luZG93IiwicWciLCJhIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInN0eWxlIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwibG9hZEFkIiwiYWRVbml0SWQiLCJjcmVhdGVCYW5uZXJBZCIsInBvc0lkIiwiYWRJbnMiLCJvbkxvYWQiLCJvbkNsb3NlIiwib25IaWRlIiwib25TaXplIiwib25SZXNpemUiLCJvbkVycm9yIiwiY29uc29sZSIsIndhcm4iLCJlcnJvciIsInNob3dCYW5uZXIiLCJpIiwic2hvd0NhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsImlzQ2FuU2hvdyIsImlzQXV0b1Nob3ciLCJpc0NvbnN1bWUiLCJyZUNyZWF0ZUFkIiwiaXNMb2FkZWQiLCJ0b3AiLCJsZWZ0Iiwid2lkdGgiLCJzaG93IiwibiIsInRoZW4iLCJmb3JiaWRkZW5CYW5uZXIiLCJoaWRlQmFubmVyIiwiZGVzdHJveUFkIiwiaGlkZSIsIm9uQWRSZXNpemUiLCJnZXRTeXN0ZW1JbmZvU3luYyIsIndpbmRvd1dpZHRoIiwid2luZG93SGVpZ2h0IiwiTWF0aCIsInJvdW5kIiwiaGVpZ2h0Iiwic2V0VGltZW91dCIsImNhbGwiLCJvZmZMb2FkIiwib2ZmQ2xvc2UiLCJvZmZTaXplIiwib2ZmRXJyb3IiLCJkZXN0cm95IiwiYXV0b1Nob3ciLCJvbkFkTG9hZCIsIm9uQWRFcnJvciIsIm9uQWRIaWRlIiwiaGlkZWluZyIsIkJhc2VBZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKO0FBQ0FDLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQixLQUFLLENBQTFCOztBQUNBLElBQUlDLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBckI7O0FBQ0Es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Q0ssU0FBRixDQUFZa0QsU0FBWixHQUF3QixVQUFVdkQsQ0FBVixFQUFhO0lBQ2pDRCxDQUFDLENBQUNNLFNBQUYsQ0FBWWtELFNBQVosQ0FBc0JSLElBQXRCLENBQTJCLElBQTNCLEVBQWlDL0MsQ0FBakM7O0lBQ0EsSUFBSSxLQUFLdUIsYUFBVCxFQUF3QjtNQUNwQixLQUFLQSxhQUFMO0lBQ0g7O0lBQ0QsS0FBS2MsU0FBTDtFQUNILENBTkQ7O0VBT0FyQyxDQUFDLENBQUNLLFNBQUYsQ0FBWW1ELFFBQVosR0FBdUIsWUFBWTtJQUMvQnpELENBQUMsQ0FBQ00sU0FBRixDQUFZbUQsUUFBWixDQUFxQlQsSUFBckIsQ0FBMEIsSUFBMUI7SUFDQSxLQUFLVSxPQUFMLEdBQWUsQ0FBQyxDQUFoQjtJQUNBLEtBQUtwQixTQUFMO0VBQ0gsQ0FKRDs7RUFLQSxPQUFPckMsQ0FBUDtBQUNILENBdktPLENBdUtMUCxPQUFPLENBQUNpRSxNQXZLSCxDQUFSOztBQXdLQW5FLE9BQU8sQ0FBQ0MsVUFBUixHQUFxQk0sQ0FBckIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLlZJVk9CYW5uZXIgPSB2b2lkIDA7XHJcbnZhciAkYmFzZUFkID0gcmVxdWlyZShcIi4vQmFzZUFkXCIpO1xyXG52YXIgciA9IHdpbmRvdy5xZztcclxudmFyIGEgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5zdHlsZSA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5sb2FkQWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRVbml0SWQpIHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgci5jcmVhdGVCYW5uZXJBZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zSWQ6IHRoaXMuYWRVbml0SWRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zID0gci5jcmVhdGVCYW5uZXJBZCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25Mb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uQ2xvc2UodGhpcy5vbkhpZGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub25TaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vblNpemUodGhpcy5vblJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkVycm9yKHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLlvZPliY3lubPlj7DkuI3mlK/mjIHliJvlu7piYW5uZXJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQmFubmVyIElE5Li656m6XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zaG93QmFubmVyID0gZnVuY3Rpb24gKHQsIGUsIGkpIHtcclxuICAgICAgICB2YXIgbyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5zaG93Q2FsbGJhY2sgPSBlO1xyXG4gICAgICAgIHRoaXMuZXJyb3JDYWxsYmFjayA9IGk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYW5TaG93KSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5hZElucykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuacquWIm+W7uu+8jOaJp+ihjOWIm+W7ulwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICEwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkQWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5pc0NvbnN1bWUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVDcmVhdGVBZCghMCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzTG9hZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmnKrliqDovb3lrozmiJDvvIznqI3nrYlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2b2lkICh0aGlzLmlzQXV0b1Nob3cgPSAhMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zICYmIHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQudG9wICYmIHRoaXMuYWRJbnMuc3R5bGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuc3R5bGUudG9wID0gdC50b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQubGVmdCAmJiB0aGlzLmFkSW5zLnN0eWxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLnN0eWxlLmxlZnQgPSB0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQud2lkdGggJiYgdGhpcy5hZElucy5zdHlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5zdHlsZS53aWR0aCA9IHQud2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0NvbnN1bWUgPSAhMTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5zaG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcy5hZElucy5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG4gJiYgbi50aGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmlzQ29uc3VtZSA9ICEwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvLnNob3dDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnNob3dDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnNob3dDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKG8uYWRVbml0SWQsIFwiOnNob3fplJnor6/vvIzph43mlrDliqDovb1cIiwgdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5yZUNyZWF0ZUFkKCEwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IChjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI6c2hvd+aYvuekuuWksei0pe+8jOmHjeaWsOWKoOi9vVwiKSwgdGhpcy5yZUNyZWF0ZUFkKCEwKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuW9k+WJjeW5v+WRiuemgeatouaYvuekulwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZm9yYmlkZGVuQmFubmVyID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmlzQ2FuU2hvdyA9ICF0O1xyXG4gICAgICAgIGlmICh0ICYmIHRoaXMuaXNDb25zdW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZUJhbm5lcighMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmhpZGVCYW5uZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHQgJiYgdGhpcy5pc0NvbnN1bWVcclxuICAgICAgICAgICAgPyAodGhpcy5kZXN0cm95QWQoKSwgdGhpcy5yZUNyZWF0ZUFkKCExKSlcclxuICAgICAgICAgICAgOiB0aGlzLmFkSW5zICYmIHRoaXMuYWRJbnMuaGlkZSAmJiB0aGlzLmFkSW5zLmhpZGUoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkUmVzaXplID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oXCJvbkJhbm5lclJlc2l6ZVwiLCB0LCB0aGlzLmFkSW5zKTtcclxuICAgICAgICB2YXIgZSA9IHIuZ2V0U3lzdGVtSW5mb1N5bmMoKTtcclxuICAgICAgICB2YXIgaSA9IGUud2luZG93V2lkdGg7XHJcbiAgICAgICAgdmFyIG8gPSBlLndpbmRvd0hlaWdodDtcclxuICAgICAgICB2YXIgbiA9IHRoaXMuc3R5bGUgfHwge307XHJcbiAgICAgICAgdGhpcy5zdHlsZSA9IHtcclxuICAgICAgICAgICAgdG9wOiBuLnRvcCB8fCBNYXRoLnJvdW5kKG8gLSB0LmhlaWdodCArIDAuMSksXHJcbiAgICAgICAgICAgIGxlZnQ6IE1hdGgucm91bmQoKGkgLSB0LndpZHRoKSAvIDIgKyAwLjEpXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmFkSW5zLnN0eWxlID0gdGhpcy5zdHlsZTtcclxuICAgICAgICBudWxsICE9IG4udG9wID8gKHRoaXMuYWRJbnMuc3R5bGUudG9wID0gbi50b3ApIDogKHRoaXMuYWRJbnMuc3R5bGUudG9wID0gTWF0aC5yb3VuZChvIC0gdC5oZWlnaHQgKyAwLjEpKTtcclxuICAgICAgICBudWxsICE9IG4ubGVmdFxyXG4gICAgICAgICAgICA/ICh0aGlzLmFkSW5zLnN0eWxlLmxlZnQgPSBuLmxlZnQpXHJcbiAgICAgICAgICAgIDogKHRoaXMuYWRJbnMuc3R5bGUubGVmdCA9IE1hdGgucm91bmQoKGkgLSB0LndpZHRoKSAvIDIgKyAwLjEpKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZUNyZWF0ZUFkID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSB0O1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBlLmxvYWRBZCgpO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmQ2xvc2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmQ2xvc2UodGhpcy5vbkhpZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZlNpemUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmU2l6ZSh0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZFcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLmRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5hdXRvU2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5pc0F1dG9TaG93KSB7XHJcbiAgICAgICAgICAgIHRoaXMuaXNBdXRvU2hvdyA9ICExO1xyXG4gICAgICAgICAgICB0aGlzLnNob3dCYW5uZXIodGhpcy5zdHlsZSwgdGhpcy5zaG93Q2FsbGJhY2ssIHRoaXMuZXJyb3JDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRMb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLm9uQWRMb2FkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgdGhpcy5pc0NvbnN1bWUgPSAhMTtcclxuICAgICAgICB0aGlzLmlzTG9hZGVkID0gITA7XHJcbiAgICAgICAgdGhpcy5hdXRvU2hvdygpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRFcnJvciA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgdC5wcm90b3R5cGUub25BZEVycm9yLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuZXJyb3JDYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yQ2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kZXN0cm95QWQoKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkSGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkSGlkZS5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuaGlkZWluZyA9ICExO1xyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlQWQuQmFzZUFkKTtcclxuZXhwb3J0cy5WSVZPQmFubmVyID0gYTtcclxuIl19