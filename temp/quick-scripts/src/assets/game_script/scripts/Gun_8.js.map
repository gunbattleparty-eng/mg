{"version":3,"sources":["assets\\game_script\\scripts\\Gun_8.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$seedUtil","$configContext","$globalParam","$localEventName","$roleContext","$baseBullet","$gameContext","$gameGemInfo","$gameSkillInfo","$baseGun","k","cc","Vec3","ZERO","v","t","e","i","call","militX","skillId","skinAtkLeftCd","skinAtkCurrCount","skillParam","ins","skillInfo","getSkillById","__extends","prototype","updateF","isAttacking","isGamePuase","currSkinInfo","skin","skinAtkTargetCount","sendSkinBullet","timeLeft","skillCD","Skill4Param","FINAL","send","RENDER_SKILL_CD_INFO","starGun","SEND_SKILL_ANIM","getButtlePool","BulletType","s_bullet_7","instance","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","SBullet_7","ResUtil","instantiate","lowBulletLayer","parent","getComponent","x","y","setPosition","initButtle","insert","skinAtkCd","iceBoomCount","GameGemInfo","hasGem","GemType","AddSkill","probability","get1","getRandomEnemys","pointNode","skillAtkRange","length","n","schedulesOnce","sendButtle","getPosition","clone","s","ice_boom","Bullet_19","skillSpecialitys","basicSkillConfigMap","get","skill_tpye","node","width","iceBoomAtkRange","setAnimation","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $roleContext = require(\"./RoleContext\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $baseGun = require(\"./BaseGun\");\r\nvar k = cc.Vec3.ZERO;\r\nvar v = (function (t) {\r\n    function e(e) {\r\n        var i = t.call(this, e) || this;\r\n        i.militX = 0;\r\n        i.skillId = 135;\r\n        i.skinAtkLeftCd = 0;\r\n        i.skinAtkCurrCount = 0;\r\n        i.skillParam = $gameContext.default.ins.skillInfo.getSkillById(i.skillId);\r\n        return i;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.updateF = function (e) {\r\n        t.prototype.updateF.call(this, e);\r\n        if (!(this.isAttacking || $globalParam.default.isGamePuase)) {\r\n            if (\r\n                7 === $roleContext.default.ins.currSkinInfo.skin &&\r\n                this.skinAtkCurrCount >= $gameContext.default.ins.skillInfo.skinAtkTargetCount\r\n            ) {\r\n                this.skinAtkLeftCd -= e;\r\n                if (this.skinAtkLeftCd <= 0) {\r\n                    this.sendSkinBullet();\r\n                }\r\n            }\r\n            this.timeLeft -= e;\r\n            this.timeLeft <= 0\r\n                ? ((this.isAttacking = !0),\r\n                  (this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL]),\r\n                  $eventManager.default.send($localEventName.default.RENDER_SKILL_CD_INFO, this.skillId, 0, -1),\r\n                  this.starGun() || ((this.isAttacking = !1), (this.timeLeft = 0)))\r\n                : $eventManager.default.send(\r\n                      $localEventName.default.RENDER_SKILL_CD_INFO,\r\n                      this.skillId,\r\n                      this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL],\r\n                      -1\r\n                  );\r\n        }\r\n    };\r\n    e.prototype.sendSkinBullet = function () {\r\n        $eventManager.default.send($localEventName.default.SEND_SKILL_ANIM);\r\n        var t = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.s_bullet_7);\r\n        if (!t) {\r\n            var e = $assetsLoader.default.instance.getRes(\r\n                $assetsMap.BundleNames.Game,\r\n                $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.SBullet_7\r\n            );\r\n            t = $resUtil.ResUtil.instantiate(e, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                $baseBullet.default\r\n            );\r\n        }\r\n        k.x = 0;\r\n        k.y = -550;\r\n        t.setPosition(k);\r\n        t.initButtle(null, this.skillId);\r\n        t.insert($gameContext.default.ins.lowBulletLayer);\r\n        this.skinAtkLeftCd = $gameContext.default.ins.skillInfo.skinAtkCd;\r\n        this.skinAtkCurrCount = 0;\r\n        return !0;\r\n    };\r\n    e.prototype.starGun = function () {\r\n        var t = this;\r\n        var e = this.skillParam.iceBoomCount;\r\n        if (\r\n            $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) &&\r\n            $seedUtil.default.probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))\r\n        ) {\r\n            e *= 2;\r\n        }\r\n        var i = $gameContext.default.ins.getRandomEnemys(\r\n            this.pointNode,\r\n            e,\r\n            this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]\r\n        );\r\n        if (i.length <= 0) {\r\n            return !1;\r\n        }\r\n        var o = function (e) {\r\n            n.schedulesOnce(function () {\r\n                t.sendButtle(i[e].getPosition().clone());\r\n            }, 0.1 * e);\r\n        };\r\n        var n = this;\r\n        for (var s = 0; s < i.length; s++) {\r\n            o(s);\r\n        }\r\n        this.isAttacking = !1;\r\n        return !0;\r\n    };\r\n    e.prototype.sendButtle = function (t) {\r\n        var e = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.ice_boom);\r\n        if (!e) {\r\n            var i = $assetsLoader.default.instance.getRes(\r\n                $assetsMap.BundleNames.Game,\r\n                $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_19\r\n            );\r\n            (e = $resUtil.ResUtil.instantiate(i, $gameContext.default.ins.lowBulletLayer.parent).getComponent(\r\n                $baseBullet.default\r\n            )).skillSpecialitys = $configContext.default.instance.basicSkillConfigMap.get(this.skillId).skill_tpye;\r\n        }\r\n        this.militX = 360 - (e.node.width / 2) * this.skillParam.iceBoomAtkRange;\r\n        if (t.x <= -this.militX) {\r\n            t.x = -this.militX;\r\n        }\r\n        if (t.x >= this.militX) {\r\n            t.x = this.militX;\r\n        }\r\n        e.setPosition(t);\r\n        e.initButtle(null, this.skillId);\r\n        e.insert($gameContext.default.ins.lowBulletLayer);\r\n        e.setAnimation(\"\");\r\n        this.skinAtkCurrCount++;\r\n    };\r\n    return e;\r\n})($baseGun.default);\r\nexports.default = v;\r\n"]}