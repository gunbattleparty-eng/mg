{"version":3,"sources":["assets\\game_script\\scripts\\Agent.js"],"names":["exports","Agent","RVOConfig","KeyValuePair","ObserverObj","$maths","require","n","t","value","e","Key","Value","s","agentCount","neighborDist","radius","maxSpeed","velocity","cc","Vec3","maxNeighbors","timeHorizon","timeHorizonObst","timeStep","r","Object","defineProperty","get","_inst","enumerable","configurable","prototype","check","i","Vector2","subtract","getCenter","newVelocity","a","l","RVOMath","sqr","c","absSq","u","d","p","multiply2","f","h","multiply","m","sqrt","y","division","x","g","det","_","k","abs","v","Line","direction","point","addition","orcaLines","push","process","length","isAgent","isRemove","object","linearProgram2","maxVelocity","prefVelocity","linearProgram3","z","linearProgram1","fabs","RVO_EPSILON","Math","min","max","normalize"],"mappings":"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","sourceRoot":"/","sourcesContent":["exports.Agent = exports.RVOConfig = exports.KeyValuePair = exports.ObserverObj = void 0;\r\nvar $maths = require(\"./Maths\");\r\nvar n = function (t) {\r\n    if (t) {\r\n        this.value = t;\r\n    }\r\n};\r\nexports.ObserverObj = n;\r\nexports.KeyValuePair = function (t, e) {\r\n    this.Key = t;\r\n    this.Value = e;\r\n};\r\nvar s = (function () {\r\n    function t() {}\r\n    t.agentCount = 10;\r\n    t.neighborDist = 0.75;\r\n    t.radius = 0.5;\r\n    t.maxSpeed = 1;\r\n    t.velocity = new cc.Vec3();\r\n    t.maxNeighbors = 10;\r\n    t.timeHorizon = 5;\r\n    t.timeHorizonObst = 0;\r\n    t.timeStep = 0.05;\r\n    return t;\r\n})();\r\nexports.RVOConfig = s;\r\nvar r = (function () {\r\n    function t() {}\r\n    Object.defineProperty(t, \"inst\", {\r\n        get: function () {\r\n            if (null == this._inst) {\r\n                this._inst = new t();\r\n            }\r\n            return this._inst;\r\n        },\r\n        enumerable: !1,\r\n        configurable: !0\r\n    });\r\n    t.prototype.check = function (t, e) {\r\n        var i = 1 / s.timeHorizon;\r\n        var n = $maths.Vector2.subtract(e.getCenter(), t.getCenter());\r\n        var r = $maths.Vector2.subtract(t.newVelocity, e.newVelocity);\r\n        var a = t.neighborDist + e.neighborDist;\r\n        var l = $maths.RVOMath.sqr(a);\r\n        var c = $maths.RVOMath.absSq(n);\r\n        var u = new $maths.Vector2();\r\n        var d = new $maths.Vector2();\r\n        if (c > l) {\r\n            var p = $maths.Vector2.subtract(r, $maths.Vector2.multiply2(i, n));\r\n            var f = $maths.RVOMath.absSq(p);\r\n            var h = $maths.Vector2.multiply(p, n);\r\n            if (h < 0 && $maths.RVOMath.sqr(h) > l * f) {\r\n                var m = $maths.RVOMath.sqrt(f);\r\n                var y = $maths.Vector2.division(p, m);\r\n                d = new $maths.Vector2(y.y, -y.x);\r\n                u = $maths.Vector2.multiply2(a * i - m, y);\r\n            } else {\r\n                var g = $maths.RVOMath.sqrt(c - l);\r\n                d =\r\n                    $maths.RVOMath.det(n, p) > 0\r\n                        ? $maths.Vector2.division(new $maths.Vector2(n.x * g - n.y * a, n.x * a + n.y * g), c)\r\n                        : $maths.Vector2.division(new $maths.Vector2(n.x * g + n.y * a, -n.x * a + n.y * g), -c);\r\n                var _ = $maths.Vector2.multiply(r, d);\r\n                u = $maths.Vector2.subtract($maths.Vector2.multiply2(_, d), r);\r\n            }\r\n        } else {\r\n            var k = 1 / s.timeStep;\r\n            p = $maths.Vector2.subtract(r, $maths.Vector2.multiply2(k, n));\r\n            m = $maths.RVOMath.abs(p);\r\n            y = $maths.Vector2.division(p, m);\r\n            d = new $maths.Vector2(y.y, -y.x);\r\n            u = $maths.Vector2.multiply2(a * k - m, y);\r\n        }\r\n        var v = new $maths.Line();\r\n        v.direction = new $maths.Vector2(d.x, d.y);\r\n        v.point = $maths.Vector2.addition(t.newVelocity, $maths.Vector2.multiply2(0.5, u));\r\n        t.orcaLines.push(v);\r\n    };\r\n    t.prototype.process = function (t) {\r\n        var e = 0;\r\n        for (var i = t.length; e < i; e++) {\r\n            var s = t[e];\r\n            if (s.isAgent && s.orcaLines.length > 0) {\r\n                if (!s.isRemove && s.object) {\r\n                    var r = new n(new $maths.Vector2(s.newVelocity.x, s.newVelocity.y));\r\n                    var a = this.linearProgram2(s.orcaLines, s.maxVelocity, s.prefVelocity, !1, r);\r\n                    if (a < s.orcaLines.length) {\r\n                        this.linearProgram3(s.orcaLines, 0, a, s.maxVelocity, r);\r\n                    }\r\n                    var l = r.value;\r\n                    s.prefVelocity.x = s.newVelocity.x;\r\n                    s.prefVelocity.y = s.newVelocity.y;\r\n                    if (s.object) {\r\n                        var c = s.object.velocity;\r\n                        c.x = l.x;\r\n                        c.y = l.y;\r\n                        c.z = 0;\r\n                    }\r\n                }\r\n                s.orcaLines.length = 0;\r\n            }\r\n        }\r\n    };\r\n    t.prototype.linearProgram1 = function (t, e, i, n, s, r) {\r\n        var a = $maths.Vector2.multiply(t[e].point, t[e].direction);\r\n        var l = $maths.RVOMath.sqr(a) + $maths.RVOMath.sqr(i) - $maths.RVOMath.absSq(t[e].point);\r\n        if (l < 0) {\r\n            return !1;\r\n        }\r\n        var c = $maths.RVOMath.sqrt(l);\r\n        var u = -a - c;\r\n        var d = -a + c;\r\n        for (var p = 0; p < e; ++p) {\r\n            var f = $maths.RVOMath.det(t[e].direction, t[p].direction);\r\n            var h = $maths.RVOMath.det(t[p].direction, $maths.Vector2.subtract(t[e].point, t[p].point));\r\n            if ($maths.RVOMath.fabs(f) <= $maths.RVOMath.RVO_EPSILON) {\r\n                if (h < 0) {\r\n                    return !1;\r\n                }\r\n            } else {\r\n                var m = h / f;\r\n                f > 0 ? (d = Math.min(d, m)) : (u = Math.max(u, m));\r\n                if (u > d) {\r\n                    return !1;\r\n                }\r\n            }\r\n        }\r\n        s\r\n            ? $maths.Vector2.multiply(n, t[e].direction) > 0\r\n                ? (r.value = $maths.Vector2.addition(t[e].point, $maths.Vector2.multiply2(d, t[e].direction)))\r\n                : (r.value = $maths.Vector2.addition(t[e].point, $maths.Vector2.multiply2(u, t[e].direction)))\r\n            : ((m = $maths.Vector2.multiply(t[e].direction, $maths.Vector2.subtract(n, t[e].point))),\r\n              (r.value =\r\n                  m < u\r\n                      ? $maths.Vector2.addition(t[e].point, $maths.Vector2.multiply2(u, t[e].direction))\r\n                      : m > d\r\n                      ? $maths.Vector2.addition(t[e].point, $maths.Vector2.multiply2(d, t[e].direction))\r\n                      : $maths.Vector2.addition(t[e].point, $maths.Vector2.multiply2(m, t[e].direction))));\r\n        return !0;\r\n    };\r\n    t.prototype.linearProgram2 = function (t, e, i, n, s) {\r\n        n\r\n            ? (s.value = $maths.Vector2.multiply2(e, i))\r\n            : $maths.RVOMath.absSq(i) > $maths.RVOMath.sqr(e)\r\n            ? (s.value = $maths.Vector2.multiply2(e, $maths.RVOMath.normalize(i)))\r\n            : (s.value = i);\r\n        for (var r = 0; r < t.length; ++r) {\r\n            if ($maths.RVOMath.det(t[r].direction, $maths.Vector2.subtract(t[r].point, s.value)) > 0) {\r\n                var a = new $maths.Vector2(s.value.x, s.value.y);\r\n                if (!this.linearProgram1(t, r, e, i, n, s)) {\r\n                    s.value = a;\r\n                    return r;\r\n                }\r\n            }\r\n        }\r\n        return t.length;\r\n    };\r\n    t.prototype.linearProgram3 = function (t, e, i, n, s) {\r\n        var r = 0;\r\n        for (var a = i; a < t.length; ++a) {\r\n            if ($maths.RVOMath.det(t[a].direction, $maths.Vector2.subtract(t[a].point, s.value)) > r) {\r\n                var l = [];\r\n                for (var c = 0; c < e; ++c) {\r\n                    l[l.length] = t[c];\r\n                }\r\n                for (var u = e; u < a; ++u) {\r\n                    var d = new $maths.Line();\r\n                    var p = $maths.RVOMath.det(t[a].direction, t[u].direction);\r\n                    if ($maths.RVOMath.fabs(p) <= $maths.RVOMath.RVO_EPSILON) {\r\n                        if ($maths.Vector2.multiply(t[a].direction, t[u].direction) > 0) {\r\n                            continue;\r\n                        }\r\n                        d.point = $maths.Vector2.multiply2(0.5, $maths.Vector2.addition(t[a].point, t[u].point));\r\n                    } else {\r\n                        d.point = $maths.Vector2.addition(\r\n                            t[a].point,\r\n                            $maths.Vector2.multiply2(\r\n                                $maths.RVOMath.det(t[u].direction, $maths.Vector2.subtract(t[a].point, t[u].point)) / p,\r\n                                t[a].direction\r\n                            )\r\n                        );\r\n                    }\r\n                    var f = $maths.Vector2.subtract(t[u].direction, t[a].direction);\r\n                    if ($maths.RVOMath.absSq(f) > 0) {\r\n                        d.direction = $maths.RVOMath.normalize(f);\r\n                        l[l.length] = d;\r\n                    }\r\n                }\r\n                var h = new $maths.Vector2(s.value.x, s.value.y);\r\n                if (\r\n                    this.linearProgram2(l, n, new $maths.Vector2(-t[a].direction.y, t[a].direction.x), !0, s) < l.length\r\n                ) {\r\n                    s.value = h;\r\n                }\r\n                r = $maths.RVOMath.det(t[a].direction, $maths.Vector2.subtract(t[a].point, s.value));\r\n            }\r\n        }\r\n    };\r\n    t._inst = null;\r\n    return t;\r\n})();\r\nexports.Agent = r;\r\n"]}