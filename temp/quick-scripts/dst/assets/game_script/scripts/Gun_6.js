
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_6.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '4aeac8wicpCapSeIYgdLLC3', 'Gun_6');
// game_script/scripts/Gun_6.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $seedUtil = require("./SeedUtil");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $roleContext = require("./RoleContext");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameGemInfo = require("./GameGemInfo");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseGun = require("./BaseGun");

var v = new cc.Vec3();

var b = function (t) {
  function e(e) {
    var i = t.call(this, e) || this;
    i.skinAtkLeftCd = 0;
    i.skinAtkCurrCount = 0;
    i.skillId = 100;
    i.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(i.skillId);
    return i;
  }

  __extends(e, t);

  e.prototype.updateF = function (e) {
    t.prototype.updateF.call(this, e);

    if (!(this.isAttacking || $globalParam["default"].isGamePuase)) {
      if (6 === $roleContext["default"].ins.currSkinInfo.skin && this.skinAtkCurrCount >= $gameContext["default"].ins.skillInfo.skinAtkTargetCount) {
        this.skinAtkLeftCd -= e;

        if (this.skinAtkLeftCd <= 0) {
          this.sendSkinBullet();
        }
      }

      this.timeLeft -= e;
      this.timeLeft <= 0 ? (this.isAttacking = !0, this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0, -1), this.starGun() || (this.isAttacking = !1, this.timeLeft = 0)) : $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1);
    }
  };

  e.prototype.starGun = function () {
    var t = $gameContext["default"].ins.getRangeRankEnemy(this.pointNode, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);
    return !!t && (this.sendButtle(t), this.isAttacking = !1, !0);
  };

  e.prototype.sendButtle = function (t) {
    var e = this.skillParam.pulseLaserCount;

    if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) && $seedUtil["default"].probability($gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill) * this.skillId)) {
      e *= 2;
    }

    for (var i = 0; i < e; i++) {
      if (i >= 1 && !(t = $gameContext["default"].ins.getRangeRandomEnemyLayerByPos(this.pointNode.position))) {
        return;
      }

      var o = t.node.position.sub(this.pointNode.position).normalize();
      this.createButtle(o);
    }

    if (this.skillParam.pulseLaserSweepCount > 0) {
      this.createButtle(null, !0);
    }
  };

  e.prototype.createButtle = function (t, e) {
    if (void 0 === e) {
      e = !1;
    }

    var i = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.pulse_laser);

    if (!i) {
      var o = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_14);
      (i = $resUtil.ResUtil.instantiate(o, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    i.setPosition(this.pointNode.position.clone());
    i.isSweep = e;
    i.initButtle(null, this.skillId);
    i.insert($gameContext["default"].ins.buttleLayer);
    i.setAnimation("");

    if (!e) {
      i.setAngle($util["default"].dirConverAngle(t));
      this.skinAtkCurrCount++;
    }
  };

  e.prototype.sendSkinBullet = function () {
    var t = $gameContext["default"].ins.getRandomEnemys(this.pointNode, 4, $gameContext["default"].ins.skillInfo.skinAtkRange);

    if (t.length <= 0) {
      this.skinAtkLeftCd = 2;
      return !1;
    }

    $eventManager["default"].send($localEventName["default"].SEND_SKILL_ANIM);
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.s_bullet_6);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.SBullet_6);
      e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    v.x = 0;
    v.y = -280;
    e.setPosition(v.clone());
    e.initButtle(null, this.skillId);
    e.node.zIndex = 100;
    e.insert($gameContext["default"].ins.lowBulletLayer);
    this.sendSkinBullet2(t);
    this.skinAtkCurrCount = 0;
    this.skinAtkLeftCd = $gameContext["default"].ins.skillInfo.skinAtkCd;
  };

  e.prototype.sendSkinBullet2 = function (t) {
    var e = this;
    this.patching(t, 4);
    this.createSkillBullet(t);

    for (var i = 1; i <= $gameContext["default"].ins.skillInfo.skinParam[4] - 1; i++) {
      this.schedulesOnce(function () {
        var t = $gameContext["default"].ins.getRandomEnemys(e.pointNode, 4, $gameContext["default"].ins.skillInfo.skinAtkRange);

        if (t.length > 0) {
          e.patching(t, 4);
          e.createSkillBullet(t);
        }
      }, i * $gameContext["default"].ins.skillInfo.skinParam[3]);
    }
  };

  e.prototype.createSkillBullet = function (t) {
    for (var e = 0; e < t.length; e++) {
      var i = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.s_bullet_6_1);

      if (!i) {
        var o = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.SBullet_6_1);
        i = $resUtil.ResUtil.instantiate(o, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
      }

      var n = t[e].node.position.sub(this.pointNode.position).normalize();
      v.x = 154 * e - 231;
      v.y = -280;
      i.targetEnemy = t[e];
      i.setPosition(v);
      i.initButtle(n, this.skillId);
      i.node.zIndex = 99;
      i.insert($gameContext["default"].ins.lowBulletLayer);
    }
  };

  e.prototype.patching = function (t, e) {
    var i = t.length;

    for (var o = i; o < e; o++) {
      t[o] = t[o % i];
    }
  };

  return e;
}($baseGun["default"]);

exports["default"] = b;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl82LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRldmVudE1hbmFnZXIiLCIkc2VlZFV0aWwiLCIkdXRpbCIsIiRjb25maWdDb250ZXh0IiwiJGdsb2JhbFBhcmFtIiwiJGxvY2FsRXZlbnROYW1lIiwiJHJvbGVDb250ZXh0IiwiJGJhc2VCdWxsZXQiLCIkZ2FtZUNvbnRleHQiLCIkZ2FtZUdlbUluZm8iLCIkZ2FtZVNraWxsSW5mbyIsIiRiYXNlR3VuIiwidiIsImNjIiwiVmVjMyIsImIiLCJ0IiwiZSIsImkiLCJjYWxsIiwic2tpbkF0a0xlZnRDZCIsInNraW5BdGtDdXJyQ291bnQiLCJza2lsbElkIiwic2tpbGxQYXJhbSIsImlucyIsInNraWxsSW5mbyIsImdldFNraWxsQnlJZCIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsInVwZGF0ZUYiLCJpc0F0dGFja2luZyIsImlzR2FtZVB1YXNlIiwiY3VyclNraW5JbmZvIiwic2tpbiIsInNraW5BdGtUYXJnZXRDb3VudCIsInNlbmRTa2luQnVsbGV0IiwidGltZUxlZnQiLCJza2lsbENEIiwiU2tpbGw0UGFyYW0iLCJGSU5BTCIsInNlbmQiLCJSRU5ERVJfU0tJTExfQ0RfSU5GTyIsInN0YXJHdW4iLCJnZXRSYW5nZVJhbmtFbmVteSIsInBvaW50Tm9kZSIsInNraWxsQXRrUmFuZ2UiLCJzZW5kQnV0dGxlIiwicHVsc2VMYXNlckNvdW50IiwiR2FtZUdlbUluZm8iLCJoYXNHZW0iLCJHZW1UeXBlIiwiQWRkU2tpbGwiLCJwcm9iYWJpbGl0eSIsImdldDEiLCJnZXRSYW5nZVJhbmRvbUVuZW15TGF5ZXJCeVBvcyIsInBvc2l0aW9uIiwibm9kZSIsInN1YiIsIm5vcm1hbGl6ZSIsImNyZWF0ZUJ1dHRsZSIsInB1bHNlTGFzZXJTd2VlcENvdW50IiwiZ2V0QnV0dGxlUG9vbCIsIkJ1bGxldFR5cGUiLCJwdWxzZV9sYXNlciIsImluc3RhbmNlIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkJ1bGxldF8xNCIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImJ1dHRsZUxheWVyIiwicGFyZW50IiwiZ2V0Q29tcG9uZW50Iiwic2tpbGxTcGVjaWFsaXR5cyIsImJhc2ljU2tpbGxDb25maWdNYXAiLCJnZXQiLCJza2lsbF90cHllIiwic2V0UG9zaXRpb24iLCJjbG9uZSIsImlzU3dlZXAiLCJpbml0QnV0dGxlIiwiaW5zZXJ0Iiwic2V0QW5pbWF0aW9uIiwic2V0QW5nbGUiLCJkaXJDb252ZXJBbmdsZSIsImdldFJhbmRvbUVuZW15cyIsInNraW5BdGtSYW5nZSIsImxlbmd0aCIsIlNFTkRfU0tJTExfQU5JTSIsInNfYnVsbGV0XzYiLCJTQnVsbGV0XzYiLCJsb3dCdWxsZXRMYXllciIsIngiLCJ5IiwiekluZGV4Iiwic2VuZFNraW5CdWxsZXQyIiwic2tpbkF0a0NkIiwicGF0Y2hpbmciLCJjcmVhdGVTa2lsbEJ1bGxldCIsInNraW5QYXJhbSIsInNjaGVkdWxlc09uY2UiLCJzX2J1bGxldF82XzEiLCJTQnVsbGV0XzZfMSIsIm4iLCJ0YXJnZXRFbmVteSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJQyxVQUFVLEdBQUdELE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlFLFFBQVEsR0FBR0YsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUcsYUFBYSxHQUFHSCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUksU0FBUyxHQUFHSixPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFDQSxJQUFJSyxLQUFL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QUNtRSxVQUFGLENBQWF1QixDQUFiLEVBQWdCLEtBQUt0RixPQUFyQjtNQUNBSixDQUFDLENBQUNzQyxJQUFGLENBQU8yQyxNQUFQLEdBQWdCLEVBQWhCO01BQ0FqRixDQUFDLENBQUNvRSxNQUFGLENBQVM5RSxZQUFZLFdBQVosQ0FBcUJnQixHQUFyQixDQUF5QndFLGNBQWxDO0lBQ0g7RUFDSixDQXJCRDs7RUFzQkEvRSxDQUFDLENBQUNXLFNBQUYsQ0FBWTBFLFFBQVosR0FBdUIsVUFBVXRGLENBQVYsRUFBYUMsQ0FBYixFQUFnQjtJQUNuQyxJQUFJQyxDQUFDLEdBQUdGLENBQUMsQ0FBQzRFLE1BQVY7O0lBQ0EsS0FBSyxJQUFJakcsQ0FBQyxHQUFHdUIsQ0FBYixFQUFnQnZCLENBQUMsR0FBR3NCLENBQXBCLEVBQXVCdEIsQ0FBQyxFQUF4QixFQUE0QjtNQUN4QnFCLENBQUMsQ0FBQ3JCLENBQUQsQ0FBRCxHQUFPcUIsQ0FBQyxDQUFDckIsQ0FBQyxHQUFHdUIsQ0FBTCxDQUFSO0lBQ0g7RUFDSixDQUxEOztFQU1BLE9BQU9ELENBQVA7QUFDSCxDQXRLTyxDQXNLTE4sUUFBUSxXQXRLSCxDQUFSOztBQXVLQW1HLE9BQU8sV0FBUCxHQUFrQi9GLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRzZWVkVXRpbCA9IHJlcXVpcmUoXCIuL1NlZWRVdGlsXCIpO1xyXG52YXIgJHV0aWwgPSByZXF1aXJlKFwiLi9VdGlsXCIpO1xyXG52YXIgJGNvbmZpZ0NvbnRleHQgPSByZXF1aXJlKFwiLi9Db25maWdDb250ZXh0XCIpO1xyXG52YXIgJGdsb2JhbFBhcmFtID0gcmVxdWlyZShcIi4vR2xvYmFsUGFyYW1cIik7XHJcbnZhciAkbG9jYWxFdmVudE5hbWUgPSByZXF1aXJlKFwiLi9Mb2NhbEV2ZW50TmFtZVwiKTtcclxudmFyICRyb2xlQ29udGV4dCA9IHJlcXVpcmUoXCIuL1JvbGVDb250ZXh0XCIpO1xyXG52YXIgJGJhc2VCdWxsZXQgPSByZXF1aXJlKFwiLi9CYXNlQnVsbGV0XCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZ2FtZUdlbUluZm8gPSByZXF1aXJlKFwiLi9HYW1lR2VtSW5mb1wiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRiYXNlR3VuID0gcmVxdWlyZShcIi4vQmFzZUd1blwiKTtcclxudmFyIHYgPSBuZXcgY2MuVmVjMygpO1xyXG52YXIgYiA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZShlKSB7XHJcbiAgICAgICAgdmFyIGkgPSB0LmNhbGwodGhpcywgZSkgfHwgdGhpcztcclxuICAgICAgICBpLnNraW5BdGtMZWZ0Q2QgPSAwO1xyXG4gICAgICAgIGkuc2tpbkF0a0N1cnJDb3VudCA9IDA7XHJcbiAgICAgICAgaS5za2lsbElkID0gMTAwO1xyXG4gICAgICAgIGkuc2tpbGxQYXJhbSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uZ2V0U2tpbGxCeUlkKGkuc2tpbGxJZCk7XHJcbiAgICAgICAgcmV0dXJuIGk7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS51cGRhdGVGLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgaWYgKCEodGhpcy5pc0F0dGFja2luZyB8fCAkZ2xvYmFsUGFyYW0uZGVmYXVsdC5pc0dhbWVQdWFzZSkpIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgNiA9PT0gJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmN1cnJTa2luSW5mby5za2luICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQgPj0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luQXRrVGFyZ2V0Q291bnRcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraW5BdGtMZWZ0Q2QgLT0gZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraW5BdGtMZWZ0Q2QgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VuZFNraW5CdWxsZXQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnRpbWVMZWZ0IC09IGU7XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgPD0gMFxyXG4gICAgICAgICAgICAgICAgPyAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICh0aGlzLnRpbWVMZWZ0ID0gdGhpcy5za2lsbFBhcmFtLnNraWxsQ0RbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdKSxcclxuICAgICAgICAgICAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuUkVOREVSX1NLSUxMX0NEX0lORk8sIHRoaXMuc2tpbGxJZCwgMCwgLTEpLFxyXG4gICAgICAgICAgICAgICAgICB0aGlzLnN0YXJHdW4oKSB8fCAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMSksICh0aGlzLnRpbWVMZWZ0ID0gMCkpKVxyXG4gICAgICAgICAgICAgICAgOiAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZChcclxuICAgICAgICAgICAgICAgICAgICAgICRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAvIHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSxcclxuICAgICAgICAgICAgICAgICAgICAgIC0xXHJcbiAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJHdW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UmFuZ2VSYW5rRW5lbXkoXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnROb2RlLFxyXG4gICAgICAgICAgICB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtSYW5nZVskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF1cclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiAhIXQgJiYgKHRoaXMuc2VuZEJ1dHRsZSh0KSwgKHRoaXMuaXNBdHRhY2tpbmcgPSAhMSksICEwKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zZW5kQnV0dGxlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuc2tpbGxQYXJhbS5wdWxzZUxhc2VyQ291bnQ7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uaW5zLmhhc0dlbSgkZ2FtZUdlbUluZm8uR2VtVHlwZS5BZGRTa2lsbCkgJiZcclxuICAgICAgICAgICAgJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkoXHJcbiAgICAgICAgICAgICAgICAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uaW5zLmdldDEoJGdhbWVHZW1JbmZvLkdlbVR5cGUuQWRkU2tpbGwpICogdGhpcy5za2lsbElkXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgZSAqPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGU7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA+PSAxICYmICEodCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSYW5nZVJhbmRvbUVuZW15TGF5ZXJCeVBvcyh0aGlzLnBvaW50Tm9kZS5wb3NpdGlvbikpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG8gPSB0Lm5vZGUucG9zaXRpb24uc3ViKHRoaXMucG9pbnROb2RlLnBvc2l0aW9uKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVCdXR0bGUobyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNraWxsUGFyYW0ucHVsc2VMYXNlclN3ZWVwQ291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQnV0dGxlKG51bGwsICEwKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY3JlYXRlQnV0dGxlID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICBpZiAodm9pZCAwID09PSBlKSB7XHJcbiAgICAgICAgICAgIGUgPSAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGkgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnB1bHNlX2xhc2VyKTtcclxuICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgdmFyIG8gPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8xNFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAoaSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUobywgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICApKS5za2lsbFNwZWNpYWxpdHlzID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5iYXNpY1NraWxsQ29uZmlnTWFwLmdldCh0aGlzLnNraWxsSWQpLnNraWxsX3RweWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGkuc2V0UG9zaXRpb24odGhpcy5wb2ludE5vZGUucG9zaXRpb24uY2xvbmUoKSk7XHJcbiAgICAgICAgaS5pc1N3ZWVwID0gZTtcclxuICAgICAgICBpLmluaXRCdXR0bGUobnVsbCwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICBpLmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIpO1xyXG4gICAgICAgIGkuc2V0QW5pbWF0aW9uKFwiXCIpO1xyXG4gICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICBpLnNldEFuZ2xlKCR1dGlsLmRlZmF1bHQuZGlyQ29udmVyQW5nbGUodCkpO1xyXG4gICAgICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQrKztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2VuZFNraW5CdWxsZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UmFuZG9tRW5lbXlzKFxyXG4gICAgICAgICAgICB0aGlzLnBvaW50Tm9kZSxcclxuICAgICAgICAgICAgNCxcclxuICAgICAgICAgICAgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luQXRrUmFuZ2VcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmICh0Lmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2tpbkF0a0xlZnRDZCA9IDI7XHJcbiAgICAgICAgICAgIHJldHVybiAhMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuU0VORF9TS0lMTF9BTklNKTtcclxuICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuc19idWxsZXRfNik7XHJcbiAgICAgICAgaWYgKCFlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5TQnVsbGV0XzZcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2LnggPSAwO1xyXG4gICAgICAgIHYueSA9IC0yODA7XHJcbiAgICAgICAgZS5zZXRQb3NpdGlvbih2LmNsb25lKCkpO1xyXG4gICAgICAgIGUuaW5pdEJ1dHRsZShudWxsLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgIGUubm9kZS56SW5kZXggPSAxMDA7XHJcbiAgICAgICAgZS5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyKTtcclxuICAgICAgICB0aGlzLnNlbmRTa2luQnVsbGV0Mih0KTtcclxuICAgICAgICB0aGlzLnNraW5BdGtDdXJyQ291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMuc2tpbkF0a0xlZnRDZCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uc2tpbkF0a0NkO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNlbmRTa2luQnVsbGV0MiA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMucGF0Y2hpbmcodCwgNCk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVTa2lsbEJ1bGxldCh0KTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnNraW5QYXJhbVs0XSAtIDE7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlc09uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UmFuZG9tRW5lbXlzKFxyXG4gICAgICAgICAgICAgICAgICAgIGUucG9pbnROb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIDQsXHJcbiAgICAgICAgICAgICAgICAgICAgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luQXRrUmFuZ2VcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBpZiAodC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wYXRjaGluZyh0LCA0KTtcclxuICAgICAgICAgICAgICAgICAgICBlLmNyZWF0ZVNraWxsQnVsbGV0KHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBpICogJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luUGFyYW1bM10pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jcmVhdGVTa2lsbEJ1bGxldCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgZSA9IDA7IGUgPCB0Lmxlbmd0aDsgZSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5zX2J1bGxldF82XzEpO1xyXG4gICAgICAgICAgICBpZiAoIWkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LlNCdWxsZXRfNl8xXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgaSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUobywgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmxvd0J1bGxldExheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG4gPSB0W2VdLm5vZGUucG9zaXRpb24uc3ViKHRoaXMucG9pbnROb2RlLnBvc2l0aW9uKS5ub3JtYWxpemUoKTtcclxuICAgICAgICAgICAgdi54ID0gMTU0ICogZSAtIDIzMTtcclxuICAgICAgICAgICAgdi55ID0gLTI4MDtcclxuICAgICAgICAgICAgaS50YXJnZXRFbmVteSA9IHRbZV07XHJcbiAgICAgICAgICAgIGkuc2V0UG9zaXRpb24odik7XHJcbiAgICAgICAgICAgIGkuaW5pdEJ1dHRsZShuLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICBpLm5vZGUuekluZGV4ID0gOTk7XHJcbiAgICAgICAgICAgIGkuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnBhdGNoaW5nID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB2YXIgaSA9IHQubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIG8gPSBpOyBvIDwgZTsgbysrKSB7XHJcbiAgICAgICAgICAgIHRbb10gPSB0W28gJSBpXTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIGU7XHJcbn0pKCRiYXNlR3VuLmRlZmF1bHQpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBiO1xyXG4iXX0=