{"version":3,"sources":["assets\\game_script\\scripts\\GinApplication.js"],"names":["o","exports","GinApplication","$uIManager","require","$assetsConverter","$assetsMap","$resManager","$countDownUtil","$globalHttp","$platform","$configContext","$skillContext","$equipmentContext","$roleContext","$aD","$onlineContext","$guide","$battleContext","$util","$userDataContext","$gameContext","$assetsLoader","$rankService","$login","$geService","$storageUtil","O","cc","_decorator","L","ccclass","E","property","M","t","e","apply","arguments","lodingView","confirmView","__extends","prototype","onLoad","StorageUtil","init","Platform","AssetsConverter","instance","execute","UIManager","node","GlobalHttp","Login","start","GeService","getLocalOpenID","BundleNames","Public","Configs","Public_Res","Start","Popup","i","Resources","Ins","isEndGuide","setTimeout","self","remove","removeComponent","push","Game","Enemy","currPlatForm","PlatformEnum","TOU_TIAO","ttGetUserInfo","WECHAT","wxGetUserInfo","KS","ksGetUserInfo","getChildByName","loadRemote","destroy","startGame","__awaiter","__generator","n","label","resourcesLoadedProccess","load","sent","initModel","replaceView","AssetsMap","StartBundles","prefabs","assetsList","StartView","currLevel","levelInfoConfigs","find","id","deepCopy","Monsterspool","length","ins","loadLevel","loadResSync","Prefab","GameBundles","GameView","removeLoadingView","CountDownUtil","currTime","Date","now","initData","loadBaseUI","ResManager","loadArray","console","log","update","time","__decorate","Component"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nexports.GinApplication = void 0;\r\nvar $uIManager = require(\"./UIManager\");\r\nvar $assetsConverter = require(\"./AssetsConverter\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resManager = require(\"./ResManager\");\r\nvar $countDownUtil = require(\"./CountDownUtil\");\r\nvar $globalHttp = require(\"./GlobalHttp\");\r\nvar $platform = require(\"./Platform\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $skillContext = require(\"./SkillContext\");\r\nvar $equipmentContext = require(\"./EquipmentContext\");\r\nvar $roleContext = require(\"./RoleContext\");\r\nvar $aD = require(\"./AD\");\r\nvar $onlineContext = require(\"./OnlineContext\");\r\nvar $guide = require(\"./Guide\");\r\nvar $battleContext = require(\"./BattleContext\");\r\nvar $util = require(\"./Util\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $rankService = require(\"./RankService\");\r\nvar $login = require(\"./Login\");\r\nvar $geService = require(\"./GeService\");\r\nvar $storageUtil = require(\"./StorageUtil\");\r\nvar O = cc._decorator;\r\nvar L = O.ccclass;\r\nvar E = O.property;\r\nvar M = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.lodingView = null;\r\n        e.confirmView = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.onLoad = function () {\r\n        $storageUtil.StorageUtil.init();\r\n        $platform.Platform.init();\r\n        $assetsConverter.AssetsConverter.instance.execute();\r\n        $uIManager.UIManager.instance.init(this.node, this.lodingView, this.confirmView);\r\n        $globalHttp.GlobalHttp.init();\r\n        $aD.default.init();\r\n        $login.Login.instance.start();\r\n        $geService.GeService.instance.start();\r\n        $login.Login.instance.getLocalOpenID();\r\n    };\r\n    e.prototype.start = function () {\r\n        var t = this;\r\n        var e = [\r\n            $assetsMap.BundleNames.Public,\r\n            $assetsMap.BundleNames.Configs,\r\n            $assetsMap.BundleNames.Public_Res,\r\n            $assetsMap.BundleNames.Start,\r\n            $assetsMap.BundleNames.Popup\r\n        ];\r\n        var i = [$assetsMap.BundleNames.Public, $assetsMap.BundleNames.Resources, $assetsMap.BundleNames.Start];\r\n        $userDataContext.default.Ins.isEndGuide\r\n            ? setTimeout(function () {\r\n                  $guide.default.self.remove();\r\n                  t.node.removeComponent($guide.default);\r\n              }, 1)\r\n            : (e.push($assetsMap.BundleNames.Game),\r\n              e.push($assetsMap.BundleNames.Enemy),\r\n              i.push($assetsMap.BundleNames.Game));\r\n        $platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO\r\n            ? $login.Login.instance.ttGetUserInfo(!0)\r\n            : $platform.Platform.currPlatForm === $platform.PlatformEnum.WECHAT\r\n            ? $login.Login.instance.wxGetUserInfo(!1)\r\n            : $platform.Platform.currPlatForm === $platform.PlatformEnum.KS && $login.Login.instance.ksGetUserInfo(!0);\r\n        var o = this.node.getChildByName(\"zg_node\");\r\n        setTimeout(function () {\r\n            $configContext.default.instance.loadRemote(function () {\r\n                o.destroy();\r\n                t.startGame(e, i);\r\n            });\r\n        }, 1e3);\r\n    };\r\n    e.prototype.startGame = function (t, e) {\r\n        var i = this;\r\n        $uIManager.UIManager.instance.lodingView(\r\n            t,\r\n            e,\r\n            function () {\r\n                return __awaiter(i, void 0, void 0, function () {\r\n                    var t;\r\n                    var e;\r\n                    var i;\r\n                    var o;\r\n                    return __generator(this, function (n) {\r\n                        switch (n.label) {\r\n                            case 0:\r\n                                this.resourcesLoadedProccess();\r\n                                return [4, $configContext.default.instance.load()];\r\n                            case 1:\r\n                                n.sent();\r\n                                this.initModel();\r\n                                return $userDataContext.default.Ins.isEndGuide\r\n                                    ? ($uIManager.UIManager.instance.replaceView(\r\n                                          $assetsMap.AssetsMap.StartBundles.prefabs.assetsList.StartView\r\n                                      ),\r\n                                      [3, 5])\r\n                                    : [3, 2];\r\n                            case 2:\r\n                                for (\r\n                                    $battleContext.default.Ins.currLevel = 1,\r\n                                        t = [],\r\n                                        e = $configContext.default.instance.levelInfoConfigs.find(function (t) {\r\n                                            return 1 === t.id;\r\n                                        }),\r\n                                        i = $util.default.deepCopy(e.Monsterspool),\r\n                                        o = 0;\r\n                                    o < i.length;\r\n                                    o++\r\n                                ) {\r\n                                    t.push(\"/prefabs/Enemy_\" + i[o]);\r\n                                }\r\n                                return [4, $gameContext.default.ins.loadLevel($battleContext.default.Ins.currLevel)];\r\n                            case 3:\r\n                                n.sent();\r\n                                return [\r\n                                    4,\r\n                                    $assetsLoader.default.instance.loadResSync(\r\n                                        $assetsMap.BundleNames.Enemy,\r\n                                        t,\r\n                                        cc.Prefab\r\n                                    )\r\n                                ];\r\n                            case 4:\r\n                                n.sent();\r\n                                $uIManager.UIManager.instance.replaceView(\r\n                                    $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.GameView\r\n                                );\r\n                                n.label = 5;\r\n                            case 5:\r\n                                $uIManager.UIManager.instance.removeLoadingView();\r\n                                return [2];\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            !1\r\n        );\r\n    };\r\n    e.prototype.initModel = function () {\r\n        $countDownUtil.CountDownUtil.currTime = Date.now();\r\n        $roleContext.default.ins.init();\r\n        $equipmentContext.default.Ins.init();\r\n        $skillContext.default.Ins.init();\r\n        $onlineContext.default.Ins.init();\r\n        $rankService.default.instance.initData();\r\n    };\r\n    e.prototype.resourcesLoadedProccess = function () {\r\n        $uIManager.UIManager.instance.loadBaseUI();\r\n        $resManager.ResManager.instance.loadArray(\r\n            [$assetsMap.BundleNames.Popup],\r\n            null,\r\n            function () {\r\n                console.log(\"弹窗预加载完成\");\r\n            },\r\n            !0\r\n        );\r\n    };\r\n    e.prototype.update = function (t) {\r\n        $countDownUtil.CountDownUtil.update(t);\r\n        $countDownUtil.CountDownUtil.time += t;\r\n    };\r\n    __decorate([E(cc.Prefab)], e.prototype, \"lodingView\", void 0);\r\n    __decorate([E(cc.Prefab)], e.prototype, \"confirmView\", void 0);\r\n    return __decorate([L], e);\r\n})(cc.Component);\r\nexports.GinApplication = M;\r\n"]}