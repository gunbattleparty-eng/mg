
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/OnlineListItem.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '10840jHuh5CbrL2TfkdyV64', 'OnlineListItem');
// game_script/scripts/OnlineListItem.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $popupManager = require("./PopupManager");

var $platform = require("./Platform");

var $remoteAudio = require("./RemoteAudio");

var $seedUtil = require("./SeedUtil");

var $util = require("./Util");

var $aD = require("./AD");

var $adService = require("./AdService");

var $localEventName = require("./LocalEventName");

var $onlineContext = require("./OnlineContext");

var $skillContext = require("./SkillContext");

var $userDataContext = require("./UserDataContext");

var $startView = require("./StartView");

var w = cc._decorator;
var A = w.ccclass;
var S = w.property;

var C = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.titleLaleb = null;
    e.btnGain = null;
    e.iconSp = null;
    e.countLable = null;
    e.timeLable = null;
    e.redDot = null;
    e.config = null;
    return e;
  }

  __extends(e, t);

  e.prototype.start = function () {
    this.btnGain.on("click", this.clickGain, this);
  };

  e.prototype.init = function (t) {
    this.config = t;
    this.titleLaleb.string = t.name;
    this.countLable.string = t.num.toString();
    this.renderIcon();
    this.render();
    this.refresh();

    if (!($onlineContext["default"].Ins.getTime() >= this.config.time)) {
      this.schedule(this.refresh, 1);
    }
  };

  e.prototype.render = function () {
    if ($onlineContext["default"].Ins.hasGain(this.config.id)) {
      this.btnGain.active = !1;
    } else {
      {
        this.btnGain.active = !0;
        var t = $onlineContext["default"].Ins.getTime() >= this.config.time;
        $util["default"].updateMaterialState(this.btnGain, !t);
        this.btnGain.getComponent(cc.Button).interactable = t;
        this.btnGain.getComponentInChildren(cc.Label).string = t ? "领取" : "未达成";
        this.btnGain.children[1].active = 1 === this.config.receivetype && t;
      }
    }
  };

  e.prototype.renderIcon = function () {
    var t = this;
    var e = "";
    var i = "";
    1 === this.config.reward ? (e = $assetsMap.BundleNames.Public, i = "/textures/gem/zuanshi") : 2 === this.config.reward ? (e = $assetsMap.BundleNames.Public, i = "/textures/gem/jinbi") : 3 === this.config.reward ? (e = $assetsMap.BundleNames.Public_Res, i = "/skill_book/jn0") : 4 === this.config.reward ? (e = $assetsMap.BundleNames.Public_Res, i = "/equipment_icon/zb0") : 6 === this.config.reward ? (e = $assetsMap.BundleNames.Public, i = "/textures/gem/upgrade_sone") : 7 === this.config.reward && (e = $assetsMap.BundleNames.Public, i = "/textures/gem/tili");
    $assetsLoader["default"].instance.loadRes(e, [i], cc.SpriteFrame, null, function (e, i) {
      var o = i[0];

      if (o && cc.isValid(t.iconSp)) {
        t.iconSp.spriteFrame = $resUtil.ResUtil.assignWith(o, t.node);
      }
    });
  };

  e.prototype.clickGain = function () {
    var t = this;
    $remoteAudio["default"].instance.playEffectMusic("Click");
    1 !== this.config.receivetype ? this.gain() : $adService["default"].Ins.showRewardedVideo(function () {
      if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {
        if (1200 === t.config.time) {
          $aD["default"].toutiao.report("Online_Rewards_1");
        }

        if (1800 === t.config.time) {
          $aD["default"].toutiao.report("Online_Rewards_2");
        }
      }

      t.gain();
    });
  };

  e.prototype.gain = function () {
    $onlineContext["default"].Ins.setRecrodGain(this.config.id);
    var t = [];

    if (1 === this.config.reward) {
      $userDataContext["default"].Ins.opearDiamond(this.config.num);
      t.push({
        type: 6,
        num: this.config.num
      });
    } else {
      if (2 === this.config.reward) {
        $userDataContext["default"].Ins.opearCoin(this.config.num);
        t.push({
          type: 1,
          num: this.config.num
        });
      } else {
        if (3 === this.config.reward) {
          var e = $skillContext["default"].Ins.getUseSkillIds();
          var i = e[$seedUtil["default"].randomFrom(0, e.length - 1)];
          t.push({
            type: 4,
            ext: i,
            num: this.config.num
          });
          $userDataContext["default"].Ins.opearSkillBook(i, this.config.num);
        } else {
          if (4 === this.config.reward) {
            var o = $seedUtil["default"].randomFrom(1, 6);
            t.push({
              type: 3,
              ext: o,
              num: this.config.num
            });
            $userDataContext["default"].Ins.opearEquipBook(o, this.config.num);
          } else {
            6 === this.config.reward ? (t.push({
              type: 7,
              num: this.config.num
            }), $userDataContext["default"].Ins.opearUpgradeStone(this.config.num)) : 7 === this.config.reward && (t.push({
              type: 8,
              num: this.config.num
            }), $userDataContext["default"].Ins.opearPower(this.config.num));
          }
        }
      }
    }

    $eventManager["default"].send($localEventName["default"].RENDER_DOT, $startView.MenuType.ALL);
    $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.RewardView, {
      infos: t
    });
    this.render();
    this.renderDot();
  };

  e.prototype.refresh = function () {
    this.renderDot();

    if (this.config.time <= $onlineContext["default"].Ins.getTime()) {
      this.unschedule(this.refresh);
      this.timeLable.node.active = !1;
      this.render();
    }

    var t = $util["default"].formatDate(this.config.time - $onlineContext["default"].Ins.getTime());
    this.timeLable.string = t[1] + ":" + t[2];
  };

  e.prototype.renderDot = function () {
    this.redDot.active = this.config.time <= $onlineContext["default"].Ins.getTime() && !$onlineContext["default"].Ins.hasGain(this.config.id);
  };

  __decorate([S(cc.Label)], e.prototype, "titleLaleb", void 0);

  __decorate([S(cc.Node)], e.prototype, "btnGain", void 0);

  __decorate([S(cc.Sprite)], e.prototype, "iconSp", void 0);

  __decorate([S(cc.Label)], e.prototype, "countLable", void 0);

  __decorate([S(cc.Label)], e.prototype, "timeLable", void 0);

  __decorate([S(cc.Node)], e.prototype, "redDot", void 0);

  return __decorate([A], e);
}(cc.Component);

exports["default"] = C;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXE9ubGluZUxpc3RJdGVtLmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRldmVudE1hbmFnZXIiLCIkcG9wdXBNYW5hZ2VyIiwiJHBsYXRmb3JtIiwiJHJlbW90ZUF1ZGlvIiwiJHNlZWRVdGlsIiwiJHV0aWwiLCIkYUQiLCIkYWRTZXJ2aWNlIiwiJGxvY2FsRXZlbnROYW1lIiwiJG9ubGluZUNvbnRleHQiLCIkc2tpbGxDb250ZXh0IiwiJHVzZXJEYXRhQ29udGV4dCIsIiRzdGFydFZpZXciLCJ3IiwiY2MiLCJfZGVjb3JhdG9yIiwiQSIsImNjY2xhc3MiLCJTIiwicHJvcGVydHkiLCJDIiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsInRpdGxlTGFsZWIiLCJidG5HYWluIiwiaWNvblNwIiwiY291bnRMYWJsZSIsInRpbWVMYWJsZSIsInJlZERvdCIsImNvbmZpZyIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsInN0YXJ0Iiwib24iLCJjbGlja0dhaW4iLCJpbml0Iiwic3RyaW5nIiwibmFtZSIsIm51bSIsInRvU3RyaW5nIiwicmVuZGVySWNvbiIsInJlbmRlciIsInJlZnJlc2giLCJJbnMiLCJnZXRUaW1lIiwidGltZSIsInNjaGVkdWxlIiwiaGFzR2FpbiIsImlkIiwiYWN0aXZlIiwidXBkYXRlTWF0ZXJpYWxTdGF0ZSIsImdldENvbXBvbmVudCIsIkJ1dHRvbiIsImludGVyYWN0YWJsZSIsImdldENvbXBvbmVudEluQ2hpbGRyZW4iLCJMYWJlbCIsImNoaWxkcmVuIiwicmVjZWl2ZXR5cGUiLCJpIiwicmV3YXJkIiwiQnVuZGxlTmFtZXMiLCJQdWJsaWMiLCJQdWJsaWNfUmVzIiwiaW5zdGFuY2UiLCJsb2FkUmVzIiwiU3ByaXRlRnJhbWUiLCJpc1ZhbGlkIiwic3ByaXRlRnJhbWUiLCJSZXNVdGlsIiwiYXNzaWduV2l0aCIsIm5vZGUiLCJwbGF5RWZmZWN0TXVzaWMiLCJnYWluIiwic2hvd1Jld2FyZGVkVmlkZW8iLCJQbGF0Zm9ybSIsImN1cnJQbGF0Rm9ybSIsIlBsYXRmb3JtRW51bSIsIlRPVV9USUFPIiwidG91dGlhbyIsInJlcG9ydCIsInNldFJlY3JvZEdhaW4iLCJvcGVhckRpYW1vbmQiLCJwdXNoIiwidHlwZSIsIm9wZWFyQ29pbiIsImdldFVzZVNraWxsSWRzIiwicmFuZG9tRnJvbSIsImxlbmd0aCIsImV4dCIsIm9wZWFyU2tpbGxCb29rIiwib3BlYXJFcXVpcEJvb2siLCJvcGVhclVwZ3JhZGVTdG9uZSIsIm9wZWFyUG93ZXIiLCJzZW5kIiwiUkVOREVSX0RPVCIsIk1lbnVUeXBlIiwiQUxMIiwiUG9wdXBNYW5hZ2VyIiwib3BlbiIsIkFzc2V0c01hcCIsIlBvcFVwQnVuZGxlcyIsInByZWZhYnMiLCJhc3NldHNMaXN0IiwiUmV3YXJkVmlldyIsImluZm9zIiwicmVuZGVyRG90IiwidW5zY2hlZHVsZSIsImZvcm1hdERhdGUiLCJfX2RlY29yYXRlIiwiTm9kZSIsIlNwcml0ZSIsIkNvbXBvbmVudCIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsQ0FBSjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdDLE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJQyxVQUFVLEdBQUdELE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlFLFFBQVEsR0FBR0YsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUcsYUFBYSxHQUFHSCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUksYUFBYSxHQUFHSixPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUssU0FBUyxHQUFHTCxPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFDQSxJQUFJTSxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlPLFNBQVMsR0FBR1AsT0FB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QyxDQUFDNUYsQ0FBQyxDQUFDSixFQUFFLENBQUNrRyxNQUFKLENBQUYsQ0FBRCxFQUFpQjFGLENBQUMsQ0FBQ1csU0FBbkIsRUFBOEIsUUFBOUIsRUFBd0MsS0FBSyxDQUE3QyxDQUFWOztFQUNBNkUsVUFBVSxDQUFDLENBQUM1RixDQUFDLENBQUNKLEVBQUUsQ0FBQzJDLEtBQUosQ0FBRixDQUFELEVBQWdCbkMsQ0FBQyxDQUFDVyxTQUFsQixFQUE2QixZQUE3QixFQUEyQyxLQUFLLENBQWhELENBQVY7O0VBQ0E2RSxVQUFVLENBQUMsQ0FBQzVGLENBQUMsQ0FBQ0osRUFBRSxDQUFDMkMsS0FBSixDQUFGLENBQUQsRUFBZ0JuQyxDQUFDLENBQUNXLFNBQWxCLEVBQTZCLFdBQTdCLEVBQTBDLEtBQUssQ0FBL0MsQ0FBVjs7RUFDQTZFLFVBQVUsQ0FBQyxDQUFDNUYsQ0FBQyxDQUFDSixFQUFFLENBQUNpRyxJQUFKLENBQUYsQ0FBRCxFQUFlekYsQ0FBQyxDQUFDVyxTQUFqQixFQUE0QixRQUE1QixFQUFzQyxLQUFLLENBQTNDLENBQVY7O0VBQ0EsT0FBTzZFLFVBQVUsQ0FBQyxDQUFDOUYsQ0FBRCxDQUFELEVBQU1NLENBQU4sQ0FBakI7QUFDSCxDQWpLTyxDQWlLTFIsRUFBRSxDQUFDbUcsU0FqS0UsQ0FBUjs7QUFrS0FDLE9BQU8sV0FBUCxHQUFrQjlGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRwb3B1cE1hbmFnZXIgPSByZXF1aXJlKFwiLi9Qb3B1cE1hbmFnZXJcIik7XHJcbnZhciAkcGxhdGZvcm0gPSByZXF1aXJlKFwiLi9QbGF0Zm9ybVwiKTtcclxudmFyICRyZW1vdGVBdWRpbyA9IHJlcXVpcmUoXCIuL1JlbW90ZUF1ZGlvXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkdXRpbCA9IHJlcXVpcmUoXCIuL1V0aWxcIik7XHJcbnZhciAkYUQgPSByZXF1aXJlKFwiLi9BRFwiKTtcclxudmFyICRhZFNlcnZpY2UgPSByZXF1aXJlKFwiLi9BZFNlcnZpY2VcIik7XHJcbnZhciAkbG9jYWxFdmVudE5hbWUgPSByZXF1aXJlKFwiLi9Mb2NhbEV2ZW50TmFtZVwiKTtcclxudmFyICRvbmxpbmVDb250ZXh0ID0gcmVxdWlyZShcIi4vT25saW5lQ29udGV4dFwiKTtcclxudmFyICRza2lsbENvbnRleHQgPSByZXF1aXJlKFwiLi9Ta2lsbENvbnRleHRcIik7XHJcbnZhciAkdXNlckRhdGFDb250ZXh0ID0gcmVxdWlyZShcIi4vVXNlckRhdGFDb250ZXh0XCIpO1xyXG52YXIgJHN0YXJ0VmlldyA9IHJlcXVpcmUoXCIuL1N0YXJ0Vmlld1wiKTtcclxudmFyIHcgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgQSA9IHcuY2NjbGFzcztcclxudmFyIFMgPSB3LnByb3BlcnR5O1xyXG52YXIgQyA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLnRpdGxlTGFsZWIgPSBudWxsO1xyXG4gICAgICAgIGUuYnRuR2FpbiA9IG51bGw7XHJcbiAgICAgICAgZS5pY29uU3AgPSBudWxsO1xyXG4gICAgICAgIGUuY291bnRMYWJsZSA9IG51bGw7XHJcbiAgICAgICAgZS50aW1lTGFibGUgPSBudWxsO1xyXG4gICAgICAgIGUucmVkRG90ID0gbnVsbDtcclxuICAgICAgICBlLmNvbmZpZyA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0bkdhaW4ub24oXCJjbGlja1wiLCB0aGlzLmNsaWNrR2FpbiwgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdGhpcy5jb25maWcgPSB0O1xyXG4gICAgICAgIHRoaXMudGl0bGVMYWxlYi5zdHJpbmcgPSB0Lm5hbWU7XHJcbiAgICAgICAgdGhpcy5jb3VudExhYmxlLnN0cmluZyA9IHQubnVtLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJJY29uKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICBpZiAoISgkb25saW5lQ29udGV4dC5kZWZhdWx0Lklucy5nZXRUaW1lKCkgPj0gdGhpcy5jb25maWcudGltZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZSh0aGlzLnJlZnJlc2gsIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCRvbmxpbmVDb250ZXh0LmRlZmF1bHQuSW5zLmhhc0dhaW4odGhpcy5jb25maWcuaWQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYnRuR2Fpbi5hY3RpdmUgPSAhMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkdhaW4uYWN0aXZlID0gITA7XHJcbiAgICAgICAgICAgICAgICB2YXIgdCA9ICRvbmxpbmVDb250ZXh0LmRlZmF1bHQuSW5zLmdldFRpbWUoKSA+PSB0aGlzLmNvbmZpZy50aW1lO1xyXG4gICAgICAgICAgICAgICAgJHV0aWwuZGVmYXVsdC51cGRhdGVNYXRlcmlhbFN0YXRlKHRoaXMuYnRuR2FpbiwgIXQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5HYWluLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9IHQ7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJ0bkdhaW4uZ2V0Q29tcG9uZW50SW5DaGlsZHJlbihjYy5MYWJlbCkuc3RyaW5nID0gdCA/IFwi6aKG5Y+WXCIgOiBcIuacqui+vuaIkFwiO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idG5HYWluLmNoaWxkcmVuWzFdLmFjdGl2ZSA9IDEgPT09IHRoaXMuY29uZmlnLnJlY2VpdmV0eXBlICYmIHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVuZGVySWNvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGUgPSBcIlwiO1xyXG4gICAgICAgIHZhciBpID0gXCJcIjtcclxuICAgICAgICAxID09PSB0aGlzLmNvbmZpZy5yZXdhcmRcclxuICAgICAgICAgICAgPyAoKGUgPSAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLlB1YmxpYyksIChpID0gXCIvdGV4dHVyZXMvZ2VtL3p1YW5zaGlcIikpXHJcbiAgICAgICAgICAgIDogMiA9PT0gdGhpcy5jb25maWcucmV3YXJkXHJcbiAgICAgICAgICAgID8gKChlID0gJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5QdWJsaWMpLCAoaSA9IFwiL3RleHR1cmVzL2dlbS9qaW5iaVwiKSlcclxuICAgICAgICAgICAgOiAzID09PSB0aGlzLmNvbmZpZy5yZXdhcmRcclxuICAgICAgICAgICAgPyAoKGUgPSAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLlB1YmxpY19SZXMpLCAoaSA9IFwiL3NraWxsX2Jvb2svam4wXCIpKVxyXG4gICAgICAgICAgICA6IDQgPT09IHRoaXMuY29uZmlnLnJld2FyZFxyXG4gICAgICAgICAgICA/ICgoZSA9ICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuUHVibGljX1JlcyksIChpID0gXCIvZXF1aXBtZW50X2ljb24vemIwXCIpKVxyXG4gICAgICAgICAgICA6IDYgPT09IHRoaXMuY29uZmlnLnJld2FyZFxyXG4gICAgICAgICAgICA/ICgoZSA9ICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuUHVibGljKSwgKGkgPSBcIi90ZXh0dXJlcy9nZW0vdXBncmFkZV9zb25lXCIpKVxyXG4gICAgICAgICAgICA6IDcgPT09IHRoaXMuY29uZmlnLnJld2FyZCAmJiAoKGUgPSAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLlB1YmxpYyksIChpID0gXCIvdGV4dHVyZXMvZ2VtL3RpbGlcIikpO1xyXG4gICAgICAgICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5sb2FkUmVzKGUsIFtpXSwgY2MuU3ByaXRlRnJhbWUsIG51bGwsIGZ1bmN0aW9uIChlLCBpKSB7XHJcbiAgICAgICAgICAgIHZhciBvID0gaVswXTtcclxuICAgICAgICAgICAgaWYgKG8gJiYgY2MuaXNWYWxpZCh0Lmljb25TcCkpIHtcclxuICAgICAgICAgICAgICAgIHQuaWNvblNwLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKG8sIHQubm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jbGlja0dhaW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgICRyZW1vdGVBdWRpby5kZWZhdWx0Lmluc3RhbmNlLnBsYXlFZmZlY3RNdXNpYyhcIkNsaWNrXCIpO1xyXG4gICAgICAgIDEgIT09IHRoaXMuY29uZmlnLnJlY2VpdmV0eXBlXHJcbiAgICAgICAgICAgID8gdGhpcy5nYWluKClcclxuICAgICAgICAgICAgOiAkYWRTZXJ2aWNlLmRlZmF1bHQuSW5zLnNob3dSZXdhcmRlZFZpZGVvKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKCRwbGF0Zm9ybS5QbGF0Zm9ybS5jdXJyUGxhdEZvcm0gPT09ICRwbGF0Zm9ybS5QbGF0Zm9ybUVudW0uVE9VX1RJQU8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgIGlmICgxMjAwID09PSB0LmNvbmZpZy50aW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJGFELmRlZmF1bHQudG91dGlhby5yZXBvcnQoXCJPbmxpbmVfUmV3YXJkc18xXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKDE4MDAgPT09IHQuY29uZmlnLnRpbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAkYUQuZGVmYXVsdC50b3V0aWFvLnJlcG9ydChcIk9ubGluZV9SZXdhcmRzXzJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgdC5nYWluKCk7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZ2FpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAkb25saW5lQ29udGV4dC5kZWZhdWx0Lklucy5zZXRSZWNyb2RHYWluKHRoaXMuY29uZmlnLmlkKTtcclxuICAgICAgICB2YXIgdCA9IFtdO1xyXG4gICAgICAgIGlmICgxID09PSB0aGlzLmNvbmZpZy5yZXdhcmQpIHtcclxuICAgICAgICAgICAgJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5vcGVhckRpYW1vbmQodGhpcy5jb25maWcubnVtKTtcclxuICAgICAgICAgICAgdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IDYsXHJcbiAgICAgICAgICAgICAgICBudW06IHRoaXMuY29uZmlnLm51bVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoMiA9PT0gdGhpcy5jb25maWcucmV3YXJkKSB7XHJcbiAgICAgICAgICAgICAgICAkdXNlckRhdGFDb250ZXh0LmRlZmF1bHQuSW5zLm9wZWFyQ29pbih0aGlzLmNvbmZpZy5udW0pO1xyXG4gICAgICAgICAgICAgICAgdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIG51bTogdGhpcy5jb25maWcubnVtXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgzID09PSB0aGlzLmNvbmZpZy5yZXdhcmQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9ICRza2lsbENvbnRleHQuZGVmYXVsdC5JbnMuZ2V0VXNlU2tpbGxJZHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGVbJHNlZWRVdGlsLmRlZmF1bHQucmFuZG9tRnJvbSgwLCBlLmxlbmd0aCAtIDEpXTtcclxuICAgICAgICAgICAgICAgICAgICB0LnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiA0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHQ6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG51bTogdGhpcy5jb25maWcubnVtXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5vcGVhclNraWxsQm9vayhpLCB0aGlzLmNvbmZpZy5udW0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoNCA9PT0gdGhpcy5jb25maWcucmV3YXJkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvID0gJHNlZWRVdGlsLmRlZmF1bHQucmFuZG9tRnJvbSgxLCA2KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IDMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHQ6IG8sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW06IHRoaXMuY29uZmlnLm51bVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5vcGVhckVxdWlwQm9vayhvLCB0aGlzLmNvbmZpZy5udW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDYgPT09IHRoaXMuY29uZmlnLnJld2FyZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAodC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IDcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudW06IHRoaXMuY29uZmlnLm51bVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJEYXRhQ29udGV4dC5kZWZhdWx0Lklucy5vcGVhclVwZ3JhZGVTdG9uZSh0aGlzLmNvbmZpZy5udW0pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiA3ID09PSB0aGlzLmNvbmZpZy5yZXdhcmQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiA4LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtOiB0aGlzLmNvbmZpZy5udW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1c2VyRGF0YUNvbnRleHQuZGVmYXVsdC5JbnMub3BlYXJQb3dlcih0aGlzLmNvbmZpZy5udW0pKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuUkVOREVSX0RPVCwgJHN0YXJ0Vmlldy5NZW51VHlwZS5BTEwpO1xyXG4gICAgICAgICRwb3B1cE1hbmFnZXIuUG9wdXBNYW5hZ2VyLmluc3RhbmNlLm9wZW4oJGFzc2V0c01hcC5Bc3NldHNNYXAuUG9wVXBCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5SZXdhcmRWaWV3LCB7XHJcbiAgICAgICAgICAgIGluZm9zOiB0XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgICAgICB0aGlzLnJlbmRlckRvdCgpO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJEb3QoKTtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcudGltZSA8PSAkb25saW5lQ29udGV4dC5kZWZhdWx0Lklucy5nZXRUaW1lKCkpIHtcclxuICAgICAgICAgICAgdGhpcy51bnNjaGVkdWxlKHRoaXMucmVmcmVzaCk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxhYmxlLm5vZGUuYWN0aXZlID0gITE7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0ID0gJHV0aWwuZGVmYXVsdC5mb3JtYXREYXRlKHRoaXMuY29uZmlnLnRpbWUgLSAkb25saW5lQ29udGV4dC5kZWZhdWx0Lklucy5nZXRUaW1lKCkpO1xyXG4gICAgICAgIHRoaXMudGltZUxhYmxlLnN0cmluZyA9IHRbMV0gKyBcIjpcIiArIHRbMl07XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUucmVuZGVyRG90ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMucmVkRG90LmFjdGl2ZSA9XHJcbiAgICAgICAgICAgIHRoaXMuY29uZmlnLnRpbWUgPD0gJG9ubGluZUNvbnRleHQuZGVmYXVsdC5JbnMuZ2V0VGltZSgpICYmXHJcbiAgICAgICAgICAgICEkb25saW5lQ29udGV4dC5kZWZhdWx0Lklucy5oYXNHYWluKHRoaXMuY29uZmlnLmlkKTtcclxuICAgIH07XHJcbiAgICBfX2RlY29yYXRlKFtTKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcInRpdGxlTGFsZWJcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1MoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJidG5HYWluXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtTKGNjLlNwcml0ZSldLCBlLnByb3RvdHlwZSwgXCJpY29uU3BcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1MoY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwiY291bnRMYWJsZVwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbUyhjYy5MYWJlbCldLCBlLnByb3RvdHlwZSwgXCJ0aW1lTGFibGVcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1MoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJyZWREb3RcIiwgdm9pZCAwKTtcclxuICAgIHJldHVybiBfX2RlY29yYXRlKFtBXSwgZSk7XHJcbn0pKGNjLkNvbXBvbmVudCk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IEM7XHJcbiJdfQ==