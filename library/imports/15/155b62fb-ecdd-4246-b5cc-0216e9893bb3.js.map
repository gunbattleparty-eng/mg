{"version":3,"sources":["assets\\game_script\\scripts\\WeChatInterstitial.js"],"names":["o","$baseAd","require","r","window","wx","a","t","e","apply","arguments","isOpenPreLoad","__extends","prototype","loadAd","adUnitId","createInterstitialAd","adIns","isConsume","isLoaded","onLoad","onClose","onErro","onError","console","warn","error","showInterstitial","i","showCallback","closeCallback","errorCallback","reCreateAd","showing","show","then","noRespondCount","destroyAd","isAutoShow","log","offLoad","offClose","offError","destroy","onAdLoad","call","autoShow","onAdError","onAdClose","BaseAd","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $baseAd = require(\"./BaseAd\");\r\nvar r = window.wx;\r\nvar a = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.isOpenPreLoad = !0;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.loadAd = function () {\r\n        if (this.adUnitId) {\r\n            if (r && r.createInterstitialAd) {\r\n                var t = {\r\n                    adUnitId: this.adUnitId\r\n                };\r\n                this.adIns = r.createInterstitialAd(t);\r\n                this.isConsume = !1;\r\n                this.isLoaded = !1;\r\n                if (this.adIns.onLoad) {\r\n                    this.adIns.onLoad(this.onLoad);\r\n                }\r\n                if (this.adIns.onClose) {\r\n                    this.adIns.onClose(this.onClose);\r\n                }\r\n                if (this.adIns.onErro) {\r\n                    this.adIns.onError(this.onError);\r\n                }\r\n            } else {\r\n                console.warn(\"当前平台不支持创建插屏\");\r\n            }\r\n        } else {\r\n            console.error(\"微信插屏 ID为空\");\r\n        }\r\n    };\r\n    e.prototype.showInterstitial = function (t, e, i) {\r\n        var o = this;\r\n        this.showCallback = t;\r\n        this.closeCallback = e;\r\n        this.errorCallback = i;\r\n        return this.adIns\r\n            ? this.isConsume\r\n                ? this.reCreateAd(!0)\r\n                : this.isLoaded\r\n                ? void (this.showing\r\n                      ? console.warn(this.adUnitId, \":正在显示中，不给显示\")\r\n                      : this.adIns\r\n                      ? this.adIns.show &&\r\n                        this.adIns\r\n                            .show()\r\n                            .then(function () {\r\n                                o.showing = !0;\r\n                                if (o.showCallback) {\r\n                                    o.showCallback();\r\n                                }\r\n                                o.showCallback = null;\r\n                                o.noRespondCount = 0;\r\n                            })\r\n                            .catch(function (t) {\r\n                                o.showing = !1;\r\n                                console.warn(\"interstitial show error:\", t);\r\n                                o.destroyAd();\r\n                            })\r\n                      : (console.warn(\"interstitial对象未创建,将在创建完成后自动显示\"), this.reCreateAd(!0)))\r\n                : (this.noRespondCount++,\r\n                  console.warn(this.adUnitId, \":未加载完成，稍等，重复：\", this.noRespondCount),\r\n                  (this.isAutoShow = !0),\r\n                  void (this.noRespondCount >= 3 && ((this.noRespondCount = 0), this.reCreateAd(!0))))\r\n            : (console.warn(this.adUnitId, \":未创建，执行创建\"), (this.isAutoShow = !0), this.loadAd());\r\n    };\r\n    e.prototype.reCreateAd = function (t) {\r\n        this.destroyAd();\r\n        this.isAutoShow = t;\r\n        this.loadAd();\r\n    };\r\n    e.prototype.destroyAd = function () {\r\n        console.log(this.adUnitId, \":===destroyAd===\");\r\n        this.isLoaded = !1;\r\n        this.isAutoShow = !1;\r\n        this.isConsume = !1;\r\n        this.showCallback = null;\r\n        this.errorCallback = null;\r\n        if (this.adIns) {\r\n            if (this.adIns.offLoad) {\r\n                this.adIns.offLoad(this.onLoad);\r\n            }\r\n            if (this.adIns.offClose) {\r\n                this.adIns.offClose(this.onClose);\r\n            }\r\n            if (this.adIns.offError) {\r\n                this.adIns.offError(this.onError);\r\n            }\r\n            if (this.adIns.destroy) {\r\n                this.adIns.destroy();\r\n            }\r\n            this.adIns = null;\r\n        }\r\n    };\r\n    e.prototype.onAdLoad = function () {\r\n        t.prototype.onAdLoad.call(this);\r\n        this.isConsume = !1;\r\n        this.isLoaded = !0;\r\n        this.autoShow();\r\n    };\r\n    e.prototype.onAdError = function (e) {\r\n        t.prototype.onAdError.call(this, e);\r\n        this.showing = !1;\r\n        if (this.errorCallback) {\r\n            this.errorCallback();\r\n        }\r\n        this.destroyAd();\r\n    };\r\n    e.prototype.onAdClose = function () {\r\n        t.prototype.onAdClose.call(this);\r\n        this.showing = !1;\r\n        if (this.closeCallback) {\r\n            this.closeCallback();\r\n        }\r\n        if (this.isOpenPreLoad) {\r\n            this.reCreateAd(!1);\r\n        }\r\n    };\r\n    e.prototype.autoShow = function () {\r\n        if (this.isAutoShow) {\r\n            this.isAutoShow = !1;\r\n            this.showInterstitial(this.showCallback, this.closeCallback, this.errorCallback);\r\n        }\r\n    };\r\n    return e;\r\n})($baseAd.BaseAd);\r\nexports.default = a;\r\n"]}