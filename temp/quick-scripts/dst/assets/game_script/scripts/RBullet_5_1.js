
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/RBullet_5_1.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b2939kaBWhGc6EAuu2YkvZ9', 'RBullet_5_1');
// game_script/scripts/RBullet_5_1.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $gameContext = require("./GameContext");

var $baseBullet = require("./BaseBullet");

var d = cc._decorator;
var p = d.ccclass;
var f = d.property;
var h = (new cc.Vec3(), function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.r_bullet_5_1;
    e.point1 = [];
    e.pointNode = null;
    e.atkCDLeft = 0;
    e.timeLeft = 0;
    e.isAttacking = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e) {
    var i = this;
    t.prototype.initButtle.call(this, e, null);
    this.atkCDLeft = $gameContext["default"].ins.skillInfo.robotParam[4];
    this.timeLeft = $gameContext["default"].ins.skillInfo.robotParam[5];
    cc.tween(this.node.children[0]).to(0.3, {
      x: 290
    }).start();
    cc.tween(this.node.children[1]).to(0.3, {
      x: -290
    }).call(function () {
      i.isUse = !1;
    }).start();
  };

  e.prototype.updateFrame = function (t) {
    var e = this;

    if (!(this.isUse || this.timeLeft <= 0)) {
      this.timeLeft -= t;

      if (this.timeLeft <= 0) {
        this.timeLeft = 0;
        this.isUse = !0;
        cc.tween(this.node.children[0]).to(0.3, {
          x: 500
        }).start();
        cc.tween(this.node.children[1]).to(0.3, {
          x: -500
        }).call(function () {
          e.removeSelf();
        }).start();
      }

      if (!this.isAttacking) {
        this.atkCDLeft -= t;

        if (this.atkCDLeft <= 0) {
          this.atkCDLeft = $gameContext["default"].ins.skillInfo.robotParam[4];
          this.startGun();
        }
      }
    }
  };

  e.prototype.startGun = function () {
    var t = $gameContext["default"].ins.getRandomEnemys(this.pointNode, 2, $gameContext["default"].ins.skillInfo.robotParam[2]);

    if (t.length <= 0) {
      this.atkCDLeft = 1;
      return !1;
    }

    if (1 === t.length) {
      this.caculateTarget(0, t[0]);
      this.caculateTarget(1, t[0]);
    } else {
      for (var e = 0; e < t.length; e++) {
        this.caculateTarget(e, t[e]);
      }
    }

    this.atkCDLeft = $gameContext["default"].ins.skillInfo.robotParam[4];
    this.isAttacking = !1;
  };

  e.prototype.caculateTarget = function (t, e) {
    var i = this.node.position.add(this.point1[t].position);
    var o = e.getPosition().sub(i).normalizeSelf();
    this.createButtle(o, i);
  };

  e.prototype.createButtle = function (t, e) {
    var i = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.r_bullet_5_2);

    if (!i) {
      var o = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.RBullet_5_2);
      i = $resUtil.ResUtil.instantiate(o, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    i.setPosition(e);
    i.initButtle(t, null);
    i.insert($gameContext["default"].ins.lowBulletLayer);
  };

  __decorate([f([cc.Node])], e.prototype, "point1", void 0);

  return __decorate([p], e);
}($baseBullet["default"]));
exports["default"] = h;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFJCdWxsZXRfNV8xLmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRnYW1lQ29udGV4dCIsIiRiYXNlQnVsbGV0IiwiZCIsImNjIiwiX2RlY29yYXRvciIsInAiLCJjY2NsYXNzIiwiZiIsInByb3BlcnR5IiwiaCIsIlZlYzMiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYnV0dGxlVHlwZSIsIkJ1bGxldFR5cGUiLCJyX2J1bGxldF81XzEiLCJwb2ludDEiLCJwb2ludE5vZGUiLCJhdGtDRExlZnQiLCJ0aW1lTGVmdCIsImlzQXR0YWNraW5nIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEJ1dHRsZSIsImkiLCJjYWxsIiwiaW5zIiwic2tpbGxJbmZvIiwicm9ib3RQYXJhbSIsInR3ZWVuIiwibm9kZSIsImNoaWxkcmVuIiwidG8iLCJ4Iiwic3RhcnQiLCJpc1VzZSIsInVwZGF0ZUZyYW1lIiwicmVtb3ZlU2VsZiIsInN0YXJ0R3VuIiwiZ2V0UmFuZG9tRW5lbXlzIiwibGVuZ3RoIiwiY2FjdWxhdGVUYXJnZXQiLCJwb3NpdGlvbiIsImFkZCIsImdldFBvc2l0aW9uIiwic3ViIiwibm9ybWFsaXplU2VsZiIsImNyZWF0ZUJ1dHRsZSIsImdldEJ1dHRsZVBvb2wiLCJyX2J1bGxldF81XzIiLCJpbnN0YW5jZSIsImdldFJlcyIsIkJ1bmRsZU5hbWVzIiwiR2FtZSIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJSQnVsbGV0XzVfMiIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImxvd0J1bGxldExheWVyIiwicGFyZW50IiwiZ2V0Q29tcG9uZW50Iiwic2V0UG9zaXRpb24iLCJpbnNlcnQiLCJfX2RlY29yYXRlIiwiTm9kZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7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ZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciBkID0gY2MuX2RlY29yYXRvcjtcclxudmFyIHAgPSBkLmNjY2xhc3M7XHJcbnZhciBmID0gZC5wcm9wZXJ0eTtcclxudmFyIGggPVxyXG4gICAgKG5ldyBjYy5WZWMzKCksXHJcbiAgICAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICAgICAgZS5idXR0bGVUeXBlID0gJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5yX2J1bGxldF81XzE7XHJcbiAgICAgICAgICAgIGUucG9pbnQxID0gW107XHJcbiAgICAgICAgICAgIGUucG9pbnROb2RlID0gbnVsbDtcclxuICAgICAgICAgICAgZS5hdGtDRExlZnQgPSAwO1xyXG4gICAgICAgICAgICBlLnRpbWVMZWZ0ID0gMDtcclxuICAgICAgICAgICAgZS5pc0F0dGFja2luZyA9ICExO1xyXG4gICAgICAgICAgICByZXR1cm4gZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgICAgIGUucHJvdG90eXBlLmluaXRCdXR0bGUgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IHRoaXM7XHJcbiAgICAgICAgICAgIHQucHJvdG90eXBlLmluaXRCdXR0bGUuY2FsbCh0aGlzLCBlLCBudWxsKTtcclxuICAgICAgICAgICAgdGhpcy5hdGtDRExlZnQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnJvYm90UGFyYW1bNF07XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnJvYm90UGFyYW1bNV07XHJcbiAgICAgICAgICAgIGNjLnR3ZWVuKHRoaXMubm9kZS5jaGlsZHJlblswXSlcclxuICAgICAgICAgICAgICAgIC50bygwLjMsIHtcclxuICAgICAgICAgICAgICAgICAgICB4OiAyOTBcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuc3RhcnQoKTtcclxuICAgICAgICAgICAgY2MudHdlZW4odGhpcy5ub2RlLmNoaWxkcmVuWzFdKVxyXG4gICAgICAgICAgICAgICAgLnRvKDAuMywge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IC0yOTBcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2FsbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaS5pc1VzZSA9ICExO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5zdGFydCgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUudXBkYXRlRnJhbWUgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICghKHRoaXMuaXNVc2UgfHwgdGhpcy50aW1lTGVmdCA8PSAwKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAtPSB0O1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudGltZUxlZnQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGltZUxlZnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNVc2UgPSAhMDtcclxuICAgICAgICAgICAgICAgICAgICBjYy50d2Vlbih0aGlzLm5vZGUuY2hpbGRyZW5bMF0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50bygwLjMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IDUwMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3RhcnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjYy50d2Vlbih0aGlzLm5vZGUuY2hpbGRyZW5bMV0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50bygwLjMsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHg6IC01MDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhbGwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5yZW1vdmVTZWxmKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdGFydCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzQXR0YWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdGtDRExlZnQgLT0gdDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hdGtDRExlZnQgPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF0a0NETGVmdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8ucm9ib3RQYXJhbVs0XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGFydEd1bigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuc3RhcnRHdW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldFJhbmRvbUVuZW15cyhcclxuICAgICAgICAgICAgICAgIHRoaXMucG9pbnROb2RlLFxyXG4gICAgICAgICAgICAgICAgMixcclxuICAgICAgICAgICAgICAgICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8ucm9ib3RQYXJhbVsyXVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAodC5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdGtDRExlZnQgPSAxO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICExO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgxID09PSB0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWN1bGF0ZVRhcmdldCgwLCB0WzBdKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjdWxhdGVUYXJnZXQoMSwgdFswXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBlID0gMDsgZSA8IHQubGVuZ3RoOyBlKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY3VsYXRlVGFyZ2V0KGUsIHRbZV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYXRrQ0RMZWZ0ID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5yb2JvdFBhcmFtWzRdO1xyXG4gICAgICAgICAgICB0aGlzLmlzQXR0YWNraW5nID0gITE7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5jYWN1bGF0ZVRhcmdldCA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gdGhpcy5ub2RlLnBvc2l0aW9uLmFkZCh0aGlzLnBvaW50MVt0XS5wb3NpdGlvbik7XHJcbiAgICAgICAgICAgIHZhciBvID0gZS5nZXRQb3NpdGlvbigpLnN1YihpKS5ub3JtYWxpemVTZWxmKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQnV0dGxlKG8sIGkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuY3JlYXRlQnV0dGxlID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0QnV0dGxlUG9vbCgkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLnJfYnVsbGV0XzVfMik7XHJcbiAgICAgICAgICAgIGlmICghaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG8gPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuUkJ1bGxldF81XzJcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICBpID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShvLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpLnNldFBvc2l0aW9uKGUpO1xyXG4gICAgICAgICAgICBpLmluaXRCdXR0bGUodCwgbnVsbCk7XHJcbiAgICAgICAgICAgIGkuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5sb3dCdWxsZXRMYXllcik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBfX2RlY29yYXRlKFtmKFtjYy5Ob2RlXSldLCBlLnByb3RvdHlwZSwgXCJwb2ludDFcIiwgdm9pZCAwKTtcclxuICAgICAgICByZXR1cm4gX19kZWNvcmF0ZShbcF0sIGUpO1xyXG4gICAgfSkoJGJhc2VCdWxsZXQuZGVmYXVsdCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBoO1xyXG4iXX0=