{"version":3,"sources":["assets\\game_script\\scripts\\HWRewardedVideo.js"],"names":["o","exports","HWRewardedVideo","$baseAd","require","r","window","qg","a","t","e","apply","arguments","videoEndCallback","_lastCallShowTime","__extends","prototype","loadAd","adUnitId","createRewardedVideoAd","adIns","onLoad","onClose","onError","load","console","warn","showRewardedVideo","i","Date","getTime","closeCallback","showCallback","musicVolume","cc","audioEngine","getMusicVolume","effectsVolume","getEffectsVolume","isAutoShow","isConsume","reCreateAd","isLoaded","showing","show","pause","resume","error","call","autoShow","onAdLoad","log","onAdError","destroyAd","onAdClose","isEnded","isOpenPreLoad","offLoad","offClose","offError","destroy","BaseAd"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nexports.HWRewardedVideo = void 0;\r\nvar $baseAd = require(\"./BaseAd\");\r\nvar r = window.qg;\r\nvar a = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.videoEndCallback = null;\r\n        e._lastCallShowTime = 0;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.loadAd = function () {\r\n        if (this.adUnitId) {\r\n            if (r && r.createRewardedVideoAd) {\r\n                var t = {\r\n                    adUnitId: this.adUnitId\r\n                };\r\n                this.adIns = r.createRewardedVideoAd(t);\r\n                if (this.adIns.onLoad) {\r\n                    this.adIns.onLoad(this.onLoad);\r\n                }\r\n                if (this.adIns.onClose) {\r\n                    this.adIns.onClose(this.onClose);\r\n                }\r\n                if (this.adIns.onError) {\r\n                    this.adIns.onError(this.onError);\r\n                }\r\n                this.adIns.load();\r\n            } else {\r\n                console.warn(\"当前平台不支持创建激励视频\");\r\n            }\r\n        } else {\r\n            console.warn(\"激励视频ID为空\");\r\n        }\r\n    };\r\n    e.prototype.showRewardedVideo = function (t, e, i) {\r\n        var o = new Date().getTime();\r\n        if (o - this._lastCallShowTime < 2e3) {\r\n            console.warn(\"showRewardedVideo,调用太频繁\");\r\n            return void (this.closeCallback && this.closeCallback());\r\n        }\r\n        this._lastCallShowTime = o;\r\n        this.showCallback = t;\r\n        this.closeCallback = e;\r\n        this.videoEndCallback = i;\r\n        this.musicVolume = cc.audioEngine.getMusicVolume();\r\n        this.effectsVolume = cc.audioEngine.getEffectsVolume();\r\n        if (!this.adIns) {\r\n            this.isAutoShow = !0;\r\n            console.warn(this.adUnitId, \":未创建，执行创建\");\r\n            this.loadAd();\r\n        }\r\n        if (this.isConsume) {\r\n            this.reCreateAd(!0);\r\n        } else {\r\n            {\r\n                if (!this.isLoaded) {\r\n                    this.isAutoShow = !0;\r\n                    return void console.warn(this.adUnitId, \":未加载完成，稍等\");\r\n                }\r\n                if (this.showing) {\r\n                    console.warn(this.adUnitId, \"广告正在显示中\");\r\n                } else {\r\n                    {\r\n                        this.showing = !1;\r\n                        if (this.adIns.show) {\r\n                            this.pause();\r\n                            this.isConsume = !0;\r\n                            this.showing = !0;\r\n                            this.adIns.show();\r\n                            if (this.showCallback) {\r\n                                this.showCallback();\r\n                            }\r\n                            return void (this.showCallback = null);\r\n                        }\r\n                        this.resume();\r\n                        console.error(this.adUnitId, \":未知错误\");\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    e.prototype.reCreateAd = function (e) {\r\n        t.prototype.reCreateAd.call(this, e);\r\n        this.resume();\r\n    };\r\n    e.prototype.autoShow = function () {\r\n        if (this.isAutoShow) {\r\n            this.isAutoShow = !1;\r\n            this.showRewardedVideo(this.showCallback, this.closeCallback, this.videoEndCallback);\r\n        }\r\n    };\r\n    e.prototype.onAdLoad = function () {\r\n        console.log(this.adUnitId, \":===onAdload===\");\r\n        this.isConsume = !1;\r\n        this.isLoaded = !0;\r\n        this.showing = !1;\r\n        this.autoShow();\r\n    };\r\n    e.prototype.onAdError = function (t) {\r\n        console.log(\"激励视频onAdError\", this.adUnitId, t);\r\n        this.showing = !1;\r\n        this.resume();\r\n        this.destroyAd();\r\n    };\r\n    e.prototype.onAdClose = function (t) {\r\n        console.log(this.adUnitId, \":===onAdClose===\");\r\n        this.showing = !1;\r\n        t && t.isEnded ? this.videoEndCallback && this.videoEndCallback() : this.closeCallback && this.closeCallback();\r\n        this.isOpenPreLoad ? this.adIns.load() : this.destroyAd();\r\n        this.resume();\r\n    };\r\n    e.prototype.destroyAd = function () {\r\n        t.prototype.destroyAd.call(this);\r\n        this.videoEndCallback = null;\r\n        if (this.adIns) {\r\n            if (this.adIns.offLoad) {\r\n                this.adIns.offLoad(this.onLoad);\r\n            }\r\n            if (this.adIns.offClose) {\r\n                this.adIns.offClose(this.onClose);\r\n            }\r\n            if (this.adIns.offError) {\r\n                this.adIns.offError(this.onError);\r\n            }\r\n            if (this.adIns.destroy) {\r\n                this.adIns.destroy();\r\n            }\r\n            this.adIns = null;\r\n        }\r\n    };\r\n    return e;\r\n})($baseAd.BaseAd);\r\nexports.HWRewardedVideo = a;\r\n"]}