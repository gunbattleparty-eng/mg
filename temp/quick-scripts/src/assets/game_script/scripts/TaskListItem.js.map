{"version":3,"sources":["assets\\game_script\\scripts\\TaskListItem.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$popupManager","$remoteAudio","$seedUtil","$util","$localEventName","$skillContext","$taskContext","$userDataContext","$startView","k","cc","_decorator","v","ccclass","b","property","w","t","e","apply","arguments","titleLaleb","progress","btnGain","iconSp","countLable","redDot","config","__extends","prototype","start","on","clickGain","init","string","num","toString","render","renderIcon","i","reward","BundleNames","Public","Public_Res","instance","loadRes","SpriteFrame","isValid","spriteFrame","ResUtil","assignWith","node","name","Ins","getTaskRecord","id","getComponentInChildren","Label","target_num","active","isGain","updateMaterialState","getComponent","Button","interactable","playEffectMusic","gainTask","opearDiamond","push","type","opearCoin","getUseSkillIds","randomFrom","length","ext","opearSkillBook","opearEquipBook","opearUpgradeStone","send","RENDER_DOT","MenuType","ALL","PopupManager","open","AssetsMap","PopUpBundles","prefabs","assetsList","RewardView","infos","__decorate","ProgressBar","Node","Sprite","Component","exports"],"mappings":";;;;;;AAAA,IAAIA,CAAJ;;AACA,IAAIC,aAAa,GAAGC,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIC,UAAU,GAAGD,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,WAAD,CAAtB;;AACA,IAAIG,aAAa,GAAGH,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAII,aAAa,GAAGJ,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIK,YAAY,GAAGL,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIM,SAAS,GAAGN,OAAO,CAAC,YAAD,CAAvB;;AACA,IAAIO,KAAK,GAAGP,OAAO,CAAC,QAAD,CAAnB;;AACA,IAAIQ,eAAe,GAAGR,OAAO,CAAC,kBAAD,CAA7B;;AACA,IAAIS,aAAa,GAAGT,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIU,YAAY,GAAGV,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIW,gBAAgB,GAAGX,OAAO,CAAC,mBAAD,CAA9B;;AACA,IAAIY,UAAU,GAAGZ,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIa,CAAC,GAAGC,EAAE,CAACC,UAAX;AACA,IAAIC,CAAC,GAAGH,CAAC,CAACI,OAAV;AACA,IAAIC,CAAC,GAAGL,CAAC,CAACM,QAAV;;AACA,IAAIC,CAAC,GAAI,UAAUC,CAAV,EAAa;EAClB,SAASC,CAAT,GAAa;IACT,IAAIA,CAAC,GAAI,SAASD,CAAT,IAAcA,CAAC,CAACE,KAAF,CAAQ,IAAR,EAAcC,SAAd,CAAf,IAA4C,IAApD;IACAF,CAAC,CAACG,UAAF,GAAe,IAAf;IACAH,CAAC,CAACI,QAAF,GAAa,IAAb;IACAJ,CAAC,CAACK,OAAF,GAAY,IAAZ;IACAL,CAAC,CAACM,MAAF,GAAW,IAAX;IACAN,CAAC,CAACO,UAAF,GAAe,IAAf;IACAP,CAAC,CAACQ,MAAF,GAAW,IAAX;IACAR,CAAC,CAACS,MAAF,GAAW,IAAX;IACA,OAAOT,CAAP;EACH;;EACDU,SAAS,CAACV,CAAD,EAAID,CAAJ,CAAT;;EACAC,CAAC,CAACW,SAAF,CAAYC,KAAZ,GAAoB,YAAY;IAC5B,KAAKP,OAAL,CAAaQ,EAAb,CAAgB,OAAhB,EAAyB,KAAKC,SAA9B,EAAyC,IAAzC;EACH,CAFD;;EAGAd,CAAC,CAACW,SAAF,CAAYI,IAAZ,GAAmB,UAAUhB,CAAV,EAAa;IAC5B,KAAKU,MAAL,GAAcV,CAAd;IACA,KAAKQ,UAAL,CAAgBS,MAAhB,GAAyBjB,CAAC,CAACkB,GAAF,CAAMC,QAAN,EAAzB;IACA,KAAKC,MAAL;IACA,KAAKC,UAAL;EACH,CALD;;EAMApB,CAAC,CAACW,SAAF,CAAYS,UAAZ,GAAyB,YAAY;IACjC,IAAIrB,CAAC,GAAG,IAAR;IACA,IAAIC,CAAC,GAAG,EAAR;IACA,IAAIqB,CAAC,GAAG,EAAR;IACA,MAAM,KAAKZ,MAAL,CAAYa,MAAlB,IACQtB,CAAC,GAAGrB,UAAU,CAAC4C,WAAX,CAAuBC,MAA5B,EAAsCH,CAAC,GAAG,uBADjD,IAEM,MAAM,KAAKZ,MAAL,CAAYa,MAAlB,IACEtB,CAAC,GAAGrB,UAAU,CAAC4C,WAAX,CAAuBC,MAA5B,EAAsCH,CAAC,GAAG,qBAD3C,IAEA,MAAM,KAAKZ,MAAL,CAAYa,MAAlB,IACEtB,CAAC,GAAGrB,UAAU,CAAC4C,WAAX,CAAuBE,UAA5B,EAA0CJ,CAAC,GAAG,iBAD/C,IAEA,MAAM,KAAKZ,MAAL,CAAYa,MAAlB,IACEtB,CAAC,GAAGrB,UAAU,CAAC4C,WAAX,CAAuBE,UAA5B,EAA0CJ,CAAC,GAAG,qBAD/C,IAEA,MAAM,KAAKZ,MAAL,CAAYa,MAAlB,KAA8BtB,CAAC,GAAGrB,UAAU,CAAC4C,WAAX,CAAuBC,MAA5B,EAAsCH,CAAC,GAAG,4BAAvE,CARN;IASA5C,aAAa,WAAb,CAAsBiD,QAAtB,CAA+BC,OAA/B,CAAuC3B,CAAvC,EAA0C,CAACqB,CAAD,CAA1C,EAA+C7B,EAAE,CAACoC,WAAlD,EAA+D,IAA/D,EAAqE,UAAU5B,CAAV,EAAaqB,CAAb,EAAgB;MACjF,IAAI7C,CAAC,GAAG6C,CAAC,CAAC,CAAD,CAAT;;MACA,IAAI7C,CAAC,IAAIgB,EAAE,CAACqC,OAAH,CAAW9B,CAAC,CAACO,MAAb,CAAT,EAA+B;QAC3BP,CAAC,CAACO,MAAF,CAASwB,WAAT,GAAuBlD,QAAQ,CAACmD,OAAT,CAAiBC,UAAjB,CAA4BxD,CAA5B,EAA+BuB,CAAC,CAACkC,IAAjC,CAAvB;MACH;IACJ,CALD;EAMH,CAnBD;;EAoBAjC,CAAC,CAACW,SAAF,CAAYQ,MAAZ,GAAqB,YAAY;IAC7B,KAAKhB,UAAL,CAAgBa,MAAhB,GAAyB,KAAKP,MAAL,CAAYyB,IAArC;IACA,IAAInC,CAAC,GAAGX,YAAY,WAAZ,CAAqB+C,GAArB,CAAyBC,aAAzB,CAAuC,KAAK3B,MAAL,CAAY4B,EAAnD,CAAR;IACA,KAAKjC,QAAL,CAAc6B,IAAd,CAAmBK,sBAAnB,CAA0C9C,EAAE,CAAC+C,KAA7C,EAAoDvB,MAApD,GAA6DjB,CAAC,CAACkB,GAAF,GAAQ,GAAR,GAAc,KAAKR,MAAL,CAAY+B,UAAvF;IACA,KAAKpC,QAAL,CAAcA,QAAd,GAAyBL,CAAC,CAACkB,GAAF,GAAQ,KAAKR,MAAL,CAAY+B,UAA7C;IACA,KAAKnC,OAAL,CAAaoC,MAAb,GAAsB,CAAC,CAAvB;IACA,KAAKjC,MAAL,CAAYiC,MAAZ,GAAqB,CAAC,CAAtB;IACA1C,CAAC,CAAC2C,MAAF,GACO,KAAKrC,OAAL,CAAaoC,MAAb,GAAsB,CAAC,CAD9B,GAEM1C,CAAC,CAACkB,GAAF,IAAS,KAAKR,MAAL,CAAY+B,UAArB,IACCvD,KAAK,WAAL,CAAc0D,mBAAd,CAAkC,KAAKtC,OAAvC,EAAgD,CAAC,CAAjD,GACA,KAAKA,OAAL,CAAauC,YAAb,CAA0BpD,EAAE,CAACqD,MAA7B,EAAqCC,YAArC,GAAoD,CAAC,CADrD,EAEA,KAAKzC,OAAL,CAAaiC,sBAAb,CAAoC9C,EAAE,CAAC+C,KAAvC,EAA8CvB,MAA9C,GAAuD,IAFvD,EAGA,KAAKR,MAAL,CAAYiC,MAAZ,GAAqB,CAAC,CAJvB,KAKCxD,KAAK,WAAL,CAAc0D,mBAAd,CAAkC,KAAKtC,OAAvC,EAAgD,CAAC,CAAjD,GACA,KAAKA,OAAL,CAAauC,YAAb,CAA0BpD,EAAE,CAACqD,MAA7B,EAAqCC,YAArC,GAAoD,CAAC,CADrD,EAEA,KAAKzC,OAAL,CAAaiC,sBAAb,CAAoC9C,EAAE,CAAC+C,KAAvC,EAA8CvB,MAA9C,GAAuD,KAPxD,CAFN;EAUH,CAjBD;;EAkBAhB,CAAC,CAACW,SAAF,CAAYG,SAAZ,GAAwB,YAAY;IAChC/B,YAAY,WAAZ,CAAqB2C,QAArB,CAA8BqB,eAA9B,CAA8C,OAA9C;;IACA,IAAI3D,YAAY,WAAZ,CAAqB+C,GAArB,CAAyBC,aAAzB,CAAuC,KAAK3B,MAAL,CAAY4B,EAAnD,EAAuDpB,GAAvD,IAA8D,KAAKR,MAAL,CAAY+B,UAA9E,EAA0F;MACtFpD,YAAY,WAAZ,CAAqB+C,GAArB,CAAyBa,QAAzB,CAAkC,KAAKvC,MAAL,CAAY4B,EAA9C;MACA,IAAItC,CAAC,GAAG,EAAR;;MACA,IAAI,MAAM,KAAKU,MAAL,CAAYa,MAAtB,EAA8B;QAC1BjC,gBAAgB,WAAhB,CAAyB8C,GAAzB,CAA6Bc,YAA7B,CAA0C,KAAKxC,MAAL,CAAYQ,GAAtD;QACAlB,CAAC,CAACmD,IAAF,CAAO;UACHC,IAAI,EAAE,CADH;UAEHlC,GAAG,EAAE,KAAKR,MAAL,CAAYQ;QAFd,CAAP;MAIH,CAND,MAMO;QACH,IAAI,MAAM,KAAKR,MAAL,CAAYa,MAAtB,EAA8B;UAC1BjC,gBAAgB,WAAhB,CAAyB8C,GAAzB,CAA6BiB,SAA7B,CAAuC,KAAK3C,MAAL,CAAYQ,GAAnD;UACAlB,CAAC,CAACmD,IAAF,CAAO;YACHC,IAAI,EAAE,CADH;YAEHlC,GAAG,EAAE,KAAKR,MAAL,CAAYQ;UAFd,CAAP;QAIH,CAND,MAMO;UACH,IAAI,MAAM,KAAKR,MAAL,CAAYa,MAAtB,EAA8B;YAC1B,IAAItB,CAAC,GAAGb,aAAa,WAAb,CAAsBgD,GAAtB,CAA0BkB,cAA1B,EAAR;YACA,IAAIhC,CAAC,GAAGrB,CAAC,CAAChB,SAAS,WAAT,CAAkBsE,UAAlB,CAA6B,CAA7B,EAAgCtD,CAAC,CAACuD,MAAF,GAAW,CAA3C,CAAD,CAAT;YACAxD,CAAC,CAACmD,IAAF,CAAO;cACHC,IAAI,EAAE,CADH;cAEHK,GAAG,EAAEnC,CAFF;cAGHJ,GAAG,EAAE,KAAKR,MAAL,CAAYQ;YAHd,CAAP;YAKA5B,gBAAgB,WAAhB,CAAyB8C,GAAzB,CAA6BsB,cAA7B,CAA4CpC,CAA5C,EAA+C,KAAKZ,MAAL,CAAYQ,GAA3D;UACH,CATD,MASO;YACH,IAAI,MAAM,KAAKR,MAAL,CAAYa,MAAtB,EAA8B;cAC1B,IAAI9C,CAAC,GAAGQ,SAAS,WAAT,CAAkBsE,UAAlB,CAA6B,CAA7B,EAAgC,CAAhC,CAAR;cACAvD,CAAC,CAACmD,IAAF,CAAO;gBACHC,IAAI,EAAE,CADH;gBAEHK,GAAG,EAAEhF,CAFF;gBAGHyC,GAAG,EAAE,KAAKR,MAAL,CAAYQ;cAHd,CAAP;cAKA5B,gBAAgB,WAAhB,CAAyB8C,GAAzB,CAA6BuB,cAA7B,CAA4ClF,CAA5C,EAA+C,KAAKiC,MAAL,CAAYQ,GAA3D;YACH,CARD,MAQO;cACH,IAAI,MAAM,KAAKR,MAAL,CAAYa,MAAtB,EAA8B;gBAC1BvB,CAAC,CAACmD,IAAF,CAAO;kBACHC,IAAI,EAAE,CADH;kBAEHlC,GAAG,EAAE,KAAKR,MAAL,CAAYQ;gBAFd,CAAP;gBAIA5B,gBAAgB,WAAhB,CAAyB8C,GAAzB,CAA6BwB,iBAA7B,CAA+C,KAAKlD,MAAL,CAAYQ,GAA3D;cACH;YACJ;UACJ;QACJ;MACJ;;MACDpC,aAAa,WAAb,CAAsB+E,IAAtB,CAA2B1E,eAAe,WAAf,CAAwB2E,UAAnD,EAA+DvE,UAAU,CAACwE,QAAX,CAAoBC,GAAnF;MACAjF,aAAa,CAACkF,YAAd,CAA2BtC,QAA3B,CAAoCuC,IAApC,CAAyCtF,UAAU,CAACuF,SAAX,CAAqBC,YAArB,CAAkCC,OAAlC,CAA0CC,UAA1C,CAAqDC,UAA9F,EAA0G;QACtGC,KAAK,EAAExE;MAD+F,CAA1G;IAGH;;IACD,KAAKoB,MAAL;EACH,CAvDD;;EAwDAqD,UAAU,CAAC,CAAC5E,CAAC,CAACJ,EAAE,CAAC+C,KAAJ,CAAF,CAAD,EAAgBvC,CAAC,CAACW,SAAlB,EAA6B,YAA7B,EAA2C,KAAK,CAAhD,CAAV;;EACA6D,UAAU,CAAC,CAAC5E,CAAC,CAACJ,EAAE,CAACiF,WAAJ,CAAF,CAAD,EAAsBzE,CAAC,CAACW,SAAxB,EAAmC,UAAnC,EAA+C,KAAK,CAApD,CAAV;;EACA6D,UAAU,CAAC,CAAC5E,CAAC,CAACJ,EAAE,CAACkF,IAAJ,CAAF,CAAD,EAAe1E,CAAC,CAACW,SAAjB,EAA4B,SAA5B,EAAuC,KAAK,CAA5C,CAAV;;EACA6D,UAAU,CAAC,CAAC5E,CAAC,CAACJ,EAAE,CAACmF,MAAJ,CAAF,CAAD,EAAiB3E,CAAC,CAACW,SAAnB,EAA8B,QAA9B,EAAwC,KAAK,CAA7C,CAAV;;EACA6D,UAAU,CAAC,CAAC5E,CAAC,CAACJ,EAAE,CAAC+C,KAAJ,CAAF,CAAD,EAAgBvC,CAAC,CAACW,SAAlB,EAA6B,YAA7B,EAA2C,KAAK,CAAhD,CAAV;;EACA6D,UAAU,CAAC,CAAC5E,CAAC,CAACJ,EAAE,CAACkF,IAAJ,CAAF,CAAD,EAAe1E,CAAC,CAACW,SAAjB,EAA4B,QAA5B,EAAsC,KAAK,CAA3C,CAAV;;EACA,OAAO6D,UAAU,CAAC,CAAC9E,CAAD,CAAD,EAAMM,CAAN,CAAjB;AACH,CA3HO,CA2HLR,EAAE,CAACoF,SA3HE,CAAR;;AA4HAC,OAAO,WAAP,GAAkB/E,CAAlB","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $remoteAudio = require(\"./RemoteAudio\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $skillContext = require(\"./SkillContext\");\r\nvar $taskContext = require(\"./TaskContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar $startView = require(\"./StartView\");\r\nvar k = cc._decorator;\r\nvar v = k.ccclass;\r\nvar b = k.property;\r\nvar w = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.titleLaleb = null;\r\n        e.progress = null;\r\n        e.btnGain = null;\r\n        e.iconSp = null;\r\n        e.countLable = null;\r\n        e.redDot = null;\r\n        e.config = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.start = function () {\r\n        this.btnGain.on(\"click\", this.clickGain, this);\r\n    };\r\n    e.prototype.init = function (t) {\r\n        this.config = t;\r\n        this.countLable.string = t.num.toString();\r\n        this.render();\r\n        this.renderIcon();\r\n    };\r\n    e.prototype.renderIcon = function () {\r\n        var t = this;\r\n        var e = \"\";\r\n        var i = \"\";\r\n        1 === this.config.reward\r\n            ? ((e = $assetsMap.BundleNames.Public), (i = \"/textures/gem/zuanshi\"))\r\n            : 2 === this.config.reward\r\n            ? ((e = $assetsMap.BundleNames.Public), (i = \"/textures/gem/jinbi\"))\r\n            : 3 === this.config.reward\r\n            ? ((e = $assetsMap.BundleNames.Public_Res), (i = \"/skill_book/jn0\"))\r\n            : 4 === this.config.reward\r\n            ? ((e = $assetsMap.BundleNames.Public_Res), (i = \"/equipment_icon/zb0\"))\r\n            : 6 === this.config.reward && ((e = $assetsMap.BundleNames.Public), (i = \"/textures/gem/upgrade_sone\"));\r\n        $assetsLoader.default.instance.loadRes(e, [i], cc.SpriteFrame, null, function (e, i) {\r\n            var o = i[0];\r\n            if (o && cc.isValid(t.iconSp)) {\r\n                t.iconSp.spriteFrame = $resUtil.ResUtil.assignWith(o, t.node);\r\n            }\r\n        });\r\n    };\r\n    e.prototype.render = function () {\r\n        this.titleLaleb.string = this.config.name;\r\n        var t = $taskContext.default.Ins.getTaskRecord(this.config.id);\r\n        this.progress.node.getComponentInChildren(cc.Label).string = t.num + \"/\" + this.config.target_num;\r\n        this.progress.progress = t.num / this.config.target_num;\r\n        this.btnGain.active = !0;\r\n        this.redDot.active = !1;\r\n        t.isGain\r\n            ? (this.btnGain.active = !1)\r\n            : t.num >= this.config.target_num\r\n            ? ($util.default.updateMaterialState(this.btnGain, !1),\r\n              (this.btnGain.getComponent(cc.Button).interactable = !0),\r\n              (this.btnGain.getComponentInChildren(cc.Label).string = \"领取\"),\r\n              (this.redDot.active = !0))\r\n            : ($util.default.updateMaterialState(this.btnGain, !0),\r\n              (this.btnGain.getComponent(cc.Button).interactable = !1),\r\n              (this.btnGain.getComponentInChildren(cc.Label).string = \"未完成\"));\r\n    };\r\n    e.prototype.clickGain = function () {\r\n        $remoteAudio.default.instance.playEffectMusic(\"Click\");\r\n        if ($taskContext.default.Ins.getTaskRecord(this.config.id).num >= this.config.target_num) {\r\n            $taskContext.default.Ins.gainTask(this.config.id);\r\n            var t = [];\r\n            if (1 === this.config.reward) {\r\n                $userDataContext.default.Ins.opearDiamond(this.config.num);\r\n                t.push({\r\n                    type: 6,\r\n                    num: this.config.num\r\n                });\r\n            } else {\r\n                if (2 === this.config.reward) {\r\n                    $userDataContext.default.Ins.opearCoin(this.config.num);\r\n                    t.push({\r\n                        type: 1,\r\n                        num: this.config.num\r\n                    });\r\n                } else {\r\n                    if (3 === this.config.reward) {\r\n                        var e = $skillContext.default.Ins.getUseSkillIds();\r\n                        var i = e[$seedUtil.default.randomFrom(0, e.length - 1)];\r\n                        t.push({\r\n                            type: 4,\r\n                            ext: i,\r\n                            num: this.config.num\r\n                        });\r\n                        $userDataContext.default.Ins.opearSkillBook(i, this.config.num);\r\n                    } else {\r\n                        if (4 === this.config.reward) {\r\n                            var o = $seedUtil.default.randomFrom(1, 6);\r\n                            t.push({\r\n                                type: 3,\r\n                                ext: o,\r\n                                num: this.config.num\r\n                            });\r\n                            $userDataContext.default.Ins.opearEquipBook(o, this.config.num);\r\n                        } else {\r\n                            if (6 === this.config.reward) {\r\n                                t.push({\r\n                                    type: 7,\r\n                                    num: this.config.num\r\n                                });\r\n                                $userDataContext.default.Ins.opearUpgradeStone(this.config.num);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.ALL);\r\n            $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.RewardView, {\r\n                infos: t\r\n            });\r\n        }\r\n        this.render();\r\n    };\r\n    __decorate([b(cc.Label)], e.prototype, \"titleLaleb\", void 0);\r\n    __decorate([b(cc.ProgressBar)], e.prototype, \"progress\", void 0);\r\n    __decorate([b(cc.Node)], e.prototype, \"btnGain\", void 0);\r\n    __decorate([b(cc.Sprite)], e.prototype, \"iconSp\", void 0);\r\n    __decorate([b(cc.Label)], e.prototype, \"countLable\", void 0);\r\n    __decorate([b(cc.Node)], e.prototype, \"redDot\", void 0);\r\n    return __decorate([v], e);\r\n})(cc.Component);\r\nexports.default = w;\r\n"]}