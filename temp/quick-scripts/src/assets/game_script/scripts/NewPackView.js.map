{"version":3,"sources":["assets\\game_script\\scripts\\NewPackView.js"],"names":["o","$assetsMap","require","$eventManager","$popupManager","$popupView","$platform","$seedUtil","$aD","$adService","$configContext","$localEventName","$roleContext","$userDataContext","$startView","k","cc","_decorator","v","ccclass","b","property","w","t","e","apply","arguments","btnAd","signContent","countLayer","__extends","prototype","onResetView","active","Ins","isSign","children","sign","day","instance","signConfigs","length","i","num","getComponent","Label","string","toString","addEvent","on","clickAd","removeEvent","off","showRewardedVideo","Platform","currPlatForm","PlatformEnum","TOU_TIAO","toutiao","report","caculetReward","send","RENDER_DOT","MenuType","Battle","find","id","rewardtpye","n","ins","getGunSkinInfo","shard","setGunSkinInfo","push","type","ext","s","gemConfigs","filter","Grade","a","randomFrom","addPackItem","opearCoin","opearDiamond","PopupManager","open","AssetsMap","PopUpBundles","prefabs","assetsList","RewardView","infos","signRecord","__decorate","Node","PopupView","exports"],"mappings":";;;;;;AAAA,IAAIA,CAAJ;;AACA,IAAIC,UAAU,GAAGC,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIC,aAAa,GAAGD,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIE,aAAa,GAAGF,OAAO,CAAC,gBAAD,CAA3B;;AACA,IAAIG,UAAU,GAAGH,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAII,SAAS,GAAGJ,OAAO,CAAC,YAAD,CAAvB;;AACA,IAAIK,SAAS,GAAGL,OAAO,CAAC,YAAD,CAAvB;;AACA,IAAIM,GAAG,GAAGN,OAAO,CAAC,MAAD,CAAjB;;AACA,IAAIO,UAAU,GAAGP,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIQ,cAAc,GAAGR,OAAO,CAAC,iBAAD,CAA5B;;AACA,IAAIS,eAAe,GAAGT,OAAO,CAAC,kBAAD,CAA7B;;AACA,IAAIU,YAAY,GAAGV,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAIW,gBAAgB,GAAGX,OAAO,CAAC,mBAAD,CAA9B;;AACA,IAAIY,UAAU,GAAGZ,OAAO,CAAC,aAAD,CAAxB;;AACA,IAAIa,CAAC,GAAGC,EAAE,CAACC,UAAX;AACA,IAAIC,CAAC,GAAGH,CAAC,CAACI,OAAV;AACA,IAAIC,CAAC,GAAGL,CAAC,CAACM,QAAV;;AACA,IAAIC,CAAC,GAAI,UAAUC,CAAV,EAAa;EAClB,SAASC,CAAT,GAAa;IACT,IAAIA,CAAC,GAAI,SAASD,CAAT,IAAcA,CAAC,CAACE,KAAF,CAAQ,IAAR,EAAcC,SAAd,CAAf,IAA4C,IAApD;IACAF,CAAC,CAACG,KAAF,GAAU,IAAV;IACAH,CAAC,CAACI,WAAF,GAAgB,IAAhB;IACAJ,CAAC,CAACK,UAAF,GAAe,IAAf;IACA,OAAOL,CAAP;EACH;;EACDM,SAAS,CAACN,CAAD,EAAID,CAAJ,CAAT;;EACAC,CAAC,CAACO,SAAF,CAAYC,WAAZ,GAA0B,YAAY;IAClC,KAAKL,KAAL,CAAWM,MAAX,GAAoB,CAACpB,gBAAgB,WAAhB,CAAyBqB,GAAzB,CAA6BC,MAA7B,EAArB;;IACA,KAAK,IAAIZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI,CAArB,EAAwBA,CAAC,EAAzB,EAA6B;MACzB,KAAKK,WAAL,CAAiBQ,QAAjB,CAA0Bb,CAAC,GAAG,CAA9B,EAAiCU,MAAjC,GAA0CpB,gBAAgB,WAAhB,CAAyBqB,GAAzB,CAA6BG,IAA7B,CAAkCC,GAAlC,IAAyCf,CAAnF;IACH;;IACD,KAAKA,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGb,cAAc,WAAd,CAAuB6B,QAAvB,CAAgCC,WAAhC,CAA4CC,MAA5D,EAAoElB,CAAC,EAArE,EAAyE;MACrE,IAAIC,CAAC,GAAGd,cAAc,WAAd,CAAuB6B,QAAvB,CAAgCC,WAAhC,CAA4CjB,CAA5C,CAAR;MACA,IAAImB,CAAC,GAAG,KAAKb,UAAL,CAAgBO,QAAhB,CAAyBb,CAAzB,CAAR;;MACA,KAAK,IAAIvB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwB,CAAC,CAACmB,GAAF,CAAMF,MAA1B,EAAkCzC,CAAC,EAAnC,EAAuC;QACnC0C,CAAC,CAACN,QAAF,CAAWpC,CAAX,EAAc4C,YAAd,CAA2B5B,EAAE,CAAC6B,KAA9B,EAAqCC,MAArC,GAA8CtB,CAAC,CAACmB,GAAF,CAAM3C,CAAN,EAAS+C,QAAT,EAA9C;MACH;IACJ;EACJ,CAZD;;EAaAvB,CAAC,CAACO,SAAF,CAAYiB,QAAZ,GAAuB,YAAY;IAC/B,KAAKrB,KAAL,CAAWsB,EAAX,CAAc,OAAd,EAAuB,KAAKC,OAA5B,EAAqC,IAArC;EACH,CAFD;;EAGA1B,CAAC,CAACO,SAAF,CAAYoB,WAAZ,GAA0B,YAAY;IAClC,KAAKxB,KAAL,CAAWyB,GAAX,CAAe,OAAf,EAAwB,KAAKF,OAA7B,EAAsC,IAAtC;EACH,CAFD;;EAGA1B,CAAC,CAACO,SAAF,CAAYmB,OAAZ,GAAsB,YAAY;IAC9B,IAAI3B,CAAC,GAAG,IAAR;IACAd,UAAU,WAAV,CAAmByB,GAAnB,CAAuBmB,iBAAvB,CAAyC,YAAY;MACjD,IAAI/C,SAAS,CAACgD,QAAV,CAAmBC,YAAnB,KAAoCjD,SAAS,CAACkD,YAAV,CAAuBC,QAA/D,EAAyE;QACrEjD,GAAG,WAAH,CAAYkD,OAAZ,CAAoBC,MAApB,CAA2B,UAA3B;MACH;;MACDpC,CAAC,CAACqC,aAAF;MACArC,CAAC,CAACS,WAAF;MACA7B,aAAa,WAAb,CAAsB0D,IAAtB,CAA2BlD,eAAe,WAAf,CAAwBmD,UAAnD,EAA+DhD,UAAU,CAACiD,QAAX,CAAoBC,MAAnF;IACH,CAPD;EAQH,CAVD;;EAWAxC,CAAC,CAACO,SAAF,CAAY6B,aAAZ,GAA4B,YAAY;IACpC,IAAIrC,CAAC,GAAGb,cAAc,WAAd,CAAuB6B,QAAvB,CAAgCC,WAAhC,CAA4CyB,IAA5C,CAAiD,UAAU1C,CAAV,EAAa;MAClE,OAAOA,CAAC,CAAC2C,EAAF,KAASrD,gBAAgB,WAAhB,CAAyBqB,GAAzB,CAA6BG,IAA7B,CAAkCC,GAAlC,GAAwC,CAAxD;IACH,CAFO,CAAR;IAGA,IAAId,CAAC,GAAG,EAAR;;IACA,KAAK,IAAIkB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,CAAC,CAAC4C,UAAF,CAAa1B,MAAjC,EAAyCC,CAAC,EAA1C,EAA8C;MAC1C,IAAI1C,CAAC,GAAGuB,CAAC,CAAC4C,UAAF,CAAazB,CAAb,CAAR;;MACA,IAAI,MAAM1C,CAAV,EAAa;QACT,IAAIoE,CAAC,GAAGxD,YAAY,WAAZ,CAAqByD,GAArB,CAAyBC,cAAzB,CAAwC,CAAxC,CAAR;QACAF,CAAC,CAACG,KAAF,IAAW,CAAX;QACA3D,YAAY,WAAZ,CAAqByD,GAArB,CAAyBG,cAAzB,CAAwCJ,CAAxC;QACA5C,CAAC,CAACiD,IAAF,CAAO;UACHC,IAAI,EAAE,EADH;UAEHC,GAAG,EAAE,CAFF;UAGHhC,GAAG,EAAE;QAHF,CAAP;MAKH,CATD,MASO;QACH,IAAI,MAAM3C,CAAV,EAAa;UACT,IAAI4E,CAAC,GAAGlE,cAAc,WAAd,CAAuB6B,QAAvB,CAAgCsC,UAAhC,CAA2CC,MAA3C,CAAkD,UAAUvD,CAAV,EAAa;YACnE,OAAO,MAAMA,CAAC,CAACwD,KAAf;UACH,CAFO,CAAR;UAGA,IAAIC,CAAC,GAAGJ,CAAC,CAACrE,SAAS,WAAT,CAAkB0E,UAAlB,CAA6B,CAA7B,EAAgCL,CAAC,CAACnC,MAAF,GAAW,CAA3C,CAAD,CAAT;UACA7B,YAAY,WAAZ,CAAqByD,GAArB,CAAyBa,WAAzB,CAAqCF,CAArC,EAAwC,CAAxC;UACAxD,CAAC,CAACiD,IAAF,CAAO;YACHC,IAAI,EAAE,CADH;YAEHC,GAAG,EAAEK,CAAC,CAACd,EAFJ;YAGHvB,GAAG,EAAE;UAHF,CAAP;QAKH,CAXD,MAWO;UACH,MAAM3C,CAAN,IACOa,gBAAgB,WAAhB,CAAyBqB,GAAzB,CAA6BiD,SAA7B,CAAuC5D,CAAC,CAACoB,GAAF,CAAMD,CAAN,CAAvC,GACDlB,CAAC,CAACiD,IAAF,CAAO;YACHC,IAAI,EAAE,CADH;YAEH/B,GAAG,EAAEpB,CAAC,CAACoB,GAAF,CAAMD,CAAN;UAFF,CAAP,CAFN,IAMM,MAAM1C,CAAN,KACCa,gBAAgB,WAAhB,CAAyBqB,GAAzB,CAA6BkD,YAA7B,CAA0C7D,CAAC,CAACoB,GAAF,CAAMD,CAAN,CAA1C,GACDlB,CAAC,CAACiD,IAAF,CAAO;YACHC,IAAI,EAAE,CADH;YAEH/B,GAAG,EAAEpB,CAAC,CAACoB,GAAF,CAAMD,CAAN;UAFF,CAAP,CAFA,CANN;QAYH;MACJ;IACJ;;IACDtC,aAAa,CAACiF,YAAd,CAA2B9C,QAA3B,CAAoC+C,IAApC,CAAyCrF,UAAU,CAACsF,SAAX,CAAqBC,YAArB,CAAkCC,OAAlC,CAA0CC,UAA1C,CAAqDC,UAA9F,EAA0G;MACtGC,KAAK,EAAEpE;IAD+F,CAA1G;IAGAX,gBAAgB,WAAhB,CAAyBqB,GAAzB,CAA6B2D,UAA7B;EACH,CAhDD;;EAiDAC,UAAU,CAAC,CAAC1E,CAAC,CAACJ,EAAE,CAAC+E,IAAJ,CAAF,CAAD,EAAevE,CAAC,CAACO,SAAjB,EAA4B,OAA5B,EAAqC,KAAK,CAA1C,CAAV;;EACA+D,UAAU,CAAC,CAAC1E,CAAC,CAACJ,EAAE,CAAC+E,IAAJ,CAAF,CAAD,EAAevE,CAAC,CAACO,SAAjB,EAA4B,aAA5B,EAA2C,KAAK,CAAhD,CAAV;;EACA+D,UAAU,CAAC,CAAC1E,CAAC,CAACJ,EAAE,CAAC+E,IAAJ,CAAF,CAAD,EAAevE,CAAC,CAACO,SAAjB,EAA4B,YAA5B,EAA0C,KAAK,CAA/C,CAAV;;EACA,OAAO+D,UAAU,CAAC,CAAC5E,CAAD,CAAD,EAAMM,CAAN,CAAjB;AACH,CA5FO,CA4FLnB,UAAU,CAAC2F,SA5FN,CAAR;;AA6FAC,OAAO,WAAP,GAAkB3E,CAAlB","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $popupView = require(\"./PopupView\");\r\nvar $platform = require(\"./Platform\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $aD = require(\"./AD\");\r\nvar $adService = require(\"./AdService\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $roleContext = require(\"./RoleContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar $startView = require(\"./StartView\");\r\nvar k = cc._decorator;\r\nvar v = k.ccclass;\r\nvar b = k.property;\r\nvar w = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.btnAd = null;\r\n        e.signContent = null;\r\n        e.countLayer = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.onResetView = function () {\r\n        this.btnAd.active = !$userDataContext.default.Ins.isSign();\r\n        for (var t = 1; t <= 3; t++) {\r\n            this.signContent.children[t - 1].active = $userDataContext.default.Ins.sign.day >= t;\r\n        }\r\n        for (t = 0; t < $configContext.default.instance.signConfigs.length; t++) {\r\n            var e = $configContext.default.instance.signConfigs[t];\r\n            var i = this.countLayer.children[t];\r\n            for (var o = 0; o < e.num.length; o++) {\r\n                i.children[o].getComponent(cc.Label).string = e.num[o].toString();\r\n            }\r\n        }\r\n    };\r\n    e.prototype.addEvent = function () {\r\n        this.btnAd.on(\"click\", this.clickAd, this);\r\n    };\r\n    e.prototype.removeEvent = function () {\r\n        this.btnAd.off(\"click\", this.clickAd, this);\r\n    };\r\n    e.prototype.clickAd = function () {\r\n        var t = this;\r\n        $adService.default.Ins.showRewardedVideo(function () {\r\n            if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {\r\n                $aD.default.toutiao.report(\"New_gift\");\r\n            }\r\n            t.caculetReward();\r\n            t.onResetView();\r\n            $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.Battle);\r\n        });\r\n    };\r\n    e.prototype.caculetReward = function () {\r\n        var t = $configContext.default.instance.signConfigs.find(function (t) {\r\n            return t.id === $userDataContext.default.Ins.sign.day + 1;\r\n        });\r\n        var e = [];\r\n        for (var i = 0; i < t.rewardtpye.length; i++) {\r\n            var o = t.rewardtpye[i];\r\n            if (1 === o) {\r\n                var n = $roleContext.default.ins.getGunSkinInfo(2);\r\n                n.shard += 1;\r\n                $roleContext.default.ins.setGunSkinInfo(n);\r\n                e.push({\r\n                    type: 10,\r\n                    ext: 2,\r\n                    num: 1\r\n                });\r\n            } else {\r\n                if (2 === o) {\r\n                    var s = $configContext.default.instance.gemConfigs.filter(function (t) {\r\n                        return 4 === t.Grade;\r\n                    });\r\n                    var a = s[$seedUtil.default.randomFrom(0, s.length - 1)];\r\n                    $roleContext.default.ins.addPackItem(a, 1);\r\n                    e.push({\r\n                        type: 5,\r\n                        ext: a.id,\r\n                        num: 1\r\n                    });\r\n                } else {\r\n                    3 === o\r\n                        ? ($userDataContext.default.Ins.opearCoin(t.num[i]),\r\n                          e.push({\r\n                              type: 1,\r\n                              num: t.num[i]\r\n                          }))\r\n                        : 4 === o &&\r\n                          ($userDataContext.default.Ins.opearDiamond(t.num[i]),\r\n                          e.push({\r\n                              type: 6,\r\n                              num: t.num[i]\r\n                          }));\r\n                }\r\n            }\r\n        }\r\n        $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.RewardView, {\r\n            infos: e\r\n        });\r\n        $userDataContext.default.Ins.signRecord();\r\n    };\r\n    __decorate([b(cc.Node)], e.prototype, \"btnAd\", void 0);\r\n    __decorate([b(cc.Node)], e.prototype, \"signContent\", void 0);\r\n    __decorate([b(cc.Node)], e.prototype, \"countLayer\", void 0);\r\n    return __decorate([v], e);\r\n})($popupView.PopupView);\r\nexports.default = w;\r\n"]}