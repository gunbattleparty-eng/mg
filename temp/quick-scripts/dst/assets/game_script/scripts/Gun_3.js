
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_3.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '349b6FGwe1NfIpA6UuWLAHj', 'Gun_3');
// game_script/scripts/Gun_3.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $remoteAudio = require("./RemoteAudio");

var $seedUtil = require("./SeedUtil");

var $configContext = require("./ConfigContext");

var $globalParam = require("./GlobalParam");

var $localEventName = require("./LocalEventName");

var $roleContext = require("./RoleContext");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameGemInfo = require("./GameGemInfo");

var $gameSkillInfo = require("./GameSkillInfo");

var $baseGun = require("./BaseGun");

var v = cc.Vec3.ZERO;

var b = function (t) {
  function e(e) {
    var i = t.call(this, e) || this;
    i.skin3AtkLeftCd = 0;
    i.skin3AtkCurrCount = 0;
    i.skillId = 41;
    i.startX = 0;
    i.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(i.skillId);
    var o = $gameContext["default"].ins.skillInfo.skinParam[3];

    if (3 === $roleContext["default"].ins.currSkinInfo.skin) {
      i.startX = -(30 * o + 100 * (o - 1)) / 2;
      i.startX += 15;
    }

    return i;
  }

  __extends(e, t);

  e.prototype.updateF = function (e) {
    t.prototype.updateF.call(this, e);

    if (!(this.isAttacking || $globalParam["default"].isGamePuase)) {
      this.timeLeft -= e;

      if (3 === $roleContext["default"].ins.currSkinInfo.skin && this.skin3AtkCurrCount >= $gameContext["default"].ins.skillInfo.skinAtkTargetCount) {
        this.skin3AtkLeftCd -= e;

        if (this.skin3AtkLeftCd <= 0) {
          this.sendSkin3Bullet();
        }
      }

      this.timeLeft <= 0 ? (this.isAttacking = !0, this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0, -1), this.starGun() || (this.isAttacking = !1, this.timeLeft = 0)) : $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1);
    }
  };

  e.prototype.starGun = function () {
    var t = this;
    var e = $gameContext["default"].ins.getRangeRankEnemy(this.pointNode, this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]);

    if (!e) {
      return !1;
    }

    var i = e.node.position.subtract(this.pointNode.position).normalize();

    if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) && $seedUtil["default"].probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))) {
      var o = 150 / this.skillParam.freezeSpeed[$gameSkillInfo.Skill4Param.FINAL];

      for (var n = 0; n < 2; n++) {
        this.schedulesOnce(function () {
          $remoteAudio["default"].instance.playEffectMusic("icebullet");
          t.sendButtle(i);
        }, o * n);
      }
    } else {
      this.sendButtle(i);
    }

    this.isAttacking = !1;
    return !0;
  };

  e.prototype.sendSkin3Bullet = function () {
    if (!$gameContext["default"].ins.getRangeRankEnemy(this.pointNode, $gameContext["default"].ins.skillInfo.skinAtkRange)) {
      this.skin3AtkLeftCd = 2;
      return !1;
    }

    $eventManager["default"].send($localEventName["default"].SEND_SKILL_ANIM);

    for (var t = 0; t < $gameContext["default"].ins.skillInfo.skinParam[3]; t++) {
      var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.s_bullet_3);

      if (!e) {
        var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.SBullet_3);
        e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"]);
      }

      v.x = this.startX + 130 * t;
      v.y = -350;
      e.setPosition(v.clone());
      v.x = 0;
      v.y = 1;
      e.initButtle(v.clone(), this.skillId);
      e.insert($gameContext["default"].ins.buttleLayer);
    }

    this.skin3AtkCurrCount = 0;
    this.skin3AtkLeftCd = $gameContext["default"].ins.skillInfo.skinAtkCd;
  };

  e.prototype.sendButtle = function (t) {
    var e = this;
    var i = $gameContext["default"].ins.getNearbyN2(this.pointNode, this.skillParam.freezeComboCount + 1);
    var o = 150 / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL];
    var n = 0;

    var s = function s(_s) {
      r.schedulesOnce(function () {
        if (0 !== _s) {
          t = i[_s].node.position.sub(e.pointNode.position).normalize();
        }

        e.createButtle(t);

        if (++n >= i.length + 1) {
          e.isAttacking = !1;
        }
      }, o * _s);
    };

    var r = this;

    for (var a = 0; a < i.length; a++) {
      s(a);
    }
  };

  e.prototype.createButtle = function (t) {
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.freeze_bullet);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_6);
      (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    var o = $gameContext["default"].ins.buttleLayer.convertToNodeSpaceAR(this.pointNode.convertToWorldSpaceAR(cc.Vec3.ZERO));
    e.setPosition(o);
    e.initButtle(t, this.skillId);
    e.insert($gameContext["default"].ins.buttleLayer);
    this.skin3AtkCurrCount++;
  };

  return e;
}($baseGun["default"]);

exports["default"] = b;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl8zLmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRldmVudE1hbmFnZXIiLCIkcmVtb3RlQXVkaW8iLCIkc2VlZFV0aWwiLCIkY29uZmlnQ29udGV4dCIsIiRnbG9iYWxQYXJhbSIsIiRsb2NhbEV2ZW50TmFtZSIsIiRyb2xlQ29udGV4dCIsIiRiYXNlQnVsbGV0IiwiJGdhbWVDb250ZXh0IiwiJGdhbWVHZW1JbmZvIiwiJGdhbWVTa2lsbEluZm8iLCIkYmFzZUd1biIsInYiLCJjYyIsIlZlYzMiLCJaRVJPIiwiYiIsInQiLCJlIiwiaSIsImNhbGwiLCJza2luM0F0a0xlZnRDZCIsInNraW4zQXRrQ3VyckNvdW50Iiwic2tpbGxJZCIsInN0YXJ0WCIsInNraWxsUGFyYW0iLCJpbnMiLCJza2lsbEluZm8iLCJnZXRTa2lsbEJ5SWQiLCJza2luUGFyYW0iLCJjdXJyU2tpbkluZm8iLCJza2luIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwidXBkYXRlRiIsImlzQXR0YWNraW5nIiwiaXNHYW1lUHVhc2UiLCJ0aW1lTGVmdCIsInNraW5BdGtUYXJnZXRDb3VudCIsInNlbmRTa2luM0J1bGxldCIsInNraWxsQ0QiLCJTa2lsbDRQYXJhbSIsIkZJTkFMIiwic2VuZCIsIlJFTkRFUl9TS0lMTF9DRF9JTkZPIiwic3Rhckd1biIsImdldFJhbmdlUmFua0VuZW15IiwicG9pbnROb2RlIiwic2tpbGxBdGtSYW5nZSIsIm5vZGUiLCJwb3NpdGlvbiIsInN1YnRyYWN0Iiwibm9ybWFsaXplIiwiR2FtZUdlbUluZm8iLCJoYXNHZW0iLCJHZW1UeXBlIiwiQWRkU2tpbGwiLCJwcm9iYWJpbGl0eSIsImdldDEiLCJmcmVlemVTcGVlZCIsIm4iLCJzY2hlZHVsZXNPbmNlIiwiaW5zdGFuY2UiLCJwbGF5RWZmZWN0TXVzaWMiLCJzZW5kQnV0dGxlIiwic2tpbkF0a1JhbmdlIiwiU0VORF9TS0lMTF9BTklNIiwiZ2V0QnV0dGxlUG9vbCIsIkJ1bGxldFR5cGUiLCJzX2J1bGxldF8zIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIlNCdWxsZXRfMyIsIlJlc1V0aWwiLCJpbnN0YW50aWF0ZSIsImJ1dHRsZUxheWVyIiwicGFyZW50IiwiZ2V0Q29tcG9uZW50IiwieCIsInkiLCJzZXRQb3NpdGlvbiIsImNsb25lIiwiaW5pdEJ1dHRsZSIsImluc2VydCIsInNraW5BdGtDZCIsImdldE5lYXJieU4yIiwiZnJlZXplQ29tYm9Db3VudCIsInMiLCJyIiwic3ViIiwiY3JlYXRlQnV0dGxlIiwibGVuZ3RoIiwiYSIsImZyZWV6ZV9idWxsZXQiLCJCdWxsZXRfNiIsInNraWxsU3BlY2lhbGl0eXMiLCJiYXNpY1NraWxsQ29uZmlnTWFwIiwiZ2V0Iiwic2tpbGxfdHB5ZSIsImNvbnZlcnRUb05vZGVTcGFjZUFSIiwiY29udmVydFRvV29ybGRTcGFjZUFSIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlDLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUUsUUFBUSxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJRyxhQUFhLEdBQUdILE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJSSxZQUFZLEdBQUdKLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlLLFNBQVMsR0FBR0wsT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSU0sY0FBYyxHQUFHTixPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSU8sWUFBWSxHQUFHUCxPQUFP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RCxTQUFMLENBQWUwRCxxQkFBZixDQUFxQzVGLEVBQUUsQ0FBQ0MsSUFBSCxDQUFRQyxJQUE3QyxDQURJLENBQVI7SUFHQUcsQ0FBQyxDQUFDbUUsV0FBRixDQUFjMUYsQ0FBZDtJQUNBdUIsQ0FBQyxDQUFDcUUsVUFBRixDQUFhdEUsQ0FBYixFQUFnQixLQUFLTSxPQUFyQjtJQUNBTCxDQUFDLENBQUNzRSxNQUFGLENBQVNoRixZQUFZLFdBQVosQ0FBcUJrQixHQUFyQixDQUF5QnNELFdBQWxDO0lBQ0EsS0FBSzFELGlCQUFMO0VBQ0gsQ0FsQkQ7O0VBbUJBLE9BQU9KLENBQVA7QUFDSCxDQTVJTyxDQTRJTFAsUUFBUSxXQTVJSCxDQUFSOztBQTZJQStGLE9BQU8sV0FBUCxHQUFrQjFGLENBQWxCIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgbztcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRyZW1vdGVBdWRpbyA9IHJlcXVpcmUoXCIuL1JlbW90ZUF1ZGlvXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkZ2xvYmFsUGFyYW0gPSByZXF1aXJlKFwiLi9HbG9iYWxQYXJhbVwiKTtcclxudmFyICRsb2NhbEV2ZW50TmFtZSA9IHJlcXVpcmUoXCIuL0xvY2FsRXZlbnROYW1lXCIpO1xyXG52YXIgJHJvbGVDb250ZXh0ID0gcmVxdWlyZShcIi4vUm9sZUNvbnRleHRcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lR2VtSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVHZW1JbmZvXCIpO1xyXG52YXIgJGdhbWVTa2lsbEluZm8gPSByZXF1aXJlKFwiLi9HYW1lU2tpbGxJbmZvXCIpO1xyXG52YXIgJGJhc2VHdW4gPSByZXF1aXJlKFwiLi9CYXNlR3VuXCIpO1xyXG52YXIgdiA9IGNjLlZlYzMuWkVSTztcclxudmFyIGIgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoZSkge1xyXG4gICAgICAgIHZhciBpID0gdC5jYWxsKHRoaXMsIGUpIHx8IHRoaXM7XHJcbiAgICAgICAgaS5za2luM0F0a0xlZnRDZCA9IDA7XHJcbiAgICAgICAgaS5za2luM0F0a0N1cnJDb3VudCA9IDA7XHJcbiAgICAgICAgaS5za2lsbElkID0gNDE7XHJcbiAgICAgICAgaS5zdGFydFggPSAwO1xyXG4gICAgICAgIGkuc2tpbGxQYXJhbSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uZ2V0U2tpbGxCeUlkKGkuc2tpbGxJZCk7XHJcbiAgICAgICAgdmFyIG8gPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnNraW5QYXJhbVszXTtcclxuICAgICAgICBpZiAoMyA9PT0gJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmN1cnJTa2luSW5mby5za2luKSB7XHJcbiAgICAgICAgICAgIGkuc3RhcnRYID0gLSgzMCAqIG8gKyAxMDAgKiAobyAtIDEpKSAvIDI7XHJcbiAgICAgICAgICAgIGkuc3RhcnRYICs9IDE1O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLnVwZGF0ZUYgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLnVwZGF0ZUYuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICBpZiAoISh0aGlzLmlzQXR0YWNraW5nIHx8ICRnbG9iYWxQYXJhbS5kZWZhdWx0LmlzR2FtZVB1YXNlKSkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVMZWZ0IC09IGU7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIDMgPT09ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8uc2tpbiAmJlxyXG4gICAgICAgICAgICAgICAgdGhpcy5za2luM0F0a0N1cnJDb3VudCA+PSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnNraW5BdGtUYXJnZXRDb3VudFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2tpbjNBdGtMZWZ0Q2QgLT0gZTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNraW4zQXRrTGVmdENkIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbmRTa2luM0J1bGxldCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMudGltZUxlZnQgPD0gMFxyXG4gICAgICAgICAgICAgICAgPyAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICh0aGlzLnRpbWVMZWZ0ID0gdGhpcy5za2lsbFBhcmFtLnNraWxsQ0RbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdKSxcclxuICAgICAgICAgICAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuUkVOREVSX1NLSUxMX0NEX0lORk8sIHRoaXMuc2tpbGxJZCwgMCwgLTEpLFxyXG4gICAgICAgICAgICAgICAgICB0aGlzLnN0YXJHdW4oKSB8fCAoKHRoaXMuaXNBdHRhY2tpbmcgPSAhMSksICh0aGlzLnRpbWVMZWZ0ID0gMCkpKVxyXG4gICAgICAgICAgICAgICAgOiAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZChcclxuICAgICAgICAgICAgICAgICAgICAgICRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lTGVmdCAvIHRoaXMuc2tpbGxQYXJhbS5za2lsbENEWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSxcclxuICAgICAgICAgICAgICAgICAgICAgIC0xXHJcbiAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnN0YXJHdW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSB0aGlzO1xyXG4gICAgICAgIHZhciBlID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldFJhbmdlUmFua0VuZW15KFxyXG4gICAgICAgICAgICB0aGlzLnBvaW50Tm9kZSxcclxuICAgICAgICAgICAgdGhpcy5za2lsbFBhcmFtLnNraWxsQXRrUmFuZ2VbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICExO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaSA9IGUubm9kZS5wb3NpdGlvbi5zdWJ0cmFjdCh0aGlzLnBvaW50Tm9kZS5wb3NpdGlvbikubm9ybWFsaXplKCk7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uaW5zLmhhc0dlbSgkZ2FtZUdlbUluZm8uR2VtVHlwZS5BZGRTa2lsbCkgJiZcclxuICAgICAgICAgICAgJHNlZWRVdGlsLmRlZmF1bHQucHJvYmFiaWxpdHkoMTAwICogJGdhbWVHZW1JbmZvLkdhbWVHZW1JbmZvLmlucy5nZXQxKCRnYW1lR2VtSW5mby5HZW1UeXBlLkFkZFNraWxsKSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgdmFyIG8gPSAxNTAgLyB0aGlzLnNraWxsUGFyYW0uZnJlZXplU3BlZWRbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBuID0gMDsgbiA8IDI7IG4rKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXNPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAkcmVtb3RlQXVkaW8uZGVmYXVsdC5pbnN0YW5jZS5wbGF5RWZmZWN0TXVzaWMoXCJpY2VidWxsZXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5zZW5kQnV0dGxlKGkpO1xyXG4gICAgICAgICAgICAgICAgfSwgbyAqIG4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kQnV0dGxlKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmlzQXR0YWNraW5nID0gITE7XHJcbiAgICAgICAgcmV0dXJuICEwO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNlbmRTa2luM0J1bGxldCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICEkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0UmFuZ2VSYW5rRW5lbXkodGhpcy5wb2ludE5vZGUsICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5za2lsbEluZm8uc2tpbkF0a1JhbmdlKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICB0aGlzLnNraW4zQXRrTGVmdENkID0gMjtcclxuICAgICAgICAgICAgcmV0dXJuICExO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkZXZlbnRNYW5hZ2VyLmRlZmF1bHQuc2VuZCgkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5TRU5EX1NLSUxMX0FOSU0pO1xyXG4gICAgICAgIGZvciAodmFyIHQgPSAwOyB0IDwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLnNraWxsSW5mby5za2luUGFyYW1bM107IHQrKykge1xyXG4gICAgICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUuc19idWxsZXRfMyk7XHJcbiAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGkgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuU0J1bGxldF8zXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdi54ID0gdGhpcy5zdGFydFggKyAxMzAgKiB0O1xyXG4gICAgICAgICAgICB2LnkgPSAtMzUwO1xyXG4gICAgICAgICAgICBlLnNldFBvc2l0aW9uKHYuY2xvbmUoKSk7XHJcbiAgICAgICAgICAgIHYueCA9IDA7XHJcbiAgICAgICAgICAgIHYueSA9IDE7XHJcbiAgICAgICAgICAgIGUuaW5pdEJ1dHRsZSh2LmNsb25lKCksIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgIGUuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2tpbjNBdGtDdXJyQ291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMuc2tpbjNBdGtMZWZ0Q2QgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLnNraW5BdGtDZDtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zZW5kQnV0dGxlID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGkgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2V0TmVhcmJ5TjIodGhpcy5wb2ludE5vZGUsIHRoaXMuc2tpbGxQYXJhbS5mcmVlemVDb21ib0NvdW50ICsgMSk7XHJcbiAgICAgICAgdmFyIG8gPSAxNTAgLyB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgdmFyIG4gPSAwO1xyXG4gICAgICAgIHZhciBzID0gZnVuY3Rpb24gKHMpIHtcclxuICAgICAgICAgICAgci5zY2hlZHVsZXNPbmNlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgwICE9PSBzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdCA9IGlbc10ubm9kZS5wb3NpdGlvbi5zdWIoZS5wb2ludE5vZGUucG9zaXRpb24pLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZS5jcmVhdGVCdXR0bGUodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoKytuID49IGkubGVuZ3RoICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuaXNBdHRhY2tpbmcgPSAhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgbyAqIHMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIHIgPSB0aGlzO1xyXG4gICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgaS5sZW5ndGg7IGErKykge1xyXG4gICAgICAgICAgICBzKGEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jcmVhdGVCdXR0bGUgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHZhciBlID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5mcmVlemVfYnVsbGV0KTtcclxuICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF82XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIChlID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShpLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAkYmFzZUJ1bGxldC5kZWZhdWx0XHJcbiAgICAgICAgICAgICkpLnNraWxsU3BlY2lhbGl0eXMgPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmJhc2ljU2tpbGxDb25maWdNYXAuZ2V0KHRoaXMuc2tpbGxJZCkuc2tpbGxfdHB5ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG8gPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIuY29udmVydFRvTm9kZVNwYWNlQVIoXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnROb2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUihjYy5WZWMzLlpFUk8pXHJcbiAgICAgICAgKTtcclxuICAgICAgICBlLnNldFBvc2l0aW9uKG8pO1xyXG4gICAgICAgIGUuaW5pdEJ1dHRsZSh0LCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgIGUuaW5zZXJ0KCRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5idXR0bGVMYXllcik7XHJcbiAgICAgICAgdGhpcy5za2luM0F0a0N1cnJDb3VudCsrO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBlO1xyXG59KSgkYmFzZUd1bi5kZWZhdWx0KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gYjtcclxuIl19