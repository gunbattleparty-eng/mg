{"version":3,"sources":["assets\\game_script\\scripts\\RBullet_7.js"],"names":["o","$object","require","$util","$globalParam","$gameContext","$gameSkillInfo","$baseBullet","p","cc","_decorator","f","ccclass","h","property","m","Vec3","y","t","e","apply","arguments","buttleType","BulletType","r_bullet_7","skin","status","leftTime","enemys","targetEnemy","findLeftTime","atkLeftTime","atkIntervalTime","pointNode","__extends","prototype","initButtle","length","speed","ins","skillInfo","robotParam","setAngle","dirConverAngle","call","atk","Math","ceil","skillParam","skillAtk","Skill4Param","FINAL","velocity","set","multiplyScalar","onTrigger","i","object","Trigger","enter","push","exit","indexOf","splice","attack","off","dragonBones","EventObject","COMPLETE","playAnim","once","sufferAtk","skillSpecialitys","findTarget","animationName","getRangeRankEnemy","addDieCallback","targetDie","findPath","x","getPosition","node","position","z","normalizeSelf","sub","add","mul","magSqr","setPosition","mulSelf","updateFrame","isGamePuase","removeSelf","updateStatus","timeScale","gameRatio","playAnimation","__decorate","ArmatureDisplay","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $object = require(\"./Object\");\r\nvar $util = require(\"./Util\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar p = cc._decorator;\r\nvar f = p.ccclass;\r\nvar h = p.property;\r\nvar m = new cc.Vec3();\r\nvar y = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.buttleType = $baseBullet.BulletType.r_bullet_7;\r\n        e.skin = null;\r\n        e.status = 0;\r\n        e.leftTime = 0;\r\n        e.enemys = [];\r\n        e.targetEnemy = null;\r\n        e.findLeftTime = 0;\r\n        e.atkLeftTime = 0;\r\n        e.atkIntervalTime = 1;\r\n        e.pointNode = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.initButtle = function (e) {\r\n        this.enemys.length = 0;\r\n        this.targetEnemy = null;\r\n        this.speed = $gameContext.default.ins.skillInfo.robotParam[3];\r\n        this.atkIntervalTime = $gameContext.default.ins.skillInfo.robotParam[4];\r\n        this.leftTime = $gameContext.default.ins.skillInfo.robotParam[5];\r\n        this.setAngle($util.default.dirConverAngle(e));\r\n        t.prototype.initButtle.call(this, e, null);\r\n        this.atk = Math.ceil(\r\n            $gameContext.default.ins.skillInfo.robotParam[0] *\r\n                this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL]\r\n        );\r\n        this.status = 0;\r\n        if (e) {\r\n            this.velocity.set(e).multiplyScalar(this.speed);\r\n        }\r\n    };\r\n    e.prototype.onTrigger = function (t, e) {\r\n        var i = t.object;\r\n        if (e === $object.Trigger.enter) {\r\n            this.enemys.push(i);\r\n        } else {\r\n            if (e === $object.Trigger.exit) {\r\n                var o = this.enemys.indexOf(i);\r\n                if (-1 !== o) {\r\n                    this.enemys.splice(o, 1);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    e.prototype.attack = function (t) {\r\n        var e = this;\r\n        this.atkLeftTime -= t;\r\n        if (!(this.atkLeftTime > 0)) {\r\n            this.atkLeftTime = 1;\r\n            this.skin.off(dragonBones.EventObject.COMPLETE);\r\n            this.playAnim(\"hit\", 1);\r\n            this.skin.once(\r\n                dragonBones.EventObject.COMPLETE,\r\n                function () {\r\n                    e.atkLeftTime = e.atkIntervalTime;\r\n                    e.playAnim(\"stand\", 0);\r\n                    if (0 !== e.status) {\r\n                        e.status = 1;\r\n                    }\r\n                },\r\n                this\r\n            );\r\n            for (var i = 0; i < this.enemys.length; i++) {\r\n                this.enemys[i].sufferAtk({\r\n                    skillSpecialitys: this.skillSpecialitys,\r\n                    atk: this.atk\r\n                });\r\n            }\r\n        }\r\n    };\r\n    e.prototype.findTarget = function (t) {\r\n        if (\"stand\" !== this.skin.animationName) {\r\n            this.skin.off(dragonBones.EventObject.COMPLETE);\r\n            this.playAnim(\"stand\", 0);\r\n        }\r\n        this.findLeftTime -= t;\r\n        if (this.findLeftTime <= 0) {\r\n            this.findLeftTime = 1;\r\n            var e = $gameContext.default.ins.getRangeRankEnemy(\r\n                this.pointNode,\r\n                $gameContext.default.ins.skillInfo.robotParam[2]\r\n            );\r\n            if (e) {\r\n                this.targetEnemy = e;\r\n                this.targetEnemy.addDieCallback(this.targetDie, this);\r\n                this.status = 1;\r\n            }\r\n        }\r\n    };\r\n    e.prototype.findPath = function (t) {\r\n        m.x = this.targetEnemy.getPosition().x - this.node.position.x;\r\n        m.y = this.targetEnemy.getPosition().y - this.node.position.y;\r\n        m.z = 0;\r\n        m.normalizeSelf();\r\n        this.targetEnemy\r\n            .getPosition()\r\n            .sub(this.node.position.add(m.mul(50)))\r\n            .magSqr() < 22500\r\n            ? 0 !== this.status && (this.status = 2)\r\n            : (\"run\" !== this.skin.animationName &&\r\n                  (this.skin.off(dragonBones.EventObject.COMPLETE), this.playAnim(\"run\", 0)),\r\n              this.setAngle($util.default.dirConverAngle(m)),\r\n              this.setPosition(m.mulSelf(this.speed * t).add(this.getPosition())));\r\n    };\r\n    e.prototype.targetDie = function () {\r\n        this.status = 0;\r\n    };\r\n    e.prototype.updateFrame = function (t) {\r\n        if (!($globalParam.default.isGamePuase || this.leftTime <= 0)) {\r\n            this.leftTime -= t;\r\n            this.leftTime <= 0 ? this.removeSelf() : this.updateStatus(t);\r\n        }\r\n    };\r\n    e.prototype.updateStatus = function (t) {\r\n        0 === this.status\r\n            ? this.findTarget(t)\r\n            : 1 === this.status\r\n            ? this.findPath(t)\r\n            : 2 === this.status && this.attack(t);\r\n    };\r\n    e.prototype.playAnim = function (t, e) {\r\n        this.skin.timeScale = $gameContext.default.ins.gameRatio;\r\n        this.skin.playAnimation(t, e);\r\n    };\r\n    __decorate([h(dragonBones.ArmatureDisplay)], e.prototype, \"skin\", void 0);\r\n    return __decorate([f], e);\r\n})($baseBullet.default);\r\nexports.default = y;\r\n"]}