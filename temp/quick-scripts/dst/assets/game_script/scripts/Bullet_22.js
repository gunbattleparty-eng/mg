
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_22.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '1390al9O6ROH4aHB+AwgGW2', 'Bullet_22');
// game_script/scripts/Bullet_22.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $seedUtil = require("./SeedUtil");

var $gameContext = require("./GameContext");

var $gameSkillInfo = require("./GameSkillInfo");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var m = cc._decorator;
var y = m.ccclass;
var g = (m.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.wind_blade;
    e.anim = null;
    e.currButtlePenetrateLayer = 0;
    e.animName = "bullet_22";
    e.isLoadedSkin = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    var o = this;
    t.prototype.initButtle.call(this, e, i);
    this.speed = this.skillParam.windBladeSpeed;
    this.velocity.set(e).multiplyScalar(this.speed);
    this.setScale(cc.v3(this.skillParam.windBladeRange, this.skillParam.windBladeRange));

    if (!this.anim) {
      this.anim = this.node.children[0].getComponent(cc.Animation);
    }

    this.setAnimation();
    this.currButtlePenetrateLayer = 0;
    this.atk = this.skillParam.skillAtk[$gameSkillInfo.Skill4Param.FINAL];

    if (!this.isLoadedSkin && this.skillParam.windBladeMulti > 0) {
      this.isLoadedSkin = !0;
      $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Game, ["/anim/bullet_22_1"], cc.AnimationClip, null, function (t, e) {
        var i = e[0];

        if (sp && cc.isValid(i)) {
          o.animName = "bullet_22_1";
          $resUtil.ResUtil.assignWith(i, $gameContext["default"].ins.buttleLayer.parent);
          o.anim.addClip(i);
          o.anim.play(o.animName);
        }
      });
    }
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse && e == $object.Trigger.enter) {
      var i = t.object;
      i.sufferAtk({
        id: this.skillId,
        skillSpecialitys: this.skillSpecialitys,
        atk: this.atk
      });

      if (this.skillParam.windBladeBack[$gameSkillInfo.Skill4Param.FINAL] > 0) {
        var o = this.skillParam.windBladeBack[$gameSkillInfo.Skill4Param.FINAL];

        if (this.skillParam.windBladeFreezeBackAdd > 0 && i.hasDebuff($enemyStatus.EnemyDebuffType.FREEZE)) {
          o = Math.ceil(o * (1 + this.skillParam.windBladeFreezeBackAdd));
        }

        var n = {
          id: this.skillId,
          type: $enemyStatus.EnemyDebuffType.BACK,
          timeLeft: -1,
          value: o
        };
        i.sufferDebuff(n);
      }

      for (var s = 0; s < this.skillParam.windBladeFreezeParam.length; s++) {
        var a = this.skillParam.windBladeFreezeParam[s];

        if ($seedUtil["default"].probability(100 * a[1])) {
          i.sufferDebuff({
            type: $enemyStatus.EnemyDebuffType.FREEZE,
            timeLeft: a[0],
            value: 0
          });
        }
      }

      if (!(29 !== i.config.id && 30 !== i.config.id && 36 !== i.config.id)) {
        this.currButtlePenetrateLayer = this.skillParam.windBladePenetrateLayer;
      }

      this.currButtlePenetrateLayer++;

      if (this.skillParam.windBladePenetrateLayer <= this.currButtlePenetrateLayer) {
        if (this.skillParam.windBladeWaveAtk[$gameSkillInfo.Skill4Param.FINAL] > 0) {
          this.createBoom();
        }

        this.removeSelf();
      }
    }
  };

  e.prototype.createBoom = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.wind_blade_boom);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_23);
      t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"]);
    }

    t.setPosition(this.getPosition());
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.lowBulletLayer);
    t.setAnimation(null);
  };

  e.prototype.checkBoundary = function () {
    return !(this.node.x <= -560 || this.node.x >= 560 || this.node.y >= cc.winSize.height / 2 + 100 || this.node.y <= -cc.winSize.height / 2 - 200);
  };

  e.prototype.setAnimation = function (t) {
    if (void 0 === t) {
      t = "bullet_22";
    }

    if (this.isLoadedSkin) {
      t = "bullet_22_1";
    }

    this.anim.play(t);
  };

  return __decorate([y], e);
}($baseBullet["default"]));
exports["default"] = g;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8yMi5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkYXNzZXRzTG9hZGVyIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJHNlZWRVdGlsIiwiJGdhbWVDb250ZXh0IiwiJGdhbWVTa2lsbEluZm8iLCIkZW5lbXlTdGF0dXMiLCIkYmFzZUJ1bGxldCIsIm0iLCJjYyIsIl9kZWNvcmF0b3IiLCJ5IiwiY2NjbGFzcyIsImciLCJwcm9wZXJ0eSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJidXR0bGVUeXBlIiwiQnVsbGV0VHlwZSIsIndpbmRfYmxhZGUiLCJhbmltIiwiY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyIiwiYW5pbU5hbWUiLCJpc0xvYWRlZFNraW4iLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0QnV0dGxlIiwiaSIsImNhbGwiLCJzcGVlZCIsInNraWxsUGFyYW0iLCJ3aW5kQmxhZGVTcGVlZCIsInZlbG9jaXR5Iiwic2V0IiwibXVsdGlwbHlTY2FsYXIiLCJzZXRTY2FsZSIsInYzIiwid2luZEJsYWRlUmFuZ2UiLCJub2RlIiwiY2hpbGRyZW4iLCJnZXRDb21wb25lbnQiLCJBbmltYXRpb24iLCJzZXRBbmltYXRpb24iLCJhdGsiLCJza2lsbEF0ayIsIlNraWxsNFBhcmFtIiwiRklOQUwiLCJ3aW5kQmxhZGVNdWx0aSIsImluc3RhbmNlIiwibG9hZFJlcyIsIkJ1bmRsZU5hbWVzIiwiR2FtZSIsIkFuaW1hdGlvbkNsaXAiLCJzcCIsImlzVmFsaWQiLCJSZXNVdGlsIiwiYXNzaWduV2l0aCIsImlucyIsImJ1dHRsZUxheWVyIiwicGFyZW50IiwiYWRkQ2xpcCIsInBsYXkiLCJvblRyaWdnZXIiLCJpc1VzZSIsIlRyaWdnZXIiLCJlbnRlciIsIm9iamVjdCIsInN1ZmZlckF0ayIsImlkIiwic2tpbGxJZCIsInNraWxsU3BlY2lhbGl0eXMiLCJ3aW5kQmxhZGVCYWNrIiwid2luZEJsYWRlRnJlZXplQmFja0FkZCIsImhhc0RlYnVmZiIsIkVuZW15RGVidWZmVHlwZSIsIkZSRUVaRSIsIk1hdGgiLCJjZWlsIiwibiIsInR5cGUiLCJCQUNLIiwidGltZUxlZnQiLCJ2YWx1ZSIsInN1ZmZlckRlYnVmZiIsInMiLCJ3aW5kQmxhZGVGcmVlemVQYXJhbSIsImxlbmd0aCIsImEiLCJwcm9iYWJpbGl0eSIsImNvbmZpZyIsIndpbmRCbGFkZVBlbmV0cmF0ZUxheWVyIiwid2luZEJsYWRlV2F2ZUF0ayIsImNyZWF0ZUJvb20iLCJyZW1vdmVTZWxmIiwiZ2V0QnV0dGxlUG9vbCIsIndpbmRfYmxhZGVfYm9vbSIsImdldFJlcyIsIkFzc2V0c01hcCIsIkdhbWVCdW5kbGVzIiwicHJlZmFicyIsImFzc2V0c0xpc3QiLCJCdWxsZXRfMjMiLCJpbnN0YW50aWF0ZSIsImxvd0J1bGxldExheWVyIiwic2V0UG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImluc2VydCIsImNoZWNrQm91bmRhcnkiLCJ4Iiwid2luU2l6ZSIsImhlaWdodCIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdELE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJRSxVQUFVLEdBQUdGLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlHLFFBQVEsR0FBR0gsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUksU0FBUyxHQUFHSixPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFDQSxJQUFJSyxZQUFZLEdBQUdMLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlNLGNBQWMsR0FBR04sT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlPLFlBQVksR0FBR1AsT0FBTyxDQUFD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QUFDLEdBQWhCLElBQ0EsS0FBS3RFLElBQUwsQ0FBVXNFLENBQVYsSUFBZSxHQURmLElBRUEsS0FBS3RFLElBQUwsQ0FBVTdCLENBQVYsSUFBZUYsRUFBRSxDQUFDc0csT0FBSCxDQUFXQyxNQUFYLEdBQW9CLENBQXBCLEdBQXdCLEdBRnZDLElBR0EsS0FBS3hFLElBQUwsQ0FBVTdCLENBQVYsSUFBZSxDQUFDRixFQUFFLENBQUNzRyxPQUFILENBQVdDLE1BQVosR0FBcUIsQ0FBckIsR0FBeUIsR0FKckMsQ0FBUDtFQU1ILENBUEQ7O0VBUUFoRyxDQUFDLENBQUNXLFNBQUYsQ0FBWWlCLFlBQVosR0FBMkIsVUFBVTdCLENBQVYsRUFBYTtJQUNwQyxJQUFJLEtBQUssQ0FBTCxLQUFXQSxDQUFmLEVBQWtCO01BQ2RBLENBQUMsR0FBRyxXQUFKO0lBQ0g7O0lBQ0QsSUFBSSxLQUFLVSxZQUFULEVBQXVCO01BQ25CVixDQUFDLEdBQUcsYUFBSjtJQUNIOztJQUNELEtBQUtPLElBQUwsQ0FBVXlDLElBQVYsQ0FBZWhELENBQWY7RUFDSCxDQVJEOztFQVNBLE9BQU9rRyxVQUFVLENBQUMsQ0FBQ3RHLENBQUQsQ0FBRCxFQUFNSyxDQUFOLENBQWpCO0FBQ0gsQ0ExSEQsQ0EwSEdULFdBQVcsV0ExSGQsQ0FGQyxDQUFMO0FBNkhBMkcsT0FBTyxXQUFQLEdBQWtCckcsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJG9iamVjdCA9IHJlcXVpcmUoXCIuL09iamVjdFwiKTtcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRnYW1lU2tpbGxJbmZvID0gcmVxdWlyZShcIi4vR2FtZVNraWxsSW5mb1wiKTtcclxudmFyICRlbmVteVN0YXR1cyA9IHJlcXVpcmUoXCIuL0VuZW15U3RhdHVzXCIpO1xyXG52YXIgJGJhc2VCdWxsZXQgPSByZXF1aXJlKFwiLi9CYXNlQnVsbGV0XCIpO1xyXG52YXIgbSA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciB5ID0gbS5jY2NsYXNzO1xyXG52YXIgZyA9XHJcbiAgICAobS5wcm9wZXJ0eSxcclxuICAgIChmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgICAgICBlLmJ1dHRsZVR5cGUgPSAkYmFzZUJ1bGxldC5CdWxsZXRUeXBlLndpbmRfYmxhZGU7XHJcbiAgICAgICAgICAgIGUuYW5pbSA9IG51bGw7XHJcbiAgICAgICAgICAgIGUuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyID0gMDtcclxuICAgICAgICAgICAgZS5hbmltTmFtZSA9IFwiYnVsbGV0XzIyXCI7XHJcbiAgICAgICAgICAgIGUuaXNMb2FkZWRTa2luID0gITE7XHJcbiAgICAgICAgICAgIHJldHVybiBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICAgICAgZS5wcm90b3R5cGUuaW5pdEJ1dHRsZSA9IGZ1bmN0aW9uIChlLCBpKSB7XHJcbiAgICAgICAgICAgIHZhciBvID0gdGhpcztcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUuaW5pdEJ1dHRsZS5jYWxsKHRoaXMsIGUsIGkpO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5za2lsbFBhcmFtLndpbmRCbGFkZVNwZWVkO1xyXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnNldChlKS5tdWx0aXBseVNjYWxhcih0aGlzLnNwZWVkKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRTY2FsZShjYy52Myh0aGlzLnNraWxsUGFyYW0ud2luZEJsYWRlUmFuZ2UsIHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVSYW5nZSkpO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuYW5pbSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbmltID0gdGhpcy5ub2RlLmNoaWxkcmVuWzBdLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyID0gMDtcclxuICAgICAgICAgICAgdGhpcy5hdGsgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxBdGtbJGdhbWVTa2lsbEluZm8uU2tpbGw0UGFyYW0uRklOQUxdO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNMb2FkZWRTa2luICYmIHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVNdWx0aSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNMb2FkZWRTa2luID0gITA7XHJcbiAgICAgICAgICAgICAgICAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UubG9hZFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgW1wiL2FuaW0vYnVsbGV0XzIyXzFcIl0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2MuQW5pbWF0aW9uQ2xpcCxcclxuICAgICAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gZVswXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwICYmIGNjLmlzVmFsaWQoaSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uYW5pbU5hbWUgPSBcImJ1bGxldF8yMl8xXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVzVXRpbC5SZXNVdGlsLmFzc2lnbldpdGgoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyLnBhcmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLmFuaW0uYWRkQ2xpcChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8uYW5pbS5wbGF5KG8uYW5pbU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUub25UcmlnZ2VyID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzVXNlICYmIGUgPT0gJG9iamVjdC5UcmlnZ2VyLmVudGVyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9IHQub2JqZWN0O1xyXG4gICAgICAgICAgICAgICAgaS5zdWZmZXJBdGsoe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiB0aGlzLnNraWxsSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2tpbGxTcGVjaWFsaXR5czogdGhpcy5za2lsbFNwZWNpYWxpdHlzLFxyXG4gICAgICAgICAgICAgICAgICAgIGF0azogdGhpcy5hdGtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVCYWNrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVCYWNrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVGcmVlemVCYWNrQWRkID4gMCAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpLmhhc0RlYnVmZigkZW5lbXlTdGF0dXMuRW5lbXlEZWJ1ZmZUeXBlLkZSRUVaRSlcclxuICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbyA9IE1hdGguY2VpbChvICogKDEgKyB0aGlzLnNraWxsUGFyYW0ud2luZEJsYWRlRnJlZXplQmFja0FkZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRoaXMuc2tpbGxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJGVuZW15U3RhdHVzLkVuZW15RGVidWZmVHlwZS5CQUNLLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogLTEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICBpLnN1ZmZlckRlYnVmZihuKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgdGhpcy5za2lsbFBhcmFtLndpbmRCbGFkZUZyZWV6ZVBhcmFtLmxlbmd0aDsgcysrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLnNraWxsUGFyYW0ud2luZEJsYWRlRnJlZXplUGFyYW1bc107XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzZWVkVXRpbC5kZWZhdWx0LnByb2JhYmlsaXR5KDEwMCAqIGFbMV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkuc3VmZmVyRGVidWZmKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuRlJFRVpFLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZUxlZnQ6IGFbMF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoISgyOSAhPT0gaS5jb25maWcuaWQgJiYgMzAgIT09IGkuY29uZmlnLmlkICYmIDM2ICE9PSBpLmNvbmZpZy5pZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJCdXR0bGVQZW5ldHJhdGVMYXllciA9IHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVQZW5ldHJhdGVMYXllcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyKys7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5za2lsbFBhcmFtLndpbmRCbGFkZVBlbmV0cmF0ZUxheWVyIDw9IHRoaXMuY3VyckJ1dHRsZVBlbmV0cmF0ZUxheWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2tpbGxQYXJhbS53aW5kQmxhZGVXYXZlQXRrWyRnYW1lU2tpbGxJbmZvLlNraWxsNFBhcmFtLkZJTkFMXSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVCb29tKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5jcmVhdGVCb29tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUud2luZF9ibGFkZV9ib29tKTtcclxuICAgICAgICAgICAgaWYgKCF0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9ICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5nZXRSZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQXNzZXRzTWFwLkdhbWVCdW5kbGVzLnByZWZhYnMuYXNzZXRzTGlzdC5CdWxsZXRfMjNcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB0ID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShlLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnNldFBvc2l0aW9uKHRoaXMuZ2V0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgIHQuaW5pdEJ1dHRsZShudWxsLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICB0Lmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIpO1xyXG4gICAgICAgICAgICB0LnNldEFuaW1hdGlvbihudWxsKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNoZWNrQm91bmRhcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnggPD0gLTU2MCB8fFxyXG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlLnggPj0gNTYwIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUueSA+PSBjYy53aW5TaXplLmhlaWdodCAvIDIgKyAxMDAgfHxcclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS55IDw9IC1jYy53aW5TaXplLmhlaWdodCAvIDIgLSAyMDBcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLnNldEFuaW1hdGlvbiA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IHQpIHtcclxuICAgICAgICAgICAgICAgIHQgPSBcImJ1bGxldF8yMlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9hZGVkU2tpbikge1xyXG4gICAgICAgICAgICAgICAgdCA9IFwiYnVsbGV0XzIyXzFcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFuaW0ucGxheSh0KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBfX2RlY29yYXRlKFt5XSwgZSk7XHJcbiAgICB9KSgkYmFzZUJ1bGxldC5kZWZhdWx0KSk7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IGc7XHJcbiJdfQ==