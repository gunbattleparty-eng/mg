
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/RobotShopView.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '8a01bxzlVpNka51x4z3aePG', 'RobotShopView');
// game_script/scripts/RobotShopView.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $list = require("./List");

var $uIManager = require("./UIManager");

var $uIView = require("./UIView");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $roleContext = require("./RoleContext");

var $startView = require("./StartView");

var $robotShopItem = require("./RobotShopItem");

var g = cc._decorator;
var _ = g.ccclass;
var k = g.property;

var v = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.nameLable = null;
    e.gunSkin = null;
    e.atkLabel = null;
    e.shardSp = null;
    e.shardLabel = null;
    e.btnSure = null;
    e.list = null;
    e.btnBack = null;
    e.skillSp = null;
    e.skillDescLabel = null;
    e.descIcon = null;
    e.gainLabel = null;
    e.currSkinId = -1;
    return e;
  }

  __extends(e, t);

  e.prototype.onLoad = function () {
    var t = 1 === $roleContext["default"].ins.currSkinInfo.robot ? 2 : $roleContext["default"].ins.currSkinInfo.robot;
    this.renderPlayer(t);
  };

  e.prototype.onResetView = function () {
    this.list.numItems = $configContext["default"].instance.robotConfigs.length - 1;
    this.list.selectedId = 0;
  };

  e.prototype.addEvent = function () {
    this.btnSure.on("click", this.clickSure, this);
    this.btnBack.on("click", this.clickBack, this);
  };

  e.prototype.removeEvent = function () {
    this.btnSure.off("click", this.clickSure, this);
    this.btnBack.off("click", this.clickBack, this);
  };

  e.prototype.clickBack = function () {
    $uIManager.UIManager.instance.replaceView($assetsMap.AssetsMap.StartBundles.prefabs.assetsList.StartView, {
      type: $startView.MenuType.Skill
    });
  };

  e.prototype.renderItem = function (t, e) {
    t.getComponent($robotShopItem["default"]).render($configContext["default"].instance.robotConfigs[e + 1]);
  };

  e.prototype.onListSelected = function (t) {
    if (t) {
      var e = t.getComponent($robotShopItem["default"]).skinId;
      this.renderPlayer(e);
    }
  };

  e.prototype.renderPlayer = function (t) {
    var e = this;
    this.currSkinId = t;
    var i = $configContext["default"].instance.robotConfigs.find(function (e) {
      return e.id === t;
    });
    var o = $roleContext["default"].ins.getRobotSkinInfo(t);
    this.nameLable.string = i.Petsskin_name;
    this.atkLabel.string = "" + i.Petsskin_attribute_describe;
    this.gunSkin.armatureName = "hl" + i.id;
    $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public_Res, ["/cd_icon/cw" + i.id], cc.SpriteFrame, null, function (t, i) {
      var o = i[0];

      if (o && cc.isValid(e.skillSp)) {
        e.skillSp.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);
        e.descIcon.getComponent(cc.Sprite).spriteFrame = o;
      }
    });
    this.shardSp.node.active = !1;
    this.shardLabel.node.active = !1;
    this.skillDescLabel.string = i.Petsskin_skill_describe;
    this.gainLabel.node.parent.active = !1;
    o.isHave ? (this.descIcon.active = !0, this.skillDescLabel.node.parent.active = !0, this.skillSp.node.parent.active = !1, $roleContext["default"].ins.currSkinInfo.robot === t ? (this.btnSure.active = !0, $util["default"].updateMaterialState(this.btnSure, !1), this.btnSure.getComponent(cc.Button).interactable = !0, this.btnSure.getComponentInChildren(cc.Label).string = "卸下") : ($util["default"].updateMaterialState(this.btnSure, !1), this.btnSure.getComponent(cc.Button).interactable = !0, this.btnSure.getComponentInChildren(cc.Label).string = "使用")) : (this.gainLabel.node.parent.active = !0, this.gainLabel.string = i.get_describe, this.skillSp.node.parent.active = !0, this.descIcon.active = !1, this.skillDescLabel.node.parent.active = !1, this.shardSp.node.active = !0, this.shardLabel.node.active = !0, $assetsLoader["default"].instance.loadRes($assetsMap.BundleNames.Public_Res, ["/robot_shard/sp" + i.id], cc.SpriteFrame, null, function (t, i) {
      var o = i[0];

      if (o && cc.isValid(e.shardSp)) {
        e.shardSp.spriteFrame = $resUtil.ResUtil.assignWith(o, e.node);
      }
    }), this.shardLabel.string = o.shard + "/" + i.shard_num, o.shard >= i.shard_num ? ($util["default"].updateMaterialState(this.btnSure, !1), this.btnSure.getComponent(cc.Button).interactable = !0, this.btnSure.getComponentInChildren(cc.Label).string = "激活") : ($util["default"].updateMaterialState(this.btnSure, !0), this.btnSure.getComponent(cc.Button).interactable = !1, this.btnSure.getComponentInChildren(cc.Label).string = "激活"));
  };

  e.prototype.clickSure = function () {
    var t = this;
    var e = $roleContext["default"].ins.getRobotSkinInfo(this.currSkinId);
    var i = $configContext["default"].instance.robotConfigs.find(function (e) {
      return e.id === t.currSkinId;
    });

    if (this.currSkinId === $roleContext["default"].ins.currSkinInfo.robot) {
      $roleContext["default"].ins.currSkinInfo.robot = 1;
      $roleContext["default"].ins.setCurrInfo($roleContext["default"].ins.currSkinInfo);
      this.renderPlayer(2);
      return void this.list.updateAll();
    }

    e.isHave ? $roleContext["default"].ins.currSkinInfo.robot !== this.currSkinId && ($roleContext["default"].ins.currSkinInfo.robot = this.currSkinId, $roleContext["default"].ins.setCurrInfo($roleContext["default"].ins.currSkinInfo), this.renderPlayer(this.currSkinId), this.list.updateAll()) : e.shard >= i.shard_num && (e.isHave = !0, e.shard -= i.shard_num, $roleContext["default"].ins.setRobotSkinInfo(e), this.renderPlayer(this.currSkinId), this.list.updateAll());
  };

  __decorate([k(cc.Label)], e.prototype, "nameLable", void 0);

  __decorate([k(dragonBones.ArmatureDisplay)], e.prototype, "gunSkin", void 0);

  __decorate([k(cc.Label)], e.prototype, "atkLabel", void 0);

  __decorate([k(cc.Sprite)], e.prototype, "shardSp", void 0);

  __decorate([k(cc.Label)], e.prototype, "shardLabel", void 0);

  __decorate([k(cc.Node)], e.prototype, "btnSure", void 0);

  __decorate([k($list["default"])], e.prototype, "list", void 0);

  __decorate([k(cc.Node)], e.prototype, "btnBack", void 0);

  __decorate([k(cc.Sprite)], e.prototype, "skillSp", void 0);

  __decorate([k(cc.Label)], e.prototype, "skillDescLabel", void 0);

  __decorate([k(cc.Node)], e.prototype, "descIcon", void 0);

  __decorate([k(cc.Label)], e.prototype, "gainLabel", void 0);

  return __decorate([_], e);
}($uIView.UIView);

exports["default"] = v;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFJvYm90U2hvcFZpZXcuanMiXSwibmFtZXMiOlsibyIsIiRhc3NldHNMb2FkZXIiLCJyZXF1aXJlIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGxpc3QiLCIkdUlNYW5hZ2VyIiwiJHVJVmlldyIsIiR1dGlsIiwiJGNvbmZpZ0NvbnRleHQiLCIkcm9sZUNvbnRleHQiLCIkc3RhcnRWaWV3IiwiJHJvYm90U2hvcEl0ZW0iLCJnIiwiY2MiLCJfZGVjb3JhdG9yIiwiXyIsImNjY2xhc3MiLCJrIiwicHJvcGVydHkiLCJ2IiwidCIsImUiLCJhcHBseSIsImFyZ3VtZW50cyIsIm5hbWVMYWJsZSIsImd1blNraW4iLCJhdGtMYWJlbCIsInNoYXJkU3AiLCJzaGFyZExhYmVsIiwiYnRuU3VyZSIsImxpc3QiLCJidG5CYWNrIiwic2tpbGxTcCIsInNraWxsRGVzY0xhYmVsIiwiZGVzY0ljb24iLCJnYWluTGFiZWwiLCJjdXJyU2tpbklkIiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwib25Mb2FkIiwiaW5zIiwiY3VyclNraW5JbmZvIiwicm9ib3QiLCJyZW5kZXJQbGF5ZXIiLCJvblJlc2V0VmlldyIsIm51bUl0ZW1zIiwiaW5zdGFuY2UiLCJyb2JvdENvbmZpZ3MiLCJsZW5ndGgiLCJzZWxlY3RlZElkIiwiYWRkRXZlbnQiLCJvbiIsImNsaWNrU3VyZSIsImNsaWNrQmFjayIsInJlbW92ZUV2ZW50Iiwib2ZmIiwiVUlNYW5hZ2VyIiwicmVwbGFjZVZpZXciLCJBc3NldHNNYXAiLCJTdGFydEJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIlN0YXJ0VmlldyIsInR5cGUiLCJNZW51VHlwZSIsIlNraWxsIiwicmVuZGVySXRlbSIsImdldENvbXBvbmVudCIsInJlbmRlciIsIm9uTGlzdFNlbGVjdGVkIiwic2tpbklkIiwiaSIsImZpbmQiLCJpZCIsImdldFJvYm90U2tpbkluZm8iLCJzdHJpbmciLCJQZXRzc2tpbl9uYW1lIiwiUGV0c3NraW5fYXR0cmlidXRlX2Rlc2NyaWJlIiwiYXJtYXR1cmVOYW1lIiwibG9hZFJlcyIsIkJ1bmRsZU5hbWVzIiwiUHVibGljX1JlcyIsIlNwcml0ZUZyYW1lIiwiaXNWYWxpZCIsInNwcml0ZUZyYW1lIiwiUmVzVXRpbCIsImFzc2lnbldpdGgiLCJub2RlIiwiU3ByaXRlIiwiYWN0aXZlIiwiUGV0c3NraW5fc2tpbGxfZGVzY3JpYmUiLCJwYXJlbnQiLCJpc0hhdmUiLCJ1cGRhdGVNYXRlcmlhbFN0YXRlIiwiQnV0dG9uIiwiaW50ZXJhY3RhYmxlIiwiZ2V0Q29tcG9uZW50SW5DaGlsZHJlbiIsIkxhYmVsIiwiZ2V0X2Rlc2NyaWJlIiwic2hhcmQiLCJzaGFyZF9udW0iLCJzZXRDdXJySW5mbyIsInVwZGF0ZUFsbCIsInNldFJvYm90U2tpbkluZm8iLCJfX2RlY29yYXRlIiwiZHJhZ29uQm9uZXMiLCJBcm1hdHVyZURpc3BsYXkiLCJOb2RlIiwiVUlWaWV3IiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKOztBQUNBLElBQUlDLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlDLFVBQVUsR0FBR0QsT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUUsUUFBUSxHQUFHRixPQUFPLENBQUMsV0FBRCxDQUF0Qjs7QUFDQSxJQUFJRyxLQUFLLEdBQUdILE9BQU8sQ0FBQyxRQUFELENBQW5COztBQUNBLElBQUlJLFVBQVUsR0FBR0osT0FBTyxDQUFDLGFBQUQsQ0FBeEI7O0FBQ0EsSUFBSUssT0FBTyxHQUFHTCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJTSxLQUFLLEdBQUdOLE9BQU8sQ0FBQyxRQUFELENBQW5COztBQUNBLElBQUlPLGNBQWMsR0FBR1AsT0FBTyxDQUFDLGlCQUFELENBQTVCOztBQUNBLElBQUlRLFlBQVksR0FBR1IsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSVMsVUFBVSxHQUFHVCxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJVSxjQUFjLEdBQUdWLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJVyxDQUFDLEdBQUdDLEVBQUUsQ0FBQ0MsVUFBWDtBQUNBLElBQUlDLENBQUMsR0FBR0gsQ0FBQyxDQUFDSSxPQUFWO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHTCxDQUFDLENBQUNNLFFBQVY7O0FBQ0EsSUFBSUMsQ0FBQyxHQUFJLFVBQVVDLENBQVYsRUFBYTtFQUNsQixTQUFTQyxDQUFULEdBQWE7SUFDVCxJQUFJQSxDQUFDLEdBQUksU0FBU0QsQ0FBVCxJQUFjQSxDQUFDLENBQUNFLEtBQUYsQ0FBUSxJQUFSLEVBQWNDLFNBQWQsQ0FBZixJQUE0QyxJQUFwRDtJQUNBRixDQUFDLENBQUNHLFNBQUYsR0FBYyxJQUFkO0lBQ0FILENBQUMsQ0FBQ0ksT0FBRixHQUFZLElBQVo7SUFDQUosQ0FBQyxDQUFDSyxRQUFGLEdBQWEsSUFBYjtJQUNBTCxDQUFDLENBQUNNLE9BQUYsR0FBWSxJQUFaO0lBQ0FOLENBQUMsQ0FBQ08sVUFBRixHQUFlLElBQWY7SUFDQVAsQ0FBQyxDQUFDUSxPQUFGLEdBQVksSUFBWjtJQUNBUixDQUFDLENBQUNTLElBQUYsR0FBUyxJQUFUO0lBQ0FULENBQUMsQ0FBQ1UsT0FBRixHQUFZLElBQVo7SUFDQVYsQ0FBQyxDQUFDVyxPQUFGLEdBQVksSUFBWjtJQUNBWCxDQUFDLENBQUNZLGNBQUYsR0FBbUIsSUFBbkI7SUFDQVosQ0FBQyxDQUFDYSxRQUFGLEdBQWEsSUFBYjtJQUNBYixDQUFDLENBQUNjLFNBQUYsR0FBYyxJQUFkO0lBQ0FkLENBQUMsQ0FBQ2UsVUFBRixHQUFlLENBQUMsQ0FBaEI7SUFDQSxPQUFPZixDQUFQO0VBQ0g7O0VBQ0RnQixTQUFTLENBQUNoQixDQUFELEVBQUlELENBQUosQ0FBVDs7RUFDQUMsQ0FBQyxDQUFDaUIsU0FBRixDQUFZQyxNQUFaLEdBQXFCLFlBQVk7SUFDN0IsSUFBSW5CLENBQUMsR0FBRyxNQUFNWCxZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QkMsWUFBekIsQ0FBc0NDLEtBQTVDLEdBQW9ELENBQXBELEdBQXdEakMsWUFBWSxXQUFaLENBQXFCK0IsR0FBckIsQ0FBeUJDLFlBQXpCLENBQXNDQyxLQUF0RztJQUNBLEtBQUtDLFlBQUwsQ0FBa0J2QixDQUFsQjtFQUNILENBSEQ7O0VBSUFDLENBQUMsQ0FBQ2lCLFNBQUYsQ0FBWU0sV0FBWixHQUEwQixZQUFZO0lBQ2xDLEtBQUtkLElBQUwsQ0FBVWUsUUFBVixHQUFxQnJDLGNBQWMsV0FBZCxDQUF1QnNDLFFBQXZCLENBQWdDQyxZQUFoQyxDQUE2Q0MsTUFBN0MsR0FBc0QsQ0FBM0U7SUFDQSxLQUFLbEIsSUFBTCxDQUFVbUIsVUFBVixHQUF1QixDQUF2QjtFQUNILENBSEQ7O0VBSUE1QixDQUFDLENBQUNpQixTQUFGLENBQVlZLFFBQVosR0FBdUIsWUFBWTtJQUMvQixLQUFLckIsT0FBTCxDQUFhc0IsRUFBYixDQUFnQixPQUFoQixFQUF5QixLQUFLQyxTQUE5QixFQUF5QyxJQUF6QztJQUNBLEtBQUtyQixPQUFMLENBQWFvQixFQUFiLENBQWdCLE9BQWhCLEVBQXlCLEtBQUtFLFNBQTlCLEVBQXlDLElBQXpDO0VBQ0gsQ0FIRDs7RUFJQWhDLENBQUMsQ0FBQ2lCLFNBQUYsQ0FBWWdCLFdBQVosR0FBMEIsWUFBWTtJQUNsQyxLQUFLekIsT0FBTCxDQUFhMEIsR0FBYixDQUFpQixPQUFqQixFQUEwQixLQUFLSCxTQUEvQixFQUEwQyxJQUExQztJQUNBLEtBQUtyQixPQUFMLENBQWF3QixHQUFiLENBQWlCLE9BQWpCLEVBQTBCLEtBQUtGLFNBQS9CLEVBQTBDLElBQTFDO0VBQ0gsQ0FIRDs7RUFJQWhDLENBQUMsQ0FBQ2lCLFNBQUYsQ0FBWWUsU0FBWixHQUF3QixZQUFZO0lBQ2hDaEQsVUFBVSxDQUFDbUQsU0FBWCxDQUFxQlYsUUFBckIsQ0FBOEJXLFdBQTlCLENBQTBDdkQsVUFBVSxDQUFDd0QsU0FBWCxDQUFxQkMsWUFBckIsQ0FBa0NDLE9BQWxDLENBQTBDQyxVQUExQyxDQUFxREMsU0FBL0YsRUFBMEc7TUFDdEdDLElBQUksRUFBRXJELFVBQVUsQ0FBQ3NELFFBQVgsQ0FBb0JDO0lBRDRFLENBQTFHO0VBR0gsQ0FKRDs7RUFLQTVDLENBQUMsQ0FBQ2lCLFNBQUYsQ0FBWTRCLFVBQVosR0FBeUIsVUFBVTlDLENBQVYsRUFBYUMsQ0FBYixFQUFnQjtJQUNyQ0QsQ0FBQyxDQUFDK0MsWUFBRixDQUFleEQsY0FBYyxXQUE3QixFQUF1Q3lELE1BQXZDLENBQThDNUQsY0FBYyxXQUFkLENBQXVCc0MsUUFBdkIsQ0FBZ0NDLFlBQWhDLENBQTZDMUIsQ0FBQyxHQUFHLENBQWpELENBQTlDO0VBQ0gsQ0FGRDs7RUFHQUEsQ0FBQyxDQUFDaUIsU0FBRixDQUFZK0IsY0FBWixHQUE2QixVQUFVakQsQ0FBVixFQUFhO0lBQ3RDLElBQUlBLENBQUosRUFBTztNQUNILElBQUlDLENBQUMsR0FBR0QsQ0FBQyxDQUFDK0MsWUFBRixDQUFleEQsY0FBYyxXQUE3QixFQUF1QzJELE1BQS9DO01BQ0EsS0FBSzNCLFlBQUwsQ0FBa0J0QixDQUFsQjtJQUNIO0VBQ0osQ0FMRDs7RUFNQUEsQ0FBQyxDQUFDaUIsU0FBRixDQUFZSyxZQUFaLEdBQTJCLFVBQVV2QixDQUFWLEVBQWE7SUFDcEMsSUFBSUMsQ0FBQyxHQUFHLElBQVI7SUFDQSxLQUFLZSxVQUFMLEdBQWtCaEIsQ0FBbEI7SUFDQSxJQUFJbUQsQ0FBQyxHQUFHL0QsY0FBYyxXQUFkLENBQXVCc0MsUUFBdkIsQ0FBZ0NDLFlBQWhDLENBQTZDeUIsSUFBN0MsQ0FBa0QsVUFBVW5ELENBQVYsRUFBYTtNQUNuRSxPQUFPQSxDQUFDLENBQUNvRCxFQUFGLEtBQVNyRCxDQUFoQjtJQUNILENBRk8sQ0FBUjtJQUdBLElBQUlyQixDQUFDLEdBQUdVLFlBQVksV0FBWixDQUFxQitCLEdBQXJCLENBQXlCa0MsZ0JBQXpCLENBQTBDdEQsQ0FBMUMsQ0FBUjtJQUNBLEtBQUtJLFNBQUwsQ0FBZW1ELE1BQWYsR0FBd0JKLENBQUMsQ0FBQ0ssYUFBMUI7SUFDQSxLQUFLbEQsUUFBTCxDQUFjaUQsTUFBZCxHQUF1QixLQUFLSixDQUFDLENBQUNNLDJCQUE5QjtJQUNBLEtBQUtwRCxPQUFMLENBQWFxRCxZQUFiLEdBQTRCLE9BQU9QLENBQUMsQ0FBQ0UsRUFBckM7SUFDQXpFLGFBQWEsV0FBYixDQUFzQjhDLFFBQXRCLENBQStCaUMsT0FBL0IsQ0FDSTdFLFVBQVUsQ0FBQzhFLFdBQVgsQ0FBdUJDLFVBRDNCLEVBRUksQ0FBQyxnQkFBZ0JWLENBQUMsQ0FBQ0UsRUFBbkIsQ0FGSixFQUdJNUQsRUFBRSxDQUFDcUUsV0FIUCxFQUlJLElBSkosRUFLSSxVQUFVOUQsQ0FBVixFQUFhbUQsQ0FBYixFQUFnQjtNQUNaLElBQUl4RSxDQUFDLEdBQUd3RSxDQUFDLENBQUMsQ0FBRCxDQUFUOztNQUNBLElBQUl4RSxDQUFDLElBQUljLEVBQUUsQ0FBQ3NFLE9BQUgsQ0FBVzlELENBQUMsQ0FBQ1csT0FBYixDQUFULEVBQWdDO1FBQzVCWCxDQUFDLENBQUNXLE9BQUYsQ0FBVW9ELFdBQVYsR0FBd0JqRixRQUFRLENBQUNrRixPQUFULENBQWlCQyxVQUFqQixDQUE0QnZGLENBQTVCLEVBQStCc0IsQ0FBQyxDQUFDa0UsSUFBakMsQ0FBeEI7UUFDQWxFLENBQUMsQ0FBQ2EsUUFBRixDQUFXaUMsWUFBWCxDQUF3QnRELEVBQUUsQ0FBQzJFLE1BQTNCLEVBQW1DSixXQUFuQyxHQUFpRHJGLENBQWpEO01BQ0g7SUFDSixDQVhMO0lBYUEsS0FBSzRCLE9BQUwsQ0FBYTRELElBQWIsQ0FBa0JFLE1BQWxCLEdBQTJCLENBQUMsQ0FBNUI7SUFDQSxLQUFLN0QsVUFBTCxDQUFnQjJELElBQWhCLENBQXFCRSxNQUFyQixHQUE4QixDQUFDLENBQS9CO0lBQ0EsS0FBS3hELGNBQUwsQ0FBb0IwQyxNQUFwQixHQUE2QkosQ0FBQyxDQUFDbUIsdUJBQS9CO0lBQ0EsS0FBS3ZELFNBQUwsQ0FBZW9ELElBQWYsQ0FBb0JJLE1BQXBCLENBQTJCRixNQUEzQixHQUFvQyxDQUFDLENBQXJDO0lBQ0ExRixDQUFDLENBQUM2RixNQUFGLElBQ1EsS0FBSzFELFFBQUwsQ0FBY3VELE1BQWQsR0FBdUIsQ0FBQyxDQUF6QixFQUNBLEtBQUt4RCxjQUFMLENBQW9Cc0QsSUFBcEIsQ0FBeUJJLE1BQXpCLENBQWdDRixNQUFoQyxHQUF5QyxDQUFDLENBRDFDLEVBRUEsS0FBS3pELE9BQUwsQ0FBYXVELElBQWIsQ0FBa0JJLE1BQWxCLENBQXlCRixNQUF6QixHQUFrQyxDQUFDLENBRm5DLEVBR0RoRixZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QkMsWUFBekIsQ0FBc0NDLEtBQXRDLEtBQWdEdEIsQ0FBaEQsSUFDUSxLQUFLUyxPQUFMLENBQWE0RCxNQUFiLEdBQXNCLENBQUMsQ0FBeEIsRUFDRGxGLEtBQUssV0FBTCxDQUFjc0YsbUJBQWQsQ0FBa0MsS0FBS2hFLE9BQXZDLEVBQWdELENBQUMsQ0FBakQsQ0FEQyxFQUVBLEtBQUtBLE9BQUwsQ0FBYXNDLFlBQWIsQ0FBMEJ0RCxFQUFFLENBQUNpRixNQUE3QixFQUFxQ0MsWUFBckMsR0FBb0QsQ0FBQyxDQUZyRCxFQUdBLEtBQUtsRSxPQUFMLENBQWFtRSxzQkFBYixDQUFvQ25GLEVBQUUsQ0FBQ29GLEtBQXZDLEVBQThDdEIsTUFBOUMsR0FBdUQsSUFKOUQsS0FLT3BFLEtBQUssV0FBTCxDQUFjc0YsbUJBQWQsQ0FBa0MsS0FBS2hFLE9BQXZDLEVBQWdELENBQUMsQ0FBakQsR0FDQSxLQUFLQSxPQUFMLENBQWFzQyxZQUFiLENBQTBCdEQsRUFBRSxDQUFDaUYsTUFBN0IsRUFBcUNDLFlBQXJDLEdBQW9ELENBQUMsQ0FEckQsRUFFQSxLQUFLbEUsT0FBTCxDQUFhbUUsc0JBQWIsQ0FBb0NuRixFQUFFLENBQUNvRixLQUF2QyxFQUE4Q3RCLE1BQTlDLEdBQXVELElBUDlELENBSk4sS0FZUSxLQUFLeEMsU0FBTCxDQUFlb0QsSUFBZixDQUFvQkksTUFBcEIsQ0FBMkJGLE1BQTNCLEdBQW9DLENBQUMsQ0FBdEMsRUFDQSxLQUFLdEQsU0FBTCxDQUFld0MsTUFBZixHQUF3QkosQ0FBQyxDQUFDMkIsWUFEMUIsRUFFQSxLQUFLbEUsT0FBTCxDQUFhdUQsSUFBYixDQUFrQkksTUFBbEIsQ0FBeUJGLE1BQXpCLEdBQWtDLENBQUMsQ0FGbkMsRUFHQSxLQUFLdkQsUUFBTCxDQUFjdUQsTUFBZCxHQUF1QixDQUFDLENBSHhCLEVBSUEsS0FBS3hELGNBQUwsQ0FBb0JzRCxJQUFwQixDQUF5QkksTUFBekIsQ0FBZ0NGLE1BQWhDLEdBQXlDLENBQUMsQ0FKMUMsRUFLQSxLQUFLOUQsT0FBTCxDQUFhNEQsSUFBYixDQUFrQkUsTUFBbEIsR0FBMkIsQ0FBQyxDQUw1QixFQU1BLEtBQUs3RCxVQUFMLENBQWdCMkQsSUFBaEIsQ0FBcUJFLE1BQXJCLEdBQThCLENBQUMsQ0FOL0IsRUFPRHpGLGFBQWEsV0FBYixDQUFzQjhDLFFBQXRCLENBQStCaUMsT0FBL0IsQ0FDSTdFLFVBQVUsQ0FBQzhFLFdBQVgsQ0FBdUJDLFVBRDNCLEVBRUksQ0FBQyxvQkFBb0JWLENBQUMsQ0FBQ0UsRUFBdkIsQ0FGSixFQUdJNUQsRUFBRSxDQUFDcUUsV0FIUCxFQUlJLElBSkosRUFLSSxVQUFVOUQsQ0FBVixFQUFhbUQsQ0FBYixFQUFnQjtNQUNaLElBQUl4RSxDQUFDLEdBQUd3RSxDQUFDLENBQUMsQ0FBRCxDQUFUOztNQUNBLElBQUl4RSxDQUFDLElBQUljLEVBQUUsQ0FBQ3NFLE9BQUgsQ0FBVzlELENBQUMsQ0FBQ00sT0FBYixDQUFULEVBQWdDO1FBQzVCTixDQUFDLENBQUNNLE9BQUYsQ0FBVXlELFdBQVYsR0FBd0JqRixRQUFRLENBQUNrRixPQUFULENBQWlCQyxVQUFqQixDQUE0QnZGLENBQTVCLEVBQStCc0IsQ0FBQyxDQUFDa0UsSUFBakMsQ0FBeEI7TUFDSDtJQUNKLENBVkwsQ0FQQyxFQW1CQSxLQUFLM0QsVUFBTCxDQUFnQitDLE1BQWhCLEdBQXlCNUUsQ0FBQyxDQUFDb0csS0FBRixHQUFVLEdBQVYsR0FBZ0I1QixDQUFDLENBQUM2QixTQW5CM0MsRUFvQkRyRyxDQUFDLENBQUNvRyxLQUFGLElBQVc1QixDQUFDLENBQUM2QixTQUFiLElBQ083RixLQUFLLFdBQUwsQ0FBY3NGLG1CQUFkLENBQWtDLEtBQUtoRSxPQUF2QyxFQUFnRCxDQUFDLENBQWpELEdBQ0EsS0FBS0EsT0FBTCxDQUFhc0MsWUFBYixDQUEwQnRELEVBQUUsQ0FBQ2lGLE1BQTdCLEVBQXFDQyxZQUFyQyxHQUFvRCxDQUFDLENBRHJELEVBRUEsS0FBS2xFLE9BQUwsQ0FBYW1FLHNCQUFiLENBQW9DbkYsRUFBRSxDQUFDb0YsS0FBdkMsRUFBOEN0QixNQUE5QyxHQUF1RCxJQUg5RCxLQUlPcEUsS0FBSyxXQUFMLENBQWNzRixtQkFBZCxDQUFrQyxLQUFLaEUsT0FBdkMsRUFBZ0QsQ0FBQyxDQUFqRCxHQUNBLEtBQUtBLE9BQUwsQ0FBYXNDLFlBQWIsQ0FBMEJ0RCxFQUFFLENBQUNpRixNQUE3QixFQUFxQ0MsWUFBckMsR0FBb0QsQ0FBQyxDQURyRCxFQUVBLEtBQUtsRSxPQUFMLENBQWFtRSxzQkFBYixDQUFvQ25GLEVBQUUsQ0FBQ29GLEtBQXZDLEVBQThDdEIsTUFBOUMsR0FBdUQsSUFOOUQsQ0FoQ047RUF1Q0gsQ0FsRUQ7O0VBbUVBdEQsQ0FBQyxDQUFDaUIsU0FBRixDQUFZYyxTQUFaLEdBQXdCLFlBQVk7SUFDaEMsSUFBSWhDLENBQUMsR0FBRyxJQUFSO0lBQ0EsSUFBSUMsQ0FBQyxHQUFHWixZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QmtDLGdCQUF6QixDQUEwQyxLQUFLdEMsVUFBL0MsQ0FBUjtJQUNBLElBQUltQyxDQUFDLEdBQUcvRCxjQUFjLFdBQWQsQ0FBdUJzQyxRQUF2QixDQUFnQ0MsWUFBaEMsQ0FBNkN5QixJQUE3QyxDQUFrRCxVQUFVbkQsQ0FBVixFQUFhO01BQ25FLE9BQU9BLENBQUMsQ0FBQ29ELEVBQUYsS0FBU3JELENBQUMsQ0FBQ2dCLFVBQWxCO0lBQ0gsQ0FGTyxDQUFSOztJQUdBLElBQUksS0FBS0EsVUFBTCxLQUFvQjNCLFlBQVksV0FBWixDQUFxQitCLEdBQXJCLENBQXlCQyxZQUF6QixDQUFzQ0MsS0FBOUQsRUFBcUU7TUFDakVqQyxZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QkMsWUFBekIsQ0FBc0NDLEtBQXRDLEdBQThDLENBQTlDO01BQ0FqQyxZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QjZELFdBQXpCLENBQXFDNUYsWUFBWSxXQUFaLENBQXFCK0IsR0FBckIsQ0FBeUJDLFlBQTlEO01BQ0EsS0FBS0UsWUFBTCxDQUFrQixDQUFsQjtNQUNBLE9BQU8sS0FBSyxLQUFLYixJQUFMLENBQVV3RSxTQUFWLEVBQVo7SUFDSDs7SUFDRGpGLENBQUMsQ0FBQ3VFLE1BQUYsR0FDTW5GLFlBQVksV0FBWixDQUFxQitCLEdBQXJCLENBQXlCQyxZQUF6QixDQUFzQ0MsS0FBdEMsS0FBZ0QsS0FBS04sVUFBckQsS0FDRTNCLFlBQVksV0FBWixDQUFxQitCLEdBQXJCLENBQXlCQyxZQUF6QixDQUFzQ0MsS0FBdEMsR0FBOEMsS0FBS04sVUFBcEQsRUFDRDNCLFlBQVksV0FBWixDQUFxQitCLEdBQXJCLENBQXlCNkQsV0FBekIsQ0FBcUM1RixZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QkMsWUFBOUQsQ0FEQyxFQUVELEtBQUtFLFlBQUwsQ0FBa0IsS0FBS1AsVUFBdkIsQ0FGQyxFQUdELEtBQUtOLElBQUwsQ0FBVXdFLFNBQVYsRUFKQSxDQUROLEdBTU1qRixDQUFDLENBQUM4RSxLQUFGLElBQVc1QixDQUFDLENBQUM2QixTQUFiLEtBQ0UvRSxDQUFDLENBQUN1RSxNQUFGLEdBQVcsQ0FBQyxDQUFiLEVBQ0F2RSxDQUFDLENBQUM4RSxLQUFGLElBQVc1QixDQUFDLENBQUM2QixTQURiLEVBRUQzRixZQUFZLFdBQVosQ0FBcUIrQixHQUFyQixDQUF5QitELGdCQUF6QixDQUEwQ2xGLENBQTFDLENBRkMsRUFHRCxLQUFLc0IsWUFBTCxDQUFrQixLQUFLUCxVQUF2QixDQUhDLEVBSUQsS0FBS04sSUFBTCxDQUFVd0UsU0FBVixFQUxBLENBTk47RUFZSCxDQXhCRDs7RUF5QkFFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUNvRixLQUFKLENBQUYsQ0FBRCxFQUFnQjVFLENBQUMsQ0FBQ2lCLFNBQWxCLEVBQTZCLFdBQTdCLEVBQTBDLEtBQUssQ0FBL0MsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDd0YsV0FBVyxDQUFDQyxlQUFiLENBQUYsQ0FBRCxFQUFtQ3JGLENBQUMsQ0FBQ2lCLFNBQXJDLEVBQWdELFNBQWhELEVBQTJELEtBQUssQ0FBaEUsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUNvRixLQUFKLENBQUYsQ0FBRCxFQUFnQjVFLENBQUMsQ0FBQ2lCLFNBQWxCLEVBQTZCLFVBQTdCLEVBQXlDLEtBQUssQ0FBOUMsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUMyRSxNQUFKLENBQUYsQ0FBRCxFQUFpQm5FLENBQUMsQ0FBQ2lCLFNBQW5CLEVBQThCLFNBQTlCLEVBQXlDLEtBQUssQ0FBOUMsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUNvRixLQUFKLENBQUYsQ0FBRCxFQUFnQjVFLENBQUMsQ0FBQ2lCLFNBQWxCLEVBQTZCLFlBQTdCLEVBQTJDLEtBQUssQ0FBaEQsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUM4RixJQUFKLENBQUYsQ0FBRCxFQUFldEYsQ0FBQyxDQUFDaUIsU0FBakIsRUFBNEIsU0FBNUIsRUFBdUMsS0FBSyxDQUE1QyxDQUFWOztFQUNBa0UsVUFBVSxDQUFDLENBQUN2RixDQUFDLENBQUNiLEtBQUssV0FBTixDQUFGLENBQUQsRUFBcUJpQixDQUFDLENBQUNpQixTQUF2QixFQUFrQyxNQUFsQyxFQUEwQyxLQUFLLENBQS9DLENBQVY7O0VBQ0FrRSxVQUFVLENBQUMsQ0FBQ3ZGLENBQUMsQ0FBQ0osRUFBRSxDQUFDOEYsSUFBSixDQUFGLENBQUQsRUFBZXRGLENBQUMsQ0FBQ2lCLFNBQWpCLEVBQTRCLFNBQTVCLEVBQXVDLEtBQUssQ0FBNUMsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUMyRSxNQUFKLENBQUYsQ0FBRCxFQUFpQm5FLENBQUMsQ0FBQ2lCLFNBQW5CLEVBQThCLFNBQTlCLEVBQXlDLEtBQUssQ0FBOUMsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUNvRixLQUFKLENBQUYsQ0FBRCxFQUFnQjVFLENBQUMsQ0FBQ2lCLFNBQWxCLEVBQTZCLGdCQUE3QixFQUErQyxLQUFLLENBQXBELENBQVY7O0VBQ0FrRSxVQUFVLENBQUMsQ0FBQ3ZGLENBQUMsQ0FBQ0osRUFBRSxDQUFDOEYsSUFBSixDQUFGLENBQUQsRUFBZXRGLENBQUMsQ0FBQ2lCLFNBQWpCLEVBQTRCLFVBQTVCLEVBQXdDLEtBQUssQ0FBN0MsQ0FBVjs7RUFDQWtFLFVBQVUsQ0FBQyxDQUFDdkYsQ0FBQyxDQUFDSixFQUFFLENBQUNvRixLQUFKLENBQUYsQ0FBRCxFQUFnQjVFLENBQUMsQ0FBQ2lCLFNBQWxCLEVBQTZCLFdBQTdCLEVBQTBDLEtBQUssQ0FBL0MsQ0FBVjs7RUFDQSxPQUFPa0UsVUFBVSxDQUFDLENBQUN6RixDQUFELENBQUQsRUFBTU0sQ0FBTixDQUFqQjtBQUNILENBMUpPLENBMEpMZixPQUFPLENBQUNzRyxNQTFKSCxDQUFSOztBQTJKQUMsT0FBTyxXQUFQLEdBQWtCMUYsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkbGlzdCA9IHJlcXVpcmUoXCIuL0xpc3RcIik7XHJcbnZhciAkdUlNYW5hZ2VyID0gcmVxdWlyZShcIi4vVUlNYW5hZ2VyXCIpO1xyXG52YXIgJHVJVmlldyA9IHJlcXVpcmUoXCIuL1VJVmlld1wiKTtcclxudmFyICR1dGlsID0gcmVxdWlyZShcIi4vVXRpbFwiKTtcclxudmFyICRjb25maWdDb250ZXh0ID0gcmVxdWlyZShcIi4vQ29uZmlnQ29udGV4dFwiKTtcclxudmFyICRyb2xlQ29udGV4dCA9IHJlcXVpcmUoXCIuL1JvbGVDb250ZXh0XCIpO1xyXG52YXIgJHN0YXJ0VmlldyA9IHJlcXVpcmUoXCIuL1N0YXJ0Vmlld1wiKTtcclxudmFyICRyb2JvdFNob3BJdGVtID0gcmVxdWlyZShcIi4vUm9ib3RTaG9wSXRlbVwiKTtcclxudmFyIGcgPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgXyA9IGcuY2NjbGFzcztcclxudmFyIGsgPSBnLnByb3BlcnR5O1xyXG52YXIgdiA9IChmdW5jdGlvbiAodCkge1xyXG4gICAgZnVuY3Rpb24gZSgpIHtcclxuICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICBlLm5hbWVMYWJsZSA9IG51bGw7XHJcbiAgICAgICAgZS5ndW5Ta2luID0gbnVsbDtcclxuICAgICAgICBlLmF0a0xhYmVsID0gbnVsbDtcclxuICAgICAgICBlLnNoYXJkU3AgPSBudWxsO1xyXG4gICAgICAgIGUuc2hhcmRMYWJlbCA9IG51bGw7XHJcbiAgICAgICAgZS5idG5TdXJlID0gbnVsbDtcclxuICAgICAgICBlLmxpc3QgPSBudWxsO1xyXG4gICAgICAgIGUuYnRuQmFjayA9IG51bGw7XHJcbiAgICAgICAgZS5za2lsbFNwID0gbnVsbDtcclxuICAgICAgICBlLnNraWxsRGVzY0xhYmVsID0gbnVsbDtcclxuICAgICAgICBlLmRlc2NJY29uID0gbnVsbDtcclxuICAgICAgICBlLmdhaW5MYWJlbCA9IG51bGw7XHJcbiAgICAgICAgZS5jdXJyU2tpbklkID0gLTE7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5vbkxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSAxID09PSAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuY3VyclNraW5JbmZvLnJvYm90ID8gMiA6ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8ucm9ib3Q7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJQbGF5ZXIodCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25SZXNldFZpZXcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5saXN0Lm51bUl0ZW1zID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5yb2JvdENvbmZpZ3MubGVuZ3RoIC0gMTtcclxuICAgICAgICB0aGlzLmxpc3Quc2VsZWN0ZWRJZCA9IDA7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYWRkRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5idG5TdXJlLm9uKFwiY2xpY2tcIiwgdGhpcy5jbGlja1N1cmUsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYnRuQmFjay5vbihcImNsaWNrXCIsIHRoaXMuY2xpY2tCYWNrLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW1vdmVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmJ0blN1cmUub2ZmKFwiY2xpY2tcIiwgdGhpcy5jbGlja1N1cmUsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYnRuQmFjay5vZmYoXCJjbGlja1wiLCB0aGlzLmNsaWNrQmFjaywgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY2xpY2tCYWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICR1SU1hbmFnZXIuVUlNYW5hZ2VyLmluc3RhbmNlLnJlcGxhY2VWaWV3KCRhc3NldHNNYXAuQXNzZXRzTWFwLlN0YXJ0QnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuU3RhcnRWaWV3LCB7XHJcbiAgICAgICAgICAgIHR5cGU6ICRzdGFydFZpZXcuTWVudVR5cGUuU2tpbGxcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW5kZXJJdGVtID0gZnVuY3Rpb24gKHQsIGUpIHtcclxuICAgICAgICB0LmdldENvbXBvbmVudCgkcm9ib3RTaG9wSXRlbS5kZWZhdWx0KS5yZW5kZXIoJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5yb2JvdENvbmZpZ3NbZSArIDFdKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkxpc3RTZWxlY3RlZCA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgaWYgKHQpIHtcclxuICAgICAgICAgICAgdmFyIGUgPSB0LmdldENvbXBvbmVudCgkcm9ib3RTaG9wSXRlbS5kZWZhdWx0KS5za2luSWQ7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUGxheWVyKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5yZW5kZXJQbGF5ZXIgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHZhciBlID0gdGhpcztcclxuICAgICAgICB0aGlzLmN1cnJTa2luSWQgPSB0O1xyXG4gICAgICAgIHZhciBpID0gJGNvbmZpZ0NvbnRleHQuZGVmYXVsdC5pbnN0YW5jZS5yb2JvdENvbmZpZ3MuZmluZChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZS5pZCA9PT0gdDtcclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgbyA9ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSb2JvdFNraW5JbmZvKHQpO1xyXG4gICAgICAgIHRoaXMubmFtZUxhYmxlLnN0cmluZyA9IGkuUGV0c3NraW5fbmFtZTtcclxuICAgICAgICB0aGlzLmF0a0xhYmVsLnN0cmluZyA9IFwiXCIgKyBpLlBldHNza2luX2F0dHJpYnV0ZV9kZXNjcmliZTtcclxuICAgICAgICB0aGlzLmd1blNraW4uYXJtYXR1cmVOYW1lID0gXCJobFwiICsgaS5pZDtcclxuICAgICAgICAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UubG9hZFJlcyhcclxuICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5QdWJsaWNfUmVzLFxyXG4gICAgICAgICAgICBbXCIvY2RfaWNvbi9jd1wiICsgaS5pZF0sXHJcbiAgICAgICAgICAgIGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICBmdW5jdGlvbiAodCwgaSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG8gPSBpWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKG8gJiYgY2MuaXNWYWxpZChlLnNraWxsU3ApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5za2lsbFNwLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKG8sIGUubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5kZXNjSWNvbi5nZXRDb21wb25lbnQoY2MuU3ByaXRlKS5zcHJpdGVGcmFtZSA9IG87XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuc2hhcmRTcC5ub2RlLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgIHRoaXMuc2hhcmRMYWJlbC5ub2RlLmFjdGl2ZSA9ICExO1xyXG4gICAgICAgIHRoaXMuc2tpbGxEZXNjTGFiZWwuc3RyaW5nID0gaS5QZXRzc2tpbl9za2lsbF9kZXNjcmliZTtcclxuICAgICAgICB0aGlzLmdhaW5MYWJlbC5ub2RlLnBhcmVudC5hY3RpdmUgPSAhMTtcclxuICAgICAgICBvLmlzSGF2ZVxyXG4gICAgICAgICAgICA/ICgodGhpcy5kZXNjSWNvbi5hY3RpdmUgPSAhMCksXHJcbiAgICAgICAgICAgICAgKHRoaXMuc2tpbGxEZXNjTGFiZWwubm9kZS5wYXJlbnQuYWN0aXZlID0gITApLFxyXG4gICAgICAgICAgICAgICh0aGlzLnNraWxsU3Aubm9kZS5wYXJlbnQuYWN0aXZlID0gITEpLFxyXG4gICAgICAgICAgICAgICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8ucm9ib3QgPT09IHRcclxuICAgICAgICAgICAgICAgICAgPyAoKHRoaXMuYnRuU3VyZS5hY3RpdmUgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICAgJHV0aWwuZGVmYXVsdC51cGRhdGVNYXRlcmlhbFN0YXRlKHRoaXMuYnRuU3VyZSwgITEpLFxyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmJ0blN1cmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gITApLFxyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmJ0blN1cmUuZ2V0Q29tcG9uZW50SW5DaGlsZHJlbihjYy5MYWJlbCkuc3RyaW5nID0gXCLljbjkuItcIikpXHJcbiAgICAgICAgICAgICAgICAgIDogKCR1dGlsLmRlZmF1bHQudXBkYXRlTWF0ZXJpYWxTdGF0ZSh0aGlzLmJ0blN1cmUsICExKSxcclxuICAgICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9ICEwKSxcclxuICAgICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudEluQ2hpbGRyZW4oY2MuTGFiZWwpLnN0cmluZyA9IFwi5L2/55SoXCIpKSlcclxuICAgICAgICAgICAgOiAoKHRoaXMuZ2FpbkxhYmVsLm5vZGUucGFyZW50LmFjdGl2ZSA9ICEwKSxcclxuICAgICAgICAgICAgICAodGhpcy5nYWluTGFiZWwuc3RyaW5nID0gaS5nZXRfZGVzY3JpYmUpLFxyXG4gICAgICAgICAgICAgICh0aGlzLnNraWxsU3Aubm9kZS5wYXJlbnQuYWN0aXZlID0gITApLFxyXG4gICAgICAgICAgICAgICh0aGlzLmRlc2NJY29uLmFjdGl2ZSA9ICExKSxcclxuICAgICAgICAgICAgICAodGhpcy5za2lsbERlc2NMYWJlbC5ub2RlLnBhcmVudC5hY3RpdmUgPSAhMSksXHJcbiAgICAgICAgICAgICAgKHRoaXMuc2hhcmRTcC5ub2RlLmFjdGl2ZSA9ICEwKSxcclxuICAgICAgICAgICAgICAodGhpcy5zaGFyZExhYmVsLm5vZGUuYWN0aXZlID0gITApLFxyXG4gICAgICAgICAgICAgICRhc3NldHNMb2FkZXIuZGVmYXVsdC5pbnN0YW5jZS5sb2FkUmVzKFxyXG4gICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLlB1YmxpY19SZXMsXHJcbiAgICAgICAgICAgICAgICAgIFtcIi9yb2JvdF9zaGFyZC9zcFwiICsgaS5pZF0sXHJcbiAgICAgICAgICAgICAgICAgIGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodCwgaSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYgKG8gJiYgY2MuaXNWYWxpZChlLnNoYXJkU3ApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zaGFyZFNwLnNwcml0ZUZyYW1lID0gJHJlc1V0aWwuUmVzVXRpbC5hc3NpZ25XaXRoKG8sIGUubm9kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICh0aGlzLnNoYXJkTGFiZWwuc3RyaW5nID0gby5zaGFyZCArIFwiL1wiICsgaS5zaGFyZF9udW0pLFxyXG4gICAgICAgICAgICAgIG8uc2hhcmQgPj0gaS5zaGFyZF9udW1cclxuICAgICAgICAgICAgICAgICAgPyAoJHV0aWwuZGVmYXVsdC51cGRhdGVNYXRlcmlhbFN0YXRlKHRoaXMuYnRuU3VyZSwgITEpLFxyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmJ0blN1cmUuZ2V0Q29tcG9uZW50KGNjLkJ1dHRvbikuaW50ZXJhY3RhYmxlID0gITApLFxyXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmJ0blN1cmUuZ2V0Q29tcG9uZW50SW5DaGlsZHJlbihjYy5MYWJlbCkuc3RyaW5nID0gXCLmv4DmtLtcIikpXHJcbiAgICAgICAgICAgICAgICAgIDogKCR1dGlsLmRlZmF1bHQudXBkYXRlTWF0ZXJpYWxTdGF0ZSh0aGlzLmJ0blN1cmUsICEwKSxcclxuICAgICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudChjYy5CdXR0b24pLmludGVyYWN0YWJsZSA9ICExKSxcclxuICAgICAgICAgICAgICAgICAgICAodGhpcy5idG5TdXJlLmdldENvbXBvbmVudEluQ2hpbGRyZW4oY2MuTGFiZWwpLnN0cmluZyA9IFwi5r+A5rS7XCIpKSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuY2xpY2tTdXJlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICB2YXIgZSA9ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRSb2JvdFNraW5JbmZvKHRoaXMuY3VyclNraW5JZCk7XHJcbiAgICAgICAgdmFyIGkgPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLnJvYm90Q29uZmlncy5maW5kKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBlLmlkID09PSB0LmN1cnJTa2luSWQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VyclNraW5JZCA9PT0gJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmN1cnJTa2luSW5mby5yb2JvdCkge1xyXG4gICAgICAgICAgICAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuY3VyclNraW5JbmZvLnJvYm90ID0gMTtcclxuICAgICAgICAgICAgJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLnNldEN1cnJJbmZvKCRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8pO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlclBsYXllcigyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy5saXN0LnVwZGF0ZUFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlLmlzSGF2ZVxyXG4gICAgICAgICAgICA/ICRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8ucm9ib3QgIT09IHRoaXMuY3VyclNraW5JZCAmJlxyXG4gICAgICAgICAgICAgICgoJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLmN1cnJTa2luSW5mby5yb2JvdCA9IHRoaXMuY3VyclNraW5JZCksXHJcbiAgICAgICAgICAgICAgJHJvbGVDb250ZXh0LmRlZmF1bHQuaW5zLnNldEN1cnJJbmZvKCRyb2xlQ29udGV4dC5kZWZhdWx0Lmlucy5jdXJyU2tpbkluZm8pLFxyXG4gICAgICAgICAgICAgIHRoaXMucmVuZGVyUGxheWVyKHRoaXMuY3VyclNraW5JZCksXHJcbiAgICAgICAgICAgICAgdGhpcy5saXN0LnVwZGF0ZUFsbCgpKVxyXG4gICAgICAgICAgICA6IGUuc2hhcmQgPj0gaS5zaGFyZF9udW0gJiZcclxuICAgICAgICAgICAgICAoKGUuaXNIYXZlID0gITApLFxyXG4gICAgICAgICAgICAgIChlLnNoYXJkIC09IGkuc2hhcmRfbnVtKSxcclxuICAgICAgICAgICAgICAkcm9sZUNvbnRleHQuZGVmYXVsdC5pbnMuc2V0Um9ib3RTa2luSW5mbyhlKSxcclxuICAgICAgICAgICAgICB0aGlzLnJlbmRlclBsYXllcih0aGlzLmN1cnJTa2luSWQpLFxyXG4gICAgICAgICAgICAgIHRoaXMubGlzdC51cGRhdGVBbGwoKSk7XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5MYWJlbCldLCBlLnByb3RvdHlwZSwgXCJuYW1lTGFibGVcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soZHJhZ29uQm9uZXMuQXJtYXR1cmVEaXNwbGF5KV0sIGUucHJvdG90eXBlLCBcImd1blNraW5cIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwiYXRrTGFiZWxcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuU3ByaXRlKV0sIGUucHJvdG90eXBlLCBcInNoYXJkU3BcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soY2MuTGFiZWwpXSwgZS5wcm90b3R5cGUsIFwic2hhcmRMYWJlbFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImJ0blN1cmVcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW2soJGxpc3QuZGVmYXVsdCldLCBlLnByb3RvdHlwZSwgXCJsaXN0XCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLk5vZGUpXSwgZS5wcm90b3R5cGUsIFwiYnRuQmFja1wiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5TcHJpdGUpXSwgZS5wcm90b3R5cGUsIFwic2tpbGxTcFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5MYWJlbCldLCBlLnByb3RvdHlwZSwgXCJza2lsbERlc2NMYWJlbFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbayhjYy5Ob2RlKV0sIGUucHJvdG90eXBlLCBcImRlc2NJY29uXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtrKGNjLkxhYmVsKV0sIGUucHJvdG90eXBlLCBcImdhaW5MYWJlbFwiLCB2b2lkIDApO1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW19dLCBlKTtcclxufSkoJHVJVmlldy5VSVZpZXcpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSB2O1xyXG4iXX0=