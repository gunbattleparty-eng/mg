
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/OPPONativeAd.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '87154RXCT5EnqgotaGIMbes', 'OPPONativeAd');
// game_script/scripts/OPPONativeAd.js

"use strict";

var o;
exports.OPPONativeAd = void 0;

var $baseAdNode = require("./BaseAdNode");

var r = window.qg;

var a = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.adViewName = null;
    e.isOpenPreLoad = !1;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (r && r.createNativeAd) {
        var t = {
          adUnitId: this.adUnitId
        };
        this.adIns = r.createNativeAd(t);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }

        this.adIns.load();
      } else {
        console.warn("组件不支持NativeAd");
      }
    } else {
      console.error("OPPONativeAd ID为空");
    }
  };

  e.prototype.showNativeAd = function (t, e, i, o) {
    var n = this;
    this.showCallback = e;
    this.errorCallback = o;
    this.closeCallback = i;
    this.adViewName = t;

    if (this.isCanShow) {
      return this.adIns && this.adData ? this.isLoaded ? void (this.isLoaded && this.adData && (this.isConsume = !0, this.createNativeAd(t, function () {
        if (n.adIns && n.adData) {
          n.adIns.reportAdClick({
            adId: n.adData.adId.toString()
          });
        }

        if (n.showCallback) {
          n.showCallback();
        }

        n.destroyAd();
        n.reCreateAd(!1);
      }, function () {
        if (n.closeCallback) {
          n.closeCallback();
        }

        n.reCreateAd(!1);
      }), this.setAdData(this.adData.imgUrlList[0], this.adData.title, this.adData.desc), this.adIns.reportAdShow({
        adId: this.adData.adId.toString()
      }))) : (console.warn(this.adUnitId, ":正在加载中，稍等"), void (this.isAutoShow = !0)) : (console.warn(this.adUnitId, ":无数据执行重建"), this.reCreateAd(!0));
    }

    console.warn(this.adUnitId, ":当前广告禁止显示");
  };

  e.prototype.forbiddenNativeAd = function (t) {
    this.isCanShow = !t;

    if (t && this.isConsume) {
      this.hideNativeAd(!1);
    }
  };

  e.prototype.hideNativeAd = function (e) {
    e && this.isConsume ? (this.destroyAd(), this.reCreateAd(!1)) : t.prototype.destroyNativeAdNode.call(this);
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);
    this.adData = null;

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showNativeAd(this.adViewName, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function (e) {
    t.prototype.onAdLoad.call(this, e);
    this.isConsume = !1;
    this.isLoaded = !0;

    if (e && e.adList && e.adList.length > 0) {
      var i = e.adList.pop();
      console.log("广告参数:", i);
      this.adData = i;
      this.autoShow();
    }
  };

  e.prototype.onAdError = function (e) {
    t.prototype.onAdError.call(this, e);
    console.error("onAdError", this.adUnitId, e);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdClose = function (e) {
    t.prototype.onAdClose.call(this, e);
    this.destroyNativeAdNode();
  };

  return e;
}($baseAdNode["default"]);

exports.OPPONativeAd = a;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXE9QUE9OYXRpdmVBZC5qcyJdLCJuYW1lcyI6WyJvIiwiZXhwb3J0cyIsIk9QUE9OYXRpdmVBZCIsIiRiYXNlQWROb2RlIiwicmVxdWlyZSIsInIiLCJ3aW5kb3ciLCJxZyIsImEiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiYWRWaWV3TmFtZSIsImlzT3BlblByZUxvYWQiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJsb2FkQWQiLCJhZFVuaXRJZCIsImNyZWF0ZU5hdGl2ZUFkIiwiYWRJbnMiLCJvbkxvYWQiLCJvbkVycm9yIiwibG9hZCIsImNvbnNvbGUiLCJ3YXJuIiwiZXJyb3IiLCJzaG93TmF0aXZlQWQiLCJpIiwibiIsInNob3dDYWxsYmFjayIsImVycm9yQ2FsbGJhY2siLCJjbG9zZUNhbGxiYWNrIiwiaXNDYW5TaG93IiwiYWREYXRhIiwiaXNMb2FkZWQiLCJpc0NvbnN1bWUiLCJyZXBvcnRBZENsaWNrIiwiYWRJZCIsInRvU3RyaW5nIiwiZGVzdHJveUFkIiwicmVDcmVhdGVBZCIsInNldEFkRGF0YSIsImltZ1VybExpc3QiLCJ0aXRsZSIsImRlc2MiLCJyZXBvcnRBZFNob3ciLCJpc0F1dG9TaG93IiwiZm9yYmlkZGVuTmF0aXZlQWQiLCJoaWRlTmF0aXZlQWQiLCJkZXN0cm95TmF0aXZlQWROb2RlIiwiY2FsbCIsIm9mZkxvYWQiLCJvZmZFcnJvciIsImRlc3Ryb3kiLCJhdXRvU2hvdyIsIm9uQWRMb2FkIiwiYWRMaXN0IiwibGVuZ3RoIiwicG9wIiwibG9nIiwib25BZEVycm9yIiwib25BZENsb3NlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7QUFDQUMsT0FBTyxDQUFDQyxZQUFSLEdBQXVCLEtBQUssQ0FBNUI7O0FBQ0EsSUFBSUMsV0FBVyxHQUFHQyxPQUFPLENBQUMsY0FBRCxDQUF6Qjs7QUFDQSxJQUFJQyxDQUFDLEdBQUdDLE1B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Q3RDLElBQUk5QixDQUFDLEdBQUdsQixDQUFDLENBQUMrQyxNQUFGLENBQVNFLEdBQVQsRUFBUjtNQUNBbkMsT0FBTyxDQUFDb0MsR0FBUixDQUFZLE9BQVosRUFBcUJoQyxDQUFyQjtNQUNBLEtBQUtNLE1BQUwsR0FBY04sQ0FBZDtNQUNBLEtBQUsyQixRQUFMO0lBQ0g7RUFDSixDQVZEOztFQVdBN0MsQ0FBQyxDQUFDTSxTQUFGLENBQVk2QyxTQUFaLEdBQXdCLFVBQVVuRCxDQUFWLEVBQWE7SUFDakNELENBQUMsQ0FBQ08sU0FBRixDQUFZNkMsU0FBWixDQUFzQlYsSUFBdEIsQ0FBMkIsSUFBM0IsRUFBaUN6QyxDQUFqQztJQUNBYyxPQUFPLENBQUNFLEtBQVIsQ0FBYyxXQUFkLEVBQTJCLEtBQUtSLFFBQWhDLEVBQTBDUixDQUExQzs7SUFDQSxJQUFJLEtBQUtxQixhQUFULEVBQXdCO01BQ3BCLEtBQUtBLGFBQUw7SUFDSDs7SUFDRCxLQUFLUyxTQUFMO0VBQ0gsQ0FQRDs7RUFRQTlCLENBQUMsQ0FBQ00sU0FBRixDQUFZOEMsU0FBWixHQUF3QixVQUFVcEQsQ0FBVixFQUFhO0lBQ2pDRCxDQUFDLENBQUNPLFNBQUYsQ0FBWThDLFNBQVosQ0FBc0JYLElBQXRCLENBQTJCLElBQTNCLEVBQWlDekMsQ0FBakM7SUFDQSxLQUFLd0MsbUJBQUw7RUFDSCxDQUhEOztFQUlBLE9BQU94QyxDQUFQO0FBQ0gsQ0FoSU8sQ0FnSUxQLFdBQVcsV0FoSU4sQ0FBUjs7QUFpSUFGLE9BQU8sQ0FBQ0MsWUFBUixHQUF1Qk0sQ0FBdkIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLk9QUE9OYXRpdmVBZCA9IHZvaWQgMDtcclxudmFyICRiYXNlQWROb2RlID0gcmVxdWlyZShcIi4vQmFzZUFkTm9kZVwiKTtcclxudmFyIHIgPSB3aW5kb3cucWc7XHJcbnZhciBhID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuYWRWaWV3TmFtZSA9IG51bGw7XHJcbiAgICAgICAgZS5pc09wZW5QcmVMb2FkID0gITE7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5sb2FkQWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYWRVbml0SWQpIHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgci5jcmVhdGVOYXRpdmVBZCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHQgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWRVbml0SWQ6IHRoaXMuYWRVbml0SWRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zID0gci5jcmVhdGVOYXRpdmVBZCh0KTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uTG9hZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25Mb2FkKHRoaXMub25Mb2FkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uRXJyb3IodGhpcy5vbkVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMubG9hZCgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwi57uE5Lu25LiN5pSv5oyBTmF0aXZlQWRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiT1BQT05hdGl2ZUFkIElE5Li656m6XCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zaG93TmF0aXZlQWQgPSBmdW5jdGlvbiAodCwgZSwgaSwgbykge1xyXG4gICAgICAgIHZhciBuID0gdGhpcztcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gbztcclxuICAgICAgICB0aGlzLmNsb3NlQ2FsbGJhY2sgPSBpO1xyXG4gICAgICAgIHRoaXMuYWRWaWV3TmFtZSA9IHQ7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYW5TaG93KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkSW5zICYmIHRoaXMuYWREYXRhXHJcbiAgICAgICAgICAgICAgICA/IHRoaXMuaXNMb2FkZWRcclxuICAgICAgICAgICAgICAgICAgICA/IHZvaWQgKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNMb2FkZWQgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkRGF0YSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICgodGhpcy5pc0NvbnN1bWUgPSAhMCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVOYXRpdmVBZChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uYWRJbnMgJiYgbi5hZERhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmFkSW5zLnJlcG9ydEFkQ2xpY2soe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZElkOiBuLmFkRGF0YS5hZElkLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLnNob3dDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLmRlc3Ryb3lBZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5yZUNyZWF0ZUFkKCExKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4uY2xvc2VDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uY2xvc2VDYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbi5yZUNyZWF0ZUFkKCExKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBZERhdGEodGhpcy5hZERhdGEuaW1nVXJsTGlzdFswXSwgdGhpcy5hZERhdGEudGl0bGUsIHRoaXMuYWREYXRhLmRlc2MpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMucmVwb3J0QWRTaG93KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRJZDogdGhpcy5hZERhdGEuYWRJZC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICAgICAgICAgOiAoY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuato+WcqOWKoOi9veS4re+8jOeojeetiVwiKSwgdm9pZCAodGhpcy5pc0F1dG9TaG93ID0gITApKVxyXG4gICAgICAgICAgICAgICAgOiAoY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuaXoOaVsOaNruaJp+ihjOmHjeW7ulwiKSwgdGhpcy5yZUNyZWF0ZUFkKCEwKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrlvZPliY3lub/lkYrnpoHmraLmmL7npLpcIik7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZm9yYmlkZGVuTmF0aXZlQWQgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHRoaXMuaXNDYW5TaG93ID0gIXQ7XHJcbiAgICAgICAgaWYgKHQgJiYgdGhpcy5pc0NvbnN1bWUpIHtcclxuICAgICAgICAgICAgdGhpcy5oaWRlTmF0aXZlQWQoITEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5oaWRlTmF0aXZlQWQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGUgJiYgdGhpcy5pc0NvbnN1bWUgPyAodGhpcy5kZXN0cm95QWQoKSwgdGhpcy5yZUNyZWF0ZUFkKCExKSkgOiB0LnByb3RvdHlwZS5kZXN0cm95TmF0aXZlQWROb2RlLmNhbGwodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYWREYXRhID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5hZElucykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZMb2FkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZkxvYWQodGhpcy5vbkxvYWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZkVycm9yKHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMuZGVzdHJveSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5hZElucyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLmF1dG9TaG93ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQXV0b1Nob3cpIHtcclxuICAgICAgICAgICAgdGhpcy5pc0F1dG9TaG93ID0gITE7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd05hdGl2ZUFkKHRoaXMuYWRWaWV3TmFtZSwgdGhpcy5zaG93Q2FsbGJhY2ssIHRoaXMuZXJyb3JDYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm9uQWRMb2FkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkTG9hZC5jYWxsKHRoaXMsIGUpO1xyXG4gICAgICAgIHRoaXMuaXNDb25zdW1lID0gITE7XHJcbiAgICAgICAgdGhpcy5pc0xvYWRlZCA9ICEwO1xyXG4gICAgICAgIGlmIChlICYmIGUuYWRMaXN0ICYmIGUuYWRMaXN0Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdmFyIGkgPSBlLmFkTGlzdC5wb3AoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCLlub/lkYrlj4LmlbA6XCIsIGkpO1xyXG4gICAgICAgICAgICB0aGlzLmFkRGF0YSA9IGk7XHJcbiAgICAgICAgICAgIHRoaXMuYXV0b1Nob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZEVycm9yID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkRXJyb3IuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwib25BZEVycm9yXCIsIHRoaXMuYWRVbml0SWQsIGUpO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZENsb3NlID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICB0LnByb3RvdHlwZS5vbkFkQ2xvc2UuY2FsbCh0aGlzLCBlKTtcclxuICAgICAgICB0aGlzLmRlc3Ryb3lOYXRpdmVBZE5vZGUoKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gZTtcclxufSkoJGJhc2VBZE5vZGUuZGVmYXVsdCk7XHJcbmV4cG9ydHMuT1BQT05hdGl2ZUFkID0gYTtcclxuIl19