{"version":3,"sources":["assets\\game_script\\scripts\\Gun_9.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$seedUtil","$util","$configContext","$globalParam","$localEventName","$baseBullet","$gameContext","$gameGemInfo","$gameSkillInfo","$baseGun","k","cc","Vec3","ZERO","v","t","e","i","call","skillId","skillParam","ins","skillInfo","getSkillById","__extends","prototype","updateF","isAttacking","isGamePuase","timeLeft","skillCD","Skill4Param","FINAL","send","RENDER_SKILL_CD_INFO","starGun","getRangeRankEnemy","pointNode","skillAtkRange","windBladeMulti","sendBullet1","sendbullet2","getRandomPos","getPosition","sub","createButtle","schedulesOnce","getRandomEnemy","node","parent","windBladeMultiTime","probability","x","randomFrom","y","winSize","height","windBladeSpeed","n","windBladeComboCount","GameGemInfo","hasGem","GemType","AddSkill","get1","s","position","r","dirConverAngle","windBladeParallelCount","angleConverDir","getButtlePool","BulletType","wind_blade","instance","getRes","BundleNames","Game","AssetsMap","GameBundles","prefabs","assetsList","Bullet_22","ResUtil","instantiate","buttleLayer","getComponent","skillSpecialitys","basicSkillConfigMap","get","skill_tpye","setPosition","initButtle","normalize","insert","setAnimation","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $baseBullet = require(\"./BaseBullet\");\r\nvar $gameContext = require(\"./GameContext\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $baseGun = require(\"./BaseGun\");\r\nvar k = cc.Vec3.ZERO;\r\nvar v = (function (t) {\r\n    function e(e) {\r\n        var i = t.call(this, e) || this;\r\n        i.skillId = 209;\r\n        i.skillParam = $gameContext.default.ins.skillInfo.getSkillById(i.skillId);\r\n        return i;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.updateF = function (e) {\r\n        t.prototype.updateF.call(this, e);\r\n        if (!(this.isAttacking || $globalParam.default.isGamePuase)) {\r\n            this.timeLeft -= e;\r\n            this.timeLeft <= 0\r\n                ? ((this.isAttacking = !0),\r\n                  (this.timeLeft = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL]),\r\n                  $eventManager.default.send($localEventName.default.RENDER_SKILL_CD_INFO, this.skillId, 0, -1),\r\n                  this.starGun() || ((this.isAttacking = !1), (this.timeLeft = 0)))\r\n                : $eventManager.default.send(\r\n                      $localEventName.default.RENDER_SKILL_CD_INFO,\r\n                      this.skillId,\r\n                      this.timeLeft / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL],\r\n                      -1\r\n                  );\r\n        }\r\n    };\r\n    e.prototype.starGun = function () {\r\n        var t = $gameContext.default.ins.getRangeRankEnemy(\r\n            this.pointNode,\r\n            this.skillParam.skillAtkRange[$gameSkillInfo.Skill4Param.FINAL]\r\n        );\r\n        return (\r\n            !!t &&\r\n            (this.skillParam.windBladeMulti <= 0 ? this.sendBullet1(t) : this.sendbullet2(t),\r\n            (this.isAttacking = !1),\r\n            !0)\r\n        );\r\n    };\r\n    e.prototype.sendbullet2 = function (t) {\r\n        var e = this;\r\n        this.getRandomPos();\r\n        var i = t.getPosition().sub(k);\r\n        this.createButtle(i, k);\r\n        for (var o = 1; o < this.skillParam.windBladeMulti; o++) {\r\n            this.schedulesOnce(function () {\r\n                var t = $gameContext.default.ins.getRandomEnemy();\r\n                if (t && t.node.parent) {\r\n                    e.getRandomPos();\r\n                    var i = t.getPosition().sub(k);\r\n                    e.createButtle(i, k);\r\n                }\r\n            }, o * this.skillParam.windBladeMultiTime);\r\n        }\r\n    };\r\n    e.prototype.getRandomPos = function () {\r\n        $seedUtil.default.probability(50)\r\n            ? ((k.x = $seedUtil.default.randomFrom(-460, 460)), (k.y = -cc.winSize.height / 2 - 150))\r\n            : ((k.x = $seedUtil.default.probability(50) ? -460 : 460),\r\n              (k.y = -$seedUtil.default.randomFrom(0, cc.winSize.height / 2 + 150)));\r\n    };\r\n    e.prototype.sendBullet1 = function (t) {\r\n        var e = this;\r\n        var i = 150 / this.skillParam.windBladeSpeed;\r\n        var o = 0;\r\n        var n = this.skillParam.windBladeComboCount + 1;\r\n        if (\r\n            $gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) &&\r\n            $seedUtil.default.probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))\r\n        ) {\r\n            n *= 2;\r\n        }\r\n        var s = t.getPosition().sub(this.pointNode.position);\r\n        k.x = this.pointNode.position.x;\r\n        k.y = this.pointNode.position.y;\r\n        for (var r = 0; r < n; r++) {\r\n            this.schedulesOnce(function () {\r\n                e.createButtle(s, k);\r\n                var t = $util.default.dirConverAngle(s);\r\n                if (e.skillParam.windBladeParallelCount >= 1) {\r\n                    e.createButtle($util.default.angleConverDir(t + 15), k);\r\n                }\r\n                if (e.skillParam.windBladeParallelCount >= 2) {\r\n                    e.createButtle($util.default.angleConverDir(t - 15), k);\r\n                }\r\n                if (++o === n) {\r\n                    e.isAttacking = !1;\r\n                }\r\n            }, i * r);\r\n        }\r\n    };\r\n    e.prototype.createButtle = function (t, e) {\r\n        var i = $gameContext.default.ins.getButtlePool($baseBullet.BulletType.wind_blade);\r\n        if (!i) {\r\n            var o = $assetsLoader.default.instance.getRes(\r\n                $assetsMap.BundleNames.Game,\r\n                $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_22\r\n            );\r\n            (i = $resUtil.ResUtil.instantiate(o, $gameContext.default.ins.buttleLayer.parent).getComponent(\r\n                $baseBullet.default\r\n            )).skillSpecialitys = $configContext.default.instance.basicSkillConfigMap.get(this.skillId).skill_tpye;\r\n        }\r\n        i.setPosition(e);\r\n        i.initButtle(t.normalize(), this.skillId);\r\n        i.insert($gameContext.default.ins.buttleLayer);\r\n        i.setAnimation(\"\");\r\n    };\r\n    return e;\r\n})($baseGun.default);\r\nexports.default = v;\r\n"]}