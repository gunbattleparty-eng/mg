
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/WechatBanner.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e5475T9dTtDI7HjmXxBPnBZ', 'WechatBanner');
// game_script/scripts/WechatBanner.js

"use strict";

var o;
exports.WechatBanner = void 0;

var $aDConfig = require("./ADConfig");

var $baseAd = require("./BaseAd");

var a = window.wx;

var l = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.isOpenPreLoad = !1;
    e.style = null;
    return e;
  }

  __extends(e, t);

  e.prototype.loadAd = function () {
    if (this.adUnitId) {
      if (a && a.createBannerAd) {
        var t = this.style || {};
        var e = {
          adUnitId: this.adUnitId,
          style: {
            left: t.left || 0,
            top: t.top || 0,
            width: t.width || $aDConfig.ADConfig.oppo.banner_width,
            height: 100
          }
        };
        this.adIns = a.createBannerAd(e);

        if (this.adIns.onLoad) {
          this.adIns.onLoad(this.onLoad);
        }

        if (this.adIns.onHide) {
          this.adIns.onHide(this.onHide);
        }

        if (this.adIns.onResize) {
          this.adIns.onResize(this.onResize);
        }

        if (this.adIns.onError) {
          this.adIns.onError(this.onError);
        }
      } else {
        console.warn("当前平台不支持创建banner");
      }
    } else {
      console.warn("Banner ID为空");
    }
  };

  e.prototype.showBanner = function (t, e, i) {
    var o = this;
    this.showCallback = e;
    this.errorCallback = i;

    if (this.isCanShow) {
      if (!this.adIns) {
        console.warn(this.adUnitId, ":未创建，执行创建");
        this.isAutoShow = !0;
        return void this.loadAd();
      }

      if (this.isConsume) {
        return this.reCreateAd(!0);
      }

      if (!this.isLoaded) {
        console.warn(this.adUnitId, ":未加载完成，稍等");
        return void (this.isAutoShow = !0);
      }

      if (this.adIns && t) {
        if (void 0 !== t.top) {
          this.adIns.style.top = t.top;
        }

        if (void 0 !== t.left) {
          this.adIns.style.left = t.left;
        }

        if (void 0 !== t.width) {
          this.adIns.style.width = t.width;
        }
      }

      this.showing = !1;
      this.isConsume = !1;

      if (this.adIns.show) {
        var n = this.adIns.show();
        n && n.then ? n.then(function () {
          o.isConsume = !0;
          o.showing = !0;

          if (o.showCallback) {
            o.showCallback();
          }

          o.showCallback = null;
        })["catch"](function (t) {
          console.warn(o.adUnitId, ":执行显示错误错误，重新加载", t);
          o.reCreateAd(!0);
        }) : (console.warn(this.adUnitId, ":执行显示错误显示失败，重新加载"), this.reCreateAd(!0));
      }
    } else {
      console.warn(this.adUnitId, ":当前广告禁止显示");
    }
  };

  e.prototype.autoShow = function () {
    if (this.isAutoShow) {
      this.isAutoShow = !1;
      this.showBanner(this.style, this.showCallback, this.errorCallback);
    }
  };

  e.prototype.onAdLoad = function () {
    console.log(this.adUnitId, ":===onAdload===");
    this.isConsume = !1;
    this.isLoaded = !0;
    this.autoShow();
  };

  e.prototype.onAdError = function (t) {
    console.error("onAdError", this.adUnitId, t);

    if (this.errorCallback) {
      this.errorCallback();
    }

    this.destroyAd();
  };

  e.prototype.onAdResize = function (t) {
    console.log("onBannerResize", t);
    var e = a.getSystemInfoSync();
    var i = e.windowWidth;
    var o = e.windowHeight;
    var n = this.style || {};
    null != n.top ? this.adIns.style.top = n.top : this.adIns.style.top = Math.round(o - t.height + 0.1);
    null != n.left ? this.adIns.style.left = n.left : this.adIns.style.left = Math.round((i - t.width) / 2 + 0.1);
  };

  e.prototype.destroyAd = function () {
    t.prototype.destroyAd.call(this);

    if (this.adIns) {
      if (this.adIns.offLoad) {
        this.adIns.offLoad(this.onLoad);
      }

      if (this.adIns.offResize) {
        this.adIns.offResize(this.onResize);
      }

      if (this.adIns.offError) {
        this.adIns.offError(this.onError);
      }

      if (this.adIns.destroy) {
        this.adIns.destroy();
      }

      this.adIns = null;
    }
  };

  return e;
}($baseAd.BaseAd);

exports.WechatBanner = l;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXFdlY2hhdEJhbm5lci5qcyJdLCJuYW1lcyI6WyJvIiwiZXhwb3J0cyIsIldlY2hhdEJhbm5lciIsIiRhRENvbmZpZyIsInJlcXVpcmUiLCIkYmFzZUFkIiwiYSIsIndpbmRvdyIsInd4IiwibCIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJpc09wZW5QcmVMb2FkIiwic3R5bGUiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJsb2FkQWQiLCJhZFVuaXRJZCIsImNyZWF0ZUJhbm5lckFkIiwibGVmdCIsInRvcCIsIndpZHRoIiwiQURDb25maWciLCJvcHBvIiwiYmFubmVyX3dpZHRoIiwiaGVpZ2h0IiwiYWRJbnMiLCJvbkxvYWQiLCJvbkhpZGUiLCJvblJlc2l6ZSIsIm9uRXJyb3IiLCJjb25zb2xlIiwid2FybiIsInNob3dCYW5uZXIiLCJpIiwic2hvd0NhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsImlzQ2FuU2hvdyIsImlzQXV0b1Nob3ciLCJpc0NvbnN1bWUiLCJyZUNyZWF0ZUFkIiwiaXNMb2FkZWQiLCJzaG93aW5nIiwic2hvdyIsIm4iLCJ0aGVuIiwiYXV0b1Nob3ciLCJvbkFkTG9hZCIsImxvZyIsIm9uQWRFcnJvciIsImVycm9yIiwiZGVzdHJveUFkIiwib25BZFJlc2l6ZSIsImdldFN5c3RlbUluZm9TeW5jIiwid2luZG93V2lkdGgiLCJ3aW5kb3dIZWlnaHQiLCJNYXRoIiwicm91bmQiLCJjYWxsIiwib2ZmTG9hZCIsIm9mZlJlc2l6ZSIsIm9mZkVycm9yIiwiZGVzdHJveSIsIkJhc2VBZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxJQUFJQSxDQUFKO0FBQ0FDLE9BQU8sQ0FBQ0MsWUFBUixHQUF1QixLQUFLLENBQTVCOztBQUNBLElBQUlDLFNBQVMsR0FBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMs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LEtBQUwsQ0FBV2lDLE9BQWYsRUFBd0I7UUFDcEIsS0FBS2pDLEtBQUwsQ0FBV2lDLE9BQVgsQ0FBbUIsS0FBS2hDLE1BQXhCO01BQ0g7O01BQ0QsSUFBSSxLQUFLRCxLQUFMLENBQVdrQyxTQUFmLEVBQTBCO1FBQ3RCLEtBQUtsQyxLQUFMLENBQVdrQyxTQUFYLENBQXFCLEtBQUsvQixRQUExQjtNQUNIOztNQUNELElBQUksS0FBS0gsS0FBTCxDQUFXbUMsUUFBZixFQUF5QjtRQUNyQixLQUFLbkMsS0FBTCxDQUFXbUMsUUFBWCxDQUFvQixLQUFLL0IsT0FBekI7TUFDSDs7TUFDRCxJQUFJLEtBQUtKLEtBQUwsQ0FBV29DLE9BQWYsRUFBd0I7UUFDcEIsS0FBS3BDLEtBQUwsQ0FBV29DLE9BQVg7TUFDSDs7TUFDRCxLQUFLcEMsS0FBTCxHQUFhLElBQWI7SUFDSDtFQUNKLENBakJEOztFQWtCQSxPQUFPakIsQ0FBUDtBQUNILENBOUlPLENBOElMTixPQUFPLENBQUM0RCxNQTlJSCxDQUFSOztBQStJQWhFLE9BQU8sQ0FBQ0MsWUFBUixHQUF1Qk8sQ0FBdkIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG5leHBvcnRzLldlY2hhdEJhbm5lciA9IHZvaWQgMDtcclxudmFyICRhRENvbmZpZyA9IHJlcXVpcmUoXCIuL0FEQ29uZmlnXCIpO1xyXG52YXIgJGJhc2VBZCA9IHJlcXVpcmUoXCIuL0Jhc2VBZFwiKTtcclxudmFyIGEgPSB3aW5kb3cud3g7XHJcbnZhciBsID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuaXNPcGVuUHJlTG9hZCA9ICExO1xyXG4gICAgICAgIGUuc3R5bGUgPSBudWxsO1xyXG4gICAgICAgIHJldHVybiBlO1xyXG4gICAgfVxyXG4gICAgX19leHRlbmRzKGUsIHQpO1xyXG4gICAgZS5wcm90b3R5cGUubG9hZEFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmFkVW5pdElkKSB7XHJcbiAgICAgICAgICAgIGlmIChhICYmIGEuY3JlYXRlQmFubmVyQWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5zdHlsZSB8fCB7fTtcclxuICAgICAgICAgICAgICAgIHZhciBlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFkVW5pdElkOiB0aGlzLmFkVW5pdElkLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IHQubGVmdCB8fCAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3A6IHQudG9wIHx8IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB0LndpZHRoIHx8ICRhRENvbmZpZy5BRENvbmZpZy5vcHBvLmJhbm5lcl93aWR0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucyA9IGEuY3JlYXRlQmFubmVyQWQoZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vbkxvYWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vbkhpZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9uSGlkZSh0aGlzLm9uSGlkZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vblJlc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub25SZXNpemUodGhpcy5vblJlc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hZElucy5vbkVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5vbkVycm9yKHRoaXMub25FcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLlvZPliY3lubPlj7DkuI3mlK/mjIHliJvlu7piYW5uZXJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJCYW5uZXIgSUTkuLrnqbpcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnNob3dCYW5uZXIgPSBmdW5jdGlvbiAodCwgZSwgaSkge1xyXG4gICAgICAgIHZhciBvID0gdGhpcztcclxuICAgICAgICB0aGlzLnNob3dDYWxsYmFjayA9IGU7XHJcbiAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrID0gaTtcclxuICAgICAgICBpZiAodGhpcy5pc0NhblNob3cpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yib5bu677yM5omn6KGM5Yib5bu6XCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc0F1dG9TaG93ID0gITA7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCB0aGlzLmxvYWRBZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzQ29uc3VtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVDcmVhdGVBZCghMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzTG9hZGVkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4odGhpcy5hZFVuaXRJZCwgXCI65pyq5Yqg6L295a6M5oiQ77yM56iN562JXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgKHRoaXMuaXNBdXRvU2hvdyA9ICEwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucyAmJiB0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LnRvcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuc3R5bGUudG9wID0gdC50b3A7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LmxlZnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLnN0eWxlLmxlZnQgPSB0LmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSB0LndpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZElucy5zdHlsZS53aWR0aCA9IHQud2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5zaG93aW5nID0gITE7XHJcbiAgICAgICAgICAgIHRoaXMuaXNDb25zdW1lID0gITE7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLnNob3cpIHtcclxuICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcy5hZElucy5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBuICYmIG4udGhlblxyXG4gICAgICAgICAgICAgICAgICAgID8gblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5pc0NvbnN1bWUgPSAhMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93aW5nID0gITA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvLnNob3dDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5zaG93Q2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvLnNob3dDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKG8uYWRVbml0SWQsIFwiOuaJp+ihjOaYvuekuumUmeivr+mUmeivr++8jOmHjeaWsOWKoOi9vVwiLCB0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby5yZUNyZWF0ZUFkKCEwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIDogKGNvbnNvbGUud2Fybih0aGlzLmFkVW5pdElkLCBcIjrmiafooYzmmL7npLrplJnor6/mmL7npLrlpLHotKXvvIzph43mlrDliqDovb1cIiksIHRoaXMucmVDcmVhdGVBZCghMCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKHRoaXMuYWRVbml0SWQsIFwiOuW9k+WJjeW5v+WRiuemgeatouaYvuekulwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuYXV0b1Nob3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNBdXRvU2hvdykge1xyXG4gICAgICAgICAgICB0aGlzLmlzQXV0b1Nob3cgPSAhMTtcclxuICAgICAgICAgICAgdGhpcy5zaG93QmFubmVyKHRoaXMuc3R5bGUsIHRoaXMuc2hvd0NhbGxiYWNrLCB0aGlzLmVycm9yQ2FsbGJhY2spO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5vbkFkTG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmFkVW5pdElkLCBcIjo9PT1vbkFkbG9hZD09PVwiKTtcclxuICAgICAgICB0aGlzLmlzQ29uc3VtZSA9ICExO1xyXG4gICAgICAgIHRoaXMuaXNMb2FkZWQgPSAhMDtcclxuICAgICAgICB0aGlzLmF1dG9TaG93KCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZEVycm9yID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwib25BZEVycm9yXCIsIHRoaXMuYWRVbml0SWQsIHQpO1xyXG4gICAgICAgIGlmICh0aGlzLmVycm9yQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvckNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZGVzdHJveUFkKCk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUub25BZFJlc2l6ZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkJhbm5lclJlc2l6ZVwiLCB0KTtcclxuICAgICAgICB2YXIgZSA9IGEuZ2V0U3lzdGVtSW5mb1N5bmMoKTtcclxuICAgICAgICB2YXIgaSA9IGUud2luZG93V2lkdGg7XHJcbiAgICAgICAgdmFyIG8gPSBlLndpbmRvd0hlaWdodDtcclxuICAgICAgICB2YXIgbiA9IHRoaXMuc3R5bGUgfHwge307XHJcbiAgICAgICAgbnVsbCAhPSBuLnRvcCA/ICh0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IG4udG9wKSA6ICh0aGlzLmFkSW5zLnN0eWxlLnRvcCA9IE1hdGgucm91bmQobyAtIHQuaGVpZ2h0ICsgMC4xKSk7XHJcbiAgICAgICAgbnVsbCAhPSBuLmxlZnRcclxuICAgICAgICAgICAgPyAodGhpcy5hZElucy5zdHlsZS5sZWZ0ID0gbi5sZWZ0KVxyXG4gICAgICAgICAgICA6ICh0aGlzLmFkSW5zLnN0eWxlLmxlZnQgPSBNYXRoLnJvdW5kKChpIC0gdC53aWR0aCkgLyAyICsgMC4xKSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuZGVzdHJveUFkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHQucHJvdG90eXBlLmRlc3Ryb3lBZC5jYWxsKHRoaXMpO1xyXG4gICAgICAgIGlmICh0aGlzLmFkSW5zKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLm9mZkxvYWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMub2ZmTG9hZCh0aGlzLm9uTG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMuYWRJbnMub2ZmUmVzaXplKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkSW5zLm9mZlJlc2l6ZSh0aGlzLm9uUmVzaXplKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5hZElucy5vZmZFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZElucy5vZmZFcnJvcih0aGlzLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFkSW5zLmRlc3Ryb3kpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRJbnMuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuYWRJbnMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gZTtcclxufSkoJGJhc2VBZC5CYXNlQWQpO1xyXG5leHBvcnRzLldlY2hhdEJhbm5lciA9IGw7XHJcbiJdfQ==