
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Enemy_27.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'e2398Yal6ZOjIyts8F45Omc', 'Enemy_27');
// game_script/scripts/Enemy_27.js

"use strict";

var o;

var $assetsMap = require("./AssetsMap");

var $resManager = require("./ResManager");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $gamePool = require("./GamePool");

var $localEventName = require("./LocalEventName");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $baseEnemy = require("./BaseEnemy");

var $healthBar = require("./HealthBar");

var y = cc._decorator;
var g = y.ccclass;
var _ = y.property;

var k = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.healthBar = null;
    e.invulnerabilityCount = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.initEnemy = function (e, i, o) {
    if (void 0 === o) {
      o = 0;
    }

    t.prototype.initEnemy.call(this, e, i, o);
    this.statusManager.specialityAtkAdd.set($baseBullet.BulletSpeciality.physics, this.config.value[0]);
    this.statusManager.specialityAtkAdd.set($baseBullet.BulletSpeciality.energy, this.config.value[1]);
    this.invulnerabilityCount = this.config.value[2];

    if (this.healthBar) {
      this.healthBar.init(this.statusManager.hp, e.hp_num);
    }
  };

  e.prototype.sufferDebuff = function (e) {
    if (!(this.invulnerabilityCount > 0)) {
      t.prototype.sufferDebuff.call(this, e);
    }
  };

  e.prototype.playShield = function () {
    var t = $gamePool["default"].instance.get($gamePool.PoolKey.Shield);

    if (!t) {
      t = $resUtil.ResUtil.instantiate($resManager.ResManager.instance.get($assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Shield), $gameContext["default"].ins.enemyLayer.parent);
    }

    t.parent = $gameContext["default"].ins.debuffLayer;
    t.zIndex = this.node.zIndex;
    t.setPosition(this.getPosition().add(this.debuffLayer.position));
    t.scale = this.debuffLayer.scale;
    var e = this.getAnimPos();
    $eventManager["default"].send($localEventName["default"].HURT_ANIM, e, -1, 1);
    var i = t.getComponentInChildren(cc.Animation);
    i.play().speed = $gameContext["default"].ins.gameRatio;
    i.on(cc.Animation.EventType.FINISHED, function () {
      $gamePool["default"].instance.put($gamePool.PoolKey.Shield, t);
    }, this);
  };

  e.prototype.sufferAtk = function (e) {
    return this.invulnerabilityCount > 0 ? (this.invulnerabilityCount--, this.playShield(), !1) : t.prototype.sufferAtk.call(this, e);
  };

  e.prototype.sufferAttack = function (e, i) {
    if (this.statusManager.isDie) {
      return !1;
    }

    var o = t.prototype.sufferAttack.call(this, e, i);

    if (this.healthBar) {
      this.healthBar.render(this.statusManager.hp);
    }

    return o;
  };

  __decorate([_($healthBar["default"])], e.prototype, "healthBar", void 0);

  return __decorate([g], e);
}($baseEnemy["default"]);

exports["default"] = k;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEVuZW15XzI3LmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTWFwIiwicmVxdWlyZSIsIiRyZXNNYW5hZ2VyIiwiJHJlc1V0aWwiLCIkZXZlbnRNYW5hZ2VyIiwiJGdhbWVQb29sIiwiJGxvY2FsRXZlbnROYW1lIiwiJGJhc2VCdWxsZXQiLCIkZ2FtZUNvbnRleHQiLCIkYmFzZUVuZW15IiwiJGhlYWx0aEJhciIsInkiLCJjYyIsIl9kZWNvcmF0b3IiLCJnIiwiY2NjbGFzcyIsIl8iLCJwcm9wZXJ0eSIsImsiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwiaGVhbHRoQmFyIiwiaW52dWxuZXJhYmlsaXR5Q291bnQiLCJfX2V4dGVuZHMiLCJwcm90b3R5cGUiLCJpbml0RW5lbXkiLCJpIiwiY2FsbCIsInN0YXR1c01hbmFnZXIiLCJzcGVjaWFsaXR5QXRrQWRkIiwic2V0IiwiQnVsbGV0U3BlY2lhbGl0eSIsInBoeXNpY3MiLCJjb25maWciLCJ2YWx1ZSIsImVuZXJneSIsImluaXQiLCJocCIsImhwX251bSIsInN1ZmZlckRlYnVmZiIsInBsYXlTaGllbGQiLCJpbnN0YW5jZSIsImdldCIsIlBvb2xLZXkiLCJTaGllbGQiLCJSZXNVdGlsIiwiaW5zdGFudGlhdGUiLCJSZXNNYW5hZ2VyIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsImlucyIsImVuZW15TGF5ZXIiLCJwYXJlbnQiLCJkZWJ1ZmZMYXllciIsInpJbmRleCIsIm5vZGUiLCJzZXRQb3NpdGlvbiIsImdldFBvc2l0aW9uIiwiYWRkIiwicG9zaXRpb24iLCJzY2FsZSIsImdldEFuaW1Qb3MiLCJzZW5kIiwiSFVSVF9BTklNIiwiZ2V0Q29tcG9uZW50SW5DaGlsZHJlbiIsIkFuaW1hdGlvbiIsInBsYXkiLCJzcGVlZCIsImdhbWVSYXRpbyIsIm9uIiwiRXZlbnRUeXBlIiwiRklOSVNIRUQiLCJwdXQiLCJzdWZmZXJBdGsiLCJzdWZmZXJBdHRhY2siLCJpc0RpZSIsInJlbmRlciIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsVUFBVSxHQUFHQyxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJQyxXQUFXLEdBQUdELE9BQU8sQ0FBQyxjQUFELENBQXpCOztBQUNBLElBQUlFLFFBQVEsR0FBR0YsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUcsYUFBYSxHQUFHSCxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUksU0FBUyxHQUFHSixPQUFPLENBQUMsWUFBRCxDQUF2Qjs7QUFDQSxJQUFJSyxlQUFlLEdBQUdMLE9BQU8sQ0FBQyxrQkFBRCxDQUE3Qjs7QUFDQSxJQUFJTSxXQUFXLEdBQUdOLE9BQU8sQ0FBQyxjQUFELENBQXpCOztBQUNBLElBQUlPLFlBQVksR0FBR1AsT0FBTyxDQUFDLGVBQUQsQ0FBMUI7O0FBQ0EsSUFBSVEsVUFBVSxHQUFHUixPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJUyxVQUFVLEdBQUdULE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlVLENBQUMsR0FBR0MsRUFBRSxDQUFDQyxVQUFYO0FBQ0EsSUFBSUMsQ0FBQyxHQUFHSCxDQUFDLENBQUNJLE9BQVY7QUFDQSxJQUFJQyxDQUFDLEdBQUdMLENBQUMsQ0FBQ00sUUFBVjs7QUFDQSxJQUFJQyxDQUFDLEdBQUksVUFBVUMsQ0FBVixFQUFhO0VBQ2xCLFNBQVNDLENBQVQsR0FBYTtJQUNULElBQUlBLENBQUMsR0FBSSxTQUFTRCxDQUFULElBQWNBLENBQUMsQ0FBQ0UsS0FBRixDQUFRLElBQVIsRUFBY0MsU0FBZCxDQUFmLElBQTRDLElBQXBEO0lBQ0FGLENBQUMsQ0FBQ0csU0FBRixHQUFjLElBQWQ7SUFDQUgsQ0FBQyxDQUFDSSxvQkFBRixHQUF5QixDQUF6QjtJQUNBLE9B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Q0FBbUJTLEVBQXpDO0lBQ0g7O0lBQ0QsT0FBT3hDLENBQVA7RUFDSCxDQVREOztFQVVBa0YsVUFBVSxDQUFDLENBQUNqRSxDQUFDLENBQUNOLFVBQVUsV0FBWCxDQUFGLENBQUQsRUFBMEJVLENBQUMsQ0FBQ00sU0FBNUIsRUFBdUMsV0FBdkMsRUFBb0QsS0FBSyxDQUF6RCxDQUFWOztFQUNBLE9BQU91RCxVQUFVLENBQUMsQ0FBQ25FLENBQUQsQ0FBRCxFQUFNTSxDQUFOLENBQWpCO0FBQ0gsQ0FsRU8sQ0FrRUxYLFVBQVUsV0FsRUwsQ0FBUjs7QUFtRUF5RSxPQUFPLFdBQVAsR0FBa0JoRSxDQUFsQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG87XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc01hbmFnZXIgPSByZXF1aXJlKFwiLi9SZXNNYW5hZ2VyXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGV2ZW50TWFuYWdlciA9IHJlcXVpcmUoXCIuL0V2ZW50TWFuYWdlclwiKTtcclxudmFyICRnYW1lUG9vbCA9IHJlcXVpcmUoXCIuL0dhbWVQb29sXCIpO1xyXG52YXIgJGxvY2FsRXZlbnROYW1lID0gcmVxdWlyZShcIi4vTG9jYWxFdmVudE5hbWVcIik7XHJcbnZhciAkYmFzZUJ1bGxldCA9IHJlcXVpcmUoXCIuL0Jhc2VCdWxsZXRcIik7XHJcbnZhciAkZ2FtZUNvbnRleHQgPSByZXF1aXJlKFwiLi9HYW1lQ29udGV4dFwiKTtcclxudmFyICRiYXNlRW5lbXkgPSByZXF1aXJlKFwiLi9CYXNlRW5lbXlcIik7XHJcbnZhciAkaGVhbHRoQmFyID0gcmVxdWlyZShcIi4vSGVhbHRoQmFyXCIpO1xyXG52YXIgeSA9IGNjLl9kZWNvcmF0b3I7XHJcbnZhciBnID0geS5jY2NsYXNzO1xyXG52YXIgXyA9IHkucHJvcGVydHk7XHJcbnZhciBrID0gKGZ1bmN0aW9uICh0KSB7XHJcbiAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgIHZhciBlID0gKG51bGwgIT09IHQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB8fCB0aGlzO1xyXG4gICAgICAgIGUuaGVhbHRoQmFyID0gbnVsbDtcclxuICAgICAgICBlLmludnVsbmVyYWJpbGl0eUNvdW50ID0gMDtcclxuICAgICAgICByZXR1cm4gZTtcclxuICAgIH1cclxuICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgIGUucHJvdG90eXBlLmluaXRFbmVteSA9IGZ1bmN0aW9uIChlLCBpLCBvKSB7XHJcbiAgICAgICAgaWYgKHZvaWQgMCA9PT0gbykge1xyXG4gICAgICAgICAgICBvID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdC5wcm90b3R5cGUuaW5pdEVuZW15LmNhbGwodGhpcywgZSwgaSwgbyk7XHJcbiAgICAgICAgdGhpcy5zdGF0dXNNYW5hZ2VyLnNwZWNpYWxpdHlBdGtBZGQuc2V0KCRiYXNlQnVsbGV0LkJ1bGxldFNwZWNpYWxpdHkucGh5c2ljcywgdGhpcy5jb25maWcudmFsdWVbMF0pO1xyXG4gICAgICAgIHRoaXMuc3RhdHVzTWFuYWdlci5zcGVjaWFsaXR5QXRrQWRkLnNldCgkYmFzZUJ1bGxldC5CdWxsZXRTcGVjaWFsaXR5LmVuZXJneSwgdGhpcy5jb25maWcudmFsdWVbMV0pO1xyXG4gICAgICAgIHRoaXMuaW52dWxuZXJhYmlsaXR5Q291bnQgPSB0aGlzLmNvbmZpZy52YWx1ZVsyXTtcclxuICAgICAgICBpZiAodGhpcy5oZWFsdGhCYXIpIHtcclxuICAgICAgICAgICAgdGhpcy5oZWFsdGhCYXIuaW5pdCh0aGlzLnN0YXR1c01hbmFnZXIuaHAsIGUuaHBfbnVtKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc3VmZmVyRGVidWZmID0gZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBpZiAoISh0aGlzLmludnVsbmVyYWJpbGl0eUNvdW50ID4gMCkpIHtcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUuc3VmZmVyRGVidWZmLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLnBsYXlTaGllbGQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHQgPSAkZ2FtZVBvb2wuZGVmYXVsdC5pbnN0YW5jZS5nZXQoJGdhbWVQb29sLlBvb2xLZXkuU2hpZWxkKTtcclxuICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgdCA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoXHJcbiAgICAgICAgICAgICAgICAkcmVzTWFuYWdlci5SZXNNYW5hZ2VyLmluc3RhbmNlLmdldCgkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuU2hpZWxkKSxcclxuICAgICAgICAgICAgICAgICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5lbmVteUxheWVyLnBhcmVudFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0LnBhcmVudCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5kZWJ1ZmZMYXllcjtcclxuICAgICAgICB0LnpJbmRleCA9IHRoaXMubm9kZS56SW5kZXg7XHJcbiAgICAgICAgdC5zZXRQb3NpdGlvbih0aGlzLmdldFBvc2l0aW9uKCkuYWRkKHRoaXMuZGVidWZmTGF5ZXIucG9zaXRpb24pKTtcclxuICAgICAgICB0LnNjYWxlID0gdGhpcy5kZWJ1ZmZMYXllci5zY2FsZTtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuZ2V0QW5pbVBvcygpO1xyXG4gICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LkhVUlRfQU5JTSwgZSwgLTEsIDEpO1xyXG4gICAgICAgIHZhciBpID0gdC5nZXRDb21wb25lbnRJbkNoaWxkcmVuKGNjLkFuaW1hdGlvbik7XHJcbiAgICAgICAgaS5wbGF5KCkuc3BlZWQgPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuZ2FtZVJhdGlvO1xyXG4gICAgICAgIGkub24oXHJcbiAgICAgICAgICAgIGNjLkFuaW1hdGlvbi5FdmVudFR5cGUuRklOSVNIRUQsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRnYW1lUG9vbC5kZWZhdWx0Lmluc3RhbmNlLnB1dCgkZ2FtZVBvb2wuUG9vbEtleS5TaGllbGQsIHQpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zdWZmZXJBdGsgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmludnVsbmVyYWJpbGl0eUNvdW50ID4gMFxyXG4gICAgICAgICAgICA/ICh0aGlzLmludnVsbmVyYWJpbGl0eUNvdW50LS0sIHRoaXMucGxheVNoaWVsZCgpLCAhMSlcclxuICAgICAgICAgICAgOiB0LnByb3RvdHlwZS5zdWZmZXJBdGsuY2FsbCh0aGlzLCBlKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zdWZmZXJBdHRhY2sgPSBmdW5jdGlvbiAoZSwgaSkge1xyXG4gICAgICAgIGlmICh0aGlzLnN0YXR1c01hbmFnZXIuaXNEaWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICExO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbyA9IHQucHJvdG90eXBlLnN1ZmZlckF0dGFjay5jYWxsKHRoaXMsIGUsIGkpO1xyXG4gICAgICAgIGlmICh0aGlzLmhlYWx0aEJhcikge1xyXG4gICAgICAgICAgICB0aGlzLmhlYWx0aEJhci5yZW5kZXIodGhpcy5zdGF0dXNNYW5hZ2VyLmhwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG87XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbXygkaGVhbHRoQmFyLmRlZmF1bHQpXSwgZS5wcm90b3R5cGUsIFwiaGVhbHRoQmFyXCIsIHZvaWQgMCk7XHJcbiAgICByZXR1cm4gX19kZWNvcmF0ZShbZ10sIGUpO1xyXG59KSgkYmFzZUVuZW15LmRlZmF1bHQpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSBrO1xyXG4iXX0=