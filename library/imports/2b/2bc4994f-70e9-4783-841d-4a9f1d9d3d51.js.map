{"version":3,"sources":["assets\\game_script\\scripts\\GemInfoView.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$uIManager","$popupView","$guide","$remoteAudio","$configContext","$equipmentContext","$globalParam","$localEventName","$roleContext","$userDataContext","$gameGemInfo","$startView","w","cc","_decorator","A","ccclass","S","property","C","t","e","apply","arguments","infoList","gemIconSp","gemName","gemDesc","embedBtn","gemMask","changeMask","btnLock","gemId","names","partNames","config","__extends","prototype","onResetView","uiParam","param","currGemIdInfo","instance","gemConfigs","find","id","loadRes","BundleNames","Public","part","Grade","SpriteFrame","i","isValid","spriteFrame","ResUtil","assignWith","node","string","color","GameGemInfo","gemColor","ins","getGemDesc","getPackInfo","children","active","isLock","render","Ins","isEndGuide","guideStep","self","startGuideTest","getGemList","n","length","s","c","getComponent","Sprite","u","d","substring","Label","addEvent","on","Node","EventType","TOUCH_START","clickClose","_touchListener","setSwallowTouches","clickCloseChange","clickEmbed","touchItem","clickLock","removeEvent","off","hasSameGem","UIManager","showToast","indexOf","target","getPartAndIndexGemId","removeGem","setGem","send","RENDER_GEM","RENDER_DOT","MenuType","Role","onClickClose","call","convertToNodeSpaceAR","getLocation","y","stopPropagationImmediate","playEffectMusic","gemCount","lockAndUnlock","openAnim","closeAnim","tween","to","opacity","__decorate","PopupView","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $uIManager = require(\"./UIManager\");\r\nvar $popupView = require(\"./PopupView\");\r\nvar $guide = require(\"./Guide\");\r\nvar $remoteAudio = require(\"./RemoteAudio\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $equipmentContext = require(\"./EquipmentContext\");\r\nvar $globalParam = require(\"./GlobalParam\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $roleContext = require(\"./RoleContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar $startView = require(\"./StartView\");\r\nvar w = cc._decorator;\r\nvar A = w.ccclass;\r\nvar S = w.property;\r\nvar C = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.infoList = null;\r\n        e.gemIconSp = null;\r\n        e.gemName = null;\r\n        e.gemDesc = null;\r\n        e.embedBtn = null;\r\n        e.gemMask = null;\r\n        e.changeMask = null;\r\n        e.btnLock = null;\r\n        e.gemId = -1;\r\n        e.names = [\"普通\", \"精良\", \"稀有\", \"史诗\", \"传奇\", \"绝世\", \"神话\"];\r\n        e.partNames = [\"帽子\", \"上衣\", \"鞋子\", \"护臂\", \"裤子\", \"手套\"];\r\n        e.config = null;\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.onResetView = function () {\r\n        var t = this;\r\n        this.gemId = this.uiParam.param.gemId;\r\n        $globalParam.default.currGemIdInfo = this.gemId;\r\n        var e = $configContext.default.instance.gemConfigs.find(function (e) {\r\n            return e.id === t.gemId;\r\n        });\r\n        this.config = e;\r\n        $assetsLoader.default.instance.loadRes(\r\n            $assetsMap.BundleNames.Public,\r\n            [\"/textures/gem/g\" + e.part + \"_\" + e.Grade],\r\n            cc.SpriteFrame,\r\n            null,\r\n            function (e, i) {\r\n                var o = i[0];\r\n                if (o && cc.isValid(t.gemIconSp)) {\r\n                    t.gemIconSp.spriteFrame = $resUtil.ResUtil.assignWith(o, t.node);\r\n                }\r\n            }\r\n        );\r\n        this.gemName.string = this.partNames[e.part - 1] + \"·\" + this.names[e.Grade - 1] + \"宝石\";\r\n        this.gemName.node.color = $gameGemInfo.GameGemInfo.gemColor[e.Grade - 1];\r\n        this.gemDesc.string = $gameGemInfo.GameGemInfo.ins.getGemDesc(e);\r\n        var i = $roleContext.default.ins.getPackInfo(e.id);\r\n        this.btnLock.children[1].active = i.isLock;\r\n        this.render();\r\n        if (!$userDataContext.default.Ins.isEndGuide) {\r\n            $userDataContext.default.Ins.guideStep = 2;\r\n            $guide.default.self.startGuideTest(this.embedBtn, \"点击镶嵌\");\r\n        }\r\n    };\r\n    e.prototype.render = function () {\r\n        var t = this;\r\n        var e = $equipmentContext.default.Ins.getGemList(this.config.part);\r\n        var i = function (i) {\r\n            var n = o.infoList.children[i];\r\n            if (e && e.length > i && e[i]) {\r\n                var s = e[i];\r\n                n.children[0].active = !1;\r\n                n.children[1].active = !0;\r\n                var c = n.children[1].children[0].getComponent(cc.Sprite);\r\n                var u = $configContext.default.instance.gemConfigs.find(function (t) {\r\n                    return t.id === s;\r\n                });\r\n                $assetsLoader.default.instance.loadRes(\r\n                    $assetsMap.BundleNames.Public,\r\n                    [\"/textures/gem/g\" + u.part + \"_\" + u.Grade],\r\n                    cc.SpriteFrame,\r\n                    null,\r\n                    function (e, i) {\r\n                        var o = i[0];\r\n                        if (o && cc.isValid(c)) {\r\n                            c.spriteFrame = $resUtil.ResUtil.assignWith(o, t.node);\r\n                        }\r\n                    }\r\n                );\r\n                var d = $gameGemInfo.GameGemInfo.ins.getGemDesc(u);\r\n                if (d.length >= 19) {\r\n                    d = d.substring(0, 18) + \"...\";\r\n                }\r\n                n.children[1].children[1].getComponent(cc.Label).string = d;\r\n            } else {\r\n                n.children[0].active = !0;\r\n                n.children[1].active = !1;\r\n            }\r\n        };\r\n        var o = this;\r\n        for (var n = 0; n < 5; n++) {\r\n            i(n);\r\n        }\r\n    };\r\n    e.prototype.addEvent = function () {\r\n        this.gemMask.on(cc.Node.EventType.TOUCH_START, this.clickClose, this);\r\n        if (this.gemMask._touchListener) {\r\n            this.gemMask._touchListener.setSwallowTouches(!1);\r\n        }\r\n        this.changeMask.on(cc.Node.EventType.TOUCH_START, this.clickCloseChange, this);\r\n        if (this.changeMask._touchListener) {\r\n            this.gemMask._touchListener.setSwallowTouches(!1);\r\n        }\r\n        this.embedBtn.on(\"click\", this.clickEmbed, this);\r\n        for (var t = 0; t < this.infoList.children.length; t++) {\r\n            this.infoList.children[t].on(cc.Node.EventType.TOUCH_START, this.touchItem, this);\r\n        }\r\n        this.btnLock.on(cc.Node.EventType.TOUCH_START, this.clickLock, this);\r\n    };\r\n    e.prototype.removeEvent = function () {\r\n        this.gemMask.off(cc.Node.EventType.TOUCH_START, this.clickClose, this);\r\n        this.embedBtn.off(\"click\", this.clickEmbed, this);\r\n        this.changeMask.off(cc.Node.EventType.TOUCH_START, this.clickCloseChange, this);\r\n        for (var t = 0; t < this.infoList.children.length; t++) {\r\n            this.infoList.children[t].off(cc.Node.EventType.TOUCH_START, this.touchItem, this);\r\n        }\r\n        this.btnLock.off(cc.Node.EventType.TOUCH_START, this.clickLock, this);\r\n    };\r\n    e.prototype.touchItem = function (e) {\r\n        if ($equipmentContext.default.Ins.hasSameGem(this.config.part, this.config.id)) {\r\n            $uIManager.UIManager.instance.showToast(\"宝石已存在\");\r\n        } else {\r\n            {\r\n                var i = this.infoList.children.indexOf(e.target);\r\n                if (-1 === $equipmentContext.default.Ins.getPartAndIndexGemId(this.config.part, i)) {\r\n                    return this.clickEmbed();\r\n                }\r\n                $equipmentContext.default.Ins.removeGem(this.config.part, i);\r\n                $equipmentContext.default.Ins.setGem(this.config.part, this.config.id, i);\r\n                this.render();\r\n                $eventManager.default.send($localEventName.default.RENDER_GEM);\r\n                this.gemMask.active = !0;\r\n                this.changeMask.active = !1;\r\n                $uIManager.UIManager.instance.showToast(\"替换完成\");\r\n                $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.Role);\r\n                $globalParam.default.currGemIdInfo = -1;\r\n                t.prototype.onClickClose.call(this);\r\n            }\r\n        }\r\n    };\r\n    e.prototype.clickCloseChange = function (t) {\r\n        var e = this.changeMask.convertToNodeSpaceAR(t.getLocation());\r\n        if (e.y >= this.changeMask.children[2].y || e.y <= this.changeMask.children[3].y) {\r\n            this.gemMask.active = !0;\r\n            this.changeMask.active = !1;\r\n        }\r\n    };\r\n    e.prototype.clickClose = function (e) {\r\n        var i = this.gemMask.convertToNodeSpaceAR(e.getLocation());\r\n        if (i.y >= this.gemMask.children[0].y || i.y <= this.gemMask.children[1].y) {\r\n            $globalParam.default.currGemIdInfo = -1;\r\n            t.prototype.onClickClose.call(this);\r\n            e.stopPropagationImmediate();\r\n        }\r\n    };\r\n    e.prototype.onClickClose = function () {\r\n        $globalParam.default.currGemIdInfo = -1;\r\n        t.prototype.onClickClose.call(this);\r\n    };\r\n    e.prototype.clickEmbed = function () {\r\n        $remoteAudio.default.instance.playEffectMusic(\"Click\");\r\n        if (!this.changeMask.active) {\r\n            if ($equipmentContext.default.Ins.hasSameGem(this.config.part, this.config.id)) {\r\n                $uIManager.UIManager.instance.showToast(\"宝石已存在\");\r\n            } else {\r\n                {\r\n                    if ($equipmentContext.default.Ins.gemCount(this.config.part) >= 5) {\r\n                        this.gemMask.active = !1;\r\n                        return void (this.changeMask.active = !0);\r\n                    }\r\n                    $equipmentContext.default.Ins.setGem(this.config.part, this.config.id);\r\n                    this.render();\r\n                    $eventManager.default.send($localEventName.default.RENDER_GEM);\r\n                    $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.Role);\r\n                    $globalParam.default.currGemIdInfo = -1;\r\n                    t.prototype.onClickClose.call(this);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    e.prototype.clickLock = function () {\r\n        var t = $roleContext.default.ins.lockAndUnlock(this.config.id);\r\n        this.btnLock.children[1].active = t;\r\n        $eventManager.default.send($localEventName.default.RENDER_GEM);\r\n    };\r\n    e.prototype.openAnim = function () {\r\n        return null;\r\n    };\r\n    e.prototype.closeAnim = function () {\r\n        return cc.tween().to(0.15, {\r\n            opacity: 100\r\n        });\r\n    };\r\n    __decorate([S(cc.Node)], e.prototype, \"infoList\", void 0);\r\n    __decorate([S(cc.Sprite)], e.prototype, \"gemIconSp\", void 0);\r\n    __decorate([S(cc.Label)], e.prototype, \"gemName\", void 0);\r\n    __decorate([S(cc.Label)], e.prototype, \"gemDesc\", void 0);\r\n    __decorate([S(cc.Node)], e.prototype, \"embedBtn\", void 0);\r\n    __decorate([S(cc.Node)], e.prototype, \"gemMask\", void 0);\r\n    __decorate([S(cc.Node)], e.prototype, \"changeMask\", void 0);\r\n    __decorate([S(cc.Node)], e.prototype, \"btnLock\", void 0);\r\n    return __decorate([A], e);\r\n})($popupView.PopupView);\r\nexports.default = C;\r\n"]}