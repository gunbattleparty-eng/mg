{"version":3,"sources":["assets\\game_script\\scripts\\SweepView.js"],"names":["o","$assetsLoader","require","$assetsMap","$resUtil","$eventManager","$list","$popupManager","$uIManager","$popupView","$platform","$remoteAudio","$countDownUtil","$seedUtil","$util","$aD","$adService","$battleContext","$configContext","$localEventName","$skillContext","$userDataContext","$startView","P","cc","_decorator","R","ccclass","B","property","x","t","e","apply","arguments","levelLabel","coinLabel","skillLable","timeLabel","list","enemptyTip","resdieLabel","btnAd","btnGina","sweepRewards","__extends","prototype","onLoad","Ins","getSweepTime","caculateReward","renderTime","schedule","numItems","length","onResetView","getLastRecord","level","string","i","instance","getSweepConfig","rewardnum","sweepQuikCount","children","active","node","getComponent","Button","interactable","updateMaterialState","addEvent","on","clickAd","clickGain","removeEvent","off","opearPower","UIManager","showToast","playEffectMusic","autoSeep","reward","showRewardedVideo","Platform","currPlatForm","PlatformEnum","TOU_TIAO","toutiao","report","sweep","updateAll","send","RENDER_DOT","MenuType","Battle","type","opearCoin","num","opearSkillBook","ext","PopupManager","open","AssetsMap","PopUpBundles","prefabs","assetsList","RewardView","infos","deepCopy","ALL","n","s","push","r","init","sweepInfo","seed","randomFrom","a","randomFromSync","l","getUseSkillIds","Math","min","randomArrSync","c","splitNumber","u","lastSweepTime","CountDownUtil","currTime","formatDate","ceil","renderItem","loadRes","BundleNames","Public","SpriteFrame","isValid","Sprite","spriteFrame","ResUtil","assignWith","Label","toString","skillConfigs","find","id","Public_Res","icon","__decorate","Node","PopupView","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var o;\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar $resUtil = require(\"./ResUtil\");\r\nvar $eventManager = require(\"./EventManager\");\r\nvar $list = require(\"./List\");\r\nvar $popupManager = require(\"./PopupManager\");\r\nvar $uIManager = require(\"./UIManager\");\r\nvar $popupView = require(\"./PopupView\");\r\nvar $platform = require(\"./Platform\");\r\nvar $remoteAudio = require(\"./RemoteAudio\");\r\nvar $countDownUtil = require(\"./CountDownUtil\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $aD = require(\"./AD\");\r\nvar $adService = require(\"./AdService\");\r\nvar $battleContext = require(\"./BattleContext\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $localEventName = require(\"./LocalEventName\");\r\nvar $skillContext = require(\"./SkillContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar $startView = require(\"./StartView\");\r\nvar P = cc._decorator;\r\nvar R = P.ccclass;\r\nvar B = P.property;\r\nvar x = (function (t) {\r\n    function e() {\r\n        var e = (null !== t && t.apply(this, arguments)) || this;\r\n        e.levelLabel = null;\r\n        e.coinLabel = null;\r\n        e.skillLable = null;\r\n        e.timeLabel = null;\r\n        e.list = null;\r\n        e.enemptyTip = null;\r\n        e.resdieLabel = null;\r\n        e.btnAd = null;\r\n        e.btnGina = null;\r\n        e.sweepRewards = [];\r\n        return e;\r\n    }\r\n    __extends(e, t);\r\n    e.prototype.onLoad = function () {\r\n        var t = $userDataContext.default.Ins.getSweepTime();\r\n        this.sweepRewards = this.caculateReward(t);\r\n        this.renderTime();\r\n        this.schedule(this.renderTime, 1);\r\n        this.list.numItems = this.sweepRewards.length;\r\n    };\r\n    e.prototype.onResetView = function () {\r\n        var t = $battleContext.default.Ins.getLastRecord();\r\n        var e = 0 !== t.level ? t.level : 1;\r\n        this.levelLabel.string = \"第\" + t.level + \"关\";\r\n        var i = $configContext.default.instance.getSweepConfig(e);\r\n        this.coinLabel.string = \"\" + i.rewardnum[0];\r\n        this.skillLable.string = \"\" + i.rewardnum[1];\r\n        var o = $userDataContext.default.Ins.sweepQuikCount();\r\n        this.resdieLabel.string = o + \"/4\";\r\n        this.btnAd.children[0].active = o < 4;\r\n        this.btnAd.children[2].active = 4 === o;\r\n        this.list.node.active = 0 !== this.sweepRewards.length;\r\n        this.enemptyTip.active = 0 === this.sweepRewards.length;\r\n        this.btnAd.getComponent(cc.Button).interactable = o > 0;\r\n        $util.default.updateMaterialState(this.btnAd, o <= 0);\r\n    };\r\n    e.prototype.addEvent = function () {\r\n        this.btnAd.on(\"click\", this.clickAd, this);\r\n        this.btnGina.on(\"click\", this.clickGain, this);\r\n    };\r\n    e.prototype.removeEvent = function () {\r\n        this.btnAd.off(\"click\", this.clickAd, this);\r\n        this.btnGina.off(\"click\", this.clickGain, this);\r\n    };\r\n    e.prototype.clickAd = function () {\r\n        var t = this;\r\n        if ($userDataContext.default.Ins.sweepQuikCount() > 3) {\r\n            if (!$userDataContext.default.Ins.opearPower(-5)) {\r\n                return void $uIManager.UIManager.instance.showToast(\"体力不足\");\r\n            }\r\n            $remoteAudio.default.instance.playEffectMusic(\"Click\");\r\n            $userDataContext.default.Ins.autoSeep();\r\n            var e = this.caculateReward(8, !1);\r\n            this.reward(e);\r\n            this.onResetView();\r\n        } else {\r\n            $adService.default.Ins.showRewardedVideo(function () {\r\n                if ($platform.Platform.currPlatForm === $platform.PlatformEnum.TOU_TIAO) {\r\n                    $aD.default.toutiao.report(\"sweep\");\r\n                }\r\n                $userDataContext.default.Ins.autoSeep();\r\n                var e = t.caculateReward(8, !1);\r\n                t.reward(e);\r\n                t.onResetView();\r\n            });\r\n        }\r\n    };\r\n    e.prototype.clickGain = function () {\r\n        $remoteAudio.default.instance.playEffectMusic(\"Click\");\r\n        if (0 !== this.sweepRewards.length) {\r\n            var t = $userDataContext.default.Ins.getSweepTime();\r\n            this.sweepRewards = this.caculateReward(t);\r\n            $userDataContext.default.Ins.sweep();\r\n            this.reward(this.sweepRewards);\r\n            this.sweepRewards.length = 0;\r\n            this.onResetView();\r\n            this.list.numItems = this.sweepRewards.length;\r\n            this.list.updateAll();\r\n            $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.Battle);\r\n        } else {\r\n            $uIManager.UIManager.instance.showToast(\"没有可领取的奖励\");\r\n        }\r\n    };\r\n    e.prototype.reward = function (t) {\r\n        for (var e = 0; e < t.length; e++) {\r\n            var i = t[e];\r\n            1 === i.type\r\n                ? $userDataContext.default.Ins.opearCoin(i.num)\r\n                : 4 === i.type && $userDataContext.default.Ins.opearSkillBook(i.num, i.ext);\r\n        }\r\n        $popupManager.PopupManager.instance.open($assetsMap.AssetsMap.PopUpBundles.prefabs.assetsList.RewardView, {\r\n            infos: $util.default.deepCopy(t)\r\n        });\r\n        $eventManager.default.send($localEventName.default.RENDER_DOT, $startView.MenuType.ALL);\r\n    };\r\n    e.prototype.caculateReward = function (t, e) {\r\n        if (void 0 === e) {\r\n            e = !0;\r\n        }\r\n        var i = [];\r\n        if (t <= 0) {\r\n            return i;\r\n        }\r\n        var o = $battleContext.default.Ins.getLastRecord();\r\n        var n = 0 !== o.level ? o.level : 1;\r\n        var s = $configContext.default.instance.getSweepConfig(n);\r\n        i.push({\r\n            type: 1,\r\n            num: s.rewardnum[0] * t\r\n        });\r\n        var r = s.rewardnum[1] * t;\r\n        e\r\n            ? $seedUtil.default.init($userDataContext.default.Ins.sweepInfo.seed)\r\n            : $seedUtil.default.init($seedUtil.default.randomFrom(0, 9999999));\r\n        var a = $seedUtil.default.randomFromSync(1, 4);\r\n        var l = $skillContext.default.Ins.getUseSkillIds();\r\n        a = Math.min(l.length, a);\r\n        a = Math.min(r, a);\r\n        l = $seedUtil.default.randomArrSync(l, a);\r\n        var c = $seedUtil.default.splitNumber(r, a, !0);\r\n        for (var u = 0; u < a; u++) {\r\n            $userDataContext.default.Ins.opearSkillBook(l[u], c[u]);\r\n            i.push({\r\n                type: 4,\r\n                ext: l[u],\r\n                num: c[u]\r\n            });\r\n        }\r\n        return i;\r\n    };\r\n    e.prototype.renderTime = function () {\r\n        var t = $userDataContext.default.Ins.sweepInfo.lastSweepTime;\r\n        var e = $countDownUtil.CountDownUtil.currTime - t;\r\n        if (e > 288e5) {\r\n            e = 288e5;\r\n        }\r\n        var i = $util.default.formatDate(Math.ceil(e / 1e3));\r\n        this.timeLabel.string = i[0] + \":\" + i[1] + \":\" + i[2];\r\n    };\r\n    e.prototype.renderItem = function (t, e) {\r\n        var i = this;\r\n        var o = this.sweepRewards[e];\r\n        if (1 === o.type) {\r\n            $assetsLoader.default.instance.loadRes(\r\n                $assetsMap.BundleNames.Public,\r\n                [\"/textures/gem/jinbi\"],\r\n                cc.SpriteFrame,\r\n                null,\r\n                function (e, n) {\r\n                    var s = n[0];\r\n                    if (s && cc.isValid(t)) {\r\n                        t.children[0].getComponent(cc.Sprite).spriteFrame = $resUtil.ResUtil.assignWith(s, i.node);\r\n                        t.children[1].getComponent(cc.Label).string = o.num.toString();\r\n                    }\r\n                }\r\n            );\r\n        } else {\r\n            if (4 === o.type) {\r\n                var n = $configContext.default.instance.skillConfigs.find(function (t) {\r\n                    return t.id === o.ext;\r\n                });\r\n                $assetsLoader.default.instance.loadRes(\r\n                    $assetsMap.BundleNames.Public_Res,\r\n                    [\"/skill_book/\" + n.icon],\r\n                    cc.SpriteFrame,\r\n                    null,\r\n                    function (e, n) {\r\n                        var s = n[0];\r\n                        if (s && cc.isValid(t)) {\r\n                            t.children[0].getComponent(cc.Sprite).spriteFrame = $resUtil.ResUtil.assignWith(s, i.node);\r\n                            t.children[1].getComponent(cc.Label).string = o.num.toString();\r\n                        }\r\n                    }\r\n                );\r\n            }\r\n        }\r\n    };\r\n    __decorate([B(cc.Label)], e.prototype, \"levelLabel\", void 0);\r\n    __decorate([B(cc.Label)], e.prototype, \"coinLabel\", void 0);\r\n    __decorate([B(cc.Label)], e.prototype, \"skillLable\", void 0);\r\n    __decorate([B(cc.Label)], e.prototype, \"timeLabel\", void 0);\r\n    __decorate([B($list.default)], e.prototype, \"list\", void 0);\r\n    __decorate([B(cc.Node)], e.prototype, \"enemptyTip\", void 0);\r\n    __decorate([B(cc.Label)], e.prototype, \"resdieLabel\", void 0);\r\n    __decorate([B(cc.Node)], e.prototype, \"btnAd\", void 0);\r\n    __decorate([B(cc.Node)], e.prototype, \"btnGina\", void 0);\r\n    return __decorate([R], e);\r\n})($popupView.PopupView);\r\nexports.default = x;\r\n"]}