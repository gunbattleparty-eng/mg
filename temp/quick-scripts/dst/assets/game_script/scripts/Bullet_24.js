
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Bullet_24.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '2d7c4BJ/PZGOp945G8HggM0', 'Bullet_24');
// game_script/scripts/Bullet_24.js

"use strict";

var o;

var $object = require("./Object");

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $configContext = require("./ConfigContext");

var $gameContext = require("./GameContext");

var $enemyStatus = require("./EnemyStatus");

var $baseBullet = require("./BaseBullet");

var h = cc._decorator;
var m = h.ccclass;
var y = (h.property, function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.buttleType = $baseBullet.BulletType.oil;
    e.enemys = new Set();
    e.targetPos = null;
    e.targetEnemy = null;
    e.flyTime = 0;
    e.timeLeft = 0;
    return e;
  }

  __extends(e, t);

  e.prototype.initButtle = function (e, i) {
    t.prototype.initButtle.call(this, e, i);
    this.speed = this.skillParam.oilSpeed;
    this.velocity.set(e).multiplyScalar(this.speed);
    this.setAngle(0);
    this.timeLeft = 0;
    this.flyTime = this.targetPos.sub(this.getPosition()).mag() / this.speed;
  };

  e.prototype.onTrigger = function (t, e) {
    if (!this.isUse) {
      if (e == $object.Trigger.enter) {
        var i = t.object;
        this.enemys.add(i);
      } else {
        if (e == $object.Trigger.exit) {
          i = t.object;
          this.enemys["delete"](i);
        }
      }
    }
  };

  e.prototype.updateFrame = function (e) {
    if (!this.isUse) {
      t.prototype.updateFrame.call(this, e);
      this.timeLeft += e;

      if (this.timeLeft >= this.flyTime) {
        this.timeLeft = this.flyTime;
        this.isUse = !0;
      }

      this.node.children[0].scale = this.easeSine(this.timeLeft, 1, 0.5, this.flyTime);

      if (this.isUse) {
        this.attack();
        this.removeSelf();
      }
    }
  };

  e.prototype.attack = function () {
    var t = this;
    this.enemys.forEach(function (e) {
      e.sufferDebuff({
        type: $enemyStatus.EnemyDebuffType.BACK,
        timeLeft: -1,
        value: t.skillParam.oilBack
      });

      if (t.skillParam.oilExtraSend && t.targetEnemy && t.targetEnemy === e && t.enemys.has(e) && 2 !== t.targetEnemy.config.monster_type) {
        t.createSelf();
      }
    });
    this.createBoom();
    this.createBurnArea();
  };

  e.prototype.createSelf = function () {
    var t = $gameContext["default"].ins.getRandomEnemy();

    if (t) {
      var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.oil);

      if (!e) {
        var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_24);
        (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
      }

      e.targetPos = t.getPosition().clone();
      e.targetEnemy = null;
      e.setPosition(this.getPosition());
      var o = t.getPosition().sub(this.getPosition()).normalize();
      e.initButtle(o, this.skillId);
      e.insert($gameContext["default"].ins.buttleLayer);
    }
  };

  e.prototype.createBoom = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.oil_boom);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_25);
      (t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.lowBulletLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = this.skillSpecialitys;
    }

    t.setPosition(this.getPosition());
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.lowBulletLayer);
    t.setAnimation(null);
  };

  e.prototype.createBurnArea = function () {
    var t = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.oil_burn_area);

    if (!t) {
      var e = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_26);
      (t = $resUtil.ResUtil.instantiate(e, $gameContext["default"].ins.floorLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = this.skillSpecialitys;
    }

    t.setPosition(this.getPosition());
    t.initButtle(null, this.skillId);
    t.insert($gameContext["default"].ins.floorLayer);
  };

  e.prototype.easeSine = function (t, e, i, o) {
    return i * Math.sin(t / o * Math.PI) + e;
  };

  return __decorate([m], e);
}($baseBullet["default"]));
exports["default"] = y;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEJ1bGxldF8yNC5qcyJdLCJuYW1lcyI6WyJvIiwiJG9iamVjdCIsInJlcXVpcmUiLCIkYXNzZXRzTG9hZGVyIiwiJGFzc2V0c01hcCIsIiRyZXNVdGlsIiwiJGNvbmZpZ0NvbnRleHQiLCIkZ2FtZUNvbnRleHQiLCIkZW5lbXlTdGF0dXMiLCIkYmFzZUJ1bGxldCIsImgiLCJjYyIsIl9kZWNvcmF0b3IiLCJtIiwiY2NjbGFzcyIsInkiLCJwcm9wZXJ0eSIsInQiLCJlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJidXR0bGVUeXBlIiwiQnVsbGV0VHlwZSIsIm9pbCIsImVuZW15cyIsIlNldCIsInRhcmdldFBvcyIsInRhcmdldEVuZW15IiwiZmx5VGltZSIsInRpbWVMZWZ0IiwiX19leHRlbmRzIiwicHJvdG90eXBlIiwiaW5pdEJ1dHRsZSIsImkiLCJjYWxsIiwic3BlZWQiLCJza2lsbFBhcmFtIiwib2lsU3BlZWQiLCJ2ZWxvY2l0eSIsInNldCIsIm11bHRpcGx5U2NhbGFyIiwic2V0QW5nbGUiLCJzdWIiLCJnZXRQb3NpdGlvbiIsIm1hZyIsIm9uVHJpZ2dlciIsImlzVXNlIiwiVHJpZ2dlciIsImVudGVyIiwib2JqZWN0IiwiYWRkIiwiZXhpdCIsInVwZGF0ZUZyYW1lIiwibm9kZSIsImNoaWxkcmVuIiwic2NhbGUiLCJlYXNlU2luZSIsImF0dGFjayIsInJlbW92ZVNlbGYiLCJmb3JFYWNoIiwic3VmZmVyRGVidWZmIiwidHlwZSIsIkVuZW15RGVidWZmVHlwZSIsIkJBQ0siLCJ2YWx1ZSIsIm9pbEJhY2siLCJvaWxFeHRyYVNlbmQiLCJoYXMiLCJjb25maWciLCJtb25zdGVyX3R5cGUiLCJjcmVhdGVTZWxmIiwiY3JlYXRlQm9vbSIsImNyZWF0ZUJ1cm5BcmVhIiwiaW5zIiwiZ2V0UmFuZG9tRW5lbXkiLCJnZXRCdXR0bGVQb29sIiwiaW5zdGFuY2UiLCJnZXRSZXMiLCJCdW5kbGVOYW1lcyIsIkdhbWUiLCJBc3NldHNNYXAiLCJHYW1lQnVuZGxlcyIsInByZWZhYnMiLCJhc3NldHNMaXN0IiwiQnVsbGV0XzI0IiwiUmVzVXRpbCIsImluc3RhbnRpYXRlIiwiYnV0dGxlTGF5ZXIiLCJwYXJlbnQiLCJnZXRDb21wb25lbnQiLCJza2lsbFNwZWNpYWxpdHlzIiwiYmFzaWNTa2lsbENvbmZpZ01hcCIsImdldCIsInNraWxsSWQiLCJza2lsbF90cHllIiwiY2xvbmUiLCJzZXRQb3NpdGlvbiIsIm5vcm1hbGl6ZSIsImluc2VydCIsIm9pbF9ib29tIiwiQnVsbGV0XzI1IiwibG93QnVsbGV0TGF5ZXIiLCJzZXRBbmltYXRpb24iLCJvaWxfYnVybl9hcmVhIiwiQnVsbGV0XzI2IiwiZmxvb3JMYXllciIsIk1hdGgiLCJzaW4iLCJQSSIsIl9fZGVjb3JhdGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxJQUFJQyxhQUFhLEdBQUdELE9BQU8sQ0FBQyxnQkFBRCxDQUEzQjs7QUFDQSxJQUFJRSxVQUFVLEdBQUdGLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLElBQUlHLFFBQVEsR0FBR0gsT0FBTyxDQUFDLFdBQUQsQ0FBdEI7O0FBQ0EsSUFBSUksY0FBYyxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBNUI7O0FBQ0EsSUFBSUssWUFBWSxHQUFHTCxPQUFPLENBQUMsZUFBRCxDQUExQjs7QUFDQSxJQUFJTSxZQUFZLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlPLFdBQVcsR0FBR1AsT0FBTyxDQUFDLGNBQUQsQ0FBekI7O0FBQ0EsSUFBSVEsQ0FBQyxHQUFHQyxFQUFFLENBQUNDLFVBQVg7QUFDQSxJQUFJQyxDQUFDLEdBQUdILENBQUMsQ0FBQ0ksT0FBVjtBQUNBLElBQUlDLENBQUMsSUFDQUwsQ0FBQyxDQUFDTSxRQUFGLEVBQ0EsVUFB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QixFQUVKM0UsVUFBVSxDQUFDNEUsU0FBWCxDQUFxQkMsV0FBckIsQ0FBaUNDLE9BQWpDLENBQXlDQyxVQUF6QyxDQUFvRHFCLFNBRmhELENBQVI7TUFJQSxDQUFDdkYsQ0FBQyxHQUFHWixRQUFRLENBQUNnRixPQUFULENBQWlCQyxXQUFqQixDQUE2QnBFLENBQTdCLEVBQWdDWCxZQUFZLFdBQVosQ0FBcUJrRSxHQUFyQixDQUF5QmdDLFVBQXpCLENBQW9DakIsTUFBcEUsRUFBNEVDLFlBQTVFLENBQ0RoRixXQUFXLFdBRFYsQ0FBTCxFQUVHaUYsZ0JBRkgsR0FFc0IsS0FBS0EsZ0JBRjNCO0lBR0g7O0lBQ0R6RSxDQUFDLENBQUMrRSxXQUFGLENBQWMsS0FBS3JELFdBQUwsRUFBZDtJQUNBMUIsQ0FBQyxDQUFDZSxVQUFGLENBQWEsSUFBYixFQUFtQixLQUFLNkQsT0FBeEI7SUFDQTVFLENBQUMsQ0FBQ2lGLE1BQUYsQ0FBUzNGLFlBQVksV0FBWixDQUFxQmtFLEdBQXJCLENBQXlCZ0MsVUFBbEM7RUFDSCxDQWREOztFQWVBdkYsQ0FBQyxDQUFDYSxTQUFGLENBQVl5QixRQUFaLEdBQXVCLFVBQVV2QyxDQUFWLEVBQWFDLENBQWIsRUFBZ0JlLENBQWhCLEVBQW1CakMsQ0FBbkIsRUFBc0I7SUFDekMsT0FBT2lDLENBQUMsR0FBR3lFLElBQUksQ0FBQ0MsR0FBTCxDQUFVMUYsQ0FBQyxHQUFHakIsQ0FBTCxHQUFVMEcsSUFBSSxDQUFDRSxFQUF4QixDQUFKLEdBQWtDMUYsQ0FBekM7RUFDSCxDQUZEOztFQUdBLE9BQU8yRixVQUFVLENBQUMsQ0FBQ2hHLENBQUQsQ0FBRCxFQUFNSyxDQUFOLENBQWpCO0FBQ0gsQ0EvSEQsQ0ErSEdULFdBQVcsV0EvSGQsQ0FGQyxDQUFMO0FBa0lBcUcsT0FBTyxXQUFQLEdBQWtCL0YsQ0FBbEIiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBvO1xyXG52YXIgJG9iamVjdCA9IHJlcXVpcmUoXCIuL09iamVjdFwiKTtcclxudmFyICRhc3NldHNMb2FkZXIgPSByZXF1aXJlKFwiLi9Bc3NldHNMb2FkZXJcIik7XHJcbnZhciAkYXNzZXRzTWFwID0gcmVxdWlyZShcIi4vQXNzZXRzTWFwXCIpO1xyXG52YXIgJHJlc1V0aWwgPSByZXF1aXJlKFwiLi9SZXNVdGlsXCIpO1xyXG52YXIgJGNvbmZpZ0NvbnRleHQgPSByZXF1aXJlKFwiLi9Db25maWdDb250ZXh0XCIpO1xyXG52YXIgJGdhbWVDb250ZXh0ID0gcmVxdWlyZShcIi4vR2FtZUNvbnRleHRcIik7XHJcbnZhciAkZW5lbXlTdGF0dXMgPSByZXF1aXJlKFwiLi9FbmVteVN0YXR1c1wiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyIGggPSBjYy5fZGVjb3JhdG9yO1xyXG52YXIgbSA9IGguY2NjbGFzcztcclxudmFyIHkgPVxyXG4gICAgKGgucHJvcGVydHksXHJcbiAgICAoZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICBmdW5jdGlvbiBlKCkge1xyXG4gICAgICAgICAgICB2YXIgZSA9IChudWxsICE9PSB0ICYmIHQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfHwgdGhpcztcclxuICAgICAgICAgICAgZS5idXR0bGVUeXBlID0gJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5vaWw7XHJcbiAgICAgICAgICAgIGUuZW5lbXlzID0gbmV3IFNldCgpO1xyXG4gICAgICAgICAgICBlLnRhcmdldFBvcyA9IG51bGw7XHJcbiAgICAgICAgICAgIGUudGFyZ2V0RW5lbXkgPSBudWxsO1xyXG4gICAgICAgICAgICBlLmZseVRpbWUgPSAwO1xyXG4gICAgICAgICAgICBlLnRpbWVMZWZ0ID0gMDtcclxuICAgICAgICAgICAgcmV0dXJuIGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIF9fZXh0ZW5kcyhlLCB0KTtcclxuICAgICAgICBlLnByb3RvdHlwZS5pbml0QnV0dGxlID0gZnVuY3Rpb24gKGUsIGkpIHtcclxuICAgICAgICAgICAgdC5wcm90b3R5cGUuaW5pdEJ1dHRsZS5jYWxsKHRoaXMsIGUsIGkpO1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5za2lsbFBhcmFtLm9pbFNwZWVkO1xyXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnNldChlKS5tdWx0aXBseVNjYWxhcih0aGlzLnNwZWVkKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRBbmdsZSgwKTtcclxuICAgICAgICAgICAgdGhpcy50aW1lTGVmdCA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZmx5VGltZSA9IHRoaXMudGFyZ2V0UG9zLnN1Yih0aGlzLmdldFBvc2l0aW9uKCkpLm1hZygpIC8gdGhpcy5zcGVlZDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLm9uVHJpZ2dlciA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1VzZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUgPT0gJG9iamVjdC5UcmlnZ2VyLmVudGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSB0Lm9iamVjdDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZW15cy5hZGQoaSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlID09ICRvYmplY3QuVHJpZ2dlci5leGl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0Lm9iamVjdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmVteXMuZGVsZXRlKGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUudXBkYXRlRnJhbWUgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNVc2UpIHtcclxuICAgICAgICAgICAgICAgIHQucHJvdG90eXBlLnVwZGF0ZUZyYW1lLmNhbGwodGhpcywgZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVMZWZ0ICs9IGU7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1lTGVmdCA+PSB0aGlzLmZseVRpbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVMZWZ0ID0gdGhpcy5mbHlUaW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNVc2UgPSAhMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5jaGlsZHJlblswXS5zY2FsZSA9IHRoaXMuZWFzZVNpbmUodGhpcy50aW1lTGVmdCwgMSwgMC41LCB0aGlzLmZseVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNVc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dGFjaygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5hdHRhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gdGhpcztcclxuICAgICAgICAgICAgdGhpcy5lbmVteXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5zdWZmZXJEZWJ1ZmYoe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICRlbmVteVN0YXR1cy5FbmVteURlYnVmZlR5cGUuQkFDSyxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lTGVmdDogLTEsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQuc2tpbGxQYXJhbS5vaWxCYWNrXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgICAgICB0LnNraWxsUGFyYW0ub2lsRXh0cmFTZW5kICYmXHJcbiAgICAgICAgICAgICAgICAgICAgdC50YXJnZXRFbmVteSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIHQudGFyZ2V0RW5lbXkgPT09IGUgJiZcclxuICAgICAgICAgICAgICAgICAgICB0LmVuZW15cy5oYXMoZSkgJiZcclxuICAgICAgICAgICAgICAgICAgICAyICE9PSB0LnRhcmdldEVuZW15LmNvbmZpZy5tb25zdGVyX3R5cGVcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHQuY3JlYXRlU2VsZigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVCb29tKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlQnVybkFyZWEoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZVNlbGYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB0ID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldFJhbmRvbUVuZW15KCk7XHJcbiAgICAgICAgICAgIGlmICh0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZSA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUub2lsKTtcclxuICAgICAgICAgICAgICAgIGlmICghZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzI0XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAoZSA9ICRyZXNVdGlsLlJlc1V0aWwuaW5zdGFudGlhdGUoaSwgJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYmFzZUJ1bGxldC5kZWZhdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgKSkuc2tpbGxTcGVjaWFsaXR5cyA9ICRjb25maWdDb250ZXh0LmRlZmF1bHQuaW5zdGFuY2UuYmFzaWNTa2lsbENvbmZpZ01hcC5nZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxJZFxyXG4gICAgICAgICAgICAgICAgICAgICkuc2tpbGxfdHB5ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUudGFyZ2V0UG9zID0gdC5nZXRQb3NpdGlvbigpLmNsb25lKCk7XHJcbiAgICAgICAgICAgICAgICBlLnRhcmdldEVuZW15ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGUuc2V0UG9zaXRpb24odGhpcy5nZXRQb3NpdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIHZhciBvID0gdC5nZXRQb3NpdGlvbigpLnN1Yih0aGlzLmdldFBvc2l0aW9uKCkpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgICAgICAgICAgZS5pbml0QnV0dGxlKG8sIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgICAgICAgICBlLmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBlLnByb3RvdHlwZS5jcmVhdGVCb29tID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUub2lsX2Jvb20pO1xyXG4gICAgICAgICAgICBpZiAoIXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlID0gJGFzc2V0c0xvYWRlci5kZWZhdWx0Lmluc3RhbmNlLmdldFJlcyhcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkJ1bmRsZU5hbWVzLkdhbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8yNVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICh0ID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShlLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgJGJhc2VCdWxsZXQuZGVmYXVsdFxyXG4gICAgICAgICAgICAgICAgKSkuc2tpbGxTcGVjaWFsaXR5cyA9IHRoaXMuc2tpbGxTcGVjaWFsaXR5cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0LnNldFBvc2l0aW9uKHRoaXMuZ2V0UG9zaXRpb24oKSk7XHJcbiAgICAgICAgICAgIHQuaW5pdEJ1dHRsZShudWxsLCB0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgICAgICB0Lmluc2VydCgkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMubG93QnVsbGV0TGF5ZXIpO1xyXG4gICAgICAgICAgICB0LnNldEFuaW1hdGlvbihudWxsKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGUucHJvdG90eXBlLmNyZWF0ZUJ1cm5BcmVhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdCA9ICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5nZXRCdXR0bGVQb29sKCRiYXNlQnVsbGV0LkJ1bGxldFR5cGUub2lsX2J1cm5fYXJlYSk7XHJcbiAgICAgICAgICAgIGlmICghdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGUgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgICAgICRhc3NldHNNYXAuQnVuZGxlTmFtZXMuR2FtZSxcclxuICAgICAgICAgICAgICAgICAgICAkYXNzZXRzTWFwLkFzc2V0c01hcC5HYW1lQnVuZGxlcy5wcmVmYWJzLmFzc2V0c0xpc3QuQnVsbGV0XzI2XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgKHQgPSAkcmVzVXRpbC5SZXNVdGlsLmluc3RhbnRpYXRlKGUsICRnYW1lQ29udGV4dC5kZWZhdWx0Lmlucy5mbG9vckxheWVyLnBhcmVudCkuZ2V0Q29tcG9uZW50KFxyXG4gICAgICAgICAgICAgICAgICAgICRiYXNlQnVsbGV0LmRlZmF1bHRcclxuICAgICAgICAgICAgICAgICkpLnNraWxsU3BlY2lhbGl0eXMgPSB0aGlzLnNraWxsU3BlY2lhbGl0eXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdC5zZXRQb3NpdGlvbih0aGlzLmdldFBvc2l0aW9uKCkpO1xyXG4gICAgICAgICAgICB0LmluaXRCdXR0bGUobnVsbCwgdGhpcy5za2lsbElkKTtcclxuICAgICAgICAgICAgdC5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmZsb29yTGF5ZXIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZS5wcm90b3R5cGUuZWFzZVNpbmUgPSBmdW5jdGlvbiAodCwgZSwgaSwgbykge1xyXG4gICAgICAgICAgICByZXR1cm4gaSAqIE1hdGguc2luKCh0IC8gbykgKiBNYXRoLlBJKSArIGU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gX19kZWNvcmF0ZShbbV0sIGUpO1xyXG4gICAgfSkoJGJhc2VCdWxsZXQuZGVmYXVsdCkpO1xyXG5leHBvcnRzLmRlZmF1bHQgPSB5O1xyXG4iXX0=