
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/game_script/scripts/Gun_1.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'ee9c3Ec5pBKQZEoU8HhhcWY', 'Gun_1');
// game_script/scripts/Gun_1.js

"use strict";

var o;

var $assetsLoader = require("./AssetsLoader");

var $assetsMap = require("./AssetsMap");

var $resUtil = require("./ResUtil");

var $eventManager = require("./EventManager");

var $seedUtil = require("./SeedUtil");

var $util = require("./Util");

var $configContext = require("./ConfigContext");

var $localEventName = require("./LocalEventName");

var $baseBullet = require("./BaseBullet");

var $gameContext = require("./GameContext");

var $gameGemInfo = require("./GameGemInfo");

var $gameSkillInfo = require("./GameSkillInfo");

var _ = cc._decorator;
var k = _.ccclass;
var v = _.property;

var b = function (t) {
  function e() {
    var e = null !== t && t.apply(this, arguments) || this;
    e.point = null;
    e.residueChangeTime = 0;
    e.residueButtleCount = 0;
    e.isShoot = !1;
    e.isAttacking = !1;
    e.schedules = [];
    e.count = 0;
    e.skillId = 1;
    return e;
  }

  __extends(e, t);

  e.prototype.start = function () {
    this.skillParam = $gameContext["default"].ins.skillInfo.getSkillById(this.skillId);
    this.residueButtleCount = this.skillParam.bulletCount;
    this.residueChangeTime = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL];
    $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, -1, this.residueButtleCount);
  };

  e.prototype.notifyChangeReloadAnimStart = function () {
    this.isShoot = !0;
    $eventManager["default"].send($localEventName["default"].CHANGE_RELOAD_ANIM, !0);
  };

  e.prototype.notifyChangeReloadAnimEnd = function () {
    this.isShoot = !1;
    $eventManager["default"].send($localEventName["default"].CHANGE_RELOAD_ANIM, !1);
  };

  e.prototype.sendButtle = function (t) {
    var e = this;
    this.isAttacking = !0;
    --this.residueButtleCount;
    $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, -1, this.residueButtleCount);

    if (this.residueButtleCount <= 0) {
      this.notifyChangeReloadAnimStart();
    }

    var i = 150 / this.skillParam.bulletSpeed;
    var o = 0;
    var n = this.skillParam.bulletComboCount + 1;

    if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.AddSkill) && $seedUtil["default"].probability(100 * $gameGemInfo.GameGemInfo.ins.get1($gameGemInfo.GemType.AddSkill))) {
      n *= 2;
    }

    for (var s = 0; s < n; s++) {
      this.schedulesOnce2(function () {
        e.createButtle(t);
        var i = $util["default"].dirConverAngle(t);

        if (e.skillParam.bulletParallelCount >= 1) {
          e.createButtle($util["default"].angleConverDir(i + 5));
        }

        if (e.skillParam.bulletParallelCount >= 2) {
          e.createButtle($util["default"].angleConverDir(i - 5));
        }

        if (++o === n) {
          e.isAttacking = !1;
        }
      }, i * s);
    }
  };

  e.prototype.schedulesOnce2 = function (t, e) {
    this.schedules.push({
      cb: t,
      sec: e
    });
  };

  e.prototype.createButtle = function (t) {
    var e = $gameContext["default"].ins.getButtlePool($baseBullet.BulletType.normal_bullet);

    if (!e) {
      var i = $assetsLoader["default"].instance.getRes($assetsMap.BundleNames.Game, $assetsMap.AssetsMap.GameBundles.prefabs.assetsList.Bullet_1);
      (e = $resUtil.ResUtil.instantiate(i, $gameContext["default"].ins.buttleLayer.parent).getComponent($baseBullet["default"])).skillSpecialitys = $configContext["default"].instance.basicSkillConfigMap.get(this.skillId).skill_tpye;
    }

    var o = $gameContext["default"].ins.buttleLayer.convertToNodeSpaceAR(this.point.convertToWorldSpaceAR(cc.Vec3.ZERO));
    e.setPosition(o);
    e.initButtle(t, this.skillId);
    e.insert($gameContext["default"].ins.buttleLayer);
  };

  e.prototype.updateF = function (t) {
    this.count = this.schedules.length;

    for (var e = 0; e < this.count; e++) {
      var i = this.schedules.shift();
      i.sec = i.sec - t;
      i.sec <= 0 ? i.cb() : this.schedules.push(i);
    }

    if (!this.isAttacking) {
      this.isShoot ? (this.residueChangeTime -= t, $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, this.residueChangeTime / this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], -1), this.residueChangeTime <= 0 && (this.isShoot = !1, this.residueChangeTime = this.skillParam.skillCD[$gameSkillInfo.Skill4Param.FINAL], this.residueButtleCount = this.skillParam.bulletCount, $eventManager["default"].send($localEventName["default"].RENDER_SKILL_CD_INFO, this.skillId, 0, -1), this.notifyChangeReloadAnimEnd())) : this.residueButtleCount <= 0 && (this.isShoot = !0, this.notifyChangeReloadAnimStart());
    }
  };

  __decorate([v(cc.Node)], e.prototype, "point", void 0);

  return __decorate([k], e);
}(cc.Component);

exports["default"] = b;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcZ2FtZV9zY3JpcHRcXHNjcmlwdHNcXEd1bl8xLmpzIl0sIm5hbWVzIjpbIm8iLCIkYXNzZXRzTG9hZGVyIiwicmVxdWlyZSIsIiRhc3NldHNNYXAiLCIkcmVzVXRpbCIsIiRldmVudE1hbmFnZXIiLCIkc2VlZFV0aWwiLCIkdXRpbCIsIiRjb25maWdDb250ZXh0IiwiJGxvY2FsRXZlbnROYW1lIiwiJGJhc2VCdWxsZXQiLCIkZ2FtZUNvbnRleHQiLCIkZ2FtZUdlbUluZm8iLCIkZ2FtZVNraWxsSW5mbyIsIl8iLCJjYyIsIl9kZWNvcmF0b3IiLCJrIiwiY2NjbGFzcyIsInYiLCJwcm9wZXJ0eSIsImIiLCJ0IiwiZSIsImFwcGx5IiwiYXJndW1lbnRzIiwicG9pbnQiLCJyZXNpZHVlQ2hhbmdlVGltZSIsInJlc2lkdWVCdXR0bGVDb3VudCIsImlzU2hvb3QiLCJpc0F0dGFja2luZyIsInNjaGVkdWxlcyIsImNvdW50Iiwic2tpbGxJZCIsIl9fZXh0ZW5kcyIsInByb3RvdHlwZSIsInN0YXJ0Iiwic2tpbGxQYXJhbSIsImlucyIsInNraWxsSW5mbyIsImdldFNraWxsQnlJZCIsImJ1bGxldENvdW50Iiwic2tpbGxDRCIsIlNraWxsNFBhcmFtIiwiRklOQUwiLCJzZW5kIiwiUkVOREVSX1NLSUxMX0NEX0lORk8iLCJub3RpZnlDaGFuZ2VSZWxvYWRBbmltU3RhcnQiLCJDSEFOR0VfUkVMT0FEX0FOSU0iLCJub3RpZnlDaGFuZ2VSZWxvYWRBbmltRW5kIiwic2VuZEJ1dHRsZSIsImkiLCJidWxsZXRTcGVlZCIsIm4iLCJidWxsZXRDb21ib0NvdW50IiwiR2FtZUdlbUluZm8iLCJoYXNHZW0iLCJHZW1UeXBlIiwiQWRkU2tpbGwiLCJwcm9iYWJpbGl0eSIsImdldDEiLCJzIiwic2NoZWR1bGVzT25jZTIiLCJjcmVhdGVCdXR0bGUiLCJkaXJDb252ZXJBbmdsZSIsImJ1bGxldFBhcmFsbGVsQ291bnQiLCJhbmdsZUNvbnZlckRpciIsInB1c2giLCJjYiIsInNlYyIsImdldEJ1dHRsZVBvb2wiLCJCdWxsZXRUeXBlIiwibm9ybWFsX2J1bGxldCIsImluc3RhbmNlIiwiZ2V0UmVzIiwiQnVuZGxlTmFtZXMiLCJHYW1lIiwiQXNzZXRzTWFwIiwiR2FtZUJ1bmRsZXMiLCJwcmVmYWJzIiwiYXNzZXRzTGlzdCIsIkJ1bGxldF8xIiwiUmVzVXRpbCIsImluc3RhbnRpYXRlIiwiYnV0dGxlTGF5ZXIiLCJwYXJlbnQiLCJnZXRDb21wb25lbnQiLCJza2lsbFNwZWNpYWxpdHlzIiwiYmFzaWNTa2lsbENvbmZpZ01hcCIsImdldCIsInNraWxsX3RweWUiLCJjb252ZXJ0VG9Ob2RlU3BhY2VBUiIsImNvbnZlcnRUb1dvcmxkU3BhY2VBUiIsIlZlYzMiLCJaRVJPIiwic2V0UG9zaXRpb24iLCJpbml0QnV0dGxlIiwiaW5zZXJ0IiwidXBkYXRlRiIsImxlbmd0aCIsInNoaWZ0IiwiX19kZWNvcmF0ZSIsIk5vZGUiLCJDb21wb25lbnQiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLENBQUo7O0FBQ0EsSUFBSUMsYUFBYSxHQUFHQyxPQUFPLENBQUMsZ0JBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsVUFBVSxHQUFHRCxPQUFPLENBQUMsYUFBRCxDQUF4Qjs7QUFDQSxJQUFJRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxXQUFELENBQXRCOztBQUNBLElBQUlHLGFBQWEsR0FBR0gsT0FBTyxDQUFDLGdCQUFELENBQTNCOztBQUNBLElBQUlJLFNBQVMsR0FBR0osT0FBTyxDQUFDLFlBQUQsQ0FBdkI7O0FBQ0EsSUFBSUssS0FBSyxHQUFHTCxPQUFPLENBQUMsUUFBRCxDQUFuQjs7QUFDQSxJQUFJTSxjQUFjLEdBQUdOLE9BQU8sQ0FBQyxpQkFBRCxDQUE1Qjs7QUFDQSxJQUFJTyxlQUFlLEdBQUdQLE9BQU8sQ0FBQyxrQkFBRCxDQUE3Qjs7QUFDQSxJQUFJUSxXQUFXLEdBQUdSLE9BQU8sQ0FBQyxjQUFELENBQXpCOztBQUNBLElBQUlT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ciBvO1xyXG52YXIgJGFzc2V0c0xvYWRlciA9IHJlcXVpcmUoXCIuL0Fzc2V0c0xvYWRlclwiKTtcclxudmFyICRhc3NldHNNYXAgPSByZXF1aXJlKFwiLi9Bc3NldHNNYXBcIik7XHJcbnZhciAkcmVzVXRpbCA9IHJlcXVpcmUoXCIuL1Jlc1V0aWxcIik7XHJcbnZhciAkZXZlbnRNYW5hZ2VyID0gcmVxdWlyZShcIi4vRXZlbnRNYW5hZ2VyXCIpO1xyXG52YXIgJHNlZWRVdGlsID0gcmVxdWlyZShcIi4vU2VlZFV0aWxcIik7XHJcbnZhciAkdXRpbCA9IHJlcXVpcmUoXCIuL1V0aWxcIik7XHJcbnZhciAkY29uZmlnQ29udGV4dCA9IHJlcXVpcmUoXCIuL0NvbmZpZ0NvbnRleHRcIik7XHJcbnZhciAkbG9jYWxFdmVudE5hbWUgPSByZXF1aXJlKFwiLi9Mb2NhbEV2ZW50TmFtZVwiKTtcclxudmFyICRiYXNlQnVsbGV0ID0gcmVxdWlyZShcIi4vQmFzZUJ1bGxldFwiKTtcclxudmFyICRnYW1lQ29udGV4dCA9IHJlcXVpcmUoXCIuL0dhbWVDb250ZXh0XCIpO1xyXG52YXIgJGdhbWVHZW1JbmZvID0gcmVxdWlyZShcIi4vR2FtZUdlbUluZm9cIik7XHJcbnZhciAkZ2FtZVNraWxsSW5mbyA9IHJlcXVpcmUoXCIuL0dhbWVTa2lsbEluZm9cIik7XHJcbnZhciBfID0gY2MuX2RlY29yYXRvcjtcclxudmFyIGsgPSBfLmNjY2xhc3M7XHJcbnZhciB2ID0gXy5wcm9wZXJ0eTtcclxudmFyIGIgPSAoZnVuY3Rpb24gKHQpIHtcclxuICAgIGZ1bmN0aW9uIGUoKSB7XHJcbiAgICAgICAgdmFyIGUgPSAobnVsbCAhPT0gdCAmJiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpIHx8IHRoaXM7XHJcbiAgICAgICAgZS5wb2ludCA9IG51bGw7XHJcbiAgICAgICAgZS5yZXNpZHVlQ2hhbmdlVGltZSA9IDA7XHJcbiAgICAgICAgZS5yZXNpZHVlQnV0dGxlQ291bnQgPSAwO1xyXG4gICAgICAgIGUuaXNTaG9vdCA9ICExO1xyXG4gICAgICAgIGUuaXNBdHRhY2tpbmcgPSAhMTtcclxuICAgICAgICBlLnNjaGVkdWxlcyA9IFtdO1xyXG4gICAgICAgIGUuY291bnQgPSAwO1xyXG4gICAgICAgIGUuc2tpbGxJZCA9IDE7XHJcbiAgICAgICAgcmV0dXJuIGU7XHJcbiAgICB9XHJcbiAgICBfX2V4dGVuZHMoZSwgdCk7XHJcbiAgICBlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNraWxsUGFyYW0gPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuc2tpbGxJbmZvLmdldFNraWxsQnlJZCh0aGlzLnNraWxsSWQpO1xyXG4gICAgICAgIHRoaXMucmVzaWR1ZUJ1dHRsZUNvdW50ID0gdGhpcy5za2lsbFBhcmFtLmJ1bGxldENvdW50O1xyXG4gICAgICAgIHRoaXMucmVzaWR1ZUNoYW5nZVRpbWUgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF07XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoXHJcbiAgICAgICAgICAgICRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLFxyXG4gICAgICAgICAgICB0aGlzLnNraWxsSWQsXHJcbiAgICAgICAgICAgIC0xLFxyXG4gICAgICAgICAgICB0aGlzLnJlc2lkdWVCdXR0bGVDb3VudFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUubm90aWZ5Q2hhbmdlUmVsb2FkQW5pbVN0YXJ0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuaXNTaG9vdCA9ICEwO1xyXG4gICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LkNIQU5HRV9SRUxPQURfQU5JTSwgITApO1xyXG4gICAgfTtcclxuICAgIGUucHJvdG90eXBlLm5vdGlmeUNoYW5nZVJlbG9hZEFuaW1FbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5pc1Nob290ID0gITE7XHJcbiAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoJGxvY2FsRXZlbnROYW1lLmRlZmF1bHQuQ0hBTkdFX1JFTE9BRF9BTklNLCAhMSk7XHJcbiAgICB9O1xyXG4gICAgZS5wcm90b3R5cGUuc2VuZEJ1dHRsZSA9IGZ1bmN0aW9uICh0KSB7XHJcbiAgICAgICAgdmFyIGUgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuaXNBdHRhY2tpbmcgPSAhMDtcclxuICAgICAgICAtLXRoaXMucmVzaWR1ZUJ1dHRsZUNvdW50O1xyXG4gICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKFxyXG4gICAgICAgICAgICAkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfU0tJTExfQ0RfSU5GTyxcclxuICAgICAgICAgICAgdGhpcy5za2lsbElkLFxyXG4gICAgICAgICAgICAtMSxcclxuICAgICAgICAgICAgdGhpcy5yZXNpZHVlQnV0dGxlQ291bnRcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmICh0aGlzLnJlc2lkdWVCdXR0bGVDb3VudCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Q2hhbmdlUmVsb2FkQW5pbVN0YXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpID0gMTUwIC8gdGhpcy5za2lsbFBhcmFtLmJ1bGxldFNwZWVkO1xyXG4gICAgICAgIHZhciBvID0gMDtcclxuICAgICAgICB2YXIgbiA9IHRoaXMuc2tpbGxQYXJhbS5idWxsZXRDb21ib0NvdW50ICsgMTtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICRnYW1lR2VtSW5mby5HYW1lR2VtSW5mby5pbnMuaGFzR2VtKCRnYW1lR2VtSW5mby5HZW1UeXBlLkFkZFNraWxsKSAmJlxyXG4gICAgICAgICAgICAkc2VlZFV0aWwuZGVmYXVsdC5wcm9iYWJpbGl0eSgxMDAgKiAkZ2FtZUdlbUluZm8uR2FtZUdlbUluZm8uaW5zLmdldDEoJGdhbWVHZW1JbmZvLkdlbVR5cGUuQWRkU2tpbGwpKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICBuICo9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIHMgPSAwOyBzIDwgbjsgcysrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVzT25jZTIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZS5jcmVhdGVCdXR0bGUodCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSA9ICR1dGlsLmRlZmF1bHQuZGlyQ29udmVyQW5nbGUodCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5za2lsbFBhcmFtLmJ1bGxldFBhcmFsbGVsQ291bnQgPj0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuY3JlYXRlQnV0dGxlKCR1dGlsLmRlZmF1bHQuYW5nbGVDb252ZXJEaXIoaSArIDUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChlLnNraWxsUGFyYW0uYnVsbGV0UGFyYWxsZWxDb3VudCA+PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5jcmVhdGVCdXR0bGUoJHV0aWwuZGVmYXVsdC5hbmdsZUNvbnZlckRpcihpIC0gNSkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCsrbyA9PT0gbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGUuaXNBdHRhY2tpbmcgPSAhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgaSAqIHMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5zY2hlZHVsZXNPbmNlMiA9IGZ1bmN0aW9uICh0LCBlKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZXMucHVzaCh7XHJcbiAgICAgICAgICAgIGNiOiB0LFxyXG4gICAgICAgICAgICBzZWM6IGVcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS5jcmVhdGVCdXR0bGUgPSBmdW5jdGlvbiAodCkge1xyXG4gICAgICAgIHZhciBlID0gJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmdldEJ1dHRsZVBvb2woJGJhc2VCdWxsZXQuQnVsbGV0VHlwZS5ub3JtYWxfYnVsbGV0KTtcclxuICAgICAgICBpZiAoIWUpIHtcclxuICAgICAgICAgICAgdmFyIGkgPSAkYXNzZXRzTG9hZGVyLmRlZmF1bHQuaW5zdGFuY2UuZ2V0UmVzKFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5CdW5kbGVOYW1lcy5HYW1lLFxyXG4gICAgICAgICAgICAgICAgJGFzc2V0c01hcC5Bc3NldHNNYXAuR2FtZUJ1bmRsZXMucHJlZmFicy5hc3NldHNMaXN0LkJ1bGxldF8xXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIChlID0gJHJlc1V0aWwuUmVzVXRpbC5pbnN0YW50aWF0ZShpLCAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIucGFyZW50KS5nZXRDb21wb25lbnQoXHJcbiAgICAgICAgICAgICAgICAkYmFzZUJ1bGxldC5kZWZhdWx0XHJcbiAgICAgICAgICAgICkpLnNraWxsU3BlY2lhbGl0eXMgPSAkY29uZmlnQ29udGV4dC5kZWZhdWx0Lmluc3RhbmNlLmJhc2ljU2tpbGxDb25maWdNYXAuZ2V0KHRoaXMuc2tpbGxJZCkuc2tpbGxfdHB5ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG8gPSAkZ2FtZUNvbnRleHQuZGVmYXVsdC5pbnMuYnV0dGxlTGF5ZXIuY29udmVydFRvTm9kZVNwYWNlQVIoXHJcbiAgICAgICAgICAgIHRoaXMucG9pbnQuY29udmVydFRvV29ybGRTcGFjZUFSKGNjLlZlYzMuWkVSTylcclxuICAgICAgICApO1xyXG4gICAgICAgIGUuc2V0UG9zaXRpb24obyk7XHJcbiAgICAgICAgZS5pbml0QnV0dGxlKHQsIHRoaXMuc2tpbGxJZCk7XHJcbiAgICAgICAgZS5pbnNlcnQoJGdhbWVDb250ZXh0LmRlZmF1bHQuaW5zLmJ1dHRsZUxheWVyKTtcclxuICAgIH07XHJcbiAgICBlLnByb3RvdHlwZS51cGRhdGVGID0gZnVuY3Rpb24gKHQpIHtcclxuICAgICAgICB0aGlzLmNvdW50ID0gdGhpcy5zY2hlZHVsZXMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5jb3VudDsgZSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBpID0gdGhpcy5zY2hlZHVsZXMuc2hpZnQoKTtcclxuICAgICAgICAgICAgaS5zZWMgPSBpLnNlYyAtIHQ7XHJcbiAgICAgICAgICAgIGkuc2VjIDw9IDAgPyBpLmNiKCkgOiB0aGlzLnNjaGVkdWxlcy5wdXNoKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuaXNBdHRhY2tpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5pc1Nob290XHJcbiAgICAgICAgICAgICAgICA/ICgodGhpcy5yZXNpZHVlQ2hhbmdlVGltZSAtPSB0KSxcclxuICAgICAgICAgICAgICAgICAgJGV2ZW50TWFuYWdlci5kZWZhdWx0LnNlbmQoXHJcbiAgICAgICAgICAgICAgICAgICAgICAkbG9jYWxFdmVudE5hbWUuZGVmYXVsdC5SRU5ERVJfU0tJTExfQ0RfSU5GTyxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2tpbGxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzaWR1ZUNoYW5nZVRpbWUgLyB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAtMVxyXG4gICAgICAgICAgICAgICAgICApLFxyXG4gICAgICAgICAgICAgICAgICB0aGlzLnJlc2lkdWVDaGFuZ2VUaW1lIDw9IDAgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICgodGhpcy5pc1Nob290ID0gITEpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHRoaXMucmVzaWR1ZUNoYW5nZVRpbWUgPSB0aGlzLnNraWxsUGFyYW0uc2tpbGxDRFskZ2FtZVNraWxsSW5mby5Ta2lsbDRQYXJhbS5GSU5BTF0pLFxyXG4gICAgICAgICAgICAgICAgICAgICAgKHRoaXMucmVzaWR1ZUJ1dHRsZUNvdW50ID0gdGhpcy5za2lsbFBhcmFtLmJ1bGxldENvdW50KSxcclxuICAgICAgICAgICAgICAgICAgICAgICRldmVudE1hbmFnZXIuZGVmYXVsdC5zZW5kKCRsb2NhbEV2ZW50TmFtZS5kZWZhdWx0LlJFTkRFUl9TS0lMTF9DRF9JTkZPLCB0aGlzLnNraWxsSWQsIDAsIC0xKSxcclxuICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5Q2hhbmdlUmVsb2FkQW5pbUVuZCgpKSlcclxuICAgICAgICAgICAgICAgIDogdGhpcy5yZXNpZHVlQnV0dGxlQ291bnQgPD0gMCAmJiAoKHRoaXMuaXNTaG9vdCA9ICEwKSwgdGhpcy5ub3RpZnlDaGFuZ2VSZWxvYWRBbmltU3RhcnQoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIF9fZGVjb3JhdGUoW3YoY2MuTm9kZSldLCBlLnByb3RvdHlwZSwgXCJwb2ludFwiLCB2b2lkIDApO1xyXG4gICAgcmV0dXJuIF9fZGVjb3JhdGUoW2tdLCBlKTtcclxufSkoY2MuQ29tcG9uZW50KTtcclxuZXhwb3J0cy5kZWZhdWx0ID0gYjtcclxuIl19