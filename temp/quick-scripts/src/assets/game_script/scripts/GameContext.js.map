{"version":3,"sources":["assets\\game_script\\scripts\\GameContext.js"],"names":["$collider","require","$seedUtil","$util","$configContext","$baseEnemy","$gameGemInfo","$gameSkillInfo","$skillContext","$userDataContext","$roleContext","$eggEnemy_1","$assetsLoader","$assetsMap","_","t","gameRatio","enemyPool","Map","buttlePool","currEnemys","enemyLayer","enemy2Layer","buttleLayer","floorLayer","debuffLayer","enemyBulletLayer","lowBulletLayer","atkLayer","robotFlyLayer","gameStartTime","currPlayerLevel","currExp","chooseSkillRecord","currLevelConfig","currLevelInfoConfig","hurtRecord","skillInfo","doorInitHp","doorLeftHp","skillBuff","createEnemyProccess","killEnemyCount","warnTimes","isBoss","warnIndex","aginChooseSkillCount","atkColor","cc","Color","WHITE","fromHEX","atkSize","eggEnemy","prototype","hpProccess","parseFloat","toFixed","init","e","i","o","n","length","clear","GameSkillInfo","chooseSkill","deepCopy","Ins","chooseBuff","GameGemInfo","ins","hasGem","GemType","WallAdd","s","get2","getEgg","id","r","instance","getRes","BundleNames","Enemy","c","instantiate","parent","position","v3","h","enemyConfigsMap","get","getComponent","initEnemy","skillConfigsMap","preSkillProccess","splice","loadLevel","__awaiter","__generator","getConfigByLevel","Promise","loadConfigResJson","seedLevel","monster_type","push","time","console","log","error","addExp","needExp","EX","Math","ceil","EX_num","pow","EX_coefficient","has","set","getChoosedSKillCount","getRangeRankEnemy","children","a","currType","abs","node","y","subtract","magSqr","sort","residueDis","getNearbyN2","slice","getRangeRandomEnemyLayer","randomFrom","getRangeRandomEnemyLayerByPos","getRandomEnemys","getPosition","sub","l","randomCount","includes","indexOf","getRandomEnemy","putButtlePool","buttleType","remove","getButtlePool","pop","putEnemyPool","config","getEnemyPool","createNextSkills","skillConfigs","filter","is_buff","checkParentSkill","skill_id","max_num","shuffle","map","skill_weight","weightRandomCount","killBossSkills","mutuallyExclusive","unclock","chooseParentRecord","isUnlock","size","Choose4Skill","getSKillLevel","getCurrEnemyAdd","Monsterspool","addHP","addatk","hurtStatistics","getGameTime","formatDate","floor","cCollider","inst","forEach","destroy","settleReward","reward_num","phase_reward_time","phase_reward_num","type","num","min","splitNumber","ext","u","d","getUseSkillIds","randomArr","m","gemstone_weight","g","gemConfigs","Grade","currSkinInfo","gun","setEgg","pauseReward","addCurrEnemy","removeEnemy","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var $collider = require(\"./Collider\");\r\nvar $seedUtil = require(\"./SeedUtil\");\r\nvar $util = require(\"./Util\");\r\nvar $configContext = require(\"./ConfigContext\");\r\nvar $baseEnemy = require(\"./BaseEnemy\");\r\nvar $gameGemInfo = require(\"./GameGemInfo\");\r\nvar $gameSkillInfo = require(\"./GameSkillInfo\");\r\nvar $skillContext = require(\"./SkillContext\");\r\nvar $userDataContext = require(\"./UserDataContext\");\r\nvar $roleContext = require(\"./RoleContext\");\r\nvar $eggEnemy_1 = require(\"./EggEnemy_1\");\r\nvar $assetsLoader = require(\"./AssetsLoader\");\r\nvar $assetsMap = require(\"./AssetsMap\");\r\nvar _ = (function () {\r\n    function t() {\r\n        this.gameRatio = 1;\r\n        this.enemyPool = new Map();\r\n        this.buttlePool = new Map();\r\n        this.currEnemys = [];\r\n        this.enemyLayer = null;\r\n        this.enemy2Layer = null;\r\n        this.buttleLayer = null;\r\n        this.floorLayer = null;\r\n        this.debuffLayer = null;\r\n        this.enemyBulletLayer = null;\r\n        this.lowBulletLayer = null;\r\n        this.atkLayer = null;\r\n        this.robotFlyLayer = null;\r\n        this.gameStartTime = 0;\r\n        this.currPlayerLevel = 1;\r\n        this.currExp = 0;\r\n        this.chooseSkillRecord = new Map();\r\n        this.currLevelConfig = null;\r\n        this.currLevelInfoConfig = null;\r\n        this.hurtRecord = new Map();\r\n        this.skillInfo = null;\r\n        this.doorInitHp = 3e3;\r\n        this.doorLeftHp = 3e3;\r\n        this.skillBuff = [];\r\n        this.createEnemyProccess = 0;\r\n        this.killEnemyCount = 0;\r\n        this.warnTimes = [];\r\n        this.isBoss = [];\r\n        this.warnIndex = -1;\r\n        this.aginChooseSkillCount = 0;\r\n        this.atkColor = [cc.Color.WHITE, new cc.Color().fromHEX(\"#FF3636\"), new cc.Color().fromHEX(\"#56CC3B\")];\r\n        this.atkSize = [27, 35];\r\n        this.eggEnemy = null;\r\n    }\r\n    t.prototype.hpProccess = function () {\r\n        return parseFloat((this.doorLeftHp / this.doorInitHp).toFixed(2));\r\n    };\r\n    t.prototype.init = function (t, e, i, o, n) {\r\n        this.currEnemys.length = 0;\r\n        this.aginChooseSkillCount = 0;\r\n        this.killEnemyCount = 0;\r\n        this.createEnemyProccess = 0;\r\n        this.gameRatio = 1;\r\n        this.gameStartTime = 0;\r\n        this.currPlayerLevel = 1;\r\n        this.currExp = 0;\r\n        this.chooseSkillRecord.clear();\r\n        this.skillInfo = new $gameSkillInfo.GameSkillInfo();\r\n        this.skillInfo.init();\r\n        this.chooseSkill(1);\r\n        this.skillBuff = $util.default.deepCopy($skillContext.default.Ins.chooseBuff);\r\n        this.chooseBuff();\r\n        this.enemyLayer = t;\r\n        this.enemy2Layer = e;\r\n        this.buttleLayer = i;\r\n        this.floorLayer = o;\r\n        this.debuffLayer = n;\r\n        this.doorInitHp = 3e3;\r\n        if ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.WallAdd)) {\r\n            var s = $gameGemInfo.GameGemInfo.ins.get2($gameGemInfo.GemType.WallAdd);\r\n            this.doorInitHp += s[0];\r\n        }\r\n        this.doorLeftHp = this.doorInitHp;\r\n        if (0 === $userDataContext.default.Ins.getEgg(6) && 6 === this.currLevelInfoConfig.id) {\r\n            var r = $assetsLoader.default.instance.getRes($assetsMap.BundleNames.Enemy, \"/prefabs/EggEnemy_1\");\r\n            var c = cc.instantiate(r);\r\n            c.parent = this.enemyLayer;\r\n            c.position = cc.v3(0, 400);\r\n            var h = $configContext.default.instance.enemyConfigsMap.get(117);\r\n            this.eggEnemy = c.getComponent($eggEnemy_1.default);\r\n            this.eggEnemy.initEnemy(h, 0, 1e5);\r\n        }\r\n    };\r\n    t.prototype.chooseBuff = function () {\r\n        var t = this.skillBuff.length;\r\n        for (var e = 0; e < t; e++) {\r\n            var i = $configContext.default.instance.skillConfigsMap.get(this.skillBuff[e]);\r\n            if (this.preSkillProccess(i)) {\r\n                this.chooseSkill(i.id);\r\n                this.skillBuff.splice(e, 1);\r\n                t--;\r\n                e--;\r\n            }\r\n        }\r\n    };\r\n    t.prototype.loadLevel = function (t) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var e = this;\r\n            return __generator(this, function () {\r\n                this.currLevelInfoConfig = $configContext.default.instance.getConfigByLevel(t);\r\n                return [\r\n                    2,\r\n                    new Promise(function (t) {\r\n                        $configContext.default.instance.loadConfigResJson(\r\n                            [\"/level_\" + $configContext.default.instance.seedLevel],\r\n                            function (i) {\r\n                                e.currLevelConfig = i[0];\r\n                                e.warnTimes.length = 0;\r\n                                e.isBoss.length = 0;\r\n                                e.warnIndex = -1;\r\n                                for (var o = 0; o < e.currLevelConfig.length; o++) {\r\n                                    var n = $configContext.default.instance.enemyConfigsMap.get(\r\n                                        e.currLevelConfig[o].id\r\n                                    ).monster_type;\r\n                                    if (!(2 !== n && 3 !== n)) {\r\n                                        e.warnTimes.push(e.currLevelConfig[o].time - 5);\r\n                                        e.isBoss.push(3 === n);\r\n                                    }\r\n                                }\r\n                                console.log(\"提示时间\", e.warnTimes);\r\n                                if (t) {\r\n                                    t(null);\r\n                                }\r\n                            }\r\n                        );\r\n                    }).catch(function (t) {\r\n                        console.error(t);\r\n                    })\r\n                ];\r\n            });\r\n        });\r\n    };\r\n    t.prototype.addExp = function (t) {\r\n        this.currExp += t;\r\n        var e = this.needExp();\r\n        return this.currExp >= e && (this.currPlayerLevel++, (this.currExp = 0), !0);\r\n    };\r\n    t.prototype.needExp = function () {\r\n        return (\r\n            this.currLevelInfoConfig.EX +\r\n            Math.ceil(\r\n                this.currLevelInfoConfig.EX_num *\r\n                    Math.pow(this.currLevelInfoConfig.EX_coefficient, this.currPlayerLevel - 1)\r\n            )\r\n        );\r\n    };\r\n    t.prototype.chooseSkill = function (t) {\r\n        if (!this.chooseSkillRecord.has(t)) {\r\n            this.chooseSkillRecord.set(t, 0);\r\n        }\r\n        var e = this.chooseSkillRecord.get(t);\r\n        e++;\r\n        this.chooseSkillRecord.set(t, e);\r\n        this.skillInfo.chooseSkill(t);\r\n    };\r\n    t.prototype.getChoosedSKillCount = function (t) {\r\n        return this.chooseSkillRecord.has(t) ? this.chooseSkillRecord.get(t) : 0;\r\n    };\r\n    t.prototype.getRangeRankEnemy = function (t, e, i, o) {\r\n        if (void 0 === i) {\r\n            i = 1;\r\n        }\r\n        if (void 0 === o) {\r\n            o = !1;\r\n        }\r\n        var n = [];\r\n        var s = this.enemyLayer.children.length - i - 1 < 0 ? 0 : this.enemyLayer.children.length - i - 1;\r\n        for (var r = s; r < this.enemyLayer.children.length; r++) {\r\n            var a = this.enemyLayer.children[r].getComponent($baseEnemy.default);\r\n            if (!(this.eggEnemy && this.eggEnemy.currType < 2 && a === this.eggEnemy)) {\r\n                o\r\n                    ? Math.abs(a.node.position.y - t.position.y) < e && n.push(a)\r\n                    : a.node.position.subtract(t.position).magSqr() < e * e && n.push(a);\r\n            }\r\n        }\r\n        for (\r\n            r = s = this.enemy2Layer.children.length - i - 1 < 0 ? 0 : this.enemy2Layer.children.length - i - 1;\r\n            r < this.enemy2Layer.children.length;\r\n            r++\r\n        ) {\r\n            a = this.enemy2Layer.children[r].getComponent($baseEnemy.default);\r\n            o\r\n                ? Math.abs(a.node.position.y - t.position.y) < e && n.push(a)\r\n                : a.node.position.subtract(t.position).magSqr() < e * e && n.push(a);\r\n        }\r\n        n.sort(function (t, e) {\r\n            return e.residueDis - t.residueDis;\r\n        });\r\n        return n.length < i ? null : n[n.length - i];\r\n    };\r\n    t.prototype.getNearbyN2 = function (t, e) {\r\n        var i = [];\r\n        var o = this.enemyLayer.children.length - e - 2 < 0 ? 0 : this.enemyLayer.children.length - e - 2;\r\n        for (var n = o; n < this.enemyLayer.children.length; n++) {\r\n            var s = this.enemyLayer.children[n].getComponent($baseEnemy.default);\r\n            if (!(this.eggEnemy && this.eggEnemy.currType < 2 && s === this.eggEnemy)) {\r\n                if (s.node !== t) {\r\n                    i.push(s);\r\n                }\r\n            }\r\n        }\r\n        for (\r\n            n = o = this.enemy2Layer.children.length - e - 2 < 0 ? 0 : this.enemy2Layer.children.length - e - 2;\r\n            n < this.enemy2Layer.children.length;\r\n            n++\r\n        ) {\r\n            if ((s = this.enemy2Layer.children[n].getComponent($baseEnemy.default)).node !== t) {\r\n                i.push(s);\r\n            }\r\n        }\r\n        i.sort(function (t, e) {\r\n            return t.residueDis - e.residueDis;\r\n        });\r\n        if (i.length > e) {\r\n            i = i.slice(0, e);\r\n        }\r\n        return i;\r\n    };\r\n    t.prototype.getRangeRandomEnemyLayer = function (t, e) {\r\n        if (void 0 === e) {\r\n            e = -1;\r\n        }\r\n        var i = [];\r\n        for (var o = 0; o < this.enemyLayer.children.length; o++) {\r\n            var n = this.enemyLayer.children[o];\r\n            if (\r\n                !(this.eggEnemy && this.eggEnemy.currType < 2 && n === this.eggEnemy.node) &&\r\n                n !== t &&\r\n                (-1 === e || n.position.subtract(t.position).magSqr() < e * e)\r\n            ) {\r\n                var s = n.getComponent($baseEnemy.default);\r\n                i.push(s);\r\n            }\r\n        }\r\n        return i.length <= 0 ? null : i[$seedUtil.default.randomFrom(0, i.length - 1)];\r\n    };\r\n    t.prototype.getRangeRandomEnemyLayerByPos = function (t, e) {\r\n        if (void 0 === e) {\r\n            e = -1;\r\n        }\r\n        var i = [];\r\n        for (var o = 0; o < this.enemyLayer.children.length; o++) {\r\n            var n = this.enemyLayer.children[o];\r\n            if (\r\n                !(this.eggEnemy && this.eggEnemy.currType < 2 && n === this.eggEnemy.node) &&\r\n                (-1 === e || n.position.subtract(t).magSqr() < e * e)\r\n            ) {\r\n                var s = n.getComponent($baseEnemy.default);\r\n                i.push(s);\r\n            }\r\n        }\r\n        return i.length <= 0 ? null : i[$seedUtil.default.randomFrom(0, i.length - 1)];\r\n    };\r\n    t.prototype.getRandomEnemys = function (t, e, i) {\r\n        var o = -1;\r\n        var n = [];\r\n        var s = 9999;\r\n        for (var a = 0; a < this.currEnemys.length; a++) {\r\n            if (\r\n                this.currEnemys[a].residueDis < s &&\r\n                this.currEnemys[a].node !== t &&\r\n                this.currEnemys[a].getPosition().sub(t.position).magSqr() <= i * i\r\n            ) {\r\n                s = this.currEnemys[a].residueDis;\r\n                o = a;\r\n            }\r\n        }\r\n        if (-1 !== o) {\r\n            n.push(this.currEnemys[o]);\r\n        }\r\n        if (-1 === o || 1 === e) {\r\n            return n;\r\n        }\r\n        var l = $seedUtil.default.randomCount(0, this.currEnemys.length - 1, e);\r\n        if (1 === l.length && l[0] === o) {\r\n            return n;\r\n        }\r\n        l.includes(o) ? l.splice(l.indexOf(o), 1) : l.splice(l.length - 1, 1);\r\n        for (a = 0; a < l.length; a++) {\r\n            n.push(this.currEnemys[l[a]]);\r\n        }\r\n        return n;\r\n    };\r\n    t.prototype.getRandomEnemy = function (e) {\r\n        if (void 0 === e) {\r\n            e = null;\r\n        }\r\n        if (0 === this.currEnemys.length) {\r\n            return null;\r\n        }\r\n        if (e) {\r\n            var i = this.currEnemys.indexOf(e);\r\n            if (-1 !== i && 1 == this.currEnemys.length) {\r\n                return null;\r\n            }\r\n            for (;;) {\r\n                var o = $seedUtil.default.randomFrom(0, t.ins.currEnemys.length - 1);\r\n                if (o !== i) {\r\n                    i = o;\r\n                    break;\r\n                }\r\n            }\r\n            return this.currEnemys[i];\r\n        }\r\n        return t.ins.currEnemys[$seedUtil.default.randomFrom(0, t.ins.currEnemys.length - 1)];\r\n    };\r\n    t.prototype.putButtlePool = function (t) {\r\n        if (!this.buttlePool.has(t.buttleType)) {\r\n            this.buttlePool.set(t.buttleType, []);\r\n        }\r\n        this.buttlePool.get(t.buttleType).push(t);\r\n        t.remove(!1);\r\n    };\r\n    t.prototype.getButtlePool = function (t) {\r\n        return this.buttlePool.has(t) && 0 !== this.buttlePool.get(t).length ? this.buttlePool.get(t).pop() : null;\r\n    };\r\n    t.prototype.putEnemyPool = function (t) {\r\n        if (!this.enemyPool.has(t.config.id)) {\r\n            this.enemyPool.set(t.config.id, []);\r\n        }\r\n        this.enemyPool.get(t.config.id).push(t);\r\n        t.remove(!1);\r\n    };\r\n    t.prototype.getEnemyPool = function (t) {\r\n        return this.enemyPool.has(t) && 0 !== this.enemyPool.get(t).length ? this.enemyPool.get(t).pop() : null;\r\n    };\r\n    t.prototype.createNextSkills = function () {\r\n        var t = this;\r\n        var e = $configContext.default.instance.skillConfigs.filter(function (e) {\r\n            return (\r\n                0 === e.is_buff &&\r\n                t.checkParentSkill(0 === e.skill_id ? e.id : e.skill_id) &&\r\n                t.preSkillProccess(e) &&\r\n                t.getChoosedSKillCount(e.id) < e.max_num\r\n            );\r\n        });\r\n        $util.default.shuffle(e);\r\n        if (0 === e.length) {\r\n            return [];\r\n        }\r\n        if (e.length <= 3) {\r\n            return e.map(function (t) {\r\n                return t.id;\r\n            });\r\n        }\r\n        var i = e.map(function (t) {\r\n            return t.skill_weight;\r\n        });\r\n        var o = $seedUtil.default.weightRandomCount(i, 3, !1);\r\n        var n = [];\r\n        for (var s = 0; s < o.length; s++) {\r\n            n.push(e[o[s]].id);\r\n        }\r\n        return n;\r\n    };\r\n    t.prototype.killBossSkills = function () {\r\n        var t = this;\r\n        var e = $configContext.default.instance.skillConfigs.filter(function (e) {\r\n            return (\r\n                0 === e.is_buff &&\r\n                t.checkParentSkill(0 === e.skill_id ? e.id : e.skill_id) &&\r\n                t.preSkillProccess(e) &&\r\n                t.mutuallyExclusive(e) &&\r\n                t.getChoosedSKillCount(e.id) < e.max_num\r\n            );\r\n        });\r\n        $util.default.shuffle(e);\r\n        if (0 === e.length) {\r\n            return [];\r\n        }\r\n        if (e.length <= 12) {\r\n            return e.map(function (t) {\r\n                return t.id;\r\n            });\r\n        }\r\n        var i = e.map(function (t) {\r\n            return t.skill_weight;\r\n        });\r\n        var o = $seedUtil.default.weightRandomCount(i, 12, !1);\r\n        var n = [];\r\n        for (var s = 0; s < o.length; s++) {\r\n            n.push(e[o[s]].id);\r\n        }\r\n        return n;\r\n    };\r\n    t.prototype.mutuallyExclusive = function (t) {\r\n        for (var e = 0; e < t.unclock[1].length; e++) {\r\n            if (t.unclock[1][e] < 0) {\r\n                return !1;\r\n            }\r\n        }\r\n        return !0;\r\n    };\r\n    t.prototype.checkParentSkill = function (t) {\r\n        return (\r\n            !!this.skillInfo.chooseParentRecord.has(t) ||\r\n            (!!$skillContext.default.Ins.isUnlock(t) &&\r\n                this.skillInfo.chooseParentRecord.size <\r\n                    ($gameGemInfo.GameGemInfo.ins.hasGem($gameGemInfo.GemType.Choose4Skill) ? 4 : 5))\r\n        );\r\n    };\r\n    t.prototype.preSkillProccess = function (t) {\r\n        var e = t.unclock;\r\n        var i = !1;\r\n        if (!(0 === e[1].length || 0 === e[1][0] || $skillContext.default.Ins.getSKillLevel(t.skill_id) >= e[1][0])) {\r\n            i = !0;\r\n        }\r\n        if (i) {\r\n            return !1;\r\n        }\r\n        for (var o = 0; o < e[0].length; o++) {\r\n            var n = e[0][o];\r\n            if (n > 0 && !this.chooseSkillRecord.has(n)) {\r\n                i = !0;\r\n                break;\r\n            }\r\n            if (n < 0 && this.chooseSkillRecord.has(Math.abs(n))) {\r\n                i = !0;\r\n                break;\r\n            }\r\n        }\r\n        return !i;\r\n    };\r\n    t.prototype.getCurrEnemyAdd = function (t) {\r\n        var e = this.currLevelInfoConfig.Monsterspool.indexOf(t);\r\n        return -1 === e ? [0, 0] : [this.currLevelInfoConfig.addHP[e], this.currLevelInfoConfig.addatk[e]];\r\n    };\r\n    t.prototype.hurtStatistics = function (t, e) {\r\n        if (!this.hurtRecord.has(t)) {\r\n            this.hurtRecord.set(t, 0);\r\n        }\r\n        this.hurtRecord.set(t, this.hurtRecord.get(t) + e);\r\n    };\r\n    t.prototype.getGameTime = function (t) {\r\n        if (0 === this.gameStartTime) {\r\n            this.gameStartTime += t;\r\n            return \"00:00\";\r\n        }\r\n        var e = this.gameStartTime + t;\r\n        if (Math.ceil(e) === Math.ceil(this.gameStartTime)) {\r\n            this.gameStartTime = e;\r\n            return \"\";\r\n        }\r\n        this.gameStartTime = e;\r\n        var i = $util.default.formatDate(Math.floor(e));\r\n        return i[1] + \":\" + i[2];\r\n    };\r\n    t.prototype.clear = function () {\r\n        $collider.cCollider.inst.clear();\r\n        this.hurtRecord.clear();\r\n        this.chooseSkillRecord.clear();\r\n        this.enemyPool.forEach(function (t) {\r\n            t.forEach(function (t) {\r\n                return t.destroy();\r\n            });\r\n        });\r\n        this.buttlePool.forEach(function (t) {\r\n            t.forEach(function (t) {\r\n                return t.destroy();\r\n            });\r\n        });\r\n        this.enemyPool.clear();\r\n        this.buttlePool.clear();\r\n    };\r\n    t.prototype.settleReward = function (t) {\r\n        var e = this.currLevelInfoConfig.reward_num;\r\n        if (!t) {\r\n            var i = this.currLevelInfoConfig.phase_reward_time.length - 1;\r\n            for (var o = 0; o < this.currLevelInfoConfig.phase_reward_time.length; o++) {\r\n                if (this.createEnemyProccess <= this.currLevelInfoConfig.phase_reward_time[o]) {\r\n                    i = o;\r\n                    break;\r\n                }\r\n            }\r\n            e = this.currLevelInfoConfig.phase_reward_num[i];\r\n        }\r\n        var n = [];\r\n        n.push({\r\n            type: 1,\r\n            num: e[0]\r\n        });\r\n        n.push({\r\n            type: 2,\r\n            num: e[1]\r\n        });\r\n        if (0 !== e[2]) {\r\n            var s = $seedUtil.default.randomFrom(1, 2);\r\n            s = Math.min(s, e[2]);\r\n            var a = $seedUtil.default.randomCount(1, 6, s);\r\n            var c = $seedUtil.default.splitNumber(e[2], s);\r\n            for (o = 0; o < s; o++) {\r\n                n.push({\r\n                    type: 3,\r\n                    ext: a[o],\r\n                    num: c[o]\r\n                });\r\n            }\r\n        }\r\n        if (0 !== e[3]) {\r\n            var u = $seedUtil.default.randomFrom(1, 4);\r\n            var d = $skillContext.default.Ins.getUseSkillIds();\r\n            u = Math.min(d.length, u);\r\n            d = $seedUtil.default.randomArr(d, u);\r\n            var m = $seedUtil.default.splitNumber(e[3], u);\r\n            for (o = 0; o < u; o++) {\r\n                n.push({\r\n                    type: 4,\r\n                    ext: d[o],\r\n                    num: m[o]\r\n                });\r\n            }\r\n        }\r\n        if (0 !== e[4]) {\r\n            var y = $seedUtil.default.weightRandomCount(this.currLevelInfoConfig.gemstone_weight[1], e[4], !0);\r\n            var g = [];\r\n            for (o = 0; o < y.length; o++) {\r\n                g.push(this.currLevelInfoConfig.gemstone_weight[0][y[o]]);\r\n            }\r\n            var _ = function (t) {\r\n                var e = $configContext.default.instance.gemConfigs.filter(function (e) {\r\n                    return e.Grade === g[t];\r\n                });\r\n                var i = e[$seedUtil.default.randomFrom(0, e.length - 1)].id;\r\n                n.push({\r\n                    type: 5,\r\n                    ext: i,\r\n                    num: 1\r\n                });\r\n            };\r\n            for (o = 0; o < g.length; o++) {\r\n                _(o);\r\n            }\r\n        }\r\n        if (\r\n            t &&\r\n            4 === this.currLevelInfoConfig.id &&\r\n            2 === $roleContext.default.ins.currSkinInfo.gun &&\r\n            0 === $userDataContext.default.Ins.getEgg(4)\r\n        ) {\r\n            n.push({\r\n                type: 9,\r\n                ext: 2,\r\n                num: 1\r\n            });\r\n            $userDataContext.default.Ins.setEgg(4, 1);\r\n        }\r\n        if (\r\n            t &&\r\n            8 === this.currLevelInfoConfig.id &&\r\n            2 === $roleContext.default.ins.currSkinInfo.gun &&\r\n            0 === $userDataContext.default.Ins.getEgg(5)\r\n        ) {\r\n            n.push({\r\n                type: 9,\r\n                ext: 2,\r\n                num: 1\r\n            });\r\n            $userDataContext.default.Ins.setEgg(5, 1);\r\n        }\r\n        return n;\r\n    };\r\n    t.prototype.pauseReward = function () {\r\n        var t = [];\r\n        var e = this.currLevelInfoConfig.phase_reward_time.length - 1;\r\n        for (var i = 0; i < this.currLevelInfoConfig.phase_reward_time.length; i++) {\r\n            if (this.createEnemyProccess <= this.currLevelInfoConfig.phase_reward_time[i]) {\r\n                e = i;\r\n                break;\r\n            }\r\n        }\r\n        var o = this.currLevelInfoConfig.phase_reward_num[e];\r\n        if (0 !== o[0]) {\r\n            t.push({\r\n                type: 1,\r\n                num: o[0]\r\n            });\r\n        }\r\n        if (0 !== o[1]) {\r\n            t.push({\r\n                type: 2,\r\n                num: o[1]\r\n            });\r\n        }\r\n        if (0 !== o[2]) {\r\n            t.push({\r\n                type: 3,\r\n                ext: 0,\r\n                num: o[2]\r\n            });\r\n        }\r\n        if (0 !== o[3]) {\r\n            t.push({\r\n                type: 4,\r\n                ext: 0,\r\n                num: o[3]\r\n            });\r\n        }\r\n        if (0 !== o[4]) {\r\n            t.push({\r\n                type: 5,\r\n                ext: 0,\r\n                num: o[4]\r\n            });\r\n        }\r\n        return t;\r\n    };\r\n    t.prototype.addCurrEnemy = function (t) {\r\n        this.currEnemys.push(t);\r\n    };\r\n    t.prototype.removeEnemy = function (t) {\r\n        var e = this.currEnemys.indexOf(t);\r\n        if (-1 !== e) {\r\n            this.currEnemys.splice(e, 1);\r\n        }\r\n    };\r\n    t.ins = new t();\r\n    return t;\r\n})();\r\nexports.default = _;\r\n"]}